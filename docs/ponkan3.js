!function(i){var r={};function n(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}n.m=i,n.c=r,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},
n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(
4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(t
){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=22)}([function(t,e,i){var r,n,s,o,a,h,u,l,c,d,p,f,m,_,y,v,g,x;function b(t,e
){return t.test(e)}function T(t){var e=t||("undefined"!=typeof navigator?navigator.userAgent:""),i=e.split("[FBAN");void 0!==i[1]&&(e=i[0]),void 0!==(i=e.split("Twitter"))[1]&&(e=i[0]);var r={apple:{phone:b(a,e)&&!b(f,e),ipod:b(h,e),tablet:!b(a,e)&&b(u,e
)&&!b(f,e),device:(b(a,e)||b(h,e)||b(u,e))&&!b(f,e)},amazon:{phone:b(d,e),tablet:!b(d,e)&&b(p,e),device:b(d,e)||b(p,e)},android:{phone:!b(f,e)&&b(d,e)||!b(f,e)&&b(l,e),tablet:!b(f,e)&&!b(d,e)&&!b(l,e)&&(b(p,e)||b(c,e)),device:!b(f,e)&&(b(d,e)||b(p,e)||b(l
,e)||b(c,e))||b(/\bokhttp\b/i,e)},windows:{phone:b(f,e),tablet:b(m,e),device:b(f,e)||b(m,e)},other:{blackberry:b(_,e),blackberry10:b(y,e),opera:b(v,e),firefox:b(x,e),chrome:b(g,e),device:b(_,e)||b(y,e)||b(v,e)||b(x,e)||b(g,e)}}
;return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}o=this,a=/iPhone/i,h=/iPod/i,u=/iPad/i,
l=/\bAndroid(?:.+)Mobile\b/i,c=/Android/i,d=/\bAndroid(?:.+)SD4930UR\b/i,p=/\bAndroid(?:.+)(?:KF[A-Z]{2,4})\b/i,f=/Windows Phone/i,m=/\bWindows(?:.+)ARM\b/i,_=/BlackBerry/i,y=/BB10/i,v=/Opera Mini/i,g=/\b(CriOS|Chrome)(?:.+)Mobile/i,
x=/Mobile(?:.+)Firefox\b/i,t.exports&&"undefined"==typeof window?t.exports=T:t.exports&&"undefined"!=typeof window?(t.exports=T(),t.exports.isMobile=T):(n=[],r=o.isMobile=T(),void 0===(s="function"==typeof r?r.apply(e,n):r)||(t.exports=s))},function(t,e,i
){"use strict";var N=i(27),L=i(29);function I(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=s
,e.resolve=function(t,e){return s(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?s(t,!1,!0).resolveObject(e):e},e.format=function(t){L.isString(t)&&(t=s(t));return t instanceof I?t.format():I.prototype.format.call(t)},e.Url=I
;var F=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,D=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,n=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),U=["'"].concat(n),B=["%","/","?",";","#"].concat(U),k=["/","?","#"],X=/^[+a-z0-9A-Z_-]{0,63}$/,
G=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,V={javascript:!0,"javascript:":!0},j={javascript:!0,"javascript:":!0},H={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Y=i(30);function s(t,e,i){if(t&&L.isObject(t
)&&t instanceof I)return t;var r=new I;return r.parse(t,e,i),r}I.prototype.parse=function(t,e,i){if(!L.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),n=-1!==r&&r<t.indexOf("#")?"?":"#",s=t.split(n)
;s[0]=s[0].replace(/\\/g,"/");var o=t=s.join(n);if(o=o.trim(),!i&&1===t.split("#").length){var a=D.exec(o);if(a)return this.path=o,this.href=o,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?Y.parse(this.search.substr(1)):this.search.substr(1)
):e&&(this.search="",this.query={}),this}var h=F.exec(o);if(h){var u=(h=h[0]).toLowerCase();this.protocol=u,o=o.substr(h.length)}if(i||h||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===o.substr(0,2);!l||h&&j[h]||(o=o.substr(2),this.slashes=!0)}if(!j[h]&&(
l||h&&!H[h])){for(var c,d,p=-1,f=0;f<k.length;f++){-1!==(m=o.indexOf(k[f]))&&(-1===p||m<p)&&(p=m)}-1!==(d=-1===p?o.lastIndexOf("@"):o.lastIndexOf("@",p))&&(c=o.slice(0,d),o=o.slice(d+1),this.auth=decodeURIComponent(c)),p=-1;for(f=0;f<B.length;f++){var m
;-1!==(m=o.indexOf(B[f]))&&(-1===p||m<p)&&(p=m)}-1===p&&(p=o.length),this.host=o.slice(0,p),o=o.slice(p),this.parseHost(),this.hostname=this.hostname||"";var _="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!_)for(
var y=this.hostname.split(/\./),v=(f=0,y.length);f<v;f++){var g=y[f];if(g&&!g.match(X)){for(var x="",b=0,T=g.length;b<T;b++)127<g.charCodeAt(b)?x+="x":x+=g[b];if(!x.match(X)){var E=y.slice(0,f),w=y.slice(f+1),A=g.match(G);A&&(E.push(A[1]),w.unshift(A[2]))
,w.length&&(o="/"+w.join(".")+o),this.hostname=E.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=N.toASCII(this.hostname));var S=this.port?":"+this.port:"",I=this.hostname||""
;this.host=I+S,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!V[u])for(f=0,v=U.length;f<v;f++){var C=U[f];if(-1!==o.indexOf(C)){var O=encodeURIComponent(C);O===C&&(O=escape(C)),o=o.split(C
).join(O)}}var R=o.indexOf("#");-1!==R&&(this.hash=o.substr(R),o=o.slice(0,R));var P=o.indexOf("?");if(-1!==P?(this.search=o.substr(P),this.query=o.substr(P+1),e&&(this.query=Y.parse(this.query)),o=o.slice(0,P)):e&&(this.search="",this.query={}),o&&(
this.pathname=o),H[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){S=this.pathname||"";var M=this.search||"";this.path=S+M}return this.href=this.format(),this},I.prototype.format=function(){var t=this.auth||"";t&&(t=(
t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",n=!1,s="";this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(
n+=":"+this.port)),this.query&&L.isObject(this.query)&&Object.keys(this.query).length&&(s=Y.stringify(this.query));var o=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||H[e])&&!1!==n?(n="//"+(n||""),i&&"/"!==i.charAt(0
)&&(i="/"+i)):n=n||"",r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+n+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(o=o.replace("#","%23"))+r},I.prototype.resolve=function(t){return this.resolveObject(s(t,!1,!0)
).format()},I.prototype.resolveObject=function(t){if(L.isString(t)){var e=new I;e.parse(t,!1,!0),t=e}for(var i=new I,r=Object.keys(this),n=0;n<r.length;n++){var s=r[n];i[s]=this[s]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(
t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var h=o[a];"protocol"!==h&&(i[h]=t[h])}return H[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(
!H[t.protocol]){for(var u=Object.keys(t),l=0;l<u.length;l++){var c=u[l];i[c]=t[c]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||j[t.protocol])i.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););
t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),i.pathname=d.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search
){var p=i.pathname||"",f=i.search||"";i.path=p+f}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var m=i.pathname&&"/"===i.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),y=_||m||i.host&&t.pathname,v=y,
g=i.pathname&&i.pathname.split("/")||[],x=(d=t.pathname&&t.pathname.split("/")||[],i.protocol&&!H[i.protocol]);if(x&&(i.hostname="",i.port=null,i.host&&(""===g[0]?g[0]=i.host:g.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(
""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),y=y&&(""===d[0]||""===g[0])),_)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,g=d;else if(d.length)(g=g||[]
).pop(),g=g.concat(d),i.search=t.search,i.query=t.query;else if(!L.isNullOrUndefined(t.search)){if(x)i.hostname=i.host=g.shift(),(A=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=A.shift(),i.host=i.hostname=A.shift())
;return i.search=t.search,i.query=t.query,L.isNull(i.pathname)&&L.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!g.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,
i.href=i.format(),i;for(var b=g.slice(-1)[0],T=(i.host||t.host||1<g.length)&&("."===b||".."===b)||""===b,E=0,w=g.length;0<=w;w--)"."===(b=g[w])?g.splice(w,1):".."===b?(g.splice(w,1),E++):E&&(g.splice(w,1),E--);if(!y&&!v)for(;E--;)g.unshift("..")
;!y||""===g[0]||g[0]&&"/"===g[0].charAt(0)||g.unshift(""),T&&"/"!==g.join("/").substr(-1)&&g.push("");var A,S=""===g[0]||g[0]&&"/"===g[0].charAt(0);x&&(i.hostname=i.host=S?"":g.length?g.shift():"",(A=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@")
)&&(i.auth=A.shift(),i.host=i.hostname=A.shift()));return(y=y||i.host&&g.length)&&!S&&g.unshift(""),g.length?i.pathname=g.join("/"):(i.pathname=null,i.path=null),L.isNull(i.pathname)&&L.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(
i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},I.prototype.parseHost=function(){var t=this.host,e=r.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)
}},function(t,e,i){"use strict";function r(t,e,i){i=i||2;var r,n,s,o,a,h,u,l=e&&e.length,c=l?e[0]*i:t.length,d=m(t,0,c,i,!0),p=[];if(!d||d.next===d.prev)return p;if(l&&(d=function(t,e,i,r){var n,s,o,a,h,u=[];for(n=0,s=e.length;n<s;n++)o=e[n]*r,
a=n<s-1?e[n+1]*r:t.length,(h=m(t,o,a,r,!1))===h.next&&(h.steiner=!0),u.push(b(h));for(u.sort(v),n=0;n<u.length;n++)g(u[n],i),i=_(i,i.next);return i}(t,e,d,i)),t.length>80*i){r=s=t[0],n=o=t[1];for(var f=i;f<c;f+=i)(a=t[f])<r&&(r=a),(h=t[f+1])<n&&(n=h),
s<a&&(s=a),o<h&&(o=h);u=0!==(u=Math.max(s-r,o-n))?1/u:0}return y(d,p,i,r,n,u),p}function m(t,e,i,r,n){var s,o;if(n===0<I(t,e,i,r))for(s=e;s<i;s+=r)o=h(s,t[s],t[s+1],o);else for(s=i-r;e<=s;s-=r)o=h(s,t[s],t[s+1],o);return o&&a(o,o.next)&&(S(o),o=o.next),o}
function _(t,e){if(!t)return t;e=e||t;var i,r=t;do{if(i=!1,r.steiner||!a(r,r.next)&&0!==E(r.prev,r,r.next))r=r.next;else{if(S(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function y(t,e,i,r,n,s,o){if(t){!o&&s&&function(t,e,i,r){var n=t
;for(;null===n.z&&(n.z=x(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next,n!==t;);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,s,o,a,h,u=1;do{for(i=t,s=t=null,o=0;i;){for(o++,r=i,e=a=0;e<u&&(a++,r=r.nextZ);e++);for(h=u;0<a||0<h&&r;
)0!==a&&(0===h||!r||i.z<=r.z)?(i=(n=i).nextZ,a--):(r=(n=r).nextZ,h--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;i=r}s.nextZ=null,u*=2}while(1<o)}(n)}(t,r,n,s);for(var a,h,u=t;t.prev!==t.next;)if(a=t.prev,h=t.next,s?c(t,r,n,s):l(t))e.push(a.i/i),e.push(t.i/i),e.push(
h.i/i),S(t),t=h.next,u=h.next;else if((t=h)===u){o?1===o?y(t=d(t,e,i),e,i,r,n,s,2):2===o&&p(t,e,i,r,n,s):y(_(t),e,i,r,n,s,1);break}}}function l(t){var e=t.prev,i=t,r=t.next;if(0<=E(e,i,r))return!1;for(var n=t.next.next;n!==t.prev;){if(T(e.x,e.y,i.x,i.y,
r.x,r.y,n.x,n.y)&&0<=E(n.prev,n,n.next))return!1;n=n.next}return!0}function c(t,e,i,r){var n=t.prev,s=t,o=t.next;if(0<=E(n,s,o))return!1;for(var a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,h=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,
u=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,l=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,c=x(a,h,e,i,r),d=x(u,l,e,i,r),p=t.prevZ,f=t.nextZ;p&&p.z>=c&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&T(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&0<=E(p.prev,p,p.next))return!1;if(
p=p.prevZ,f!==t.prev&&f!==t.next&&T(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&0<=E(f.prev,f,f.next))return!1;f=f.nextZ}for(;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&T(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&0<=E(p.prev,p,p.next))return!1;p=p.prevZ}for(;f&&f.z<=d;){if(
f!==t.prev&&f!==t.next&&T(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&0<=E(f.prev,f,f.next))return!1;f=f.nextZ}return!0}function d(t,e,i){var r=t;do{var n=r.prev,s=r.next.next;!a(n,s)&&f(n,r,r.next,s)&&w(n,s)&&w(s,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(s.i/i),S(r)
,S(r.next),r=t=s),r=r.next}while(r!==t);return r}function p(t,e,i,r,n,s){var o,a,h=t;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&(a=u,(o=h).next.i!==a.i&&o.prev.i!==a.i&&!function(t,e){var i=t;do{if(
i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&f(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(o,a)&&w(o,a)&&w(a,o)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;for(;i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(
i.next.y-i.y)+i.x&&(r=!r),i=i.next,i!==t;);return r}(o,a))){var l=A(h,u);return h=_(h,h.next),l=_(l,l.next),y(h,e,i,r,n,s),void y(l,e,i,r,n,s)}u=u.next}h=h.next}while(h!==t)}function v(t,e){return t.x-e.x}function g(t,e){if(e=function(t,e){var i,r=e,n=t.x
,s=t.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&o<a){if((o=a)===n){if(s===r.y)return r;if(s===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(
n===o)return i.prev;var h,u=i,l=i.x,c=i.y,d=1/0;r=i.next;for(;r!==u;)n>=r.x&&r.x>=l&&n!==r.x&&T(s<c?n:o,s,l,c,s<c?o:n,s,r.x,r.y)&&((h=Math.abs(s-r.y)/(n-r.x))<d||h===d&&r.x>i.x)&&w(r,t)&&(i=r,d=h),r=r.next;return i}(t,e)){var i=A(e,t);_(i,i.next)}}
function x(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function b(t){for(
var e=t,i=t;(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),(e=e.next)!==t;);return i}function T(t,e,i,r,n,s,o,a){return 0<=(n-o)*(e-a)-(t-o)*(s-a)&&0<=(t-o)*(r-a)-(i-o)*(e-a)&&0<=(i-o)*(s-a)-(n-o)*(r-a)}function E(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y
)}function a(t,e){return t.x===e.x&&t.y===e.y}function f(t,e,i,r){return!!(a(t,e)&&a(i,r)||a(t,r)&&a(i,e))||0<E(t,e,i)!=0<E(t,e,r)&&0<E(i,r,t)!=0<E(i,r,e)}function w(t,e){return E(t.prev,t,t.next)<0?0<=E(t,e,t.next)&&0<=E(t,t.prev,e):E(t,e,t.prev)<0||E(t,
t.next,e)<0}function A(t,e){var i=new o(t.i,t.x,t.y),r=new o(e.i,e.x,e.y),n=t.next,s=e.prev;return(t.next=e).prev=t,(i.next=n).prev=i,(r.next=i).prev=r,(s.next=r).prev=s,r}function h(t,e,i,r){var n=new o(t,e,i);return r?(n.next=r.next,(n.prev=r
).next.prev=n,r.next=n):(n.prev=n).next=n,n}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function o(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,
this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e,i,r){for(var n=0,s=e,o=i-r;s<i;s+=r)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}t.exports=r,(t.exports.default=r).deviation=function(t,e,i,r){var n=e&&e.length,s=n?e[0]*i:t.length,o=Math.abs(
I(t,0,s,i));if(n)for(var a=0,h=e.length;a<h;a++){var u=e[a]*i,l=a<h-1?e[a+1]*i:t.length;o-=Math.abs(I(t,u,l,i))}var c=0;for(a=0;a<r.length;a+=3){var d=r[a]*i,p=r[a+1]*i,f=r[a+2]*i;c+=Math.abs((t[d]-t[f])*(t[1+p]-t[1+d])-(t[d]-t[p])*(t[1+f]-t[1+d]))}
return 0===o&&0===c?0:Math.abs((c-o)/o)},r.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++)for(var o=0;o<e;o++)i.vertices.push(t[n][s][o]);0<n&&(r+=t[n-1].length,
i.holes.push(r))}return i}},function(t,e,i){"use strict";var r=Object.prototype.hasOwnProperty,p="~";function n(){}function a(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,i,r,n){if("function"!=typeof i)throw new TypeError(
"The listener must be a function");var s=new a(i,r||t,n),o=p?p+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function u(t,e){
0==--t._eventsCount?t._events=new n:delete t._events[e]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(p=!1)),o.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount
)return i;for(e in t=this._events)r.call(t,e)&&i.push(p?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},o.prototype.listeners=function(t){var e=p?p+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn]
;for(var r=0,n=i.length,s=new Array(n);r<n;r++)s[r]=i[r].fn;return s},o.prototype.listenerCount=function(t){var e=p?p+t:t,i=this._events[e];return i?i.fn?1:i.length:0},o.prototype.emit=function(t,e,i,r,n,s){var o=p?p+t:t;if(!this._events[o])return!1;var a
,h,u=this._events[o],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(
u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,n),!0;case 6:return u.fn.call(u.context,e,i,r,n,s),!0}for(h=1,a=new Array(l-1);h<l;h++)a[h-1]=arguments[h];u.fn.apply(u.context,a)}else{var c,d=u.length;for(h=0;h<d;h++)switch(
u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),l){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,i);break;case 4:u[h].fn.call(u[h].context,e,i,r);break;default:if(!a)for(c=1,
a=new Array(l-1);c<l;c++)a[c-1]=arguments[c];u[h].fn.apply(u[h].context,a)}}return!0},o.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,i,r){
var n=p?p+t:t;if(!this._events[n])return this;if(!e)return u(this,n),this;var s=this._events[n];if(s.fn)s.fn!==e||r&&!s.once||i&&s.context!==i||u(this,n);else{for(var o=0,a=[],h=s.length;o<h;o++)(s[o].fn!==e||r&&!s[o].once||i&&s[o].context!==i)&&a.push(
s[o]);a.length?this._events[n]=1===a.length?a[0]:a:u(this,n)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=p?p+t:t,this._events[e]&&u(this,e)):(this._events=new n,this._eventsCount=0),this},
o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=p,o.EventEmitter=o,t.exports=o},function(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}}
;Object.defineProperty(e,"__esModule",{value:!0});function n(t,e,i,r){this.name=t,this.type=e,this.required=i,this.defaultValue=r}e.TagValue=n;function s(t,e,i){this.names=t,this.values=e,this.action=i}e.TagAction=s,e.applyJsEntity=function(t,e){for(
var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=""+e[i];if(0===r.indexOf("&")&&2<=r.length){var n=r.substring(1);e[i]=t.evalJs(n)}}},e.castTagValues=function(r,t){t.values.forEach(function(t){var e=r.values[t.name];if(
null!=e&&typeof e!==t.type){var i=""+e;switch(t.type){case"number":if(r.values[t.name]=+i,isNaN(r.values[t.name]))throw new Error(r.name+"タグの"+t.name+"を数値に変換できませんでした("+i+")");break;case"boolean":r.values[t.name]="true"==i;break;case"string":
r.values[t.name]=i;break;case"function":r.values[t.name]=e;break;case"string|function":r.values[t.name]="string"==typeof e?i:e;break;case"number|array":if("number"==typeof e||"string"==typeof e){if(r.values[t.name]=+i,isNaN(r.values[t.name])
)throw new Error(r.name+"タグの"+t.name+"を数値に変換できませんでした("+i+")")}else r.values[t.name]=e;break;case"string|array":r.values[t.name]="string"==typeof e?i:e;break;case"array":if(!Array.isArray(e))throw new Error(r.name+"タグの"+t.name+"は配列である必要があります")
;r.values[t.name]=e;break;case"object":if("object"!=typeof e||Array.isArray(e))throw new Error(r.name+"タグの"+t.name+"はオブジェクトである必要があります");r.values[t.name]=e}}})};var o=r(i(34)),a=r(i(35)),h=r(i(36)),u=r(i(37)),l=r(i(38)),c=r(i(39)),d=r(i(40)),p=r(i(41)),
f=r(i(42)),m=r(i(43)),_=r(i(44)),y=r(i(45)),v=r(i(46));e.generateTagActions=function(t){return(new Array).concat(_.default(t)).concat(f.default(t)).concat(c.default(t)).concat(d.default(t)).concat(l.default(t)).concat(a.default(t)).concat(o.default(t)
).concat(u.default(t)).concat(m.default(t)).concat(y.default(t)).concat(h.default(t)).concat(v.default(t)).concat(p.default(t))}},function(t,e,i){"use strict";i.r(e);var r={};i.r(r),i.d(r,"AccessibilityManager",function(){return At}),i.d(r,
"accessibleTarget",function(){return wt});var n={};i.r(n),i.d(n,"Extract",function(){return on});var s={};i.r(s),i.d(s,"InteractionData",function(){return Ts}),i.d(s,"InteractionEvent",function(){return ws}),i.d(s,"InteractionManager",function(){return Rs
}),i.d(s,"InteractionTrackingData",function(){return As}),i.d(s,"interactiveTarget",function(){return Cs});var o={};i.r(o),i.d(o,"BasePrepare",function(){return Qx}),i.d(o,"CountLimiter",function(){return Jx}),i.d(o,"Prepare",function(){return ob}),i.d(o,
"TimeLimiter",function(){return lb});var a={};i.r(a),i.d(a,"isMobile",function(){return u.a}),i.d(a,"EventEmitter",function(){return X.a}),i.d(a,"earcut",function(){return V.a}),i.d(a,"url",function(){return H.a}),i.d(a,"BaseTextureCache",function(){
return cT}),i.d(a,"CanvasRenderTarget",function(){return mT}),i.d(a,"DATA_URI",function(){return vT}),i.d(a,"ProgramCache",function(){return uT}),i.d(a,"TextureCache",function(){return lT}),i.d(a,"clearTextureCache",function(){return pT}),i.d(a,
"correctBlendMode",function(){return Jb}),i.d(a,"createIndicesForQuads",function(){return eT}),i.d(a,"decomposeDataUri",function(){return gT}),i.d(a,"deprecation",function(){return ET}),i.d(a,"destroyTextureCache",function(){return dT}),i.d(a,
"determineCrossOrigin",function(){return xT}),i.d(a,"getResolutionOfUrl",function(){return bT}),i.d(a,"hex2rgb",function(){return zb}),i.d(a,"hex2string",function(){return Wb}),i.d(a,"isPow2",function(){return aT}),i.d(a,"isWebGLSupported",function(){
return Yb}),i.d(a,"log2",function(){return hT}),i.d(a,"nextPow2",function(){return oT}),i.d(a,"premultiplyBlendMode",function(){return Zb}),i.d(a,"premultiplyRgba",function(){return Qb}),i.d(a,"premultiplyTint",function(){return $b}),i.d(a,
"premultiplyTintToRgba",function(){return tT}),i.d(a,"removeItems",function(){return iT}),i.d(a,"rgb2hex",function(){return Kb}),i.d(a,"sayHello",function(){return Hb}),i.d(a,"sign",function(){return sT}),i.d(a,"skipHello",function(){return jb}),i.d(a,
"string2hex",function(){return qb}),i.d(a,"trimCanvas",function(){return fT}),i.d(a,"uid",function(){return nT});i(23);var h=i(0),u=i.n(h);var l,c,d,p,f,m,_,y,v,g,x,b,T,E,w,A,S,I,C,O,R,P,M,N,L,F,D,U,B={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,
FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(
/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,
height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,
ROUND_PIXELS:!1},k=i(3),X=i.n(k),G=i(2),V=i.n(G),j=i(1),H=i.n(j);(c=l=l||{})[c.WEBGL_LEGACY=0]="WEBGL_LEGACY",c[c.WEBGL=1]="WEBGL",c[c.WEBGL2=2]="WEBGL2",(p=d=d||{})[p.UNKNOWN=0]="UNKNOWN",p[p.WEBGL=1]="WEBGL",p[p.CANVAS=2]="CANVAS",(m=f=f||{}
)[m.NORMAL=0]="NORMAL",m[m.ADD=1]="ADD",m[m.MULTIPLY=2]="MULTIPLY",m[m.SCREEN=3]="SCREEN",m[m.OVERLAY=4]="OVERLAY",m[m.DARKEN=5]="DARKEN",m[m.LIGHTEN=6]="LIGHTEN",m[m.COLOR_DODGE=7]="COLOR_DODGE",m[m.COLOR_BURN=8]="COLOR_BURN",
m[m.HARD_LIGHT=9]="HARD_LIGHT",m[m.SOFT_LIGHT=10]="SOFT_LIGHT",m[m.DIFFERENCE=11]="DIFFERENCE",m[m.EXCLUSION=12]="EXCLUSION",m[m.HUE=13]="HUE",m[m.SATURATION=14]="SATURATION",m[m.COLOR=15]="COLOR",m[m.LUMINOSITY=16]="LUMINOSITY",
m[m.NORMAL_NPM=17]="NORMAL_NPM",m[m.ADD_NPM=18]="ADD_NPM",m[m.SCREEN_NPM=19]="SCREEN_NPM",m[m.NONE=20]="NONE",m[m.SRC_OVER=0]="SRC_OVER",m[m.SRC_IN=21]="SRC_IN",m[m.SRC_OUT=22]="SRC_OUT",m[m.SRC_ATOP=23]="SRC_ATOP",m[m.DST_OVER=24]="DST_OVER",
m[m.DST_IN=25]="DST_IN",m[m.DST_OUT=26]="DST_OUT",m[m.DST_ATOP=27]="DST_ATOP",m[m.ERASE=26]="ERASE",m[m.SUBTRACT=28]="SUBTRACT",m[m.XOR=29]="XOR",(y=_=_||{})[y.POINTS=0]="POINTS",y[y.LINES=1]="LINES",y[y.LINE_LOOP=2]="LINE_LOOP",
y[y.LINE_STRIP=3]="LINE_STRIP",y[y.TRIANGLES=4]="TRIANGLES",y[y.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",y[y.TRIANGLE_FAN=6]="TRIANGLE_FAN",(g=v=v||{})[g.RGBA=6408]="RGBA",g[g.RGB=6407]="RGB",g[g.ALPHA=6406]="ALPHA",g[g.LUMINANCE=6409]="LUMINANCE",
g[g.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",g[g.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",g[g.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(b=x=x||{})[b.TEXTURE_2D=3553]="TEXTURE_2D",b[b.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",
b[b.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",b[b.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",b[b.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",b[b.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",
b[b.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",b[b.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",b[b.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(E=T=T||{}
)[E.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",E[E.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",E[E.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",E[E.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",E[E.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",
E[E.FLOAT=5126]="FLOAT",E[E.HALF_FLOAT=36193]="HALF_FLOAT",(A=w=w||{})[A.NEAREST=0]="NEAREST",A[A.LINEAR=1]="LINEAR",(I=S=S||{})[I.CLAMP=33071]="CLAMP",I[I.REPEAT=10497]="REPEAT",I[I.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(O=C=C||{})[O.OFF=0]="OFF",
O[O.POW2=1]="POW2",O[O.ON=2]="ON",(P=R=R||{})[P.NPM=0]="NPM",P[P.UNPACK=1]="UNPACK",P[P.PMA=2]="PMA",P[P.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",P[P.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",P[P.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(
N=M=M||{})[N.AUTO=0]="AUTO",N[N.MANUAL=1]="MANUAL",(F=L=L||{}).LOW="lowp",F.MEDIUM="mediump",F.HIGH="highp",(U=D=D||{})[U.NONE=0]="NONE",U[U.SCISSOR=1]="SCISSOR",U[U.STENCIL=2]="STENCIL",U[U.SPRITE=3]="SPRITE",B.RETINA_PREFIX=/@([0-9\.]+)x/
;B.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;!function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[f.NORMAL_NPM]=f.NORMAL,t[f.ADD_NPM]=f.ADD,t[f.SCREEN_NPM]=f.SCREEN,e[f.NORMAL]=f.NORMAL_NPM,e[f.ADD]=f.ADD_NPM,e[f.SCREEN]=f.SCREEN_NPM;var r=[];r.push(e),
r.push(t)}();function Y(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}Object.create(null),Object.create(null);function z(t,e,i){this.canvas=document.createElement("canvas"),
this.context=this.canvas.getContext("2d"),this.resolution=i||B.RESOLUTION,this.resize(t,e)}var W={width:{configurable:!0},height:{configurable:!0}};z.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,
this.canvas.width,this.canvas.height)},z.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},z.prototype.destroy=function(){this.context=null,this.canvas=null},W.width.get=function(){
return this.canvas.width},W.width.set=function(t){this.canvas.width=t},W.height.get=function(){return this.canvas.height},W.height.set=function(t){this.canvas.height=t},Object.defineProperties(z.prototype,W);var q=(K.prototype.clone=function(){
return new K(this.x,this.y)},K.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},K.prototype.copyTo=function(t){return t.set(this.x,this.y),t},K.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},K.prototype.set=function(t,e){
void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e},K);function K(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var Z=(J.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new J(t,e,this._x,this._y)},
J.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},J.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},J.prototype.copyTo=function(t){return t.set(this._x,this._y),t},J.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(J.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(J.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),J);function J(t,e
,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var Q,$,tt=2*Math.PI,et=180/Math.PI,it=Math.PI/180;($=Q=Q||{})[$.POLY=0]="POLY",$[$.RECT=1]="RECT",$[$.CIRC=2]="CIRC",$[$.ELIP=3]="ELIP",$[$.RREC=4]="RREC";var rt=(
nt.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},nt.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},nt.prototype.toArray=function(t,e){
this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),
i[8]=1,i},nt.prototype.apply=function(t,e){e=e||new q;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},nt.prototype.applyInverse=function(t,e){e=e||new q;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y
;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},nt.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},nt.prototype.scale=function(t,e){return this.a*=t
,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},nt.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,
this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},nt.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,
this.ty=t.tx*i+t.ty*n+this.ty,this},nt.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}
,nt.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,
this.ty=e*t.b+this.ty*t.d+t.ty,this},nt.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(tt-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,
t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},nt.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,
this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},nt.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},nt.prototype.clone=function(){var t=new nt;return t.a=this.a,t.b=this.b
,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},nt.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},nt.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,
this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(nt,"IDENTITY",{get:function(){return new nt},enumerable:!0,configurable:!0}),Object.defineProperty(nt,"TEMP_MATRIX",{get:function(){return new nt},enumerable:!0,configurable:!0}),nt);function nt(t,e,i,
r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var st=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ot=[0,1,1,1,0,-1,-1,
-1,0,1,1,1,0,-1,-1,-1],at=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ht=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ut=[],lt=[],ct=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];ut.push(e);for(var i=0;i<16;i++)for(var r=ct(st[t]*st[i]+at[t]*ot[i]),n=ct(
ot[t]*st[i]+ht[t]*ot[i]),s=ct(st[t]*at[i]+at[t]*ht[i]),o=ct(ot[t]*at[i]+ht[t]*ht[i]),a=0;a<16;a++)if(st[a]===r&&ot[a]===n&&at[a]===s&&ht[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new rt;h.set(st[t],ot[t],at[t],ht[t],0,0),lt.push(h)}}();var dt=(
pt.prototype.onChange=function(){this._localID++},pt.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},pt.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},pt.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},pt.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(pt.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),pt.IDENTITY=new pt,pt);function pt(){this.worldTransform=new rt,this.localTransform=new rt,this.position=new Z(this.onChange,
this,0,0),this.scale=new Z(this.onChange,this,1,1),this.pivot=new Z(this.onChange,this,0,0),this.skew=new Z(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var ft=(Object.defineProperty(mt.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(mt.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(mt,"EMPTY"
,{get:function(){return new mt(0,0,0,0)},enumerable:!0,configurable:!0}),mt.prototype.clone=function(){return new mt(this.x,this.y,this.width,this.height)},mt.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},mt.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},mt.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},mt.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},mt.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},mt.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
mt.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},mt);function mt(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=Q.RECT}_t.prototype.clone=function(){return new _t(this.x,this.y,this.radius)},
_t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},_t.prototype.getBounds=function(){return new ft(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function _t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=Q.CIRC}yt.prototype.clone=function(){return new yt(this.x,this.y,this.width,this.height)},yt.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},yt.prototype.getBounds=function(){return new ft(this.x-this.width,this.y-this.height,this.width,this.height)};function yt(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=Q.ELIP}vt.prototype.clone=function(){var t=new vt(this.points.slice());return t.closeStroke=this.closeStroke,t},
vt.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function vt(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof q){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=Q.POLY,this.closeStroke=!0}gt.prototype.clone=function(
){return new gt(this.x,this.y,this.width,this.height,this.radius)},gt.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function gt(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=Q.RREC}B.SORTABLE_CHILDREN=!1;function xt(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}xt.prototype.isEmpty=function(){
return this.minX>this.maxX||this.minY>this.maxY},xt.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},xt.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?ft.EMPTY:((
t=t||new ft(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},xt.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},xt.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},xt.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
xt.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},xt.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},xt.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
xt.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},xt.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},xt.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},xt.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},xt.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},xt.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},xt.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var bt=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new dt,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new xt,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new ft),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new ft),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*et},e.angle.set=function(t){this.transform.rotation=t*it
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function Tt(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}bt.prototype.displayObjectUpdateTransform=bt.prototype.updateTransform;var Et=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=B.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Y(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,Y(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,
e.transform._parentID=-1,Y(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(Tt),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(bt);Et.prototype.containerUpdateTransform=Et.prototype.updateTransform;var wt={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1,accessibleType:"button",
accessiblePointerEvents:"auto",accessibleChildren:!0};bt.mixin(wt);var At=function(t){this._hookDiv=null,(u.a.tablet||u.a.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",
e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(
this),this.isActive=!1,this.isMobileAccessibility=!1,window.addEventListener("keydown",this._onKeyDown,!1)};At.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",
e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()}),
document.body.appendChild(e),this._hookDiv=e},At.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},At.prototype.activate=function(){this.isActive||(this.isActive=!0,
window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))
},At.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessibility&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",
this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},At.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId
);for(var e=t.children,i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}},At.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered)
;var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,r=this.div;r.style.left=t.left+"px",r.style.top=t.top+"px",r.style.width=this.renderer.width+"px",r.style.height=this.renderer.height+"px";for(
var n=0;n<this.children.length;n++){var s=this.children[n];if(s.renderId!==this.renderId)s._accessibleActive=!1,Y(this.children,n,1),this.div.removeChild(s._accessibleDiv),this.pool.push(s._accessibleDiv),s._accessibleDiv=null,n--,
0===this.children.length&&this.deactivate();else{r=s._accessibleDiv;var o=s.hitArea,a=s.worldTransform;s.hitArea?(r.style.left=(a.tx+o.x*a.a)*e+"px",r.style.top=(a.ty+o.y*a.d)*i+"px",r.style.width=o.width*a.a*e+"px",r.style.height=o.height*a.d*i+"px"):(
o=s.getBounds(),this.capHitArea(o),r.style.left=o.x*e+"px",r.style.top=o.y*i+"px",r.style.width=o.width*e+"px",r.style.height=o.height*i+"px",r.title!==s.accessibleTitle&&null!==s.accessibleTitle&&(r.title=s.accessibleTitle),r.getAttribute("aria-label"
)!==s.accessibleHint&&null!==s.accessibleHint&&r.setAttribute("aria-label",s.accessibleHint)),s.accessibleTitle===r.title&&s.tabIndex===r.tabIndex||(r.title=s.accessibleTitle,r.tabIndex=s.tabIndex,this.debug&&this.updateDebugHTML(r))}}this.renderId++}},
At.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},At.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(
t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},At.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",
e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",-1<navigator.userAgent.toLowerCase().indexOf("chrome")?e.setAttribute("aria-live","off"):e.setAttribute(
"aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),
e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(
e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,(t._accessibleDiv=e).displayObject=t,this.children.push(t),
this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},At.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData),e.dispatchEvent(t.target.displayObject,
"pointertap",e.eventData),e.dispatchEvent(t.target.displayObject,"tap",e.eventData)},At.prototype._onFocus=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction
;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},At.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(
t.target.displayObject,"mouseout",e.eventData)},At.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},At.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},At.prototype.destroy=function(){
this.destroyTouchHook(),this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,
this.children=null,this.renderer=null};var St=(It.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,
a);return u===this.items&&this._aliasCount--,this},It.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},It.prototype.add=function(t){return t[this._name]&&(
this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},It.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},It.prototype.contains=function(t){
return-1!==this.items.indexOf(t)},It.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},It.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(It.prototype,"empty",
{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(It.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),It);function It(t){this.items=[],this._name=t,this._aliasCount=0}
Object.defineProperties(St.prototype,{dispatch:{value:St.prototype.emit},run:{value:St.prototype.emit}});var Ct,Ot,Rt,Pt,Mt,Nt,Lt,Ft,Dt,Ut,Bt,kt,Xt,Gt,Vt,jt,Ht,Yt,zt,Wt,qt,Kt,Zt,Jt,Qt,$t,te,ee,ie={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,
FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(
/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,
height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,
ROUND_PIXELS:!1};(Ot=Ct=Ct||{})[Ot.WEBGL_LEGACY=0]="WEBGL_LEGACY",Ot[Ot.WEBGL=1]="WEBGL",Ot[Ot.WEBGL2=2]="WEBGL2",(Pt=Rt=Rt||{})[Pt.UNKNOWN=0]="UNKNOWN",Pt[Pt.WEBGL=1]="WEBGL",Pt[Pt.CANVAS=2]="CANVAS",(Nt=Mt=Mt||{})[Nt.NORMAL=0]="NORMAL",
Nt[Nt.ADD=1]="ADD",Nt[Nt.MULTIPLY=2]="MULTIPLY",Nt[Nt.SCREEN=3]="SCREEN",Nt[Nt.OVERLAY=4]="OVERLAY",Nt[Nt.DARKEN=5]="DARKEN",Nt[Nt.LIGHTEN=6]="LIGHTEN",Nt[Nt.COLOR_DODGE=7]="COLOR_DODGE",Nt[Nt.COLOR_BURN=8]="COLOR_BURN",Nt[Nt.HARD_LIGHT=9]="HARD_LIGHT",
Nt[Nt.SOFT_LIGHT=10]="SOFT_LIGHT",Nt[Nt.DIFFERENCE=11]="DIFFERENCE",Nt[Nt.EXCLUSION=12]="EXCLUSION",Nt[Nt.HUE=13]="HUE",Nt[Nt.SATURATION=14]="SATURATION",Nt[Nt.COLOR=15]="COLOR",Nt[Nt.LUMINOSITY=16]="LUMINOSITY",Nt[Nt.NORMAL_NPM=17]="NORMAL_NPM",
Nt[Nt.ADD_NPM=18]="ADD_NPM",Nt[Nt.SCREEN_NPM=19]="SCREEN_NPM",Nt[Nt.NONE=20]="NONE",Nt[Nt.SRC_OVER=0]="SRC_OVER",Nt[Nt.SRC_IN=21]="SRC_IN",Nt[Nt.SRC_OUT=22]="SRC_OUT",Nt[Nt.SRC_ATOP=23]="SRC_ATOP",Nt[Nt.DST_OVER=24]="DST_OVER",Nt[Nt.DST_IN=25]="DST_IN",
Nt[Nt.DST_OUT=26]="DST_OUT",Nt[Nt.DST_ATOP=27]="DST_ATOP",Nt[Nt.ERASE=26]="ERASE",Nt[Nt.SUBTRACT=28]="SUBTRACT",Nt[Nt.XOR=29]="XOR",(Ft=Lt=Lt||{})[Ft.POINTS=0]="POINTS",Ft[Ft.LINES=1]="LINES",Ft[Ft.LINE_LOOP=2]="LINE_LOOP",Ft[Ft.LINE_STRIP=3]="LINE_STRIP"
,Ft[Ft.TRIANGLES=4]="TRIANGLES",Ft[Ft.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Ft[Ft.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Ut=Dt=Dt||{})[Ut.RGBA=6408]="RGBA",Ut[Ut.RGB=6407]="RGB",Ut[Ut.ALPHA=6406]="ALPHA",Ut[Ut.LUMINANCE=6409]="LUMINANCE",
Ut[Ut.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Ut[Ut.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Ut[Ut.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(kt=Bt=Bt||{})[kt.TEXTURE_2D=3553]="TEXTURE_2D",kt[kt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",
kt[kt.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",kt[kt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",kt[kt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
kt[kt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",kt[kt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",kt[kt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
kt[kt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(Gt=Xt=Xt||{})[Gt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",Gt[Gt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",Gt[Gt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
Gt[Gt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",Gt[Gt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",Gt[Gt.FLOAT=5126]="FLOAT",Gt[Gt.HALF_FLOAT=36193]="HALF_FLOAT",(jt=Vt=Vt||{})[jt.NEAREST=0]="NEAREST",jt[jt.LINEAR=1]="LINEAR",(
Yt=Ht=Ht||{})[Yt.CLAMP=33071]="CLAMP",Yt[Yt.REPEAT=10497]="REPEAT",Yt[Yt.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(Wt=zt=zt||{})[Wt.OFF=0]="OFF",Wt[Wt.POW2=1]="POW2",Wt[Wt.ON=2]="ON",(Kt=qt=qt||{})[Kt.NPM=0]="NPM",Kt[Kt.UNPACK=1]="UNPACK",
Kt[Kt.PMA=2]="PMA",Kt[Kt.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Kt[Kt.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Kt[Kt.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(Jt=Zt=Zt||{})[Jt.AUTO=0]="AUTO",Jt[Jt.MANUAL=1]="MANUAL",($t=Qt=Qt||{}
).LOW="lowp",$t.MEDIUM="mediump",$t.HIGH="highp",(ee=te=te||{})[ee.NONE=0]="NONE",ee[ee.SCISSOR=1]="SCISSOR",ee[ee.STENCIL=2]="STENCIL",ee[ee.SPRITE=3]="SPRITE",ie.RETINA_PREFIX=/@([0-9\.]+)x/;var re,ne=!(ie.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),se="5.2.0"
;var oe=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[Mt.NORMAL_NPM]=Mt.NORMAL,t[Mt.ADD_NPM]=Mt.ADD,t[Mt.SCREEN_NPM]=Mt.SCREEN,e[Mt.NORMAL]=Mt.NORMAL_NPM,e[Mt.ADD]=Mt.ADD_NPM,e[Mt.SCREEN]=Mt.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function ae(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var he=0;function ue(){return++he}function le(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function ce(t){
return!(t&t-1||!t)}function de(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var pe={},fe=Object.create(null),me=Object.create(null);function _e(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||ie.RESOLUTION,this.resize(t,e)}var ye={width:{configurable:!0},height:{configurable:!0}};_e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},_e.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},_e.prototype.destroy=function(){this.context=null,this.canvas=null},ye.width.get=function(){
return this.canvas.width},ye.width.set=function(t){this.canvas.width=t},ye.height.get=function(){return this.canvas.height},ye.height.set=function(t){this.canvas.height=t},Object.defineProperties(_e.prototype,ye);var ve;function ge(t,e){
var i=ie.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var xe,be,Te={};ie.TARGET_FPMS=.06,(be=xe=xe||{})[be.INTERACTION=50]="INTERACTION",be[be.HIGH=25]="HIGH",be[be.NORMAL=0]="NORMAL",be[be.LOW=-25]="LOW",be[be.UTILITY=-50]="UTILITY"
;var Ee=(we.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},we.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),
this._destroyed&&(this.next=null),e},we.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},we.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,
this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},we);function we(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,
this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var Ae=(Se.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},Se.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Se.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},Se.prototype.add=function(t,e,i){return void 0===i&&(i=xe.NORMAL),this._addListener(new Ee(t,e,i))},Se.prototype.addOnce=function(t,e,i){return void 0===i&&(i=xe.NORMAL),this._addListener(new Ee(t,e,i,!0))},
Se.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},Se.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Se.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Se.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},Se.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},Se.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*ie.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(Se.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(Se.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,ie.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(Se.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(Se,"shared",{get:function(){if(!Se._shared){var t=Se._shared=new Se;t.autoStart=!0,t._protected=!0}return Se._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(Se,"system",{get:function(){if(!Se._system){var t=Se._system=new Se;t.autoStart=!0,t._protected=!0}return Se._system},enumerable:!0,configurable:!0}),Se);function Se(){var e=this;this._head=new Ee(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/ie.TARGET_FPMS,this.elapsedMS=1/ie.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}Ie.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,xe.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?Ae.shared:new Ae,t.autoStart&&this.start()},Ie.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function Ie(){}var Ce=(Oe.prototype.clone=function(){return new Oe(this.x,this.y)},
Oe.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},Oe.prototype.copyTo=function(t){return t.set(this.x,this.y),t},Oe.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},Oe.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},Oe);function Oe(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var Re=(Pe.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new Pe(t,e,this._x,this._y)},
Pe.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},Pe.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},Pe.prototype.copyTo=function(t){return t.set(this._x,this._y),t},Pe.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(Pe.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(Pe.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Pe);function Pe(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var Me,Ne,Le=2*Math.PI,Fe=180/Math.PI,De=Math.PI/180;(Ne=Me=Me||{})[Ne.POLY=0]="POLY",Ne[Ne.RECT=1]="RECT",Ne[Ne.CIRC=2]="CIRC",Ne[Ne.ELIP=3]="ELIP",
Ne[Ne.RREC=4]="RREC";var Ue=(Be.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},Be.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
Be.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},Be.prototype.apply=function(t,e){e=e||new Ce;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},Be.prototype.applyInverse=function(t,e){e=e||new Ce;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},Be.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
Be.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},Be.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},Be.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},Be.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},Be.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},Be.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(Le-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},Be.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},Be.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Be.prototype.clone=function(){
var t=new Be;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Be.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Be.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(Be,"IDENTITY",{get:function(){return new Be},enumerable:!0,configurable:!0}),Object.defineProperty(Be,"TEMP_MATRIX",{get:function(){return new Be},
enumerable:!0,configurable:!0}),Be);function Be(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var ke=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Xe=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ge=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ve=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],je=[],He=[],Ye=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];je.push(e);for(
var i=0;i<16;i++)for(var r=Ye(ke[t]*ke[i]+Ge[t]*Xe[i]),n=Ye(Xe[t]*ke[i]+Ve[t]*Xe[i]),s=Ye(ke[t]*Ge[i]+Ge[t]*Ve[i]),o=Ye(Xe[t]*Ge[i]+Ve[t]*Ve[i]),a=0;a<16;a++)if(ke[a]===r&&Xe[a]===n&&Ge[a]===s&&Ve[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Ue
;h.set(ke[t],Xe[t],Ge[t],Ve[t],0,0),He.push(h)}}();var ze={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return ke[t]},uY:function(t){return Xe[t]},vX:function(t){
return Ge[t]},vY:function(t){return Ve[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return je[t][e]},sub:function(t,e){return je[t][ze.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?ze.S:ze.N:2*Math.abs(e)<=Math.abs(t)?0<t?ze.E:ze.W:0<e?0<t?ze.SE:ze.SW:0<t?ze.NE:ze.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=He[ze.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},We=(qe.prototype.onChange=function(){this._localID++},qe.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},qe.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},qe.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},qe.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(qe.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),qe.IDENTITY=new qe,qe);function qe(){this.worldTransform=new Ue,this.localTransform=new Ue,this.position=new Re(this.onChange,
this,0,0),this.scale=new Re(this.onChange,this,1,1),this.pivot=new Re(this.onChange,this,0,0),this.skew=new Re(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var Ke=(Object.defineProperty(Ze.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Ze.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(Ze.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Ze.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Ze,"EMPTY"
,{get:function(){return new Ze(0,0,0,0)},enumerable:!0,configurable:!0}),Ze.prototype.clone=function(){return new Ze(this.x,this.y,this.width,this.height)},Ze.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},Ze.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},Ze.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},Ze.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},Ze.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},Ze.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
Ze.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},Ze);function Ze(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=Me.RECT}Je.prototype.clone=function(){return new Je(this.x,this.y,this.radius)},
Je.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},Je.prototype.getBounds=function(){return new Ke(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function Je(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=Me.CIRC}Qe.prototype.clone=function(){return new Qe(this.x,this.y,this.width,this.height)},Qe.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},Qe.prototype.getBounds=function(){return new Ke(this.x-this.width,this.y-this.height,this.width,this.height)};function Qe(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=Me.ELIP}$e.prototype.clone=function(){var t=new $e(this.points.slice());return t.closeStroke=this.closeStroke,t},
$e.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function $e(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof Ce){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=Me.POLY,this.closeStroke=!0}
ti.prototype.clone=function(){return new ti(this.x,this.y,this.width,this.height,this.radius)},ti.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function ti(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=Me.RREC}ie.SORTABLE_CHILDREN=!1;function ei(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}ei.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},ei.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},ei.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Ke.EMPTY:((
t=t||new Ke(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},ei.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},ei.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},ei.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
ei.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},ei.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},ei.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
ei.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},ei.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},ei.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},ei.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},ei.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},ei.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},ei.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var ii=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new We,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ei,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Ke),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Ke),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*Fe},e.angle.set=function(t){this.transform.rotation=t*De
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function ri(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}ii.prototype.displayObjectUpdateTransform=ii.prototype.updateTransform;var ni=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=ie.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);ae(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,ae(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,ae(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(ri),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(ii);ni.prototype.containerUpdateTransform=ni.prototype.updateTransform;function si(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new St(
"setRealSize",2),this.onUpdate=new St("update"),this.onError=new St("onError",1)}var oi={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};si.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},si.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},si.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},oi.valid.get=function(){return!!this._width&&!!this._height},si.prototype.update=function(){this.destroyed||this.onUpdate.run()},si.prototype.load=function(){return Promise.resolve()},
oi.width.get=function(){return this._width},oi.height.get=function(){return this._height},si.prototype.upload=function(t,e,i){return!1},si.prototype.style=function(t,e,i){return!1},si.prototype.dispose=function(){},si.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(si.prototype,oi);var ai=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(ve=ve||document.createElement("a")).href=t;var i=!(t=H.a.parse(ve.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===qt.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(si),hi=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:ie.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===qt.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(ai),ui=[];function li(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=ui.length-1;0<=n;--n){var s=ui[n];if(s.test&&s.test(t,i))return new s(t,e)}return new hi(t,e)}var ci=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===qt.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(si),di={scaleMode:Vt.NEAREST,format:Dt.RGBA,
alphaMode:qt.NPM},pi=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof si||((t=li(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||ie.RESOLUTION,this.mipmap=void 0!==r?r:ie.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:ie.ANISOTROPIC_LEVEL,
this.wrapMode=h||ie.WRAP_MODE,this.scaleMode=void 0!==s?s:ie.SCALE_MODE,this.format=u||Dt.RGBA,this.type=l||Xt.UNSIGNED_BYTE,this.target=c||Bt.TEXTURE_2D,this.alphaMode=void 0!==i?i:qt.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=ue(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=ce(this.realWidth
)&&ce(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete me[this.cacheId],delete fe[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=ie.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+ue()),t._pixiId);var s=me[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new ci(t,{width:e,height:i}),
s=t instanceof Float32Array?Xt.FLOAT:Xt.UNSIGNED_BYTE;return new o(n,Object.assign(di,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),me[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),me[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=me[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete me[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete me[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);pi._globalBatch=0;var fi=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new pi;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(li(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=Bt.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(si),
mi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(ai),
_i=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=Bt.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=Bt.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(fi);_i.SIDES=6;var yi=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+ue(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(ai)
;yi.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var vi=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=Ae.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(Ae.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(Ae.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&Ae.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(Ae.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(Ae.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(ai);vi.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var gi=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(ai);ui.push(hi,gi,mi,vi,yi,ci,_i,fi);function xi(t){this.renderer=t}
xi.prototype.destroy=function(){this.renderer=null};function bi(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new St("disposeFramebuffer",2)}var Ti=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===qt.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(ci),Ei={colorTexture:{configurable:!0}};Ei.colorTexture.get=function(){return this.colorTextures[0]},bi.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new pi(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},bi.prototype.addDepthTexture=function(t){return this.depthTexture=t||new pi(new Ti(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:Dt.DEPTH_COMPONENT,type:Xt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},bi.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},bi.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},bi.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},bi.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(bi.prototype,Ei);function wi(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var Ai=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new bi(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(pi);wi.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=ze.add(i,ze.NW),this.x0=a+s*ze.uX(i),this.y0=h+o*ze.uY(i),i=ze.add(i,2),this.x1=a+s*ze.uX(i),this.y1=h+o*ze.uY(i),i=ze.add(i,2),this.x2=a+s*ze.uX(i),this.y2=h+o*ze.uY(i),i=ze.add(i,2),
this.x3=a+s*ze.uX(i),this.y3=h+o*ze.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Si=new wi,Ii=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new Ke(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=Si,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new Ce(s.x,s.y):new Ce(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&fe[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===Si&&(this._uvs=new wi),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=ie.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+ue()),t._pixiId);var s=fe[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=ge(t)),(s=new a(new pi(t,e))).baseTexture.cacheId=n,
pi.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(pi.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new hi(t);r.url=e;var n=new a(new pi(r,{scaleMode:ie.SCALE_MODE,resolution:ge(e)}));return i=i||e,
pi.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(pi.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),fe[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),fe[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=fe[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete fe[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)fe[t.textureCacheIds[r]]===t&&delete fe[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function Ci(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Ii.EMPTY=new Ii(new pi),Ci(Ii.EMPTY),Ci(Ii.EMPTY.baseTexture),Ii.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Ii(new pi(new mi(t)))}(),Ci(Ii.WHITE),Ci(Ii.WHITE.baseTexture);function Oi(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var Ri=function(a){function n(t,e){var i=null;if(!(t instanceof Ai)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new Ai({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new Ai(t))},n}(Ii);Oi.prototype.createTexture=function(t,e){var i=new Ai(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Ri(i)},
Oi.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=Oi.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=le(t)))<<16|65535&(e=le(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},Oi.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
Oi.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},Oi.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Oi.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},Oi.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Oi.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Oi.SCREEN_KEY="screen";function Pi(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}Pi.prototype.destroy=function(){this.buffer=null},Pi.from=function(t,e,i,r,n){return new Pi(t,e,i,r,n)};function Mi(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=Ni++,this.disposeRunner=new St("disposeBuffer",2)}var Ni=0;function Li(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Mi.prototype.update=function(t){this.data=t||this.data,this._updateID++},Mi.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Mi.prototype.destroy=function(){this.dispose(),this.data=null},Mi.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Mi(t)};var Fi={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Di(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Bi++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new St("disposeGeometry",2),this.refCount=0}var Ui={5126:4,5123:2,5121:1},Bi=0,ki={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};Di.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Mi(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Pi(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},Di.prototype.getAttribute=function(t){return this.attributes[t]},Di.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},Di.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Mi(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
Di.prototype.getIndex=function(){return this.indexBuffer},Di.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Mi;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Ui[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Li(c)
;n[d]||(n[d]=new Fi[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Di.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Di.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},Di.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Di.prototype.clone=function(){for(var t=new Di,e=0;e<this.buffers.length;e++)t.buffers[e]=new Mi(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new Pi(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},Di.merge=function(t){for(var e,i=new Di,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(ki[Li(e.buffers[h].data)])(n[h]),i.buffers[h]=new Mi(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Ui[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function Xi(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=ji++,this.static=!!e}var Gi=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Di),
Vi=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Mi(this.vertices),this.uvBuffer=new Mi(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Di),ji=0
;Xi.prototype.update=function(){this.dirtyId++},Xi.prototype.add=function(t,e,i){this.uniforms[t]=new Xi(e,i)},Xi.from=function(t,e){return new Xi(t,e)};function Hi(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new Ke,this.destinationFrame=new Ke,this.filters=[]}Hi.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function Yi(t){this.renderer=t}var zi=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new Oi,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Gi,this.quadUv=new Vi,this.tempRect=new Ke,this.activeState={},this.globalUniforms=new Xi({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Hi,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Lt.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(Lt.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
Ue.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(xi);Yi.prototype.flush=function(){},Yi.prototype.destroy=function(){this.renderer=null},Yi.prototype.start=function(){},Yi.prototype.stop=function(){this.flush()},Yi.prototype.render=function(t){};var Wi=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new Yi(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(xi);ie.PREFER_ENV=u.a.any?Ct.WEBGL:Ct.WEBGL2,ie.STRICT_TEXTURE_CACHE=!1
;function qi(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function Ki(t){this.type=te.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var Zi=0,Ji=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Zi++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Zi++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(ie.PREFER_ENV>=Ct.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(xi),Qi=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new bi(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Ke,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;ie.PREFER_ENV===Ct.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Ke},Object.defineProperties(t.prototype,i),t}(xi),$i={5126:4,5123:2,5121:1},
tr=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;ie.PREFER_ENV===Ct.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*$i[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*$i[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*$i[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new qi(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(xi);function er(t,e,i,r){var n=ir(t,t.VERTEX_SHADER,e),s=ir(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function ir(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function rr(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return nr(2*e)
;case"bvec3":return nr(3*e);case"bvec4":return nr(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function nr(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}Ki.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=te.NONE,this.autoDetect=!0),this._target=null},Ki.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var sr,or={},ar=or;function hr(){if(ar===or||ar&&ar.isContextLost()){
var t,e=document.createElement("canvas");ie.PREFER_ENV>=Ct.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),ar=t}return ar}function ur(t,e,i){if(
"precision"===t.substring(0,9))return i!==Qt.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===Qt.HIGH&&i!==Qt.HIGH&&(r=Qt.MEDIUM),"precision "+r+" float;\n"+t}var lr={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var cr=null,dr={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function pr(t,e){if(!cr){var i=Object.keys(dr)
;cr={};for(var r=0;r<i.length;++r){var n=i[r];cr[t[n]]=dr[n]}}return cr[e]}var fr={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},mr={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var _r,yr=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function vr(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function gr(t,e,i){void 0===i&&(i="pixi-shader"),this.id=xr++,this.vertexSrc=t||gr.defaultVertexSrc,
this.fragmentSrc=e||gr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),br[i]?(br[i]++,i+="-"+br[i]):br[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=ur(this.vertexSrc,ie.PRECISION_VERTEX,Qt.HIGH),this.fragmentSrc=ur(this.fragmentSrc,ie.PRECISION_FRAGMENT,function(
){if(!sr){sr=Qt.MEDIUM;var t=hr();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);sr=e.precision?Qt.HIGH:Qt.MEDIUM}}return sr}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var xr=0,br={},Tr={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};gr.prototype.extractData=function(t,e){var i=hr();if(i){var r=er(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},gr.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=pr(e,a.type),u={type:h,name:a.name,size:(i=h,lr[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
gr.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=pr(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:rr(h,s.size)}}return i},Tr.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},Tr.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},gr.from=function(t,e,i){var r=t+e,n=pe[r];return n||(pe[r]=n=new gr(t
,e,i)),n},Object.defineProperties(gr,Tr);function Er(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof Xi?e:new Xi(e):new Xi({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var wr={uniforms:{configurable:!0}};Er.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
Er.prototype.destroy=function(){this.uniformGroup=null},wr.uniforms.get=function(){return this.uniformGroup.uniforms},Er.from=function(t,e,i){var r=gr.from(t,e);return new Er(r,i)},Object.defineProperties(Er.prototype,wr);function Ar(){this.data=0,
this.blendMode=Mt.NORMAL,this.polygonOffset=0,this.blend=!0}var Sr={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};Sr.blend.get=function(){return!!(1&this.data)},Sr.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Sr.offsets.get=function(){return!!(2&this.data)},Sr.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
Sr.culling.get=function(){return!!(4&this.data)},Sr.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Sr.depthTest.get=function(){return!!(8&this.data)},Sr.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
Sr.clockwiseFrontFace.get=function(){return!!(16&this.data)},Sr.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Sr.blendMode.get=function(){return this._blendMode},Sr.blendMode.set=function(t){this.blend=t!==Mt.NONE,
this._blendMode=t},Sr.polygonOffset.get=function(){return this._polygonOffset},Sr.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Ar.for2d=function(){var t=new Ar;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
Ar.prototype,Sr);var Ir=function(n){function s(t,e,i){var r=gr.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=ie.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Ar}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(Er);Ir.SOURCE_KEY_MAP={};function Cr(t,e){this._texture=t,this.mapCoord=new Ue,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var Or=new Ue,Rr={texture:{configurable:!0}};Rr.texture.get=function(){return this._texture},Rr.texture.set=function(t){this._texture=t,this._updateID=-1},Cr.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},Cr.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(Or.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Or));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(Cr.prototype,Rr);function Pr(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Mr=function(i){
function t(t){var e=new Ue;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new Cr(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(Ir),Nr=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new Ki;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case te.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case te.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case te.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case te.SCISSOR:this.renderer.scissor.pop();break;case te.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case te.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=te.SPRITE;else if(t.type=te.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=te.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new Mr(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(xi),Lr=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(xi),Fr=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(Lr),Dr=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Lr),Ur=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ue,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(xi),Br=new Ke,kr=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new Ke,this.destinationFrame=new Ke}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(Br.width=s.realWidth,Br.height=s.realHeight,i=Br),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
Br.width=n.width,Br.height=n.height,i=Br),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(xi)
;Pr.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Xr=0,Gr=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Xr++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof _r)return _r;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;_r=!0===t({a:"b"},"a","b")}catch(t){_r=!1}return _r}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?fr:mr)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=er(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:rr(h.type,h.size)}}var u=new Pr(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(xi);function Vr(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var jr=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Mt.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Ar,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Mt.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.ADD]=[t.ONE,t.ONE],e[Mt.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[Mt.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[Mt.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[Mt.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.NONE]=[0,0],e[Mt.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[Mt.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Mt.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Mt.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Mt.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Mt.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[Mt.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Mt.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Mt.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Mt.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Mt.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(xi),Hr=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=ie.GC_MAX_IDLE,
this.checkCountMax=ie.GC_MAX_CHECK_COUNT,this.mode=ie.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Zt.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(xi),Yr=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new pi}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new Vr(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Vr(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new Vr(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===Xt.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&ae(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==zt.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Ht.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===Vt.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(xi),zr=new Ue;X.a;function Wr(){this.texArray=null,this.blend=0,this.type=Lt.TRIANGLES,this.start=0,this.size=0,this.data=null}function qr(){this.elements=[],this.ids=[],this.count=0}qr.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function Kr(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var Zr={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Zr.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Zr.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Zr.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Zr.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Zr.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Kr.prototype.view=function(t){
return this[t+"View"]},Kr.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Kr.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Kr.prototype,Zr);var Jr=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Ar.for2d(),this.size=4*ie.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;ie.PREFER_ENV===Ct.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),ie.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=yr.replace(/%forloop%/gi,vr(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Wr);for(;e.length<r;)e.push(new qr);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++pi._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;pi._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=oe[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;ie.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),ie.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=le(Math.ceil(t/8)),i=de(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Kr(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=le(Math.ceil(t/12)),i=de(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(Yi);Jr._drawCallPool=[],Jr._textureArrayPool=[];function Qr(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}Qr.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=Xi.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new gr(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ue,default:this.defaultGroupCache[t]};return new Er(this.programCache[t],n)},
Qr.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function $r(){}var tn=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Mi(null,t,!1),this._indexBuffer=new Mi(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Xt.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,Xt.FLOAT).addAttribute("aColor",this._buffer,4,!0,Xt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Xt.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Di),
en="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,rn="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",nn={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};$r.create=function(t){var e=Object.assign({vertex:en,fragment:rn,geometryClass:tn,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new Qr(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Jr)},nn.defaultVertexSrc.get=function(){return en},nn.defaultFragmentTemplate.get=function(){
return rn},Object.defineProperties($r,nn);$r.create();var sn=new Ke,on=function(t){(this.renderer=t).extract=this};on.prototype.image=function(t,e,i){var r=new Image;return r.src=this.base64(t,e,i),r},on.prototype.base64=function(t,e,i){
return this.canvas(t).toDataURL(e,i)},on.prototype.canvas=function(t){var e,i,r,n=this.renderer,s=!1,o=!1;t&&(t instanceof Ri?r=t:(r=this.renderer.generateTexture(t),o=!0)),r?(e=r.baseTexture.resolution,i=r.frame,s=!1,n.renderTexture.bind(r)):(
e=this.renderer.resolution,s=!0,(i=sn).width=this.renderer.width,i.height=this.renderer.height,n.renderTexture.bind(null));var a=Math.floor(i.width*e+1e-4),h=Math.floor(i.height*e+1e-4),u=new _e(a,h,1),l=new Uint8Array(4*a*h),c=n.gl;c.readPixels(i.x*e,
i.y*e,a,h,c.RGBA,c.UNSIGNED_BYTE,l);var d=u.context.getImageData(0,0,a,h);return on.arrayPostDivide(l,d.data),u.context.putImageData(d,0,0),s&&(u.context.scale(1,-1),u.context.drawImage(u.canvas,0,-h)),o&&r.destroy(!0),u.canvas},
on.prototype.pixels=function(t){var e,i,r,n=this.renderer,s=!1;t&&(t instanceof Ri?r=t:(r=this.renderer.generateTexture(t),s=!0)),r?(e=r.baseTexture.resolution,i=r.frame,n.renderTexture.bind(r)):(e=n.resolution,(i=sn).width=n.width,i.height=n.height,
n.renderTexture.bind(null));var o=i.width*e,a=i.height*e,h=new Uint8Array(4*o*a),u=n.gl;return u.readPixels(i.x*e,i.y*e,o,a,u.RGBA,u.UNSIGNED_BYTE,h),s&&r.destroy(!0),on.arrayPostDivide(h,h),h},on.prototype.destroy=function(){this.renderer.extract=null,
this.renderer=null},on.arrayPostDivide=function(t,e){for(var i=0;i<t.length;i+=4){var r=e[i+3]=t[i+3];0!==r?(e[i]=Math.round(Math.min(255*t[i]/r,255)),e[i+1]=Math.round(Math.min(255*t[i+1]/r,255)),e[i+2]=Math.round(Math.min(255*t[i+2]/r,255))):(e[i]=t[i],
e[i+1]=t[i+1],e[i+2]=t[i+2])}};var an=(hn.prototype.clone=function(){return new hn(this.x,this.y)},hn.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},hn.prototype.copyTo=function(t){return t.set(this.x,this.y),t},
hn.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},hn.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e},hn);function hn(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var un=(
ln.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new ln(t,e,this._x,this._y)},ln.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(
this.scope))},ln.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},ln.prototype.copyTo=function(t){return t.set(this._x,this._y),t},ln.prototype.equals=function(t){
return t.x===this._x&&t.y===this._y},Object.defineProperty(ln.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(ln.prototype,"y",{
get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),ln);function ln(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var cn,dn,
pn=2*Math.PI,fn=180/Math.PI,mn=Math.PI/180;(dn=cn=cn||{})[dn.POLY=0]="POLY",dn[dn.RECT=1]="RECT",dn[dn.CIRC=2]="CIRC",dn[dn.ELIP=3]="ELIP",dn[dn.RREC=4]="RREC";var _n=(yn.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],
this.tx=t[2],this.ty=t[5]},yn.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},yn.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(
i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},yn.prototype.apply=function(t,e){e=e||new an;var i=t.x,r=t.y
;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},yn.prototype.applyInverse=function(t,e){e=e||new an;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,
e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},yn.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},yn.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},
yn.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},
yn.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},
yn.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},yn.prototype.prepend=function(t){
var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},
yn.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(pn-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),
t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},yn.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,
this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},yn.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},yn.prototype.clone=function(){var t=new yn;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,
t.tx=this.tx,t.ty=this.ty,t},yn.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},yn.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,
this},Object.defineProperty(yn,"IDENTITY",{get:function(){return new yn},enumerable:!0,configurable:!0}),Object.defineProperty(yn,"TEMP_MATRIX",{get:function(){return new yn},enumerable:!0,configurable:!0}),yn);function yn(t,e,i,r,n,s){void 0===t&&(t=1),
void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var vn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],gn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],
xn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],bn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Tn=[],En=[],wn=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Tn.push(e);for(var i=0;i<16;i++)for(var r=wn(vn[t]*vn[i]+xn[t]*gn[i]),n=wn(gn[t]*vn[i]+bn[t]*gn[i]),
s=wn(vn[t]*xn[i]+xn[t]*bn[i]),o=wn(gn[t]*xn[i]+bn[t]*bn[i]),a=0;a<16;a++)if(vn[a]===r&&gn[a]===n&&xn[a]===s&&bn[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new _n;h.set(vn[t],gn[t],xn[t],bn[t],0,0),En.push(h)}}();var An=(
Sn.prototype.onChange=function(){this._localID++},Sn.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},Sn.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},Sn.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},Sn.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(Sn.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),Sn.IDENTITY=new Sn,Sn);function Sn(){this.worldTransform=new _n,this.localTransform=new _n,this.position=new un(this.onChange,
this,0,0),this.scale=new un(this.onChange,this,1,1),this.pivot=new un(this.onChange,this,0,0),this.skew=new un(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var In=(Object.defineProperty(Cn.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Cn.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(Cn.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Cn.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Cn,"EMPTY"
,{get:function(){return new Cn(0,0,0,0)},enumerable:!0,configurable:!0}),Cn.prototype.clone=function(){return new Cn(this.x,this.y,this.width,this.height)},Cn.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},Cn.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},Cn.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},Cn.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},Cn.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},Cn.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
Cn.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},Cn);function Cn(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=cn.RECT}On.prototype.clone=function(){return new On(this.x,this.y,this.radius)},
On.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},On.prototype.getBounds=function(){return new In(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function On(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=cn.CIRC}Rn.prototype.clone=function(){return new Rn(this.x,this.y,this.width,this.height)},Rn.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},Rn.prototype.getBounds=function(){return new In(this.x-this.width,this.y-this.height,this.width,this.height)};function Rn(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=cn.ELIP}Pn.prototype.clone=function(){var t=new Pn(this.points.slice());return t.closeStroke=this.closeStroke,t},
Pn.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function Pn(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof an){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=cn.POLY,this.closeStroke=!0}
Mn.prototype.clone=function(){return new Mn(this.x,this.y,this.width,this.height,this.radius)},Mn.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function Mn(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=cn.RREC}var Nn,Ln,Fn={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(
u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}
return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,
GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};Fn.TARGET_FPMS=.06,(Ln=Nn=Nn||{}
)[Ln.INTERACTION=50]="INTERACTION",Ln[Ln.HIGH=25]="HIGH",Ln[Ln.NORMAL=0]="NORMAL",Ln[Ln.LOW=-25]="LOW",Ln[Ln.UTILITY=-50]="UTILITY";var Dn=(Un.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},
Un.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},Un.prototype.connect=function(t){(this.previous=t).next&&(
t.next.previous=this),this.next=t.next,t.next=this},Un.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous)
;var e=this.next;return this.next=t?null:e,this.previous=null,e},Un);function Un(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}
var Bn=(kn.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},kn.prototype._cancelIfNeeded=function(){
null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},kn.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},kn.prototype.add=function(t,e,i){return void 0===i&&(
i=Nn.NORMAL),this._addListener(new Dn(t,e,i))},kn.prototype.addOnce=function(t,e,i){return void 0===i&&(i=Nn.NORMAL),this._addListener(new Dn(t,e,i,!0))},kn.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(
t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},kn.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next
;return this._head.next||this._cancelIfNeeded(),this},kn.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},kn.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},
kn.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},kn.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((
e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,
this.deltaTime=this.deltaMS*Fn.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(kn.prototype,"FPS",{get:function(
){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(kn.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Fn.TARGET_FPMS)
;this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(kn.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(kn,"shared",{get:function(){if(!kn._shared){var t=kn._shared=new kn;t.autoStart=!0,t._protected=!0}return kn._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(kn,"system",{get:function(){if(!kn._system){var t=kn._system=new kn;t.autoStart=!0,t._protected=!0}return kn._system},enumerable:!0,configurable:!0}),kn);function kn(){var e=this;this._head=new Dn(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Fn.TARGET_FPMS,this.elapsedMS=1/Fn.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}var Xn,Gn,Vn,jn,Hn,Yn,zn,Wn,qn,Kn,Zn,Jn,Qn,$n,ts,es,is,rs,ns,ss,os,as,hs,us,ls,cs,ds,ps;fs.init=function(t){var e=this
;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,Nn.LOW)},get:function(){return this._ticker}}),
this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Bn.shared:new Bn,t.autoStart&&this.start()},fs.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()
}};function fs(){}(Gn=Xn=Xn||{})[Gn.WEBGL_LEGACY=0]="WEBGL_LEGACY",Gn[Gn.WEBGL=1]="WEBGL",Gn[Gn.WEBGL2=2]="WEBGL2",(jn=Vn=Vn||{})[jn.UNKNOWN=0]="UNKNOWN",jn[jn.WEBGL=1]="WEBGL",jn[jn.CANVAS=2]="CANVAS",(Yn=Hn=Hn||{})[Yn.NORMAL=0]="NORMAL",
Yn[Yn.ADD=1]="ADD",Yn[Yn.MULTIPLY=2]="MULTIPLY",Yn[Yn.SCREEN=3]="SCREEN",Yn[Yn.OVERLAY=4]="OVERLAY",Yn[Yn.DARKEN=5]="DARKEN",Yn[Yn.LIGHTEN=6]="LIGHTEN",Yn[Yn.COLOR_DODGE=7]="COLOR_DODGE",Yn[Yn.COLOR_BURN=8]="COLOR_BURN",Yn[Yn.HARD_LIGHT=9]="HARD_LIGHT",
Yn[Yn.SOFT_LIGHT=10]="SOFT_LIGHT",Yn[Yn.DIFFERENCE=11]="DIFFERENCE",Yn[Yn.EXCLUSION=12]="EXCLUSION",Yn[Yn.HUE=13]="HUE",Yn[Yn.SATURATION=14]="SATURATION",Yn[Yn.COLOR=15]="COLOR",Yn[Yn.LUMINOSITY=16]="LUMINOSITY",Yn[Yn.NORMAL_NPM=17]="NORMAL_NPM",
Yn[Yn.ADD_NPM=18]="ADD_NPM",Yn[Yn.SCREEN_NPM=19]="SCREEN_NPM",Yn[Yn.NONE=20]="NONE",Yn[Yn.SRC_OVER=0]="SRC_OVER",Yn[Yn.SRC_IN=21]="SRC_IN",Yn[Yn.SRC_OUT=22]="SRC_OUT",Yn[Yn.SRC_ATOP=23]="SRC_ATOP",Yn[Yn.DST_OVER=24]="DST_OVER",Yn[Yn.DST_IN=25]="DST_IN",
Yn[Yn.DST_OUT=26]="DST_OUT",Yn[Yn.DST_ATOP=27]="DST_ATOP",Yn[Yn.ERASE=26]="ERASE",Yn[Yn.SUBTRACT=28]="SUBTRACT",Yn[Yn.XOR=29]="XOR",(Wn=zn=zn||{})[Wn.POINTS=0]="POINTS",Wn[Wn.LINES=1]="LINES",Wn[Wn.LINE_LOOP=2]="LINE_LOOP",Wn[Wn.LINE_STRIP=3]="LINE_STRIP"
,Wn[Wn.TRIANGLES=4]="TRIANGLES",Wn[Wn.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Wn[Wn.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Kn=qn=qn||{})[Kn.RGBA=6408]="RGBA",Kn[Kn.RGB=6407]="RGB",Kn[Kn.ALPHA=6406]="ALPHA",Kn[Kn.LUMINANCE=6409]="LUMINANCE",
Kn[Kn.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Kn[Kn.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Kn[Kn.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(Jn=Zn=Zn||{})[Jn.TEXTURE_2D=3553]="TEXTURE_2D",Jn[Jn.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",
Jn[Jn.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Jn[Jn.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",Jn[Jn.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
Jn[Jn.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Jn[Jn.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",Jn[Jn.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
Jn[Jn.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",($n=Qn=Qn||{})[$n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",$n[$n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",$n[$n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
$n[$n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",$n[$n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",$n[$n.FLOAT=5126]="FLOAT",$n[$n.HALF_FLOAT=36193]="HALF_FLOAT",(es=ts=ts||{})[es.NEAREST=0]="NEAREST",es[es.LINEAR=1]="LINEAR",(
rs=is=is||{})[rs.CLAMP=33071]="CLAMP",rs[rs.REPEAT=10497]="REPEAT",rs[rs.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(ss=ns=ns||{})[ss.OFF=0]="OFF",ss[ss.POW2=1]="POW2",ss[ss.ON=2]="ON",(as=os=os||{})[as.NPM=0]="NPM",as[as.UNPACK=1]="UNPACK",
as[as.PMA=2]="PMA",as[as.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",as[as.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",as[as.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(us=hs=hs||{})[us.AUTO=0]="AUTO",us[us.MANUAL=1]="MANUAL",(cs=ls=ls||{}
).LOW="lowp",cs.MEDIUM="mediump",cs.HIGH="highp",(ps=ds=ds||{})[ps.NONE=0]="NONE",ps[ps.SCISSOR=1]="SCISSOR",ps[ps.STENCIL=2]="STENCIL",ps[ps.SPRITE=3]="SPRITE",Fn.RETINA_PREFIX=/@([0-9\.]+)x/;Fn.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;!function(){for(var t=[
],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[Hn.NORMAL_NPM]=Hn.NORMAL,t[Hn.ADD_NPM]=Hn.ADD,t[Hn.SCREEN_NPM]=Hn.SCREEN,e[Hn.NORMAL]=Hn.NORMAL_NPM,e[Hn.ADD]=Hn.ADD_NPM,e[Hn.SCREEN]=Hn.SCREEN_NPM;var r=[];r.push(e),r.push(t)}();function ms(t,e,i){var r,n=t.length;if(!(
n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}Object.create(null),Object.create(null);function _s(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),
this.resolution=i||Fn.RESOLUTION,this.resize(t,e)}var ys={width:{configurable:!0},height:{configurable:!0}};_s.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},
_s.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},_s.prototype.destroy=function(){this.context=null,this.canvas=null},ys.width.get=function(){return this.canvas.width},ys.width.set=function(t){
this.canvas.width=t},ys.height.get=function(){return this.canvas.height},ys.height.set=function(t){this.canvas.height=t},Object.defineProperties(_s.prototype,ys);Fn.SORTABLE_CHILDREN=!1;function vs(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,
this.maxY=-1/0,this.rect=null}vs.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},vs.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},vs.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?In.EMPTY:((t=t||new In(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},vs.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(
this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},vs.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},vs.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(
t.worldTransform,e,i,r,n)},vs.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(
_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},vs.prototype.addVertexData=function(t,e
,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},vs.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(
t.worldTransform,e,i,r)},vs.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c
;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},vs.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,
this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},vs.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(
i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},vs.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},
vs.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY
;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},vs.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},vs.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,
e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var gs=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new An,
this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new vs,this._boundsID=0,this._lastBoundsID=-1,
this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{
configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},
mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},
e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)
):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,
this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new In),e=this._boundsRect),this._bounds.getRectangle(e)},
n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new In),t=this._localBoundsRect);var r=this.getBounds(!1,t)
;return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error(
"setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0)
,void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),
this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,
this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){
return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){
return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},
e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*fn},e.angle.set=function(t){
this.transform.rotation=t*mn},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},
e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},
Object.defineProperties(n.prototype,e),n}(X.a);function xs(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}gs.prototype.displayObjectUpdateTransform=gs.prototype.updateTransform;var bs=function(n){function t(){
n.call(this),this.children=[],this.sortableChildren=Fn.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t
).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,
this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);ms(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,ms(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,ms(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(xs),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(gs);bs.prototype.containerUpdateTransform=bs.prototype.updateTransform;var Ts=function(){this.global=new an,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,
this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0},Es={pointerId:{configurable:!0}};Es.pointerId.get=function(){return this.identifier},
Ts.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},Ts.prototype.copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,
this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},
Ts.prototype.reset=function(){this.isPrimary=!1},Object.defineProperties(Ts.prototype,Es);var ws=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}
;ws.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},ws.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null
,this.target=null};var As=function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE},Ss={pointerId:{configurable:!0},flags:{configurable:!0},none:{configurable:!0},over:{configurable:!0},rightDown:{configurable:!0},leftDown:{configurable:!0}}
;As.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Ss.pointerId.get=function(){return this._pointerId},Ss.flags.get=function(){return this._flags},Ss.flags.set=function(t){this._flags=t},Ss.none.get=function(){
return this._flags===this.constructor.FLAGS.NONE},Ss.over.get=function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},Ss.over.set=function(t){this._doSet(this.constructor.FLAGS.OVER,t)},Ss.rightDown.get=function(){return 0!=(
this._flags&this.constructor.FLAGS.RIGHT_DOWN)},Ss.rightDown.set=function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)},Ss.leftDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},Ss.leftDown.set=function(t){this._doSet(
this.constructor.FLAGS.LEFT_DOWN,t)},Object.defineProperties(As.prototype,Ss),As.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4});function Is(){this._tempPoint=new an}Is.prototype.recursiveFindHit=function(t,e,i,r,n){if(!e||!e.visible
)return!1;var s=t.data.global,o=!1,a=n=e.interactive||n,h=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:h=r=!1),a=!1):e._mask&&r&&(
e._mask.containsPoint&&e._mask.containsPoint(s)||(r=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,l=u.length-1;0<=l;l--){var c=u[l],d=this.recursiveFindHit(t,c,i,r,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(r=!1),o=!0)}}
return n&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(o=!0),e.interactive&&(o&&!t.target&&(t.target=e),i&&i(t,e,!!o))),o};var Cs={interactive:!(Is.prototype.findHit=function(t,e,i,r){this.recursiveFindHit(t,e,i,r,!1)}),
interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(
this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};gs.mixin(Cs);var Os={target:null,data:{global:null}},Rs=function(i){function t(t,e){i.call(this),e=e||{},this.renderer=t,
this.autoPreventDefault=void 0===e.autoPreventDefault||e.autoPreventDefault,this.interactionFrequency=e.interactionFrequency||10,this.mouse=new Ts,this.mouse.identifier=1,this.mouse.global.set(-999999),this.activeInteractionData={},
this.activeInteractionData[1]=this.mouse,this.interactionDataPool=[],this.eventData=new ws,this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.mouseOverRenderer=!1,this.supportsTouchEvents="ontouchstart"in window,
this.supportsPointerEvents=!!window.PointerEvent,this.onPointerUp=this.onPointerUp.bind(this),this.processPointerUp=this.processPointerUp.bind(this),this.onPointerCancel=this.onPointerCancel.bind(this),
this.processPointerCancel=this.processPointerCancel.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.processPointerDown=this.processPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),
this.processPointerMove=this.processPointerMove.bind(this),this.onPointerOut=this.onPointerOut.bind(this),this.processPointerOverOut=this.processPointerOverOut.bind(this),this.onPointerOver=this.onPointerOver.bind(this),this.cursorStyles={
default:"inherit",pointer:"pointer"},this.currentCursorMode=null,this.cursor=null,this.resolution=1,this.delayedEvents=[],this.search=new Is,this.setTargetElement(this.renderer.view,this.renderer.resolution)}return i&&(t.__proto__=i),((
t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.hitTest=function(t,e){return Os.target=null,Os.data.global=t,e=e||this.renderer._lastObjectRendered,this.processInteractive(Os,e,null,!0),Os.target},t.prototype.setTargetElement=function(
t,e){void 0===e&&(e=1),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},t.prototype.addEvents=function(){this.interactionDOMElement&&(Bn.system.add(this.update,this,Nn.INTERACTION),window.navigator.msPointerEnabled?(
this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(
window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),
this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",
this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,
!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),
this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},t.prototype.removeEvents=function(){this.interactionDOMElement&&(
Bn.system.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(
this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),
this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),
window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),
this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(
this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),
this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},t.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,
this.interactionDOMElement))if(this.didMove)this.didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var i=this.activeInteractionData[e];if(i.originalEvent&&"touch"!==i.pointerType){
var r=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(t){if(
t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(
this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},t.prototype.dispatchEvent=function(t,e,i){
i.stopPropagationHint&&t!==i.stopsPropagatingAt||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},t.prototype.delayDispatchEvent=function(t,e,i){this.delayedEvents.push({displayObject:t,eventString:e,eventData:i})},
t.prototype.mapPositionToPoint=function(t,e,i){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width
)*n,t.y=(i-r.top)*(this.interactionDOMElement.height/r.height)*n},t.prototype.processInteractive=function(t,e,i,r){var n=this.search.findHit(t,e,i,r),s=this.delayedEvents;if(!s.length)return n;t.stopPropagationHint=!1;var o=s.length;this.delayedEvents=[]
;for(var a=0;a<o;a++){var h=s[a],u=h.displayObject,l=h.eventString,c=h.eventData;c.stopsPropagatingAt===u&&(c.stopPropagationHint=!0),this.dispatchEvent(u,l,c)}return n},t.prototype.onPointerDown=function(t){if(
!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i=e.length,r=0;r<i;r++){var n=e[r],
s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);if(o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),
"touch"===n.pointerType)this.emit("touchstart",o);else if("mouse"===n.pointerType||"pen"===n.pointerType){var a=2===n.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(t,e,i){var r=t.data,
n=t.data.identifier;if(i)if(e.trackedPointers[n]||(e.trackedPointers[n]=new As(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){
var s=2===r.button;s?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,s?"rightdown":"mousedown",t)}},t.prototype.onPointerComplete=function(t,e,i){for(var r=this.normalizeToPointerData(t),n=r.length,
s=t.target!==this.interactionDOMElement?"outside":"",o=0;o<n;o++){var a=r[o],h=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(u.data.originalEvent=t,this.processInteractive(u,
this.renderer._lastObjectRendered,i,e||!s),this.emit(e?"pointercancel":"pointerup"+s,u),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+s:"mouseup"+s,u)}else"touch"===a.pointerType&&(this.emit(
e?"touchcancel":"touchend"+s,u),this.releaseInteractionDataForPointerId(a.pointerId,h))}},t.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},
t.prototype.processPointerCancel=function(t,e){var i=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},
t.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},t.prototype.processPointerUp=function(t,e,i){var r=t.data,n=t.data.identifier,s=e.trackedPointers[n],
o="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType,h=!1;if(a){var u=2===r.button,l=As.FLAGS,c=u?l.RIGHT_DOWN:l.LEFT_DOWN,d=void 0!==s&&s.flags&c;i?(this.dispatchEvent(e,u?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,
u?"rightclick":"click",t),h=!0)):d&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),s&&(u?s.rightDown=!1:s.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),s&&(a&&!h||this.dispatchEvent(e,"pointertap",t
),o&&(this.dispatchEvent(e,"tap",t),s.over=!1))):s&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),s&&s.none&&delete e.trackedPointers[n]},t.prototype.onPointerMove=function(t){if(
!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var i=e.length,r=0;r<i;r++){var n=e[r],
s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),
"touch"===n.pointerType&&this.emit("touchmove",o),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(t,e,i){var r=t.data,
n="touch"===r.pointerType,s="mouse"===r.pointerType||"pen"===r.pointerType;s&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),s&&this.dispatchEvent(e,"mousemove",t))}
,t.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e)
,r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),
"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(i.identifier)}},t.prototype.processPointerOverOut=function(t,e,i){var r=t.data,n=t.data.identifier,
s="mouse"===r.pointerType||"pen"===r.pointerType,o=e.trackedPointers[n];i&&!o&&(o=e.trackedPointers[n]=new As(n)),void 0!==o&&(i&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(e,"pointerover",t),s&&this.delayDispatchEvent(e,
"mouseover",t)),s&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),s&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[n]))},t.prototype.onPointerOver=function(t){
var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);"mouse"===(r.data.originalEvent=e).pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),
"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)},t.prototype.getInteractionDataForPointerId=function(t){var e,i=t.pointerId
;return 1===i||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[i]?e=this.activeInteractionData[i]:((e=this.interactionDataPool.pop()||new Ts).identifier=i,this.activeInteractionData[i]=e),e.copyEvent(t),e},
t.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},t.prototype.configureInteractionEventForDOMEvent=function(t,e,i){
return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t.reset(),t},t.prototype.normalizeToPointerData=function(t){var e=[];if(
this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,r=t.changedTouches.length;i<r;i++){var n=t.changedTouches[i];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(
n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),
void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(
n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent||(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),
void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=1),void 0===t.pressure&&(t.pressure=.5),void 0===t.twist&&(t.twist=0),void 0===t.tangentialPressure&&(
t.tangentialPressure=0),t.isNormalized=!0),e.push(t);return e},t.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,
this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,
this.onPointerOver=null,this.search=null},t}(X.a);var Ps,Ms,Ns,Ls,Fs,Ds,Us,Bs,ks,Xs,Gs,Vs,js,Hs,Ys,zs,Ws,qs,Ks,Zs,Js,Qs,$s,to,eo,io,ro,no,so={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0
;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}
return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,
GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},oo=(ao.prototype.emit=function(t,e,i,r,n,s,
o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},
ao.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},ao.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t))
,this},ao.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},ao.prototype.contains=function(t){return-1!==this.items.indexOf(t)},ao.prototype.removeAll=function(){
return this.ensureNonAliasedItems(),this.items.length=0,this},ao.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(ao.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,
configurable:!0}),Object.defineProperty(ao.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),ao);function ao(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(oo.prototype,{dispatch:{
value:oo.prototype.emit},run:{value:oo.prototype.emit}}),(Ms=Ps=Ps||{})[Ms.WEBGL_LEGACY=0]="WEBGL_LEGACY",Ms[Ms.WEBGL=1]="WEBGL",Ms[Ms.WEBGL2=2]="WEBGL2",(Ls=Ns=Ns||{})[Ls.UNKNOWN=0]="UNKNOWN",Ls[Ls.WEBGL=1]="WEBGL",Ls[Ls.CANVAS=2]="CANVAS",(Ds=Fs=Fs||{}
)[Ds.NORMAL=0]="NORMAL",Ds[Ds.ADD=1]="ADD",Ds[Ds.MULTIPLY=2]="MULTIPLY",Ds[Ds.SCREEN=3]="SCREEN",Ds[Ds.OVERLAY=4]="OVERLAY",Ds[Ds.DARKEN=5]="DARKEN",Ds[Ds.LIGHTEN=6]="LIGHTEN",Ds[Ds.COLOR_DODGE=7]="COLOR_DODGE",Ds[Ds.COLOR_BURN=8]="COLOR_BURN",
Ds[Ds.HARD_LIGHT=9]="HARD_LIGHT",Ds[Ds.SOFT_LIGHT=10]="SOFT_LIGHT",Ds[Ds.DIFFERENCE=11]="DIFFERENCE",Ds[Ds.EXCLUSION=12]="EXCLUSION",Ds[Ds.HUE=13]="HUE",Ds[Ds.SATURATION=14]="SATURATION",Ds[Ds.COLOR=15]="COLOR",Ds[Ds.LUMINOSITY=16]="LUMINOSITY",
Ds[Ds.NORMAL_NPM=17]="NORMAL_NPM",Ds[Ds.ADD_NPM=18]="ADD_NPM",Ds[Ds.SCREEN_NPM=19]="SCREEN_NPM",Ds[Ds.NONE=20]="NONE",Ds[Ds.SRC_OVER=0]="SRC_OVER",Ds[Ds.SRC_IN=21]="SRC_IN",Ds[Ds.SRC_OUT=22]="SRC_OUT",Ds[Ds.SRC_ATOP=23]="SRC_ATOP",
Ds[Ds.DST_OVER=24]="DST_OVER",Ds[Ds.DST_IN=25]="DST_IN",Ds[Ds.DST_OUT=26]="DST_OUT",Ds[Ds.DST_ATOP=27]="DST_ATOP",Ds[Ds.ERASE=26]="ERASE",Ds[Ds.SUBTRACT=28]="SUBTRACT",Ds[Ds.XOR=29]="XOR",(Bs=Us=Us||{})[Bs.POINTS=0]="POINTS",Bs[Bs.LINES=1]="LINES",
Bs[Bs.LINE_LOOP=2]="LINE_LOOP",Bs[Bs.LINE_STRIP=3]="LINE_STRIP",Bs[Bs.TRIANGLES=4]="TRIANGLES",Bs[Bs.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Bs[Bs.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Xs=ks=ks||{})[Xs.RGBA=6408]="RGBA",Xs[Xs.RGB=6407]="RGB",
Xs[Xs.ALPHA=6406]="ALPHA",Xs[Xs.LUMINANCE=6409]="LUMINANCE",Xs[Xs.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Xs[Xs.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Xs[Xs.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(Vs=Gs=Gs||{})[Vs.TEXTURE_2D=3553]="TEXTURE_2D",
Vs[Vs.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",Vs[Vs.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Vs[Vs.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",Vs[Vs.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
Vs[Vs.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Vs[Vs.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",Vs[Vs.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
Vs[Vs.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(Hs=js=js||{})[Hs.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",Hs[Hs.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",Hs[Hs.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
Hs[Hs.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",Hs[Hs.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",Hs[Hs.FLOAT=5126]="FLOAT",Hs[Hs.HALF_FLOAT=36193]="HALF_FLOAT",(zs=Ys=Ys||{})[zs.NEAREST=0]="NEAREST",zs[zs.LINEAR=1]="LINEAR",(
qs=Ws=Ws||{})[qs.CLAMP=33071]="CLAMP",qs[qs.REPEAT=10497]="REPEAT",qs[qs.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(Zs=Ks=Ks||{})[Zs.OFF=0]="OFF",Zs[Zs.POW2=1]="POW2",Zs[Zs.ON=2]="ON",(Qs=Js=Js||{})[Qs.NPM=0]="NPM",Qs[Qs.UNPACK=1]="UNPACK",
Qs[Qs.PMA=2]="PMA",Qs[Qs.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Qs[Qs.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Qs[Qs.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(to=$s=$s||{})[to.AUTO=0]="AUTO",to[to.MANUAL=1]="MANUAL",(io=eo=eo||{}
).LOW="lowp",io.MEDIUM="mediump",io.HIGH="highp",(no=ro=ro||{})[no.NONE=0]="NONE",no[no.SCISSOR=1]="SCISSOR",no[no.STENCIL=2]="STENCIL",no[no.SPRITE=3]="SPRITE",so.RETINA_PREFIX=/@([0-9\.]+)x/;var ho,uo=!(so.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),lo="5.2.0"
;var co=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[Fs.NORMAL_NPM]=Fs.NORMAL,t[Fs.ADD_NPM]=Fs.ADD,t[Fs.SCREEN_NPM]=Fs.SCREEN,e[Fs.NORMAL]=Fs.NORMAL_NPM,e[Fs.ADD]=Fs.ADD_NPM,e[Fs.SCREEN]=Fs.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function po(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var fo=0;function mo(){return++fo}function _o(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function yo(t){
return!(t&t-1||!t)}function vo(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var go={},xo=Object.create(null),bo=Object.create(null);function To(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||so.RESOLUTION,this.resize(t,e)}var Eo={width:{configurable:!0},height:{configurable:!0}};To.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},To.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},To.prototype.destroy=function(){this.context=null,this.canvas=null},Eo.width.get=function(){
return this.canvas.width},Eo.width.set=function(t){this.canvas.width=t},Eo.height.get=function(){return this.canvas.height},Eo.height.set=function(t){this.canvas.height=t},Object.defineProperties(To.prototype,Eo);var wo;function Ao(t,e){
var i=so.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var So,Io,Co={};so.TARGET_FPMS=.06,(Io=So=So||{})[Io.INTERACTION=50]="INTERACTION",Io[Io.HIGH=25]="HIGH",Io[Io.NORMAL=0]="NORMAL",Io[Io.LOW=-25]="LOW",Io[Io.UTILITY=-50]="UTILITY"
;var Oo=(Ro.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},Ro.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),
this._destroyed&&(this.next=null),e},Ro.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},Ro.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,
this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},Ro);function Ro(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,
this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var Po=(Mo.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},Mo.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Mo.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},Mo.prototype.add=function(t,e,i){return void 0===i&&(i=So.NORMAL),this._addListener(new Oo(t,e,i))},Mo.prototype.addOnce=function(t,e,i){return void 0===i&&(i=So.NORMAL),this._addListener(new Oo(t,e,i,!0))},
Mo.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},Mo.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Mo.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Mo.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},Mo.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},Mo.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*so.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(Mo.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(Mo.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,so.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(Mo.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(Mo,"shared",{get:function(){if(!Mo._shared){var t=Mo._shared=new Mo;t.autoStart=!0,t._protected=!0}return Mo._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(Mo,"system",{get:function(){if(!Mo._system){var t=Mo._system=new Mo;t.autoStart=!0,t._protected=!0}return Mo._system},enumerable:!0,configurable:!0}),Mo);function Mo(){var e=this;this._head=new Oo(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/so.TARGET_FPMS,this.elapsedMS=1/so.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}No.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,So.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?Po.shared:new Po,t.autoStart&&this.start()},No.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function No(){}var Lo=(Fo.prototype.clone=function(){return new Fo(this.x,this.y)},
Fo.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},Fo.prototype.copyTo=function(t){return t.set(this.x,this.y),t},Fo.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},Fo.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},Fo);function Fo(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var Do=(Uo.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new Uo(t,e,this._x,this._y)},
Uo.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},Uo.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},Uo.prototype.copyTo=function(t){return t.set(this._x,this._y),t},Uo.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(Uo.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(Uo.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Uo);function Uo(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var Bo,ko,Xo=2*Math.PI,Go=180/Math.PI,Vo=Math.PI/180;(ko=Bo=Bo||{})[ko.POLY=0]="POLY",ko[ko.RECT=1]="RECT",ko[ko.CIRC=2]="CIRC",ko[ko.ELIP=3]="ELIP",
ko[ko.RREC=4]="RREC";var jo=(Ho.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},Ho.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
Ho.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},Ho.prototype.apply=function(t,e){e=e||new Lo;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},Ho.prototype.applyInverse=function(t,e){e=e||new Lo;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},Ho.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
Ho.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},Ho.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},Ho.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},Ho.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},Ho.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},Ho.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(Xo-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},Ho.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},Ho.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Ho.prototype.clone=function(){
var t=new Ho;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Ho.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Ho.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(Ho,"IDENTITY",{get:function(){return new Ho},enumerable:!0,configurable:!0}),Object.defineProperty(Ho,"TEMP_MATRIX",{get:function(){return new Ho},
enumerable:!0,configurable:!0}),Ho);function Ho(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var Yo=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],zo=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Wo=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],qo=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ko=[],Zo=[],Jo=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Ko.push(e);for(
var i=0;i<16;i++)for(var r=Jo(Yo[t]*Yo[i]+Wo[t]*zo[i]),n=Jo(zo[t]*Yo[i]+qo[t]*zo[i]),s=Jo(Yo[t]*Wo[i]+Wo[t]*qo[i]),o=Jo(zo[t]*Wo[i]+qo[t]*qo[i]),a=0;a<16;a++)if(Yo[a]===r&&zo[a]===n&&Wo[a]===s&&qo[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new jo
;h.set(Yo[t],zo[t],Wo[t],qo[t],0,0),Zo.push(h)}}();var Qo={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Yo[t]},uY:function(t){return zo[t]},vX:function(t){
return Wo[t]},vY:function(t){return qo[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Ko[t][e]},sub:function(t,e){return Ko[t][Qo.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?Qo.S:Qo.N:2*Math.abs(e)<=Math.abs(t)?0<t?Qo.E:Qo.W:0<e?0<t?Qo.SE:Qo.SW:0<t?Qo.NE:Qo.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=Zo[Qo.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},$o=(ta.prototype.onChange=function(){this._localID++},ta.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},ta.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},ta.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},ta.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(ta.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),ta.IDENTITY=new ta,ta);function ta(){this.worldTransform=new jo,this.localTransform=new jo,this.position=new Do(this.onChange,
this,0,0),this.scale=new Do(this.onChange,this,1,1),this.pivot=new Do(this.onChange,this,0,0),this.skew=new Do(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var ea=(Object.defineProperty(ia.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(ia.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(ia.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(ia.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(ia,"EMPTY"
,{get:function(){return new ia(0,0,0,0)},enumerable:!0,configurable:!0}),ia.prototype.clone=function(){return new ia(this.x,this.y,this.width,this.height)},ia.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},ia.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},ia.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},ia.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},ia.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},ia.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
ia.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},ia);function ia(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=Bo.RECT}ra.prototype.clone=function(){return new ra(this.x,this.y,this.radius)},
ra.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},ra.prototype.getBounds=function(){return new ea(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function ra(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=Bo.CIRC}na.prototype.clone=function(){return new na(this.x,this.y,this.width,this.height)},na.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},na.prototype.getBounds=function(){return new ea(this.x-this.width,this.y-this.height,this.width,this.height)};function na(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=Bo.ELIP}sa.prototype.clone=function(){var t=new sa(this.points.slice());return t.closeStroke=this.closeStroke,t},
sa.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function sa(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof Lo){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=Bo.POLY,this.closeStroke=!0}
oa.prototype.clone=function(){return new oa(this.x,this.y,this.width,this.height,this.radius)},oa.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function oa(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=Bo.RREC}so.SORTABLE_CHILDREN=!1;function aa(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}aa.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},aa.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},aa.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?ea.EMPTY:((
t=t||new ea(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},aa.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},aa.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},aa.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
aa.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},aa.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},aa.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
aa.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},aa.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},aa.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},aa.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},aa.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},aa.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},aa.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var ha=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new $o,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new aa,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new ea),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new ea),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*Go},e.angle.set=function(t){this.transform.rotation=t*Vo
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function ua(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}ha.prototype.displayObjectUpdateTransform=ha.prototype.updateTransform;var la=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=so.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);po(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,po(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,po(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(ua),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(ha);la.prototype.containerUpdateTransform=la.prototype.updateTransform;function ca(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new oo(
"setRealSize",2),this.onUpdate=new oo("update"),this.onError=new oo("onError",1)}var da={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};ca.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},ca.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},ca.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},da.valid.get=function(){return!!this._width&&!!this._height},ca.prototype.update=function(){this.destroyed||this.onUpdate.run()},ca.prototype.load=function(){return Promise.resolve()},
da.width.get=function(){return this._width},da.height.get=function(){return this._height},ca.prototype.upload=function(t,e,i){return!1},ca.prototype.style=function(t,e,i){return!1},ca.prototype.dispose=function(){},ca.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(ca.prototype,da);var pa=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(wo=wo||document.createElement("a")).href=t;var i=!(t=H.a.parse(wo.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Js.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(ca),fa=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:so.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===Js.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(pa),ma=[];function _a(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=ma.length-1;0<=n;--n){var s=ma[n];if(s.test&&s.test(t,i))return new s(t,e)}return new fa(t,e)}var ya=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Js.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(ca),va={scaleMode:Ys.NEAREST,format:ks.RGBA,
alphaMode:Js.NPM},ga=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof ca||((t=_a(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||so.RESOLUTION,this.mipmap=void 0!==r?r:so.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:so.ANISOTROPIC_LEVEL,
this.wrapMode=h||so.WRAP_MODE,this.scaleMode=void 0!==s?s:so.SCALE_MODE,this.format=u||ks.RGBA,this.type=l||js.UNSIGNED_BYTE,this.target=c||Gs.TEXTURE_2D,this.alphaMode=void 0!==i?i:Js.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=mo(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=yo(this.realWidth
)&&yo(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete bo[this.cacheId],delete xo[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=so.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+mo()),t._pixiId);var s=bo[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new ya(t,{width:e,height:i}),
s=t instanceof Float32Array?js.FLOAT:js.UNSIGNED_BYTE;return new o(n,Object.assign(va,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),bo[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),bo[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=bo[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete bo[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete bo[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);ga._globalBatch=0;var xa=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new ga;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(_a(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=Gs.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(ca),
ba=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(pa),
Ta=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=Gs.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=Gs.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(xa);Ta.SIDES=6;var Ea=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+mo(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(pa)
;Ea.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var wa=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=Po.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(Po.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(Po.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&Po.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(Po.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(Po.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(pa);wa.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var Aa=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(pa);ma.push(fa,Aa,ba,wa,Ea,ya,Ta,xa);function Sa(t){this.renderer=t}
Sa.prototype.destroy=function(){this.renderer=null};function Ia(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new oo("disposeFramebuffer",2)}var Ca=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Js.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(ya),Oa={colorTexture:{configurable:!0}};Oa.colorTexture.get=function(){return this.colorTextures[0]},Ia.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new ga(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Ia.prototype.addDepthTexture=function(t){return this.depthTexture=t||new ga(new Ca(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:ks.DEPTH_COMPONENT,type:js.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Ia.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Ia.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Ia.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},Ia.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(Ia.prototype,Oa);function Ra(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var Pa=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new Ia(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(ga);Ra.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=Qo.add(i,Qo.NW),this.x0=a+s*Qo.uX(i),this.y0=h+o*Qo.uY(i),i=Qo.add(i,2),this.x1=a+s*Qo.uX(i),this.y1=h+o*Qo.uY(i),i=Qo.add(i,2),this.x2=a+s*Qo.uX(i),this.y2=h+o*Qo.uY(i),i=Qo.add(i,2),
this.x3=a+s*Qo.uX(i),this.y3=h+o*Qo.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Ma=new Ra,Na=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new ea(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=Ma,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new Lo(s.x,s.y):new Lo(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&xo[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===Ma&&(this._uvs=new Ra),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=so.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+mo()),t._pixiId);var s=xo[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=Ao(t)),(s=new a(new ga(t,e))).baseTexture.cacheId=n,
ga.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(ga.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new fa(t);r.url=e;var n=new a(new ga(r,{scaleMode:so.SCALE_MODE,resolution:Ao(e)}));return i=i||e,
ga.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(ga.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),xo[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),xo[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=xo[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete xo[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)xo[t.textureCacheIds[r]]===t&&delete xo[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function La(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Na.EMPTY=new Na(new ga),La(Na.EMPTY),La(Na.EMPTY.baseTexture),Na.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Na(new ga(new ba(t)))}(),La(Na.WHITE),La(Na.WHITE.baseTexture);function Fa(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var Da=function(a){function n(t,e){var i=null;if(!(t instanceof Pa)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new Pa({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new Pa(t))},n}(Na);Fa.prototype.createTexture=function(t,e){var i=new Pa(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Da(i)},
Fa.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=Fa.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=_o(t)))<<16|65535&(e=_o(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},Fa.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
Fa.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},Fa.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Fa.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},Fa.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Fa.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Fa.SCREEN_KEY="screen";function Ua(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}Ua.prototype.destroy=function(){this.buffer=null},Ua.from=function(t,e,i,r,n){return new Ua(t,e,i,r,n)};function Ba(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=ka++,this.disposeRunner=new oo("disposeBuffer",2)}var ka=0;function Xa(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Ba.prototype.update=function(t){this.data=t||this.data,this._updateID++},Ba.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Ba.prototype.destroy=function(){this.dispose(),this.data=null},Ba.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Ba(t)};var Ga={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Va(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Ha++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new oo("disposeGeometry",2),this.refCount=0}var ja={5126:4,5123:2,5121:1},Ha=0,Ya={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};Va.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Ba(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Ua(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},Va.prototype.getAttribute=function(t){return this.attributes[t]},Va.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},Va.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ba(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
Va.prototype.getIndex=function(){return this.indexBuffer},Va.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Ba;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*ja[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Xa(c)
;n[d]||(n[d]=new Ga[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Va.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Va.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},Va.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Va.prototype.clone=function(){for(var t=new Va,e=0;e<this.buffers.length;e++)t.buffers[e]=new Ba(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new Ua(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},Va.merge=function(t){for(var e,i=new Va,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(Ya[Xa(e.buffers[h].data)])(n[h]),i.buffers[h]=new Ba(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*ja[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function za(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=Ka++,this.static=!!e}var Wa=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Va),
qa=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ba(this.vertices),this.uvBuffer=new Ba(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Va),Ka=0
;za.prototype.update=function(){this.dirtyId++},za.prototype.add=function(t,e,i){this.uniforms[t]=new za(e,i)},za.from=function(t,e){return new za(t,e)};function Za(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new ea,this.destinationFrame=new ea,this.filters=[]}Za.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function Ja(t){this.renderer=t}var Qa=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new Fa,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Wa,this.quadUv=new qa,this.tempRect=new ea,this.activeState={},this.globalUniforms=new za({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Za,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Us.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(Us.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
jo.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(Sa);Ja.prototype.flush=function(){},Ja.prototype.destroy=function(){this.renderer=null},Ja.prototype.start=function(){},Ja.prototype.stop=function(){this.flush()},Ja.prototype.render=function(t){};var $a=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new Ja(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(Sa);so.PREFER_ENV=u.a.any?Ps.WEBGL:Ps.WEBGL2,so.STRICT_TEXTURE_CACHE=!1
;function th(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function eh(t){this.type=ro.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var ih=0,rh=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=ih++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=ih++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(so.PREFER_ENV>=Ps.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(Sa),nh=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new Ia(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ea,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;so.PREFER_ENV===Ps.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new ea},Object.defineProperties(t.prototype,i),t}(Sa),sh={5126:4,5123:2,5121:1},
oh=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;so.PREFER_ENV===Ps.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*sh[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*sh[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*sh[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new th(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(Sa);function ah(t,e,i,r){var n=hh(t,t.VERTEX_SHADER,e),s=hh(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function hh(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function uh(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return lh(2*e)
;case"bvec3":return lh(3*e);case"bvec4":return lh(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function lh(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}eh.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=ro.NONE,this.autoDetect=!0),this._target=null},eh.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var ch,dh={},ph=dh;function fh(){if(ph===dh||ph&&ph.isContextLost()){
var t,e=document.createElement("canvas");so.PREFER_ENV>=Ps.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),ph=t}return ph}function mh(t,e,i){if(
"precision"===t.substring(0,9))return i!==eo.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===eo.HIGH&&i!==eo.HIGH&&(r=eo.MEDIUM),"precision "+r+" float;\n"+t}var _h={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var yh=null,vh={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function gh(t,e){if(!yh){var i=Object.keys(vh)
;yh={};for(var r=0;r<i.length;++r){var n=i[r];yh[t[n]]=vh[n]}}return yh[e]}var xh={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},bh={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Th,Eh=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function wh(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function Ah(t,e,i){void 0===i&&(i="pixi-shader"),this.id=Sh++,this.vertexSrc=t||Ah.defaultVertexSrc,
this.fragmentSrc=e||Ah.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Ih[i]?(Ih[i]++,i+="-"+Ih[i]):Ih[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=mh(this.vertexSrc,so.PRECISION_VERTEX,eo.HIGH),this.fragmentSrc=mh(this.fragmentSrc,so.PRECISION_FRAGMENT,function(
){if(!ch){ch=eo.MEDIUM;var t=fh();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);ch=e.precision?eo.HIGH:eo.MEDIUM}}return ch}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var Sh=0,Ih={},Ch={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Ah.prototype.extractData=function(t,e){var i=fh();if(i){var r=ah(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},Ah.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=gh(e,a.type),u={type:h,name:a.name,size:(i=h,_h[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
Ah.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=gh(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:uh(h,s.size)}}return i},Ch.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},Ch.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},Ah.from=function(t,e,i){var r=t+e,n=go[r];return n||(go[r]=n=new Ah(t
,e,i)),n},Object.defineProperties(Ah,Ch);function Oh(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof za?e:new za(e):new za({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var Rh={uniforms:{configurable:!0}};Oh.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
Oh.prototype.destroy=function(){this.uniformGroup=null},Rh.uniforms.get=function(){return this.uniformGroup.uniforms},Oh.from=function(t,e,i){var r=Ah.from(t,e);return new Oh(r,i)},Object.defineProperties(Oh.prototype,Rh);function Ph(){this.data=0,
this.blendMode=Fs.NORMAL,this.polygonOffset=0,this.blend=!0}var Mh={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};Mh.blend.get=function(){return!!(1&this.data)},Mh.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Mh.offsets.get=function(){return!!(2&this.data)},Mh.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
Mh.culling.get=function(){return!!(4&this.data)},Mh.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Mh.depthTest.get=function(){return!!(8&this.data)},Mh.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
Mh.clockwiseFrontFace.get=function(){return!!(16&this.data)},Mh.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Mh.blendMode.get=function(){return this._blendMode},Mh.blendMode.set=function(t){this.blend=t!==Fs.NONE,
this._blendMode=t},Mh.polygonOffset.get=function(){return this._polygonOffset},Mh.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Ph.for2d=function(){var t=new Ph;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
Ph.prototype,Mh);var Nh=function(n){function s(t,e,i){var r=Ah.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=so.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Ph}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(Oh);Nh.SOURCE_KEY_MAP={};function Lh(t,e){this._texture=t,this.mapCoord=new jo,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var Fh=new jo,Dh={texture:{configurable:!0}};Dh.texture.get=function(){return this._texture},Dh.texture.set=function(t){this._texture=t,this._updateID=-1},Lh.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},Lh.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(Fh.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Fh));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(Lh.prototype,Dh);function Uh(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Bh=function(i){
function t(t){var e=new jo;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new Lh(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(Nh),kh=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new eh;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case ro.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case ro.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case ro.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case ro.SCISSOR:this.renderer.scissor.pop();break;case ro.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case ro.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=ro.SPRITE;else if(t.type=ro.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=ro.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new Bh(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(Sa),Xh=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(Sa),Gh=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(Xh),Vh=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Xh),jh=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new jo,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(Sa),Hh=new ea,Yh=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new ea,this.destinationFrame=new ea}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(Hh.width=s.realWidth,Hh.height=s.realHeight,i=Hh),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
Hh.width=n.width,Hh.height=n.height,i=Hh),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(Sa)
;Uh.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var zh=0,Wh=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=zh++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Th)return Th;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;Th=!0===t({a:"b"},"a","b")}catch(t){Th=!1}return Th}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?xh:bh)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=ah(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:uh(h.type,h.size)}}var u=new Uh(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(Sa);function qh(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var Kh=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Fs.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Ph,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Fs.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.ADD]=[t.ONE,t.ONE],e[Fs.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[Fs.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[Fs.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[Fs.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.NONE]=[0,0],e[Fs.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[Fs.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Fs.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Fs.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Fs.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Fs.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[Fs.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Fs.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Fs.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Fs.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Fs.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(Sa),Zh=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=so.GC_MAX_IDLE,
this.checkCountMax=so.GC_MAX_CHECK_COUNT,this.mode=so.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==$s.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(Sa),Jh=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ga}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new qh(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new qh(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new qh(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===js.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&po(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==Ks.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Ws.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===Ys.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(Sa),Qh=new jo;X.a;function $h(){this.texArray=null,this.blend=0,this.type=Us.TRIANGLES,this.start=0,this.size=0,this.data=null}function tu(){this.elements=[],this.ids=[],this.count=0}tu.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function eu(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var iu={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};iu.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},iu.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},iu.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},iu.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},iu.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},eu.prototype.view=function(t){
return this[t+"View"]},eu.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},eu.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(eu.prototype,iu);var ru=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Ph.for2d(),this.size=4*so.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;so.PREFER_ENV===Ps.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),so.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Eh.replace(/%forloop%/gi,wh(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new $h);for(;e.length<r;)e.push(new tu);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++ga._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;ga._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=co[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;so.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),so.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=_o(Math.ceil(t/8)),i=vo(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new eu(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=_o(Math.ceil(t/12)),i=vo(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(Ja);ru._drawCallPool=[],ru._textureArrayPool=[];function nu(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}nu.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=za.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ah(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new jo,default:this.defaultGroupCache[t]};return new Oh(this.programCache[t],n)},
nu.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function su(){}var ou=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Ba(null,t,!1),this._indexBuffer=new Ba(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,js.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,js.FLOAT).addAttribute("aColor",this._buffer,4,!0,js.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,js.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Va),
au="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,hu="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",uu={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};su.create=function(t){var e=Object.assign({vertex:au,fragment:hu,geometryClass:ou,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new nu(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(ru)},uu.defaultVertexSrc.get=function(){return au},uu.defaultFragmentTemplate.get=function(){
return hu},Object.defineProperties(su,uu);su.create();var lu=(cu.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++
)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},cu.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},cu.prototype.add=function(t){
return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},cu.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},
cu.prototype.contains=function(t){return-1!==this.items.indexOf(t)},cu.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},cu.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},
Object.defineProperty(cu.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(cu.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),cu);function cu(t){
this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(lu.prototype,{dispatch:{value:lu.prototype.emit},run:{value:lu.prototype.emit}});var du,pu,fu,mu,_u,yu,vu,gu,xu,bu,Tu,Eu,wu,Au,Su,Iu,Cu,Ou,Ru,Pu,Mu,Nu,Lu,Fu,Du,Uu,Bu,ku,Xu={
MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(
u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,
clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",
CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(pu=du=du||{})[pu.WEBGL_LEGACY=0]="WEBGL_LEGACY",pu[pu.WEBGL=1]="WEBGL",pu[pu.WEBGL2=2]="WEBGL2",(mu=fu=fu||{})[mu.UNKNOWN=0]="UNKNOWN",mu[mu.WEBGL=1]="WEBGL",
mu[mu.CANVAS=2]="CANVAS",(yu=_u=_u||{})[yu.NORMAL=0]="NORMAL",yu[yu.ADD=1]="ADD",yu[yu.MULTIPLY=2]="MULTIPLY",yu[yu.SCREEN=3]="SCREEN",yu[yu.OVERLAY=4]="OVERLAY",yu[yu.DARKEN=5]="DARKEN",yu[yu.LIGHTEN=6]="LIGHTEN",yu[yu.COLOR_DODGE=7]="COLOR_DODGE",
yu[yu.COLOR_BURN=8]="COLOR_BURN",yu[yu.HARD_LIGHT=9]="HARD_LIGHT",yu[yu.SOFT_LIGHT=10]="SOFT_LIGHT",yu[yu.DIFFERENCE=11]="DIFFERENCE",yu[yu.EXCLUSION=12]="EXCLUSION",yu[yu.HUE=13]="HUE",yu[yu.SATURATION=14]="SATURATION",yu[yu.COLOR=15]="COLOR",
yu[yu.LUMINOSITY=16]="LUMINOSITY",yu[yu.NORMAL_NPM=17]="NORMAL_NPM",yu[yu.ADD_NPM=18]="ADD_NPM",yu[yu.SCREEN_NPM=19]="SCREEN_NPM",yu[yu.NONE=20]="NONE",yu[yu.SRC_OVER=0]="SRC_OVER",yu[yu.SRC_IN=21]="SRC_IN",yu[yu.SRC_OUT=22]="SRC_OUT",
yu[yu.SRC_ATOP=23]="SRC_ATOP",yu[yu.DST_OVER=24]="DST_OVER",yu[yu.DST_IN=25]="DST_IN",yu[yu.DST_OUT=26]="DST_OUT",yu[yu.DST_ATOP=27]="DST_ATOP",yu[yu.ERASE=26]="ERASE",yu[yu.SUBTRACT=28]="SUBTRACT",yu[yu.XOR=29]="XOR",(gu=vu=vu||{})[gu.POINTS=0]="POINTS",
gu[gu.LINES=1]="LINES",gu[gu.LINE_LOOP=2]="LINE_LOOP",gu[gu.LINE_STRIP=3]="LINE_STRIP",gu[gu.TRIANGLES=4]="TRIANGLES",gu[gu.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",gu[gu.TRIANGLE_FAN=6]="TRIANGLE_FAN",(bu=xu=xu||{})[bu.RGBA=6408]="RGBA",bu[bu.RGB=6407]="RGB",
bu[bu.ALPHA=6406]="ALPHA",bu[bu.LUMINANCE=6409]="LUMINANCE",bu[bu.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",bu[bu.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",bu[bu.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(Eu=Tu=Tu||{})[Eu.TEXTURE_2D=3553]="TEXTURE_2D",
Eu[Eu.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",Eu[Eu.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Eu[Eu.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",Eu[Eu.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
Eu[Eu.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Eu[Eu.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",Eu[Eu.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
Eu[Eu.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(Au=wu=wu||{})[Au.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",Au[Au.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",Au[Au.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
Au[Au.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",Au[Au.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",Au[Au.FLOAT=5126]="FLOAT",Au[Au.HALF_FLOAT=36193]="HALF_FLOAT",(Iu=Su=Su||{})[Iu.NEAREST=0]="NEAREST",Iu[Iu.LINEAR=1]="LINEAR",(
Ou=Cu=Cu||{})[Ou.CLAMP=33071]="CLAMP",Ou[Ou.REPEAT=10497]="REPEAT",Ou[Ou.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(Pu=Ru=Ru||{})[Pu.OFF=0]="OFF",Pu[Pu.POW2=1]="POW2",Pu[Pu.ON=2]="ON",(Nu=Mu=Mu||{})[Nu.NPM=0]="NPM",Nu[Nu.UNPACK=1]="UNPACK",
Nu[Nu.PMA=2]="PMA",Nu[Nu.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Nu[Nu.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Nu[Nu.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(Fu=Lu=Lu||{})[Fu.AUTO=0]="AUTO",Fu[Fu.MANUAL=1]="MANUAL",(Uu=Du=Du||{}
).LOW="lowp",Uu.MEDIUM="mediump",Uu.HIGH="highp",(ku=Bu=Bu||{})[ku.NONE=0]="NONE",ku[ku.SCISSOR=1]="SCISSOR",ku[ku.STENCIL=2]="STENCIL",ku[ku.SPRITE=3]="SPRITE",Xu.RETINA_PREFIX=/@([0-9\.]+)x/;var Gu,Vu=!(Xu.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),ju="5.2.0"
;function Hu(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}var Yu=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[_u.NORMAL_NPM]=_u.NORMAL,t[_u.ADD_NPM]=_u.ADD,t[_u.SCREEN_NPM]=_u.SCREEN,e[_u.NORMAL]=_u.NORMAL_NPM,
e[_u.ADD]=_u.ADD_NPM,e[_u.SCREEN]=_u.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function zu(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(n=n*e+.5|0)
}function Wu(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var qu=0;function Ku(){return++qu}function Zu(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Ju(t){
return!(t&t-1||!t)}function Qu(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var $u={},tl=Object.create(null),el=Object.create(null);function il(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||Xu.RESOLUTION,this.resize(t,e)}var rl={width:{configurable:!0},height:{configurable:!0}};il.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},il.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},il.prototype.destroy=function(){this.context=null,this.canvas=null},rl.width.get=function(){
return this.canvas.width},rl.width.set=function(t){this.canvas.width=t},rl.height.get=function(){return this.canvas.height},rl.height.set=function(t){this.canvas.height=t},Object.defineProperties(il.prototype,rl);var nl;function sl(t,e){
var i=Xu.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var ol,al,hl={};function ul(t,e,i){if(void 0===i&&(i=3),!hl[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split(
"\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),
console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),hl[e]=!0}}Xu.TARGET_FPMS=.06,(al=ol=ol||{})[al.INTERACTION=50]="INTERACTION",al[al.HIGH=25]="HIGH",al[al.NORMAL=0]="NORMAL",al[al.LOW=-25]="LOW"
,al[al.UTILITY=-50]="UTILITY";var ll=(cl.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},cl.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next
;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},cl.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},cl.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,
this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},cl);function cl(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),
void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var dl=(pl.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),
this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},pl.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},pl.prototype._startIfPossible=function(){
this.started?this._requestIfNeeded():this.autoStart&&this.start()},pl.prototype.add=function(t,e,i){return void 0===i&&(i=ol.NORMAL),this._addListener(new ll(t,e,i))},pl.prototype.addOnce=function(t,e,i){return void 0===i&&(i=ol.NORMAL),this._addListener(
new ll(t,e,i,!0))},pl.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},
pl.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},pl.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},
pl.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},pl.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},
pl.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(
i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Xu.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()
}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(pl.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(pl.prototype,"minFPS",{get:function(){
return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Xu.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(pl.prototype,"maxFPS",{get:function(){
return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(pl,"shared",{
get:function(){if(!pl._shared){var t=pl._shared=new pl;t.autoStart=!0,t._protected=!0}return pl._shared},enumerable:!0,configurable:!0}),Object.defineProperty(pl,"system",{get:function(){if(!pl._system){var t=pl._system=new pl;t.autoStart=!0,
t._protected=!0}return pl._system},enumerable:!0,configurable:!0}),pl);function pl(){var e=this;this._head=new ll(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,
this.deltaMS=1/Xu.TARGET_FPMS,this.elapsedMS=1/Xu.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),
e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}fl.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){
this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,ol.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?dl.shared:new dl,t.autoStart&&this.start()},fl.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function fl(){}var ml=(_l.prototype.clone=function(){return new _l(this.x,this.y)},
_l.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},_l.prototype.copyTo=function(t){return t.set(this.x,this.y),t},_l.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},_l.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},_l);function _l(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var yl=(vl.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new vl(t,e,this._x,this._y)},
vl.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},vl.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},vl.prototype.copyTo=function(t){return t.set(this._x,this._y),t},vl.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(vl.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(vl.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),vl);function vl(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var gl,xl,bl=2*Math.PI,Tl=180/Math.PI,El=Math.PI/180;(xl=gl=gl||{})[xl.POLY=0]="POLY",xl[xl.RECT=1]="RECT",xl[xl.CIRC=2]="CIRC",xl[xl.ELIP=3]="ELIP",
xl[xl.RREC=4]="RREC";var wl=(Al.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},Al.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
Al.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},Al.prototype.apply=function(t,e){e=e||new ml;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},Al.prototype.applyInverse=function(t,e){e=e||new ml;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},Al.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
Al.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},Al.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},Al.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},Al.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},Al.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},Al.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(bl-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},Al.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},Al.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Al.prototype.clone=function(){
var t=new Al;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Al.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Al.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(Al,"IDENTITY",{get:function(){return new Al},enumerable:!0,configurable:!0}),Object.defineProperty(Al,"TEMP_MATRIX",{get:function(){return new Al},
enumerable:!0,configurable:!0}),Al);function Al(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var Sl=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Il=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Cl=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ol=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Rl=[],Pl=[],Ml=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Rl.push(e);for(
var i=0;i<16;i++)for(var r=Ml(Sl[t]*Sl[i]+Cl[t]*Il[i]),n=Ml(Il[t]*Sl[i]+Ol[t]*Il[i]),s=Ml(Sl[t]*Cl[i]+Cl[t]*Ol[i]),o=Ml(Il[t]*Cl[i]+Ol[t]*Ol[i]),a=0;a<16;a++)if(Sl[a]===r&&Il[a]===n&&Cl[a]===s&&Ol[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new wl
;h.set(Sl[t],Il[t],Cl[t],Ol[t],0,0),Pl.push(h)}}();var Nl={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Sl[t]},uY:function(t){return Il[t]},vX:function(t){
return Cl[t]},vY:function(t){return Ol[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Rl[t][e]},sub:function(t,e){return Rl[t][Nl.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?Nl.S:Nl.N:2*Math.abs(e)<=Math.abs(t)?0<t?Nl.E:Nl.W:0<e?0<t?Nl.SE:Nl.SW:0<t?Nl.NE:Nl.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=Pl[Nl.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},Ll=(Fl.prototype.onChange=function(){this._localID++},Fl.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},Fl.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},Fl.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},Fl.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(Fl.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),Fl.IDENTITY=new Fl,Fl);function Fl(){this.worldTransform=new wl,this.localTransform=new wl,this.position=new yl(this.onChange,
this,0,0),this.scale=new yl(this.onChange,this,1,1),this.pivot=new yl(this.onChange,this,0,0),this.skew=new yl(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var Dl=(Object.defineProperty(Ul.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Ul.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(Ul.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Ul.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Ul,"EMPTY"
,{get:function(){return new Ul(0,0,0,0)},enumerable:!0,configurable:!0}),Ul.prototype.clone=function(){return new Ul(this.x,this.y,this.width,this.height)},Ul.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},Ul.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},Ul.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},Ul.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},Ul.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},Ul.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
Ul.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},Ul);function Ul(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=gl.RECT}var Bl=(kl.prototype.clone=function(){return new kl(this.x,this.y,this.radius)},
kl.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},kl.prototype.getBounds=function(){return new Dl(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},
kl);function kl(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=gl.CIRC}var Xl=(Gl.prototype.clone=function(){return new Gl(this.x,this.y,this.width,this.height)},Gl.prototype.contains=function(t,e){
if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},Gl.prototype.getBounds=function(){return new Dl(this.x-this.width,this.y-this.height,this.width,this.height)},Gl);function Gl(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=gl.ELIP}var Vl=(jl.prototype.clone=function(){var t=new jl(this.points.slice());return t.closeStroke=this.closeStroke,t},
jl.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i},jl);function jl(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof ml){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=gl.POLY,this.closeStroke=!0}var Hl=(
Yl.prototype.clone=function(){return new Yl(this.x,this.y,this.width,this.height,this.radius)},Yl.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1},Yl);function Yl(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=gl.RREC}Xu.SORTABLE_CHILDREN=!1;function zl(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}zl.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},zl.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},zl.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Dl.EMPTY:((
t=t||new Dl(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},zl.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},zl.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},zl.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
zl.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},zl.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},zl.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
zl.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},zl.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},zl.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},zl.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},zl.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},zl.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},zl.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var Wl=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new Ll,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new zl,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Dl),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Dl),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*Tl},e.angle.set=function(t){this.transform.rotation=t*El
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function ql(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Wl.prototype.displayObjectUpdateTransform=Wl.prototype.updateTransform;var Kl=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=Xu.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Wu(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,Wu(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,Wu(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(ql),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(Wl);Kl.prototype.containerUpdateTransform=Kl.prototype.updateTransform;function Zl(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new lu(
"setRealSize",2),this.onUpdate=new lu("update"),this.onError=new lu("onError",1)}var Jl={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};Zl.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},Zl.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},Zl.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},Jl.valid.get=function(){return!!this._width&&!!this._height},Zl.prototype.update=function(){this.destroyed||this.onUpdate.run()},Zl.prototype.load=function(){return Promise.resolve()},
Jl.width.get=function(){return this._width},Jl.height.get=function(){return this._height},Zl.prototype.upload=function(t,e,i){return!1},Zl.prototype.style=function(t,e,i){return!1},Zl.prototype.dispose=function(){},Zl.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(Zl.prototype,Jl);var Ql=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(nl=nl||document.createElement("a")).href=t;var i=!(t=H.a.parse(nl.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Mu.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(Zl),$l=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:Xu.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===Mu.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(Ql),tc=[];function ec(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=tc.length-1;0<=n;--n){var s=tc[n];if(s.test&&s.test(t,i))return new s(t,e)}return new $l(t,e)}var ic=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Mu.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(Zl),rc={scaleMode:Su.NEAREST,format:xu.RGBA,
alphaMode:Mu.NPM},nc=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof Zl||((t=ec(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||Xu.RESOLUTION,this.mipmap=void 0!==r?r:Xu.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:Xu.ANISOTROPIC_LEVEL,
this.wrapMode=h||Xu.WRAP_MODE,this.scaleMode=void 0!==s?s:Xu.SCALE_MODE,this.format=u||xu.RGBA,this.type=l||wu.UNSIGNED_BYTE,this.target=c||Tu.TEXTURE_2D,this.alphaMode=void 0!==i?i:Mu.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=Ku(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=Ju(this.realWidth
)&&Ju(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete el[this.cacheId],delete tl[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=Xu.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Ku()),t._pixiId);var s=el[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new ic(t,{width:e,height:i}),
s=t instanceof Float32Array?wu.FLOAT:wu.UNSIGNED_BYTE;return new o(n,Object.assign(rc,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),el[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),el[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=el[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete el[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete el[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);nc._globalBatch=0;var sc=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new nc;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(ec(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=Tu.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(Zl),
oc=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(Ql),
ac=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=Tu.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=Tu.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(sc);ac.SIDES=6;var hc=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+Ku(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(Ql)
;hc.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var uc=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=dl.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(dl.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(dl.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&dl.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(dl.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(dl.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(Ql);uc.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var lc=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(Ql);tc.push($l,lc,oc,uc,hc,ic,ac,sc);function cc(t){this.renderer=t}
cc.prototype.destroy=function(){this.renderer=null};function dc(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new lu("disposeFramebuffer",2)}var pc=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Mu.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(ic),fc={colorTexture:{configurable:!0}};fc.colorTexture.get=function(){return this.colorTextures[0]},dc.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new nc(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},dc.prototype.addDepthTexture=function(t){return this.depthTexture=t||new nc(new pc(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:xu.DEPTH_COMPONENT,type:wu.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},dc.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},dc.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},dc.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},dc.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(dc.prototype,fc);function mc(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var _c=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new dc(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(nc);mc.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=Nl.add(i,Nl.NW),this.x0=a+s*Nl.uX(i),this.y0=h+o*Nl.uY(i),i=Nl.add(i,2),this.x1=a+s*Nl.uX(i),this.y1=h+o*Nl.uY(i),i=Nl.add(i,2),this.x2=a+s*Nl.uX(i),this.y2=h+o*Nl.uY(i),i=Nl.add(i,2),
this.x3=a+s*Nl.uX(i),this.y3=h+o*Nl.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var yc=new mc,vc=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new Dl(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=yc,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new ml(s.x,s.y):new ml(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&tl[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===yc&&(this._uvs=new mc),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=Xu.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Ku()),t._pixiId);var s=tl[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=sl(t)),(s=new a(new nc(t,e))).baseTexture.cacheId=n,
nc.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(nc.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new $l(t);r.url=e;var n=new a(new nc(r,{scaleMode:Xu.SCALE_MODE,resolution:sl(e)}));return i=i||e,
nc.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(nc.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),tl[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),tl[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=tl[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete tl[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)tl[t.textureCacheIds[r]]===t&&delete tl[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function gc(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}vc.EMPTY=new vc(new nc),gc(vc.EMPTY),gc(vc.EMPTY.baseTexture),vc.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new vc(new nc(new oc(t)))}(),gc(vc.WHITE),gc(vc.WHITE.baseTexture);function xc(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var bc=function(a){function n(t,e){var i=null;if(!(t instanceof _c)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new _c({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new _c(t))},n}(vc);xc.prototype.createTexture=function(t,e){var i=new _c(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new bc(i)},
xc.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=xc.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=Zu(t)))<<16|65535&(e=Zu(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},xc.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
xc.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},xc.prototype.returnFilterTexture=function(t){this.returnTexture(t)},xc.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},xc.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=xc.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},xc.SCREEN_KEY="screen";function Tc(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}Tc.prototype.destroy=function(){this.buffer=null},Tc.from=function(t,e,i,r,n){return new Tc(t,e,i,r,n)};function Ec(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=wc++,this.disposeRunner=new lu("disposeBuffer",2)}var wc=0;function Ac(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Ec.prototype.update=function(t){this.data=t||this.data,this._updateID++},Ec.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Ec.prototype.destroy=function(){this.dispose(),this.data=null},Ec.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Ec(t)};var Sc={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Ic(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Oc++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new lu("disposeGeometry",2),this.refCount=0}var Cc={5126:4,5123:2,5121:1},Oc=0,Rc={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};Ic.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Ec(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Tc(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},Ic.prototype.getAttribute=function(t){return this.attributes[t]},Ic.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},Ic.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ec(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
Ic.prototype.getIndex=function(){return this.indexBuffer},Ic.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Ec;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Cc[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Ac(c)
;n[d]||(n[d]=new Sc[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Ic.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Ic.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},Ic.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Ic.prototype.clone=function(){for(var t=new Ic,e=0;e<this.buffers.length;e++)t.buffers[e]=new Ec(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new Tc(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},Ic.merge=function(t){for(var e,i=new Ic,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(Rc[Ac(e.buffers[h].data)])(n[h]),i.buffers[h]=new Ec(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Cc[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function Pc(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=Lc++,this.static=!!e}var Mc=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Ic),
Nc=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ec(this.vertices),this.uvBuffer=new Ec(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Ic),Lc=0
;Pc.prototype.update=function(){this.dirtyId++},Pc.prototype.add=function(t,e,i){this.uniforms[t]=new Pc(e,i)},Pc.from=function(t,e){return new Pc(t,e)};function Fc(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new Dl,this.destinationFrame=new Dl,this.filters=[]}Fc.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function Dc(t){this.renderer=t}var Uc=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new xc,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Mc,this.quadUv=new Nc,this.tempRect=new Dl,this.activeState={},this.globalUniforms=new Pc({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Fc,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(vu.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(vu.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
wl.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(cc);Dc.prototype.flush=function(){},Dc.prototype.destroy=function(){this.renderer=null},Dc.prototype.start=function(){},Dc.prototype.stop=function(){this.flush()},Dc.prototype.render=function(t){};var Bc=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new Dc(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(cc);Xu.PREFER_ENV=u.a.any?du.WEBGL:du.WEBGL2,Xu.STRICT_TEXTURE_CACHE=!1
;function kc(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function Xc(t){this.type=Bu.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var Gc=0,Vc=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Gc++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Gc++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(Xu.PREFER_ENV>=du.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(cc),jc=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new dc(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Dl,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Xu.PREFER_ENV===du.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Dl},Object.defineProperties(t.prototype,i),t}(cc),Hc={5126:4,5123:2,5121:1},
Yc=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;Xu.PREFER_ENV===du.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Hc[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Hc[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Hc[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new kc(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(cc);function zc(t,e,i,r){var n=Wc(t,t.VERTEX_SHADER,e),s=Wc(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Wc(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function qc(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Kc(2*e)
;case"bvec3":return Kc(3*e);case"bvec4":return Kc(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Kc(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}Xc.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Bu.NONE,this.autoDetect=!0),this._target=null},Xc.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var Zc,Jc={},Qc=Jc;function $c(){if(Qc===Jc||Qc&&Qc.isContextLost()){
var t,e=document.createElement("canvas");Xu.PREFER_ENV>=du.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),Qc=t}return Qc}function td(t,e,i){if(
"precision"===t.substring(0,9))return i!==Du.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===Du.HIGH&&i!==Du.HIGH&&(r=Du.MEDIUM),"precision "+r+" float;\n"+t}var ed={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var id=null,rd={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function nd(t,e){if(!id){var i=Object.keys(rd)
;id={};for(var r=0;r<i.length;++r){var n=i[r];id[t[n]]=rd[n]}}return id[e]}var sd={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},od={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var ad,hd=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function ud(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function ld(t,e,i){void 0===i&&(i="pixi-shader"),this.id=cd++,this.vertexSrc=t||ld.defaultVertexSrc,
this.fragmentSrc=e||ld.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),dd[i]?(dd[i]++,i+="-"+dd[i]):dd[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=td(this.vertexSrc,Xu.PRECISION_VERTEX,Du.HIGH),this.fragmentSrc=td(this.fragmentSrc,Xu.PRECISION_FRAGMENT,function(
){if(!Zc){Zc=Du.MEDIUM;var t=$c();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Zc=e.precision?Du.HIGH:Du.MEDIUM}}return Zc}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var cd=0,dd={},pd={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};ld.prototype.extractData=function(t,e){var i=$c();if(i){var r=zc(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},ld.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=nd(e,a.type),u={type:h,name:a.name,size:(i=h,ed[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
ld.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=nd(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:qc(h,s.size)}}return i},pd.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},pd.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},ld.from=function(t,e,i){var r=t+e,n=$u[r];return n||($u[r]=n=new ld(t
,e,i)),n},Object.defineProperties(ld,pd);function fd(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof Pc?e:new Pc(e):new Pc({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var md={uniforms:{configurable:!0}};fd.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
fd.prototype.destroy=function(){this.uniformGroup=null},md.uniforms.get=function(){return this.uniformGroup.uniforms},fd.from=function(t,e,i){var r=ld.from(t,e);return new fd(r,i)},Object.defineProperties(fd.prototype,md);function _d(){this.data=0,
this.blendMode=_u.NORMAL,this.polygonOffset=0,this.blend=!0}var yd={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};yd.blend.get=function(){return!!(1&this.data)},yd.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},yd.offsets.get=function(){return!!(2&this.data)},yd.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
yd.culling.get=function(){return!!(4&this.data)},yd.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},yd.depthTest.get=function(){return!!(8&this.data)},yd.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
yd.clockwiseFrontFace.get=function(){return!!(16&this.data)},yd.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},yd.blendMode.get=function(){return this._blendMode},yd.blendMode.set=function(t){this.blend=t!==_u.NONE,
this._blendMode=t},yd.polygonOffset.get=function(){return this._polygonOffset},yd.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},_d.for2d=function(){var t=new _d;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
_d.prototype,yd);var vd=function(n){function s(t,e,i){var r=ld.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=Xu.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new _d}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(fd);vd.SOURCE_KEY_MAP={};function gd(t,e){this._texture=t,this.mapCoord=new wl,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var xd=new wl,bd={texture:{configurable:!0}};bd.texture.get=function(){return this._texture},bd.texture.set=function(t){this._texture=t,this._updateID=-1},gd.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},gd.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(xd.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(xd));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(gd.prototype,bd);function Td(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Ed=function(i){
function t(t){var e=new wl;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new gd(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(vd),wd=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new Xc;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case Bu.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case Bu.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case Bu.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Bu.SCISSOR:this.renderer.scissor.pop();break;case Bu.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Bu.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Bu.SPRITE;else if(t.type=Bu.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=Bu.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new Ed(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(cc),Ad=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(cc),Sd=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(Ad),Id=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Ad),Cd=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new wl,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(cc),Od=new Dl,Rd=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new Dl,this.destinationFrame=new Dl}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(Od.width=s.realWidth,Od.height=s.realHeight,i=Od),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
Od.width=n.width,Od.height=n.height,i=Od),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(cc)
;Td.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Pd=0,Md=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Pd++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof ad)return ad;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;ad=!0===t({a:"b"},"a","b")}catch(t){ad=!1}return ad}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?sd:od)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=zc(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:qc(h.type,h.size)}}var u=new Td(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(cc);function Nd(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var Ld=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=_u.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new _d,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[_u.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.ADD]=[t.ONE,t.ONE],e[_u.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[_u.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[_u.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[_u.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.NONE]=[0,0],e[_u.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[_u.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_u.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[_u.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[_u.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[_u.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[_u.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[_u.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[_u.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[_u.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[_u.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(cc),Fd=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=Xu.GC_MAX_IDLE,
this.checkCountMax=Xu.GC_MAX_CHECK_COUNT,this.mode=Xu.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Lu.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(cc),Dd=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new nc}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new Nd(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Nd(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new Nd(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===wu.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&Wu(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==Ru.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Cu.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===Su.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(cc),Ud=new wl;X.a;function Bd(){this.texArray=null,this.blend=0,this.type=vu.TRIANGLES,this.start=0,this.size=0,this.data=null}function kd(){this.elements=[],this.ids=[],this.count=0}kd.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function Xd(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var Gd={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Gd.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Gd.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Gd.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Gd.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Gd.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Xd.prototype.view=function(t){
return this[t+"View"]},Xd.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Xd.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Xd.prototype,Gd);var Vd=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=_d.for2d(),this.size=4*Xu.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;Xu.PREFER_ENV===du.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Xu.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=hd.replace(/%forloop%/gi,ud(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Bd);for(;e.length<r;)e.push(new kd);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++nc._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;nc._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=Yu[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;Xu.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Xu.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=Zu(Math.ceil(t/8)),i=Qu(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Xd(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=Zu(Math.ceil(t/12)),i=Qu(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?zu(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(
var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(Dc);Vd._drawCallPool=[],Vd._textureArrayPool=[];function jd(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error(
'Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}jd.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i
;this.defaultGroupCache[t]=Pc.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ld(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),
translationMatrix:new wl,default:this.defaultGroupCache[t]};return new fd(this.programCache[t],n)},jd.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",
e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};function Hd(){}var Yd=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Ec(null,t,!1),this._indexBuffer=new Ec(null,t,!0),
this.addAttribute("aVertexPosition",this._buffer,2,!1,wu.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,wu.FLOAT).addAttribute("aColor",this._buffer,4,!0,wu.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,wu.FLOAT).addIndex(
this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Ic),
zd="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,Wd="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",qd={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};Hd.create=function(t){var e=Object.assign({vertex:zd,fragment:Wd,geometryClass:Yd,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new jd(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Vd)},qd.defaultVertexSrc.get=function(){return zd},qd.defaultFragmentTemplate.get=function(){
return Wd},Object.defineProperties(Hd,qd);Hd.create();function Kd(){this.reset()}var Zd={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive)return e;var i=Math.ceil(t/this.maxLength)
;return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}};Kd.prototype.clone=function(){var t=new Kd;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},
Kd.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=vc.WHITE,this.matrix=null,this.visible=!1},Kd.prototype.destroy=function(){this.texture=null,this.matrix=null};var Jd={build:function(t){t.points=t.shape.points.slice()},
triangulate:function(t,e){var i=t.points,r=t.holes,n=e.points,s=e.indices;if(6<=i.length){for(var o=[],a=0;a<r.length;a++){var h=r[a];o.push(i.length/2),i=i.concat(h.points)}var u=V()(i,o,2);if(!u)return;for(var l=n.length/2,c=0;c<u.length;c+=3)s.push(
u[c]+l),s.push(u[c+1]+l),s.push(u[c+2]+l);for(var d=0;d<i.length;d++)n.push(i[d])}}},Qd={build:function(t){var e,i,r=t.shape,n=t.points,s=r.x,o=r.y;if(n.length=0,i=t.type===gl.CIRC?(e=r.radius,r.radius):(e=r.width,r.height),0!==e&&0!==i){var a=Math.floor(
30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(r.width+r.height));a/=2.3;for(var h=2*Math.PI/a,u=0;u<a;u++)n.push(s+Math.sin(-h*u)*e,o+Math.cos(-h*u)*i);n.push(n[0],n[1])}},triangulate:function(t,e){var i=t.points,r=e.points,n=e.indices,s=r.length/2,o=s
;r.push(t.shape.x,t.shape.y);for(var a=0;a<i.length;a+=2)r.push(i[a],i[a+1]),n.push(s++,o,s)}},$d={build:function(t){var e=t.shape,i=e.x,r=e.y,n=e.width,s=e.height,o=t.points;o.length=0,o.push(i,r,i+n,r,i+n,r+s,i,r+s)},triangulate:function(t,e){
var i=t.points,r=e.points,n=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(n,1+n,2+n,1+n,2+n,3+n)}},tp={build:function(t){var e=t.shape,i=t.points,r=e.x,n=e.y,s=e.width,o=e.height,a=e.radius;i.length=0,ip(r,n+a,r,n,r+a,n,i),ip(
r+s-a,n,r+s,n,r+s,n+a,i),ip(r+s,n+o-a,r+s,n+o,r+s-a,n+o,i),ip(r+a,n+o,r,n+o,r,n+o-a,i)},triangulate:function(t,e){for(var i=t.points,r=e.points,n=e.indices,s=r.length/2,o=V()(i,null,2),a=0,h=o.length;a<h;a+=3)n.push(o[a]+s),n.push(o[a+1]+s),n.push(
o[a+2]+s);for(var u=0,l=i.length;u<l;u++)r.push(i[u],i[++u])}};function ep(t,e,i){return t+(e-t)*i}function ip(t,e,i,r,n,s,o){void 0===o&&(o=[]);for(var a=o,h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0;f<=20;++f)h=ep(t,i,m=f/20),u=ep(e,r,m),l=ep(i,n,m),c=ep(r,s,m),
d=ep(h,l,m),p=ep(u,c,m),a.push(d,p);return a}function rp(t,e){t.lineStyle.native?function(t,e){var i=0,r=t.shape,n=t.points||r.points,s=r.type!==gl.POLY||r.closeStroke;if(0===n.length)return;var o=e.points,a=e.indices,h=n.length/2,u=o.length/2,l=u;for(
o.push(n[0],n[1]),i=1;i<h;i++)o.push(n[2*i],n[2*i+1]),a.push(l,l+1),l++;s&&a.push(l,u)}(t,e):function(t,e){var i=t.shape,r=t.points||i.points.slice(),n=e.closePointEps;if(0===r.length)return;var s=t.lineStyle,o=new ml(r[0],r[1]),a=new ml(r[r.length-2],
r[r.length-1]),h=i.type!==gl.POLY||i.closeStroke,u=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(h){r=r.slice(),u&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));var l=a.x+.5*(o.x-a.x),c=a.y+.5*(o.y-a.y);r.unshift(l,c),r.push(l,c)}var d=e.points,
p=r.length/2,f=r.length,m=d.length/2,_=s.width/2,y=r[0],v=r[1],g=r[2],x=r[3],b=0,T=0,E=-(v-x),w=y-g,A=0,S=0,I=0,C=0,O=Math.sqrt(E*E+w*w);E/=O,w/=O,E*=_,w*=_;var R=s.alignment,P=2*(1-R),M=2*R;d.push(y-E*P,v-w*P),d.push(y+E*M,v+w*M);for(var N=1;N<p-1;++N){
y=r[2*(N-1)],v=r[2*(N-1)+1],g=r[2*N],x=r[2*N+1],b=r[2*(N+1)],T=r[2*(N+1)+1],E=-(v-x),w=y-g,O=Math.sqrt(E*E+w*w),E/=O,w/=O,E*=_,w*=_,A=-(x-T),S=g-b,O=Math.sqrt(A*A+S*S),A/=O,S/=O;var L=-w+v-(-w+x),F=-E+g-(-E+y),D=(-E+y)*(-w+x)-(-E+g)*(-w+v),U=-(S*=_)+T-(
-S+x),B=-(A*=_)+g-(-A+b),k=(-A+b)*(-S+x)-(-A+g)*(-S+T),X=L*B-U*F;if(Math.abs(X)<.1)X+=10.1,d.push(g-E*P,x-w*P),d.push(g+E*M,x+w*M);else{var G=(F*k-B*D)/X,V=(U*D-L*k)/X;196*_*_<(G-g)*(G-g)+(V-x)*(V-x)?(I=E-A,C=w-S,O=Math.sqrt(I*I+C*C),I/=O,C/=O,I*=_,C*=_,
d.push(g-I*P,x-C*P),d.push(g+I*M,x+C*M),d.push(g-I*M*P,x-C*P),f++):(d.push(g+(G-g)*P,x+(V-x)*P),d.push(g-(G-g)*M,x-(V-x)*M))}}y=r[2*(p-2)],v=r[2*(p-2)+1],g=r[2*(p-1)],x=r[2*(p-1)+1],E=-(v-x),w=y-g,O=Math.sqrt(E*E+w*w),E/=O,w/=O,E*=_,w*=_,d.push(g-E*P,
x-w*P),d.push(g+E*M,x+w*M);for(var j=e.indices,H=0;H<f-2;++H)j.push(m,m+1,m+2),m++}(t,e)}function np(){}var sp=function(p){function t(t,e,i,r,n,s){n=n||r/2;for(var o=-1*Math.PI/2+s,a=2*i,h=bl/a,u=[],l=0;l<a;l++){var c=l%2?n:r,d=l*h+o;u.push(t+c*Math.cos(d
),e+c*Math.sin(d))}p.call(this,u)}return p&&(t.__proto__=p),(t.prototype=Object.create(p&&p.prototype)).constructor=t}(Vl);np.curveTo=function(t,e,i,r,n,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,u=r-e,l=i-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===n
)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var d=a*a+h*h,p=u*u+l*l,f=a*u+h*l,m=n*Math.sqrt(d)/c,_=n*Math.sqrt(p)/c,y=m*f/d,v=_*f/p,g=m*l+_*h,x=m*u+_*a,b=h*(_+y),T=a*(_+y),E=l*(m+v),w=u*(m+v);return{cx:g+t,cy:x+e,radius:n,
startAngle:Math.atan2(T-x,b-g),endAngle:Math.atan2(w-x,E-g),anticlockwise:l*a<h*u}},np.arc=function(t,e,i,r,n,s,o,a,h){for(var u=o-s,l=Zd._segmentsCount(Math.abs(u)*n,40*Math.ceil(Math.abs(u)/bl)),c=u/(2*l),d=2*c,p=Math.cos(c),f=Math.sin(c),m=l-1,_=m%1/m,
y=0;y<=m;++y){var v=c+s+d*(y+_*y),g=Math.cos(v),x=-Math.sin(v);h.push((p*g+f*x)*n+i,(p*-x+f*g)*n+r)}};function op(){}op.curveLength=function(t,e,i,r,n,s,o,a){for(var h=0,u=0,l=0,c=0,d=0,p=0,f=0,m=0,_=0,y=0,v=0,g=t,x=e,b=1;b<=10;++b)y=g-(m=(f=(p=(d=1-(
u=b/10))*d)*d)*t+3*p*u*i+3*d*(l=u*u)*n+(c=l*u)*o),v=x-(_=f*e+3*p*u*r+3*d*l*s+c*a),g=m,x=_,h+=Math.sqrt(y*y+v*v);return h},op.curveTo=function(t,e,i,r,n,s,o){var a=o[o.length-2],h=o[o.length-1];o.length-=2;var u=Zd._segmentsCount(op.curveLength(a,h,t,e,i,r
,n,s)),l=0,c=0,d=0,p=0,f=0;o.push(a,h);for(var m=1,_=0;m<=u;++m)d=(c=(l=1-(_=m/u))*l)*l,f=(p=_*_)*_,o.push(d*a+3*c*_*t+3*l*p*i+f*n,d*h+3*c*_*e+3*l*p*r+f*s)};function ap(){}ap.curveLength=function(t,e,i,r,n,s){var o=t-2*i+n,a=e-2*r+s,h=2*i-2*t,u=2*r-2*e,
l=4*(o*o+a*a),c=4*(o*h+a*u),d=h*h+u*u,p=2*Math.sqrt(l+c+d),f=Math.sqrt(l),m=2*l*f,_=2*Math.sqrt(d),y=c/f;return(m*p+f*c*(p-_)+(4*d*l-c*c)*Math.log((2*f+y+p)/(y+_)))/(4*m)},ap.curveTo=function(t,e,i,r,n){for(var s=n[n.length-2],o=n[n.length-1],
a=Zd._segmentsCount(ap.curveLength(s,o,t,e,i,r)),h=0,u=0,l=1;l<=a;++l){var c=l/a;h=s+(t-s)*c,u=o+(e-o)*c,n.push(h+(t+(i-t)*c-h)*c,u+(e+(r-e)*c-u)*c)}};function hp(){this.reset()}hp.prototype.begin=function(t,e,i){this.reset(),this.style=t,this.start=e,
this.attribStart=i},hp.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},hp.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0};var up={};up[gl.POLY]=Jd,
up[gl.CIRC]=Qd,up[gl.ELIP]=Qd,up[gl.RECT]=$d,up[gl.RREC]=tp;function lp(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type,this.points=[],this.holes=[]}
var cp=[],dp=[],pp={buildPoly:Jd,buildCircle:Qd,buildRectangle:$d,buildRoundedRectangle:tp,FILL_COMMANDS:up,BATCH_POOL:cp,DRAW_CALL_POOL:dp,buildLine:rp,buildComplexPoly:function(t,e){var i=t.points.slice();if(!(i.length<6)){var r=e.indices;e.points=i,
e.alpha=t.fillAlpha,e.color=Hu(t.fillColor);for(var n=1/0,s=-1/0,o=1/0,a=-1/0,h=0,u=0,l=0;l<i.length;l+=2)n=(h=i[l])<n?h:n,s=s<h?h:s,o=(u=i[l+1])<o?u:o,a=a<u?u:a;i.push(n,o,s,o,s,a,n,a);for(var c=i.length/2,d=0;d<c;d++)r.push(d)}},bezierCurveTo:function(t
,e,i,r,n,s,o,a,h,u){void 0===u&&(u=[]);var l=0,c=0,d=0,p=0,f=0;u.push(t,e);for(var m=1,_=0;m<=h;++m)d=(c=(l=1-(_=m/h))*l)*l,f=(p=_*_)*_,u.push(d*t+3*c*_*i+3*l*p*n+f*o,d*e+3*c*_*r+3*l*p*s+f*a);return u},Star:sp,ArcUtils:np,BezierUtils:op,QuadraticUtils:ap,
BatchPart:hp};lp.prototype.clone=function(){return new lp(this.shape,this.fillStyle,this.lineStyle,this.matrix)},lp.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,
this.fillStyle=null};var fp=new ml,mp=new zl,_p=function(i){function r(){i.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,
this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new zl,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null,this.closePointEps=1e-4}i&&(r.__proto__=i),(r.prototype=Object.create(
i&&i.prototype)).constructor=r;var t={bounds:{configurable:!0}};return t.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},r.prototype.invalidate=function(){this.boundsDirty=-1,
this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0;for(var t=this.textureIds.length=0;t<this.drawCalls.length;t++)this.drawCalls[t].textures.length=0,dp.push(this.drawCalls[t]
);for(var e=this.drawCalls.length=0;e<this.batches.length;e++){var i=this.batches[e];i.start=0,i.attribStart=0,i.style=null,cp.push(i)}this.batches.length=0},r.prototype.clear=function(){return 0<this.graphicsData.length&&(this.invalidate(),
this.clearDirty++,this.graphicsData.length=0),this},r.prototype.drawShape=function(t,e,i,r){var n=new lp(t,e,i,r);return this.graphicsData.push(n),this.dirty++,this},r.prototype.drawHole=function(t,e){if(!this.graphicsData.length)return null;var i=new lp(
t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this},r.prototype.destroy=function(t){i.prototype.destroy.call(this,t);for(var e=0;e<this.graphicsData.length;++e
)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0
,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},r.prototype.containsPoint=function(t){for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fillStyle.visible&&(
r.shape&&(r.matrix?r.matrix.applyInverse(t,fp):fp.copyFrom(t),r.shape.contains(fp.x,fp.y)))){var n=!1;if(r.holes)for(var s=0;s<r.holes.length;s++){if(r.holes[s].shape.contains(fp.x,fp.y)){n=!0;break}}if(!n)return!0}}return!1},
r.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,i=null,r=null;0<this.batches.length&&(r=(i=this.batches[this.batches.length-1]).style);for(
var n=this.shapeIndex;n<e.length;n++){this.shapeIndex++;var s=e[n],o=s.fillStyle,a=s.lineStyle;up[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var h=0;h<2;h++){var u=0===h?o:a;if(u.visible){var l=u.texture.baseTexture,
c=this.indices.length,d=this.points.length/2;l.wrapMode=Cu.REPEAT,i&&!this._compareStyles(r,u)&&(i.end(c,d),0<i.size&&(i=null)),i||((i=cp.pop()||new hp).begin(u,c,d),this.batches.push(i),r=u);var p=this.points.length/2;0===h?this.processFill(s
):this.processLine(s);var f=this.points.length/2-p;this.addUvs(this.points,t,u.texture,p,f,u.matrix)}}}if(i){var m=this.indices.length,_=this.points.length/2;i.end(m,_),this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),
this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},r.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(
t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},r.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var i=this.graphicsData[t],
r=i.fillStyle,n=i.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},r.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,
i=t.length;e<i;e++)for(var r=t[e],n=0;n<r.size;n++){var s=r.start+n;this.indicesUint16[s]=this.indicesUint16[s]-r.attribStart}},r.prototype.isBatchable=function(){for(var t=this.batches,e=0;e<t.length;e++)if(t[e].style.native)return!1
;return this.points.length<2*r.BATCHABLE_SIZE},r.prototype.buildDrawCalls=function(){for(var t=++nc._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].textures.length=0,dp.push(this.drawCalls[e]);this.drawCalls.length=0;var i=this.colors,
r=this.textureIds,n=dp.pop();n||((n=new Bd).textures=new kd),n.textures.count=0,n.start=0,n.size=0,n.type=vu.TRIANGLES;var s=0,o=null,a=0,h=!1,u=vu.TRIANGLES,l=0;this.drawCalls.push(n);for(var c=0;c<this.batches.length;c++){var d=this.batches[c],p=d.style
,f=p.texture.baseTexture;h!==!!p.native&&(u=(h=!!p.native)?vu.LINES:vu.TRIANGLES,o=null,s=8,t++),o!==f&&(o=f)._batchEnabled!==t&&(8===s&&(t++,(s=0)<n.size&&((n=dp.pop())||((n=new Bd).textures=new kd),this.drawCalls.push(n)),n.start=l,n.size=0,
n.textures.count=0,n.type=u),f.touched=1,f._batchEnabled=t,f._batchLocation=s,f.wrapMode=10497,n.textures.elements[n.textures.count++]=f,s++),n.size+=d.size,l+=d.size,a=f._batchLocation,this.addColors(i,p.color,p.alpha,d.attribSize),this.addTextureIds(r,a
,d.attribSize)}nc._globalBatch=t,this.packAttributes()},r.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,i=this.colors,r=this.textureIds,n=new ArrayBuffer(3*t.length*4),s=new Float32Array(n),o=new Uint32Array(n),a=0,
h=0;h<t.length/2;h++)s[a++]=t[2*h],s[a++]=t[2*h+1],s[a++]=e[2*h],s[a++]=e[2*h+1],o[a++]=i[h],s[a++]=r[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},r.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),
Jd.triangulate(t,this)):up[t.type].triangulate(t,this)},r.prototype.processLine=function(t){rp(t,this);for(var e=0;e<t.holes.length;e++)rp(t.holes[e],this)},r.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var i=t[e];up[i.type].build(i),
i.matrix&&this.transformPoints(i.points,i.matrix)}},r.prototype.calculateBounds=function(){var t=this._bounds,e=mp,i=wl.IDENTITY;this._bounds.clear(),e.clear();for(var r=0;r<this.graphicsData.length;r++){var n=this.graphicsData[r],s=n.shape,o=n.type,
a=n.lineStyle,h=n.matrix||wl.IDENTITY,u=0;if(a&&a.visible){var l=a.alignment;u=a.width,o===gl.POLY?u*=.5+Math.abs(.5-l):u*=Math.max(0,l)}i!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,i),e.clear()),i=h),o===gl.RECT||o===gl.RREC?e.addFramePad(s.x,s.y,
s.x+s.width,s.y+s.height,u,u):o===gl.CIRC?e.addFramePad(s.x,s.y,s.x,s.y,s.radius+u,s.radius+u):o===gl.ELIP?e.addFramePad(s.x,s.y,s.x,s.y,s.width+u,s.height+u):t.addVerticesMatrix(i,s.points,0,s.points.length,u,u)}e.isEmpty()||t.addBoundsMatrix(e,i),t.pad(
this.boundsPadding,this.boundsPadding)},r.prototype.transformPoints=function(t,e){for(var i=0;i<t.length/2;i++){var r=t[2*i],n=t[2*i+1];t[2*i]=e.a*r+e.c*n+e.tx,t[2*i+1]=e.b*r+e.d*n+e.ty}},r.prototype.addColors=function(t,e,i,r){for(var n=zu((e>>16)+(
65280&e)+((255&e)<<16),i);0<r--;)t.push(n)},r.prototype.addTextureIds=function(t,e,i){for(;0<i--;)t.push(e)},r.prototype.addUvs=function(t,e,i,r,n,s){for(var o=0,a=e.length,h=i.frame;o<n;){var u=t[2*(r+o)],l=t[2*(r+o)+1];if(s){var c=s.a*u+s.c*l+s.tx
;l=s.b*u+s.d*l+s.ty,u=c}o++,e.push(u/h.width,l/h.height)}var d=i.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,i,a,n)},r.prototype.adjustUvs=function(t,e,i,r){for(var n=e.baseTexture,s=i+2*r,o=e.frame,a=o.width/n.width,
h=o.height/n.height,u=o.x/o.width,l=o.y/o.height,c=Math.floor(t[i]+1e-6),d=Math.floor(t[i+1]+1e-6),p=i+2;p<s;p+=2)c=Math.min(c,Math.floor(t[p]+1e-6)),d=Math.min(d,Math.floor(t[p+1]+1e-6));u-=c,l-=d;for(var f=i;f<s;f+=2)t[f]=(t[f]+u)*a,t[f+1]=(t[f+1]+l)*h}
,Object.defineProperties(r.prototype,t),r}(Yd);_p.BATCHABLE_SIZE=100;var yp=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.clone=function(){var t=new e
;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,
this.width=0,this.alignment=.5,this.native=!1},e}(Kd),vp=new Float32Array(3),gp={},xp=function(e){function i(t){void 0===t&&(t=null),e.call(this),this.geometry=t||new _p,this.geometry.refCount++,this.shader=null,this.state=_d.for2d(),
this._fillStyle=new Kd,this._lineStyle=new yp,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.pluginName="batch",this.tint=16777215,
this.blendMode=_u.NORMAL}e&&(i.__proto__=e);var t={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.clone=function(){
return this.finishPoly(),new i(this.geometry)},t.blendMode.set=function(t){this.state.blendMode=t},t.blendMode.get=function(){return this.state.blendMode},t.tint.get=function(){return this._tint},t.tint.set=function(t){this._tint=t},t.fill.get=function(){
return this._fillStyle},t.line.get=function(){return this._lineStyle},i.prototype.lineStyle=function(t){if("number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}
return this.lineTextureStyle(t)},i.prototype.lineTextureStyle=function(e,t,i,r,n,s,o){"number"==typeof e&&(ul("v5.2.0","Please use object-based options for Graphics#lineTextureStyle"),e={width:arguments[0],texture:t,color:i,alpha:r,matrix:n,alignment:s,
native:o},Object.keys(e).forEach(function(t){return void 0===e[t]&&delete e[t]}));e=Object.assign({width:0,texture:vc.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1},e),this.currentPath&&this.startPoly()
;var a=0<e.width&&0<e.alpha;return a?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:a},e)):this._lineStyle.reset(),this},i.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,
e=this.currentPath.points.length;2<e&&(this.drawShape(this.currentPath),this.currentPath=new Vl,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Vl,this.currentPath.closeStroke=!1},
i.prototype.finishPoly=function(){this.currentPath&&(2<this.currentPath.points.length?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},i.prototype.moveTo=function(t,e){return this.startPoly(),
this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},i.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,r=i[i.length-2],n=i[i.length-1];return r===t&&n===e||i.push(t,e),this},
i.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},i.prototype.quadraticCurveTo=function(t,e,i,r){this._initCurve()
;var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),ap.curveTo(t,e,i,r,n),this},i.prototype.bezierCurveTo=function(t,e,i,r,n,s){return this._initCurve(),op.curveTo(t,e,i,r,n,s,this.currentPath.points),this},i.prototype.arcTo=function(t,e,
i,r,n){this._initCurve(t,e);var s=this.currentPath.points,o=np.curveTo(t,e,i,r,n,s);if(o){var a=o.cx,h=o.cy,u=o.radius,l=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(a,h,u,l,c,d)}return this},i.prototype.arc=function(t,e,i,r,n,s){if(void 0===s&&(
s=!1),r===n)return this;if(!s&&n<=r?n+=bl:s&&r<=n&&(r+=bl),0==n-r)return this;var o=t+Math.cos(r)*i,a=e+Math.sin(r)*i,h=this.geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var l=Math.abs(u[u.length-2]-o),c=Math.abs(
u[u.length-1]-a);l<h&&c<h||u.push(o,a)}else this.moveTo(o,a),u=this.currentPath.points;return np.arc(o,a,t,e,i,r,n,s,u),this},i.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:vc.WHITE,color:t,
alpha:e})},i.prototype.beginTextureFill=function(e,t,i,r){e instanceof vc&&(ul("v5.2.0","Please use object-based options for Graphics#beginTextureFill"),e={texture:arguments[0],color:t,alpha:i,matrix:r},Object.keys(e).forEach(function(t){
return void 0===e[t]&&delete e[t]}));e=Object.assign({texture:vc.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var n=0<e.alpha;return n?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(
this._fillStyle,{visible:n},e)):this._fillStyle.reset(),this},i.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},i.prototype.drawRect=function(t,e,i,r){return this.drawShape(new Dl(t,e,i,r))},
i.prototype.drawRoundedRect=function(t,e,i,r,n){return this.drawShape(new Hl(t,e,i,r,n))},i.prototype.drawCircle=function(t,e,i){return this.drawShape(new Bl(t,e,i))},i.prototype.drawEllipse=function(t,e,i,r){return this.drawShape(new Xl(t,e,i,r))},
i.prototype.drawPolygon=function(t){var e=arguments,i=t,r=!0;if(i.points&&(r=i.closeStroke,i=i.points),!Array.isArray(i)){i=new Array(arguments.length);for(var n=0;n<i.length;++n)i[n]=e[n]}var s=new Vl(i);return s.closeStroke=r,this.drawShape(s),this},
i.prototype.drawShape=function(t){return this._holeMode?this.geometry.drawHole(t,this._matrix):this.geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},i.prototype.drawStar=function(t,e,i,r,n,s){return void 0===s&&(s=0
),this.drawPolygon(new sp(t,e,i,r,n,s))},i.prototype.clear=function(){return this.geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this},i.prototype.isFastRect=function(){
return 1===this.geometry.graphicsData.length&&this.geometry.graphicsData[0].shape.type===gl.RECT&&!this.geometry.graphicsData[0].lineWidth},i.prototype._render=function(t){this.finishPoly();var e=this.geometry;e.updateBatches(),e.batchable?(
this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},i.prototype._populateBatches=function(){var t=this.geometry,e=this.blendMode;this.batches=[],this.batchTint=-1,this._transformID=-1,
this.batchDirty=t.batchDirty,this.vertexData=new Float32Array(t.points);for(var i=0,r=t.batches.length;i<r;i++){var n=t.batches[i],s=n.style.color,o=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(
t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:Hu(s),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1}
;this.batches[i]=h}},i.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,i=this.batches.length;e<i;e++){var r=this.batches[e]
;r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},i.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),i=this.geometry,r=this.tint,n=this.worldAlpha,s=e.uniforms,o=i.drawCalls
;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(r>>16&255)/255*n,s.tint[1]=(r>>8&255)/255*n,s.tint[2]=(255&r)/255*n,s.tint[3]=n,t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(var a=0,h=o.length;a<h;a++
)this._renderDrawCallDirect(t,i.drawCalls[a])},i.prototype._renderDrawCallDirect=function(t,e){for(var i=e.textures,r=e.type,n=e.size,s=e.start,o=i.count,a=0;a<o;a++)t.texture.bind(i.elements[a],a);t.geometry.draw(r,n,s)},
i.prototype._resolveDirectShader=function(t){var e=this.shader,i=this.pluginName;if(!e){if(!gp[i]){for(var r=new Int32Array(16),n=0;n<16;n++)r[n]=n;var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new wl,default:Pc.from({uSamplers:r},!0)},
o=t.plugins[i]._shader.program;gp[i]=new fd(o,s)}e=gp[i]}return e},i.prototype._calculateBounds=function(){this.finishPoly();var t=this.geometry;if(t.graphicsData.length){var e=t.bounds,i=e.minX,r=e.minY,n=e.maxX,s=e.maxY;this._bounds.addFrame(
this.transform,i,r,n,s)}},i.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,i._TEMP_POINT),this.geometry.containsPoint(i._TEMP_POINT)},i.prototype.calculateTints=function(){if(this.batchTint!==this.tint){
this.batchTint=this.tint;for(var t=Hu(this.tint,vp),e=0;e<this.batches.length;e++){var i=this.batches[e],r=i._batchRGB,n=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},
i.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var t=this.transform.worldTransform,e=t.a,i=t.b,r=t.c,n=t.d,s=t.tx,o=t.ty,a=this.geometry.points,h=this.vertexData,u=0,
l=0;l<a.length;l+=2){var c=a[l],d=a[l+1];h[u++]=e*c+r*d+s,h[u++]=n*d+i*c+o}}},i.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},i.prototype.setMatrix=function(t){return this._matrix=t,this},
i.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},i.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},i.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.geometry.refCount--,
0===this.geometry.refCount&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,
this.batches.length=0,this.batches=null,e.prototype.destroy.call(this,t)},Object.defineProperties(i.prototype,t),i}(Kl);xp._TEMP_POINT=new ml;var bp=(Tp.prototype.clone=function(){return new Tp(this.x,this.y)},Tp.prototype.copyFrom=function(t){
return this.set(t.x,t.y),this},Tp.prototype.copyTo=function(t){return t.set(this.x,this.y),t},Tp.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},Tp.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e},Tp)
;function Tp(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var Ep=(wp.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new wp(t,e,this._x,this._y)},wp.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},wp.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},wp.prototype.copyTo=function(t){
return t.set(this._x,this._y),t},wp.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(wp.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,
configurable:!0}),Object.defineProperty(wp.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),wp);function wp(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),
this._x=i,this._y=r,this.cb=t,this.scope=e}var Ap,Sp,Ip=2*Math.PI,Cp=180/Math.PI,Op=Math.PI/180;(Sp=Ap=Ap||{})[Sp.POLY=0]="POLY",Sp[Sp.RECT=1]="RECT",Sp[Sp.CIRC=2]="CIRC",Sp[Sp.ELIP=3]="ELIP",Sp[Sp.RREC=4]="RREC";var Rp=(Pp.prototype.fromArray=function(t
){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},Pp.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},Pp.prototype.toArray=function(t,e){this.array||(
this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},
Pp.prototype.apply=function(t,e){e=e||new bp;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},Pp.prototype.applyInverse=function(t,e){e=e||new bp;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y
;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},Pp.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},Pp.prototype.scale=function(t,e){return this.a*=t
,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},Pp.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,
this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},Pp.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,
this.ty=t.tx*i+t.ty*n+this.ty,this},Pp.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}
,Pp.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,
this.ty=e*t.b+this.ty*t.d+t.ty,this},Pp.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(Ip-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,
t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},Pp.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,
this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},Pp.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Pp.prototype.clone=function(){var t=new Pp;return t.a=this.a,t.b=this.b
,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Pp.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Pp.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,
this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(Pp,"IDENTITY",{get:function(){return new Pp},enumerable:!0,configurable:!0}),Object.defineProperty(Pp,"TEMP_MATRIX",{get:function(){return new Pp},enumerable:!0,configurable:!0}),Pp);function Pp(t,e,i,
r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var Mp=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Np=[0,1,1,1,0,-1,-1,
-1,0,1,1,1,0,-1,-1,-1],Lp=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Fp=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Dp=[],Up=[],Bp=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Dp.push(e);for(var i=0;i<16;i++)for(var r=Bp(Mp[t]*Mp[i]+Lp[t]*Np[i]),n=Bp(
Np[t]*Mp[i]+Fp[t]*Np[i]),s=Bp(Mp[t]*Lp[i]+Lp[t]*Fp[i]),o=Bp(Np[t]*Lp[i]+Fp[t]*Fp[i]),a=0;a<16;a++)if(Mp[a]===r&&Np[a]===n&&Lp[a]===s&&Fp[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Rp;h.set(Mp[t],Np[t],Lp[t],Fp[t],0,0),Up.push(h)}}();var kp={E:0,
SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Mp[t]},uY:function(t){return Np[t]},vX:function(t){return Lp[t]},vY:function(t){return Fp[t]},inv:function(t){
return 8&t?15&t:7&-t},add:function(t,e){return Dp[t][e]},sub:function(t,e){return Dp[t][kp.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e
)?0<=e?kp.S:kp.N:2*Math.abs(e)<=Math.abs(t)?0<t?kp.E:kp.W:0<e?0<t?kp.SE:kp.SW:0<t?kp.NE:kp.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=Up[kp.inv(e)];n.tx=i,n.ty=r,t.append(n)}},Xp=(
Gp.prototype.onChange=function(){this._localID++},Gp.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},Gp.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},Gp.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},Gp.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(Gp.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),Gp.IDENTITY=new Gp,Gp);function Gp(){this.worldTransform=new Rp,this.localTransform=new Rp,this.position=new Ep(this.onChange,
this,0,0),this.scale=new Ep(this.onChange,this,1,1),this.pivot=new Ep(this.onChange,this,0,0),this.skew=new Ep(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var Vp=(Object.defineProperty(jp.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(jp.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(jp.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(jp.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(jp,"EMPTY"
,{get:function(){return new jp(0,0,0,0)},enumerable:!0,configurable:!0}),jp.prototype.clone=function(){return new jp(this.x,this.y,this.width,this.height)},jp.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},jp.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},jp.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},jp.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},jp.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},jp.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
jp.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},jp);function jp(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=Ap.RECT}Hp.prototype.clone=function(){return new Hp(this.x,this.y,this.radius)},
Hp.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},Hp.prototype.getBounds=function(){return new Vp(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function Hp(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=Ap.CIRC}Yp.prototype.clone=function(){return new Yp(this.x,this.y,this.width,this.height)},Yp.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},Yp.prototype.getBounds=function(){return new Vp(this.x-this.width,this.y-this.height,this.width,this.height)};function Yp(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=Ap.ELIP}zp.prototype.clone=function(){var t=new zp(this.points.slice());return t.closeStroke=this.closeStroke,t},
zp.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function zp(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof bp){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=Ap.POLY,this.closeStroke=!0}
Wp.prototype.clone=function(){return new Wp(this.x,this.y,this.width,this.height,this.radius)},Wp.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function Wp(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=Ap.RREC}var qp,Kp,Zp,Jp,Qp,$p,tf,ef,rf,nf,sf,of,af,hf,uf,lf,cf,df,pf,ff,mf,_f,yf,vf,gf,xf,bf,Tf,Ef={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,
RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){
var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,
preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",
CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(Kp=qp=qp||{})[Kp.WEBGL_LEGACY=0]="WEBGL_LEGACY",Kp[Kp.WEBGL=1]="WEBGL",Kp[Kp.WEBGL2=2]="WEBGL2",(Jp=Zp=Zp||{})[Jp.UNKNOWN=0]="UNKNOWN",Jp[Jp.WEBGL=1]="WEBGL",
Jp[Jp.CANVAS=2]="CANVAS",($p=Qp=Qp||{})[$p.NORMAL=0]="NORMAL",$p[$p.ADD=1]="ADD",$p[$p.MULTIPLY=2]="MULTIPLY",$p[$p.SCREEN=3]="SCREEN",$p[$p.OVERLAY=4]="OVERLAY",$p[$p.DARKEN=5]="DARKEN",$p[$p.LIGHTEN=6]="LIGHTEN",$p[$p.COLOR_DODGE=7]="COLOR_DODGE",
$p[$p.COLOR_BURN=8]="COLOR_BURN",$p[$p.HARD_LIGHT=9]="HARD_LIGHT",$p[$p.SOFT_LIGHT=10]="SOFT_LIGHT",$p[$p.DIFFERENCE=11]="DIFFERENCE",$p[$p.EXCLUSION=12]="EXCLUSION",$p[$p.HUE=13]="HUE",$p[$p.SATURATION=14]="SATURATION",$p[$p.COLOR=15]="COLOR",
$p[$p.LUMINOSITY=16]="LUMINOSITY",$p[$p.NORMAL_NPM=17]="NORMAL_NPM",$p[$p.ADD_NPM=18]="ADD_NPM",$p[$p.SCREEN_NPM=19]="SCREEN_NPM",$p[$p.NONE=20]="NONE",$p[$p.SRC_OVER=0]="SRC_OVER",$p[$p.SRC_IN=21]="SRC_IN",$p[$p.SRC_OUT=22]="SRC_OUT",
$p[$p.SRC_ATOP=23]="SRC_ATOP",$p[$p.DST_OVER=24]="DST_OVER",$p[$p.DST_IN=25]="DST_IN",$p[$p.DST_OUT=26]="DST_OUT",$p[$p.DST_ATOP=27]="DST_ATOP",$p[$p.ERASE=26]="ERASE",$p[$p.SUBTRACT=28]="SUBTRACT",$p[$p.XOR=29]="XOR",(ef=tf=tf||{})[ef.POINTS=0]="POINTS",
ef[ef.LINES=1]="LINES",ef[ef.LINE_LOOP=2]="LINE_LOOP",ef[ef.LINE_STRIP=3]="LINE_STRIP",ef[ef.TRIANGLES=4]="TRIANGLES",ef[ef.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",ef[ef.TRIANGLE_FAN=6]="TRIANGLE_FAN",(nf=rf=rf||{})[nf.RGBA=6408]="RGBA",nf[nf.RGB=6407]="RGB",
nf[nf.ALPHA=6406]="ALPHA",nf[nf.LUMINANCE=6409]="LUMINANCE",nf[nf.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",nf[nf.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",nf[nf.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(of=sf=sf||{})[of.TEXTURE_2D=3553]="TEXTURE_2D",
of[of.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",of[of.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",of[of.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",of[of.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
of[of.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",of[of.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",of[of.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
of[of.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(hf=af=af||{})[hf.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",hf[hf.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",hf[hf.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
hf[hf.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",hf[hf.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",hf[hf.FLOAT=5126]="FLOAT",hf[hf.HALF_FLOAT=36193]="HALF_FLOAT",(lf=uf=uf||{})[lf.NEAREST=0]="NEAREST",lf[lf.LINEAR=1]="LINEAR",(
df=cf=cf||{})[df.CLAMP=33071]="CLAMP",df[df.REPEAT=10497]="REPEAT",df[df.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(ff=pf=pf||{})[ff.OFF=0]="OFF",ff[ff.POW2=1]="POW2",ff[ff.ON=2]="ON",(_f=mf=mf||{})[_f.NPM=0]="NPM",_f[_f.UNPACK=1]="UNPACK",
_f[_f.PMA=2]="PMA",_f[_f.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",_f[_f.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",_f[_f.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(vf=yf=yf||{})[vf.AUTO=0]="AUTO",vf[vf.MANUAL=1]="MANUAL",(xf=gf=gf||{}
).LOW="lowp",xf.MEDIUM="mediump",xf.HIGH="highp",(Tf=bf=bf||{})[Tf.NONE=0]="NONE",Tf[Tf.SCISSOR=1]="SCISSOR",Tf[Tf.STENCIL=2]="STENCIL",Tf[Tf.SPRITE=3]="SPRITE",Ef.RETINA_PREFIX=/@([0-9\.]+)x/;var wf,Af=!(Ef.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),Sf="5.2.0"
;var If=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[Qp.NORMAL_NPM]=Qp.NORMAL,t[Qp.ADD_NPM]=Qp.ADD,t[Qp.SCREEN_NPM]=Qp.SCREEN,e[Qp.NORMAL]=Qp.NORMAL_NPM,e[Qp.ADD]=Qp.ADD_NPM,e[Qp.SCREEN]=Qp.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function Cf(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var Of=0;function Rf(){return++Of}function Pf(t){return 0===t?0:t<0?-1:1}function Mf(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,
t|=t>>>8,(t|=t>>>16)+1}function Nf(t){return!(t&t-1||!t)}function Lf(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var Ff={},Df=Object.create(null),Uf=Object.create(null);function Bf(t,e,i){
this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||Ef.RESOLUTION,this.resize(t,e)}var kf={width:{configurable:!0},height:{configurable:!0}};Bf.prototype.clear=function(){this.context.setTransform(1,0,
0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},Bf.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},Bf.prototype.destroy=function(){this.context=null,this.canvas=null},
kf.width.get=function(){return this.canvas.width},kf.width.set=function(t){this.canvas.width=t},kf.height.get=function(){return this.canvas.height},kf.height.set=function(t){this.canvas.height=t},Object.defineProperties(Bf.prototype,kf);var Xf
;function Gf(t,e){var i=Ef.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var Vf={};var jf,Hf,Yf=(zf.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items
;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},zf.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,
this.items=this.items.slice(0))},zf.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},zf.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(
this.ensureNonAliasedItems(),this.items.splice(e,1)),this},zf.prototype.contains=function(t){return-1!==this.items.indexOf(t)},zf.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},zf.prototype.destroy=function(){
this.removeAll(),this.items=null,this._name=null},Object.defineProperty(zf.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(zf.prototype,"name",{get:function(){return this._name},
enumerable:!0,configurable:!0}),zf);function zf(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(Yf.prototype,{dispatch:{value:Yf.prototype.emit},run:{value:Yf.prototype.emit}}),Ef.TARGET_FPMS=.06,(Hf=jf=jf||{}
)[Hf.INTERACTION=50]="INTERACTION",Hf[Hf.HIGH=25]="HIGH",Hf[Hf.NORMAL=0]="NORMAL",Hf[Hf.LOW=-25]="LOW",Hf[Hf.UTILITY=-50]="UTILITY";var Wf=(qf.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},
qf.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},qf.prototype.connect=function(t){(this.previous=t).next&&(
t.next.previous=this),this.next=t.next,t.next=this},qf.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous)
;var e=this.next;return this.next=t?null:e,this.previous=null,e},qf);function qf(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}
var Kf=(Zf.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},Zf.prototype._cancelIfNeeded=function(){
null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Zf.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Zf.prototype.add=function(t,e,i){return void 0===i&&(
i=jf.NORMAL),this._addListener(new Wf(t,e,i))},Zf.prototype.addOnce=function(t,e,i){return void 0===i&&(i=jf.NORMAL),this._addListener(new Wf(t,e,i,!0))},Zf.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(
t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},Zf.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next
;return this._head.next||this._cancelIfNeeded(),this},Zf.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Zf.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},
Zf.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},Zf.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((
e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,
this.deltaTime=this.deltaMS*Ef.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(Zf.prototype,"FPS",{get:function(
){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(Zf.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Ef.TARGET_FPMS)
;this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(Zf.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(Zf,"shared",{get:function(){if(!Zf._shared){var t=Zf._shared=new Zf;t.autoStart=!0,t._protected=!0}return Zf._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(Zf,"system",{get:function(){if(!Zf._system){var t=Zf._system=new Zf;t.autoStart=!0,t._protected=!0}return Zf._system},enumerable:!0,configurable:!0}),Zf);function Zf(){var e=this;this._head=new Wf(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Ef.TARGET_FPMS,this.elapsedMS=1/Ef.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}Jf.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,jf.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?Kf.shared:new Kf,t.autoStart&&this.start()},Jf.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function Jf(){}Ef.SORTABLE_CHILDREN=!1;function Qf(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0
,this.maxY=-1/0,this.rect=null}Qf.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Qf.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Qf.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?Vp.EMPTY:((t=t||new Vp(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Qf.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(
this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Qf.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},Qf.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(
t.worldTransform,e,i,r,n)},Qf.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(
_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},Qf.prototype.addVertexData=function(t,e
,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},Qf.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(
t.worldTransform,e,i,r)},Qf.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c
;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},Qf.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,
this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},Qf.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(
i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},Qf.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},
Qf.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY
;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},Qf.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},Qf.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,
e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var $f=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new Xp,
this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Qf,this._boundsID=0,this._lastBoundsID=-1,
this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{
configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},
mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},
e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)
):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,
this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Vp),e=this._boundsRect),this._bounds.getRectangle(e)},
n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Vp),t=this._localBoundsRect);var r=this.getBounds(!1,t)
;return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error(
"setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0)
,void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),
this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,
this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){
return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){
return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},
e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*Cp},e.angle.set=function(t){
this.transform.rotation=t*Op},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},
e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},
Object.defineProperties(n.prototype,e),n}(X.a);function tm(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}$f.prototype.displayObjectUpdateTransform=$f.prototype.updateTransform;var em=function(n){function t(){
n.call(this),this.children=[],this.sortableChildren=Ef.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t
).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,
this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Cf(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,Cf(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,Cf(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(tm),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}($f);em.prototype.containerUpdateTransform=em.prototype.updateTransform;function im(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Yf(
"setRealSize",2),this.onUpdate=new Yf("update"),this.onError=new Yf("onError",1)}var rm={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};im.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},im.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},im.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},rm.valid.get=function(){return!!this._width&&!!this._height},im.prototype.update=function(){this.destroyed||this.onUpdate.run()},im.prototype.load=function(){return Promise.resolve()},
rm.width.get=function(){return this._width},rm.height.get=function(){return this._height},im.prototype.upload=function(t,e,i){return!1},im.prototype.style=function(t,e,i){return!1},im.prototype.dispose=function(){},im.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(im.prototype,rm);var nm=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(Xf=Xf||document.createElement("a")).href=t;var i=!(t=H.a.parse(Xf.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===mf.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(im),sm=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:Ef.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===mf.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(nm),om=[];function am(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=om.length-1;0<=n;--n){var s=om[n];if(s.test&&s.test(t,i))return new s(t,e)}return new sm(t,e)}var hm=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===mf.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(im),um={scaleMode:uf.NEAREST,format:rf.RGBA,
alphaMode:mf.NPM},lm=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof im||((t=am(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||Ef.RESOLUTION,this.mipmap=void 0!==r?r:Ef.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:Ef.ANISOTROPIC_LEVEL,
this.wrapMode=h||Ef.WRAP_MODE,this.scaleMode=void 0!==s?s:Ef.SCALE_MODE,this.format=u||rf.RGBA,this.type=l||af.UNSIGNED_BYTE,this.target=c||sf.TEXTURE_2D,this.alphaMode=void 0!==i?i:mf.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=Rf(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=Nf(this.realWidth
)&&Nf(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Uf[this.cacheId],delete Df[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=Ef.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Rf()),t._pixiId);var s=Uf[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new hm(t,{width:e,height:i}),
s=t instanceof Float32Array?af.FLOAT:af.UNSIGNED_BYTE;return new o(n,Object.assign(um,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Uf[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Uf[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=Uf[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Uf[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete Uf[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);lm._globalBatch=0;var cm=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new lm;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(am(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=sf.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(im),
dm=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(nm),
pm=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=sf.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=sf.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(cm);pm.SIDES=6;var fm=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+Rf(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(nm)
;fm.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var mm=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=Kf.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(Kf.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(Kf.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&Kf.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(Kf.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(Kf.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(nm);mm.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var _m=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(nm);om.push(sm,_m,dm,mm,fm,hm,pm,cm);function ym(t){this.renderer=t}
ym.prototype.destroy=function(){this.renderer=null};function vm(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new Yf("disposeFramebuffer",2)}var gm=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===mf.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(hm),xm={colorTexture:{configurable:!0}};xm.colorTexture.get=function(){return this.colorTextures[0]},vm.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new lm(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},vm.prototype.addDepthTexture=function(t){return this.depthTexture=t||new lm(new gm(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:rf.DEPTH_COMPONENT,type:af.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},vm.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},vm.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},vm.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},vm.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(vm.prototype,xm);function bm(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var Tm=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new vm(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(lm);bm.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=kp.add(i,kp.NW),this.x0=a+s*kp.uX(i),this.y0=h+o*kp.uY(i),i=kp.add(i,2),this.x1=a+s*kp.uX(i),this.y1=h+o*kp.uY(i),i=kp.add(i,2),this.x2=a+s*kp.uX(i),this.y2=h+o*kp.uY(i),i=kp.add(i,2),
this.x3=a+s*kp.uX(i),this.y3=h+o*kp.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Em=new bm,wm=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new Vp(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=Em,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new bp(s.x,s.y):new bp(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&Df[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===Em&&(this._uvs=new bm),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=Ef.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Rf()),t._pixiId);var s=Df[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=Gf(t)),(s=new a(new lm(t,e))).baseTexture.cacheId=n,
lm.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(lm.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new sm(t);r.url=e;var n=new a(new lm(r,{scaleMode:Ef.SCALE_MODE,resolution:Gf(e)}));return i=i||e,
lm.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(lm.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Df[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),Df[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=Df[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Df[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Df[t.textureCacheIds[r]]===t&&delete Df[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function Am(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}wm.EMPTY=new wm(new lm),Am(wm.EMPTY),Am(wm.EMPTY.baseTexture),wm.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new wm(new lm(new dm(t)))}(),Am(wm.WHITE),Am(wm.WHITE.baseTexture);function Sm(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var Im=function(a){function n(t,e){var i=null;if(!(t instanceof Tm)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new Tm({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new Tm(t))},n}(wm);Sm.prototype.createTexture=function(t,e){var i=new Tm(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Im(i)},
Sm.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=Sm.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=Mf(t)))<<16|65535&(e=Mf(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},Sm.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
Sm.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},Sm.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Sm.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},Sm.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Sm.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Sm.SCREEN_KEY="screen";function Cm(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}Cm.prototype.destroy=function(){this.buffer=null},Cm.from=function(t,e,i,r,n){return new Cm(t,e,i,r,n)};function Om(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=Rm++,this.disposeRunner=new Yf("disposeBuffer",2)}var Rm=0;function Pm(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Om.prototype.update=function(t){this.data=t||this.data,this._updateID++},Om.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Om.prototype.destroy=function(){this.dispose(),this.data=null},Om.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Om(t)};var Mm={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Nm(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Fm++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Yf("disposeGeometry",2),this.refCount=0}var Lm={5126:4,5123:2,5121:1},Fm=0,Dm={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};Nm.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Om(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Cm(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},Nm.prototype.getAttribute=function(t){return this.attributes[t]},Nm.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},Nm.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Om(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
Nm.prototype.getIndex=function(){return this.indexBuffer},Nm.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Om;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Lm[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Pm(c)
;n[d]||(n[d]=new Mm[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Nm.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Nm.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},Nm.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Nm.prototype.clone=function(){for(var t=new Nm,e=0;e<this.buffers.length;e++)t.buffers[e]=new Om(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new Cm(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},Nm.merge=function(t){for(var e,i=new Nm,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(Dm[Pm(e.buffers[h].data)])(n[h]),i.buffers[h]=new Om(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Lm[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function Um(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=Xm++,this.static=!!e}var Bm=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Nm),
km=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Om(this.vertices),this.uvBuffer=new Om(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Nm),Xm=0
;Um.prototype.update=function(){this.dirtyId++},Um.prototype.add=function(t,e,i){this.uniforms[t]=new Um(e,i)},Um.from=function(t,e){return new Um(t,e)};function Gm(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new Vp,this.destinationFrame=new Vp,this.filters=[]}Gm.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function Vm(t){this.renderer=t}var jm=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new Sm,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Bm,this.quadUv=new km,this.tempRect=new Vp,this.activeState={},this.globalUniforms=new Um({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Gm,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(tf.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(tf.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
Rp.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(ym);Vm.prototype.flush=function(){},Vm.prototype.destroy=function(){this.renderer=null},Vm.prototype.start=function(){},Vm.prototype.stop=function(){this.flush()},Vm.prototype.render=function(t){};var Hm=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new Vm(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(ym);Ef.PREFER_ENV=u.a.any?qp.WEBGL:qp.WEBGL2,Ef.STRICT_TEXTURE_CACHE=!1
;function Ym(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function zm(t){this.type=bf.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var Wm=0,qm=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Wm++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Wm++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(Ef.PREFER_ENV>=qp.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(ym),Km=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new vm(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Vp,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Ef.PREFER_ENV===qp.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Vp},Object.defineProperties(t.prototype,i),t}(ym),Zm={5126:4,5123:2,5121:1},
Jm=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;Ef.PREFER_ENV===qp.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Zm[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Zm[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Zm[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new Ym(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(ym);function Qm(t,e,i,r){var n=$m(t,t.VERTEX_SHADER,e),s=$m(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function $m(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function t_(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return e_(2*e)
;case"bvec3":return e_(3*e);case"bvec4":return e_(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function e_(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}zm.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=bf.NONE,this.autoDetect=!0),this._target=null},zm.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var i_,r_={},n_=r_;function s_(){if(n_===r_||n_&&n_.isContextLost()){
var t,e=document.createElement("canvas");Ef.PREFER_ENV>=qp.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),n_=t}return n_}function o_(t,e,i){if(
"precision"===t.substring(0,9))return i!==gf.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===gf.HIGH&&i!==gf.HIGH&&(r=gf.MEDIUM),"precision "+r+" float;\n"+t}var a_={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var h_=null,u_={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function l_(t,e){if(!h_){var i=Object.keys(u_)
;h_={};for(var r=0;r<i.length;++r){var n=i[r];h_[t[n]]=u_[n]}}return h_[e]}var c_={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},d_={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var p_,f_=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function m_(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function __(t,e,i){void 0===i&&(i="pixi-shader"),this.id=y_++,this.vertexSrc=t||__.defaultVertexSrc,
this.fragmentSrc=e||__.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),v_[i]?(v_[i]++,i+="-"+v_[i]):v_[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=o_(this.vertexSrc,Ef.PRECISION_VERTEX,gf.HIGH),this.fragmentSrc=o_(this.fragmentSrc,Ef.PRECISION_FRAGMENT,function(
){if(!i_){i_=gf.MEDIUM;var t=s_();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);i_=e.precision?gf.HIGH:gf.MEDIUM}}return i_}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var y_=0,v_={},g_={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};__.prototype.extractData=function(t,e){var i=s_();if(i){var r=Qm(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},__.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=l_(e,a.type),u={type:h,name:a.name,size:(i=h,a_[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
__.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=l_(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:t_(h,s.size)}}return i},g_.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},g_.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},__.from=function(t,e,i){var r=t+e,n=Ff[r];return n||(Ff[r]=n=new __(t
,e,i)),n},Object.defineProperties(__,g_);function x_(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof Um?e:new Um(e):new Um({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var b_={uniforms:{configurable:!0}};x_.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
x_.prototype.destroy=function(){this.uniformGroup=null},b_.uniforms.get=function(){return this.uniformGroup.uniforms},x_.from=function(t,e,i){var r=__.from(t,e);return new x_(r,i)},Object.defineProperties(x_.prototype,b_);function T_(){this.data=0,
this.blendMode=Qp.NORMAL,this.polygonOffset=0,this.blend=!0}var E_={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};E_.blend.get=function(){return!!(1&this.data)},E_.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},E_.offsets.get=function(){return!!(2&this.data)},E_.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
E_.culling.get=function(){return!!(4&this.data)},E_.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},E_.depthTest.get=function(){return!!(8&this.data)},E_.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
E_.clockwiseFrontFace.get=function(){return!!(16&this.data)},E_.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},E_.blendMode.get=function(){return this._blendMode},E_.blendMode.set=function(t){this.blend=t!==Qp.NONE,
this._blendMode=t},E_.polygonOffset.get=function(){return this._polygonOffset},E_.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},T_.for2d=function(){var t=new T_;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
T_.prototype,E_);var w_=function(n){function s(t,e,i){var r=__.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=Ef.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new T_}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(x_);w_.SOURCE_KEY_MAP={};function A_(t,e){this._texture=t,this.mapCoord=new Rp,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var S_=new Rp,I_={texture:{configurable:!0}};I_.texture.get=function(){return this._texture},I_.texture.set=function(t){this._texture=t,this._updateID=-1},A_.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},A_.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(S_.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(S_));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(A_.prototype,I_);function C_(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var O_=function(i){
function t(t){var e=new Rp;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new A_(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(w_),R_=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new zm;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case bf.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case bf.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case bf.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case bf.SCISSOR:this.renderer.scissor.pop();break;case bf.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case bf.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=bf.SPRITE;else if(t.type=bf.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=bf.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new O_(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(ym),P_=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(ym),M_=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(P_),N_=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(P_),L_=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Rp,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(ym),F_=new Vp,D_=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new Vp,this.destinationFrame=new Vp}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(F_.width=s.realWidth,F_.height=s.realHeight,i=F_),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
F_.width=n.width,F_.height=n.height,i=F_),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(ym)
;C_.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var U_=0,B_=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=U_++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof p_)return p_;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;p_=!0===t({a:"b"},"a","b")}catch(t){p_=!1}return p_}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?c_:d_)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=Qm(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:t_(h.type,h.size)}}var u=new C_(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(ym);function k_(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var X_=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Qp.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new T_,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Qp.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.ADD]=[t.ONE,t.ONE],e[Qp.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[Qp.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[Qp.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[Qp.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.NONE]=[0,0],e[Qp.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[Qp.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Qp.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Qp.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Qp.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Qp.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[Qp.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Qp.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Qp.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Qp.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Qp.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(ym),G_=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=Ef.GC_MAX_IDLE,
this.checkCountMax=Ef.GC_MAX_CHECK_COUNT,this.mode=Ef.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==yf.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(ym),V_=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new lm}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new k_(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new k_(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new k_(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===af.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&Cf(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==pf.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=cf.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===uf.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(ym),j_=new Rp;X.a;function H_(){this.texArray=null,this.blend=0,this.type=tf.TRIANGLES,this.start=0,this.size=0,this.data=null}function Y_(){this.elements=[],this.ids=[],this.count=0}Y_.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function z_(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var W_={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};W_.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},W_.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},W_.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},W_.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},W_.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},z_.prototype.view=function(t){
return this[t+"View"]},z_.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},z_.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(z_.prototype,W_);var q_=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=T_.for2d(),this.size=4*Ef.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;Ef.PREFER_ENV===qp.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Ef.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=f_.replace(/%forloop%/gi,m_(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new H_);for(;e.length<r;)e.push(new Y_);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++lm._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;lm._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=If[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;Ef.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Ef.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=Mf(Math.ceil(t/8)),i=Lf(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new z_(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=Mf(Math.ceil(t/12)),i=Lf(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(Vm);q_._drawCallPool=[],q_._textureArrayPool=[];function K_(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}K_.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=Um.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new __(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Rp,default:this.defaultGroupCache[t]};return new x_(this.programCache[t],n)},
K_.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function Z_(){}var J_=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Om(null,t,!1),this._indexBuffer=new Om(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,af.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,af.FLOAT).addAttribute("aColor",this._buffer,4,!0,af.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,af.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Nm),
Q_="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,$_="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",ty={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};Z_.create=function(t){var e=Object.assign({vertex:Q_,fragment:$_,geometryClass:J_,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new K_(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(q_)},ty.defaultVertexSrc.get=function(){return Q_},ty.defaultFragmentTemplate.get=function(){
return $_},Object.defineProperties(Z_,ty);Z_.create();var ey=new bp,iy=new Uint16Array([0,1,2,0,2,3]),ry=function(i){function r(t){i.call(this),this._anchor=new Ep(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,
this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=Qp.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=t||wm.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,
this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=iy,this.size=4,this.start=0,this.pluginName="batch",this.isSprite=!0,this._roundPixels=Ef.ROUND_PIXELS}i&&(r.__proto__=i);var t={roundPixels:{
configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return((r.prototype=Object.create(i&&i.prototype)).constructor=r).prototype._onTextureUpdate=function(){
this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Pf(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Pf(this.scale.y)*this._height/this._texture.orig.height)},
r.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},r.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){
this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,
c=this._anchor,d=0,p=0,f=0,m=0;if(f=u?(d=(p=u.x-c._x*l.width)+u.width,(m=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,(m=-c._y*l.height)+l.height),h[0]=i*p+n*m+o,h[1]=s*m+r*p+a,h[2]=i*d+n*m+o,h[3]=s*m+r*d+a,h[4]=i*d+n*f+o,h[5]=s*f+r*d+a,
h[6]=i*p+n*f+o,h[7]=s*f+r*p+a,this._roundPixels)for(var _=0;_<8;_++)h[_]=Math.round(h[_])}},r.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(
this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID
;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=-r._x*i.width,d=c+i.width,p=-r._y*i.height,f=p+i.height;e[0]=s*c+a*p+u,e[1]=h*p+o*c+l,e[2]=s*d+a*p+u,
e[3]=h*p+o*d+l,e[4]=s*d+a*f+u,e[5]=h*f+o*d+l,e[6]=s*c+a*f+u,e[7]=h*f+o*c+l},r.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},
r.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(
this.vertexTrimmedData))},r.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,
this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Vp),t=this._localBoundsRect),this._bounds.getRectangle(t)
):i.prototype.getLocalBounds.call(this,t)},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,ey);var e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,n=0;return ey.x>=r&&ey.x<r+e&&(n=-i*this.anchor.y,
ey.y>=n&&ey.y<n+i)},r.prototype.destroy=function(t){if(i.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t&&t.texture){var e="boolean"==typeof t?t:t&&t.baseTexture
;this._texture.destroy(!!e)}this._texture=null,this.shader=null},r.from=function(t,e){return new r(t instanceof wm?t:wm.from(t,e))},t.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},
t.roundPixels.get=function(){return this._roundPixels},t.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},t.width.set=function(t){var e=Pf(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},
t.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},t.height.set=function(t){var e=Pf(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},t.anchor.get=function(){return this._anchor},
t.anchor.set=function(t){this._anchor.copyFrom(t)},t.tint.get=function(){return this._tint},t.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},t.texture.get=function(){return this._texture},t.texture.set=function(t){
this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||wm.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",
this._onTextureUpdate,this)))},Object.defineProperties(r.prototype,t),r}(em),ny=(sy.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,
c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},sy.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},
sy.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},sy.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}
,sy.prototype.contains=function(t){return-1!==this.items.indexOf(t)},sy.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},sy.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},
Object.defineProperty(sy.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(sy.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),sy);function sy(t){
this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(ny.prototype,{dispatch:{value:ny.prototype.emit},run:{value:ny.prototype.emit}});var oy,ay,hy,uy,ly,cy,dy,py,fy,my,_y,yy,vy,gy,xy,by,Ty,Ey,wy,Ay,Sy,Iy,Cy,Oy,Ry,Py,My,Ny,Ly={
MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(
u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,
clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",
CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(ay=oy=oy||{})[ay.WEBGL_LEGACY=0]="WEBGL_LEGACY",ay[ay.WEBGL=1]="WEBGL",ay[ay.WEBGL2=2]="WEBGL2",(uy=hy=hy||{})[uy.UNKNOWN=0]="UNKNOWN",uy[uy.WEBGL=1]="WEBGL",
uy[uy.CANVAS=2]="CANVAS",(cy=ly=ly||{})[cy.NORMAL=0]="NORMAL",cy[cy.ADD=1]="ADD",cy[cy.MULTIPLY=2]="MULTIPLY",cy[cy.SCREEN=3]="SCREEN",cy[cy.OVERLAY=4]="OVERLAY",cy[cy.DARKEN=5]="DARKEN",cy[cy.LIGHTEN=6]="LIGHTEN",cy[cy.COLOR_DODGE=7]="COLOR_DODGE",
cy[cy.COLOR_BURN=8]="COLOR_BURN",cy[cy.HARD_LIGHT=9]="HARD_LIGHT",cy[cy.SOFT_LIGHT=10]="SOFT_LIGHT",cy[cy.DIFFERENCE=11]="DIFFERENCE",cy[cy.EXCLUSION=12]="EXCLUSION",cy[cy.HUE=13]="HUE",cy[cy.SATURATION=14]="SATURATION",cy[cy.COLOR=15]="COLOR",
cy[cy.LUMINOSITY=16]="LUMINOSITY",cy[cy.NORMAL_NPM=17]="NORMAL_NPM",cy[cy.ADD_NPM=18]="ADD_NPM",cy[cy.SCREEN_NPM=19]="SCREEN_NPM",cy[cy.NONE=20]="NONE",cy[cy.SRC_OVER=0]="SRC_OVER",cy[cy.SRC_IN=21]="SRC_IN",cy[cy.SRC_OUT=22]="SRC_OUT",
cy[cy.SRC_ATOP=23]="SRC_ATOP",cy[cy.DST_OVER=24]="DST_OVER",cy[cy.DST_IN=25]="DST_IN",cy[cy.DST_OUT=26]="DST_OUT",cy[cy.DST_ATOP=27]="DST_ATOP",cy[cy.ERASE=26]="ERASE",cy[cy.SUBTRACT=28]="SUBTRACT",cy[cy.XOR=29]="XOR",(py=dy=dy||{})[py.POINTS=0]="POINTS",
py[py.LINES=1]="LINES",py[py.LINE_LOOP=2]="LINE_LOOP",py[py.LINE_STRIP=3]="LINE_STRIP",py[py.TRIANGLES=4]="TRIANGLES",py[py.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",py[py.TRIANGLE_FAN=6]="TRIANGLE_FAN",(my=fy=fy||{})[my.RGBA=6408]="RGBA",my[my.RGB=6407]="RGB",
my[my.ALPHA=6406]="ALPHA",my[my.LUMINANCE=6409]="LUMINANCE",my[my.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",my[my.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",my[my.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(yy=_y=_y||{})[yy.TEXTURE_2D=3553]="TEXTURE_2D",
yy[yy.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",yy[yy.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",yy[yy.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",yy[yy.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
yy[yy.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",yy[yy.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",yy[yy.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
yy[yy.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(gy=vy=vy||{})[gy.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",gy[gy.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",gy[gy.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
gy[gy.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",gy[gy.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",gy[gy.FLOAT=5126]="FLOAT",gy[gy.HALF_FLOAT=36193]="HALF_FLOAT",(by=xy=xy||{})[by.NEAREST=0]="NEAREST",by[by.LINEAR=1]="LINEAR",(
Ey=Ty=Ty||{})[Ey.CLAMP=33071]="CLAMP",Ey[Ey.REPEAT=10497]="REPEAT",Ey[Ey.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(Ay=wy=wy||{})[Ay.OFF=0]="OFF",Ay[Ay.POW2=1]="POW2",Ay[Ay.ON=2]="ON",(Iy=Sy=Sy||{})[Iy.NPM=0]="NPM",Iy[Iy.UNPACK=1]="UNPACK",
Iy[Iy.PMA=2]="PMA",Iy[Iy.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Iy[Iy.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Iy[Iy.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(Oy=Cy=Cy||{})[Oy.AUTO=0]="AUTO",Oy[Oy.MANUAL=1]="MANUAL",(Py=Ry=Ry||{}
).LOW="lowp",Py.MEDIUM="mediump",Py.HIGH="highp",(Ny=My=My||{})[Ny.NONE=0]="NONE",Ny[Ny.SCISSOR=1]="SCISSOR",Ny[Ny.STENCIL=2]="STENCIL",Ny[Ny.SPRITE=3]="SPRITE",Ly.RETINA_PREFIX=/@([0-9\.]+)x/;var Fy,Dy=!(Ly.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),Uy="5.2.0"
;function By(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function ky(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)}var Xy=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i
;t[ly.NORMAL_NPM]=ly.NORMAL,t[ly.ADD_NPM]=ly.ADD,t[ly.SCREEN_NPM]=ly.SCREEN,e[ly.NORMAL]=ly.NORMAL_NPM,e[ly.ADD]=ly.ADD_NPM,e[ly.SCREEN]=ly.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function Gy(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){
var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var Vy=0;function jy(){return++Vy}function Hy(t){return 0===t?0:t<0?-1:1}function Yy(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function zy(t){return!(t&t-1||!t)
}function Wy(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var qy={},Ky=Object.create(null),Zy=Object.create(null);function Jy(t,e,i){this.canvas=document.createElement("canvas"),
this.context=this.canvas.getContext("2d"),this.resolution=i||Ly.RESOLUTION,this.resize(t,e)}var Qy={width:{configurable:!0},height:{configurable:!0}};Jy.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,
this.canvas.width,this.canvas.height)},Jy.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},Jy.prototype.destroy=function(){this.context=null,this.canvas=null},Qy.width.get=function(){
return this.canvas.width},Qy.width.set=function(t){this.canvas.width=t},Qy.height.get=function(){return this.canvas.height},Qy.height.set=function(t){this.canvas.height=t},Object.defineProperties(Jy.prototype,Qy);var $y;function tv(t,e){
var i=Ly.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var ev,iv,rv={};Ly.TARGET_FPMS=.06,(iv=ev=ev||{})[iv.INTERACTION=50]="INTERACTION",iv[iv.HIGH=25]="HIGH",iv[iv.NORMAL=0]="NORMAL",iv[iv.LOW=-25]="LOW",iv[iv.UTILITY=-50]="UTILITY"
;var nv=(sv.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},sv.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),
this._destroyed&&(this.next=null),e},sv.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},sv.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,
this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},sv);function sv(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,
this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var ov=(av.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},av.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},av.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},av.prototype.add=function(t,e,i){return void 0===i&&(i=ev.NORMAL),this._addListener(new nv(t,e,i))},av.prototype.addOnce=function(t,e,i){return void 0===i&&(i=ev.NORMAL),this._addListener(new nv(t,e,i,!0))},
av.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},av.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},av.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},av.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},av.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},av.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*Ly.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(av.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(av.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Ly.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(av.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(av,"shared",{get:function(){if(!av._shared){var t=av._shared=new av;t.autoStart=!0,t._protected=!0}return av._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(av,"system",{get:function(){if(!av._system){var t=av._system=new av;t.autoStart=!0,t._protected=!0}return av._system},enumerable:!0,configurable:!0}),av);function av(){var e=this;this._head=new nv(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Ly.TARGET_FPMS,this.elapsedMS=1/Ly.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}hv.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,ev.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?ov.shared:new ov,t.autoStart&&this.start()},hv.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function hv(){}var uv=(lv.prototype.clone=function(){return new lv(this.x,this.y)},
lv.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},lv.prototype.copyTo=function(t){return t.set(this.x,this.y),t},lv.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},lv.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},lv);function lv(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var cv=(dv.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new dv(t,e,this._x,this._y)},
dv.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},dv.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},dv.prototype.copyTo=function(t){return t.set(this._x,this._y),t},dv.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(dv.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(dv.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),dv);function dv(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var pv,fv,mv=2*Math.PI,_v=180/Math.PI,yv=Math.PI/180;(fv=pv=pv||{})[fv.POLY=0]="POLY",fv[fv.RECT=1]="RECT",fv[fv.CIRC=2]="CIRC",fv[fv.ELIP=3]="ELIP",
fv[fv.RREC=4]="RREC";var vv=(gv.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},gv.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
gv.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},gv.prototype.apply=function(t,e){e=e||new uv;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},gv.prototype.applyInverse=function(t,e){e=e||new uv;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},gv.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
gv.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},gv.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},gv.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},gv.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},gv.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},gv.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(mv-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},gv.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},gv.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},gv.prototype.clone=function(){
var t=new gv;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},gv.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},gv.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(gv,"IDENTITY",{get:function(){return new gv},enumerable:!0,configurable:!0}),Object.defineProperty(gv,"TEMP_MATRIX",{get:function(){return new gv},
enumerable:!0,configurable:!0}),gv);function gv(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var xv=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],bv=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Tv=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ev=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],wv=[],Av=[],Sv=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];wv.push(e);for(
var i=0;i<16;i++)for(var r=Sv(xv[t]*xv[i]+Tv[t]*bv[i]),n=Sv(bv[t]*xv[i]+Ev[t]*bv[i]),s=Sv(xv[t]*Tv[i]+Tv[t]*Ev[i]),o=Sv(bv[t]*Tv[i]+Ev[t]*Ev[i]),a=0;a<16;a++)if(xv[a]===r&&bv[a]===n&&Tv[a]===s&&Ev[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new vv
;h.set(xv[t],bv[t],Tv[t],Ev[t],0,0),Av.push(h)}}();var Iv={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return xv[t]},uY:function(t){return bv[t]},vX:function(t){
return Tv[t]},vY:function(t){return Ev[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return wv[t][e]},sub:function(t,e){return wv[t][Iv.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?Iv.S:Iv.N:2*Math.abs(e)<=Math.abs(t)?0<t?Iv.E:Iv.W:0<e?0<t?Iv.SE:Iv.SW:0<t?Iv.NE:Iv.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=Av[Iv.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},Cv=(Ov.prototype.onChange=function(){this._localID++},Ov.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},Ov.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},Ov.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},Ov.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(Ov.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),Ov.IDENTITY=new Ov,Ov);function Ov(){this.worldTransform=new vv,this.localTransform=new vv,this.position=new cv(this.onChange,
this,0,0),this.scale=new cv(this.onChange,this,1,1),this.pivot=new cv(this.onChange,this,0,0),this.skew=new cv(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var Rv=(Object.defineProperty(Pv.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Pv.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(Pv.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Pv.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Pv,"EMPTY"
,{get:function(){return new Pv(0,0,0,0)},enumerable:!0,configurable:!0}),Pv.prototype.clone=function(){return new Pv(this.x,this.y,this.width,this.height)},Pv.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},Pv.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},Pv.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},Pv.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},Pv.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},Pv.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
Pv.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},Pv);function Pv(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=pv.RECT}Mv.prototype.clone=function(){return new Mv(this.x,this.y,this.radius)},
Mv.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},Mv.prototype.getBounds=function(){return new Rv(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function Mv(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=pv.CIRC}Nv.prototype.clone=function(){return new Nv(this.x,this.y,this.width,this.height)},Nv.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},Nv.prototype.getBounds=function(){return new Rv(this.x-this.width,this.y-this.height,this.width,this.height)};function Nv(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=pv.ELIP}Lv.prototype.clone=function(){var t=new Lv(this.points.slice());return t.closeStroke=this.closeStroke,t},
Lv.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function Lv(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof uv){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=pv.POLY,this.closeStroke=!0}
Fv.prototype.clone=function(){return new Fv(this.x,this.y,this.width,this.height,this.radius)},Fv.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function Fv(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=pv.RREC}Ly.SORTABLE_CHILDREN=!1;function Dv(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}Dv.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},Dv.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Dv.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Rv.EMPTY:((
t=t||new Rv(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Dv.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},Dv.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},Dv.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
Dv.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},Dv.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},Dv.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
Dv.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},Dv.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},Dv.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},Dv.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},Dv.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},Dv.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},Dv.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var Uv=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new Cv,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Dv,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Rv),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Rv),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*_v},e.angle.set=function(t){this.transform.rotation=t*yv
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function Bv(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Uv.prototype.displayObjectUpdateTransform=Uv.prototype.updateTransform;var kv=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=Ly.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Gy(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,Gy(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,Gy(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(Bv),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(Uv);kv.prototype.containerUpdateTransform=kv.prototype.updateTransform;function Xv(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ny(
"setRealSize",2),this.onUpdate=new ny("update"),this.onError=new ny("onError",1)}var Gv={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};Xv.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},Xv.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},Xv.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},Gv.valid.get=function(){return!!this._width&&!!this._height},Xv.prototype.update=function(){this.destroyed||this.onUpdate.run()},Xv.prototype.load=function(){return Promise.resolve()},
Gv.width.get=function(){return this._width},Gv.height.get=function(){return this._height},Xv.prototype.upload=function(t,e,i){return!1},Xv.prototype.style=function(t,e,i){return!1},Xv.prototype.dispose=function(){},Xv.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(Xv.prototype,Gv);var Vv=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,($y=$y||document.createElement("a")).href=t;var i=!(t=H.a.parse($y.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Sy.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(Xv),jv=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:Ly.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===Sy.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(Vv),Hv=[];function Yv(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=Hv.length-1;0<=n;--n){var s=Hv[n];if(s.test&&s.test(t,i))return new s(t,e)}return new jv(t,e)}var zv=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Sy.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(Xv),Wv={scaleMode:xy.NEAREST,format:fy.RGBA,
alphaMode:Sy.NPM},qv=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof Xv||((t=Yv(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||Ly.RESOLUTION,this.mipmap=void 0!==r?r:Ly.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:Ly.ANISOTROPIC_LEVEL,
this.wrapMode=h||Ly.WRAP_MODE,this.scaleMode=void 0!==s?s:Ly.SCALE_MODE,this.format=u||fy.RGBA,this.type=l||vy.UNSIGNED_BYTE,this.target=c||_y.TEXTURE_2D,this.alphaMode=void 0!==i?i:Sy.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=jy(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=zy(this.realWidth
)&&zy(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Zy[this.cacheId],delete Ky[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=Ly.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+jy()),t._pixiId);var s=Zy[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new zv(t,{width:e,height:i}),
s=t instanceof Float32Array?vy.FLOAT:vy.UNSIGNED_BYTE;return new o(n,Object.assign(Wv,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Zy[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Zy[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=Zy[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Zy[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete Zy[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);qv._globalBatch=0;var Kv=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new qv;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(Yv(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=_y.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(Xv),
Zv=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(Vv),
Jv=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=_y.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=_y.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(Kv);Jv.SIDES=6;var Qv=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+jy(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(Vv)
;Qv.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var $v=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=ov.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(ov.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(ov.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&ov.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(ov.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(ov.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(Vv);$v.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var tg=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(Vv);Hv.push(jv,tg,Zv,$v,Qv,zv,Jv,Kv);function eg(t){this.renderer=t}
eg.prototype.destroy=function(){this.renderer=null};function ig(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new ny("disposeFramebuffer",2)}var rg=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Sy.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(zv),ng={colorTexture:{configurable:!0}};ng.colorTexture.get=function(){return this.colorTextures[0]},ig.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new qv(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},ig.prototype.addDepthTexture=function(t){return this.depthTexture=t||new qv(new rg(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:fy.DEPTH_COMPONENT,type:vy.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},ig.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},ig.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},ig.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},ig.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(ig.prototype,ng);function sg(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var og=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new ig(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(qv);sg.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=Iv.add(i,Iv.NW),this.x0=a+s*Iv.uX(i),this.y0=h+o*Iv.uY(i),i=Iv.add(i,2),this.x1=a+s*Iv.uX(i),this.y1=h+o*Iv.uY(i),i=Iv.add(i,2),this.x2=a+s*Iv.uX(i),this.y2=h+o*Iv.uY(i),i=Iv.add(i,2),
this.x3=a+s*Iv.uX(i),this.y3=h+o*Iv.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var ag=new sg,hg=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new Rv(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=ag,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new uv(s.x,s.y):new uv(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&Ky[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===ag&&(this._uvs=new sg),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=Ly.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+jy()),t._pixiId);var s=Ky[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=tv(t)),(s=new a(new qv(t,e))).baseTexture.cacheId=n,
qv.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(qv.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new jv(t);r.url=e;var n=new a(new qv(r,{scaleMode:Ly.SCALE_MODE,resolution:tv(e)}));return i=i||e,
qv.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(qv.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ky[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),Ky[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=Ky[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Ky[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Ky[t.textureCacheIds[r]]===t&&delete Ky[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function ug(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}hg.EMPTY=new hg(new qv),ug(hg.EMPTY),ug(hg.EMPTY.baseTexture),hg.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new hg(new qv(new Zv(t)))}(),ug(hg.WHITE),ug(hg.WHITE.baseTexture);function lg(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var cg=function(a){function n(t,e){var i=null;if(!(t instanceof og)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new og({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new og(t))},n}(hg);lg.prototype.createTexture=function(t,e){var i=new og(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new cg(i)},
lg.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=lg.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=Yy(t)))<<16|65535&(e=Yy(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},lg.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
lg.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},lg.prototype.returnFilterTexture=function(t){this.returnTexture(t)},lg.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},lg.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=lg.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},lg.SCREEN_KEY="screen";function dg(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}dg.prototype.destroy=function(){this.buffer=null},dg.from=function(t,e,i,r,n){return new dg(t,e,i,r,n)};function pg(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=fg++,this.disposeRunner=new ny("disposeBuffer",2)}var fg=0;function mg(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}pg.prototype.update=function(t){this.data=t||this.data,this._updateID++},pg.prototype.dispose=function(){this.disposeRunner.run(this,!1)},pg.prototype.destroy=function(){this.dispose(),this.data=null},pg.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new pg(t)};var _g={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function yg(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=gg++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ny("disposeGeometry",2),this.refCount=0}var vg={5126:4,5123:2,5121:1},gg=0,xg={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};yg.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new pg(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new dg(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},yg.prototype.getAttribute=function(t){return this.attributes[t]},yg.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},yg.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new pg(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
yg.prototype.getIndex=function(){return this.indexBuffer},yg.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new pg;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*vg[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=mg(c)
;n[d]||(n[d]=new _g[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},yg.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},yg.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},yg.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},yg.prototype.clone=function(){for(var t=new yg,e=0;e<this.buffers.length;e++)t.buffers[e]=new pg(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new dg(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},yg.merge=function(t){for(var e,i=new yg,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(xg[mg(e.buffers[h].data)])(n[h]),i.buffers[h]=new pg(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*vg[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function bg(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=wg++,this.static=!!e}var Tg=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(yg),
Eg=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new pg(this.vertices),this.uvBuffer=new pg(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(yg),wg=0
;bg.prototype.update=function(){this.dirtyId++},bg.prototype.add=function(t,e,i){this.uniforms[t]=new bg(e,i)},bg.from=function(t,e){return new bg(t,e)};function Ag(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new Rv,this.destinationFrame=new Rv,this.filters=[]}Ag.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function Sg(t){this.renderer=t}var Ig=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new lg,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Tg,this.quadUv=new Eg,this.tempRect=new Rv,this.activeState={},this.globalUniforms=new bg({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Ag,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(dy.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(dy.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
vv.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(eg);Sg.prototype.flush=function(){},Sg.prototype.destroy=function(){this.renderer=null},Sg.prototype.start=function(){},Sg.prototype.stop=function(){this.flush()},Sg.prototype.render=function(t){};var Cg=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new Sg(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(eg);Ly.PREFER_ENV=u.a.any?oy.WEBGL:oy.WEBGL2,Ly.STRICT_TEXTURE_CACHE=!1
;function Og(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function Rg(t){this.type=My.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var Pg=0,Mg=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Pg++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Pg++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(Ly.PREFER_ENV>=oy.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(eg),Ng=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new ig(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rv,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Ly.PREFER_ENV===oy.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Rv},Object.defineProperties(t.prototype,i),t}(eg),Lg={5126:4,5123:2,5121:1},
Fg=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;Ly.PREFER_ENV===oy.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Lg[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Lg[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Lg[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new Og(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(eg);function Dg(t,e,i,r){var n=Ug(t,t.VERTEX_SHADER,e),s=Ug(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Ug(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function Bg(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return kg(2*e)
;case"bvec3":return kg(3*e);case"bvec4":return kg(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function kg(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}Rg.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=My.NONE,this.autoDetect=!0),this._target=null},Rg.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var Xg,Gg={},Vg=Gg;function jg(){if(Vg===Gg||Vg&&Vg.isContextLost()){
var t,e=document.createElement("canvas");Ly.PREFER_ENV>=oy.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),Vg=t}return Vg}function Hg(t,e,i){if(
"precision"===t.substring(0,9))return i!==Ry.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===Ry.HIGH&&i!==Ry.HIGH&&(r=Ry.MEDIUM),"precision "+r+" float;\n"+t}var Yg={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var zg=null,Wg={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function qg(t,e){if(!zg){var i=Object.keys(Wg)
;zg={};for(var r=0;r<i.length;++r){var n=i[r];zg[t[n]]=Wg[n]}}return zg[e]}var Kg={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Zg={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Jg,Qg=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function $g(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function tx(t,e,i){void 0===i&&(i="pixi-shader"),this.id=ex++,this.vertexSrc=t||tx.defaultVertexSrc,
this.fragmentSrc=e||tx.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),ix[i]?(ix[i]++,i+="-"+ix[i]):ix[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Hg(this.vertexSrc,Ly.PRECISION_VERTEX,Ry.HIGH),this.fragmentSrc=Hg(this.fragmentSrc,Ly.PRECISION_FRAGMENT,function(
){if(!Xg){Xg=Ry.MEDIUM;var t=jg();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Xg=e.precision?Ry.HIGH:Ry.MEDIUM}}return Xg}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var ex=0,ix={},rx={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};tx.prototype.extractData=function(t,e){var i=jg();if(i){var r=Dg(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},tx.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=qg(e,a.type),u={type:h,name:a.name,size:(i=h,Yg[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
tx.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=qg(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:Bg(h,s.size)}}return i},rx.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},rx.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},tx.from=function(t,e,i){var r=t+e,n=qy[r];return n||(qy[r]=n=new tx(t
,e,i)),n},Object.defineProperties(tx,rx);function nx(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof bg?e:new bg(e):new bg({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var sx={uniforms:{configurable:!0}};nx.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
nx.prototype.destroy=function(){this.uniformGroup=null},sx.uniforms.get=function(){return this.uniformGroup.uniforms},nx.from=function(t,e,i){var r=tx.from(t,e);return new nx(r,i)},Object.defineProperties(nx.prototype,sx);function ox(){this.data=0,
this.blendMode=ly.NORMAL,this.polygonOffset=0,this.blend=!0}var ax={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};ax.blend.get=function(){return!!(1&this.data)},ax.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},ax.offsets.get=function(){return!!(2&this.data)},ax.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
ax.culling.get=function(){return!!(4&this.data)},ax.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},ax.depthTest.get=function(){return!!(8&this.data)},ax.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
ax.clockwiseFrontFace.get=function(){return!!(16&this.data)},ax.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},ax.blendMode.get=function(){return this._blendMode},ax.blendMode.set=function(t){this.blend=t!==ly.NONE,
this._blendMode=t},ax.polygonOffset.get=function(){return this._polygonOffset},ax.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},ox.for2d=function(){var t=new ox;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
ox.prototype,ax);var hx=function(n){function s(t,e,i){var r=tx.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=Ly.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new ox}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(nx);hx.SOURCE_KEY_MAP={};function ux(t,e){this._texture=t,this.mapCoord=new vv,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var lx=new vv,cx={texture:{configurable:!0}};cx.texture.get=function(){return this._texture},cx.texture.set=function(t){this._texture=t,this._updateID=-1},ux.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},ux.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(lx.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(lx));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(ux.prototype,cx);function dx(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var px=function(i){
function t(t){var e=new vv;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new ux(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(hx),fx=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new Rg;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case My.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case My.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case My.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case My.SCISSOR:this.renderer.scissor.pop();break;case My.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case My.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=My.SPRITE;else if(t.type=My.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=My.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new px(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(eg),mx=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(eg),_x=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(mx),yx=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(mx),vx=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new vv,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(eg),gx=new Rv,xx=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new Rv,this.destinationFrame=new Rv}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(gx.width=s.realWidth,gx.height=s.realHeight,i=gx),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
gx.width=n.width,gx.height=n.height,i=gx),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(eg)
;dx.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var bx=0,Tx=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=bx++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Jg)return Jg;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;Jg=!0===t({a:"b"},"a","b")}catch(t){Jg=!1}return Jg}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?Kg:Zg)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=Dg(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Bg(h.type,h.size)}}var u=new dx(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(eg);function Ex(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var wx=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ly.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new ox,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[ly.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.ADD]=[t.ONE,t.ONE],e[ly.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[ly.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[ly.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[ly.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.NONE]=[0,0],e[ly.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[ly.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ly.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[ly.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[ly.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ly.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[ly.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[ly.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[ly.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[ly.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ly.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(eg),Ax=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=Ly.GC_MAX_IDLE,
this.checkCountMax=Ly.GC_MAX_CHECK_COUNT,this.mode=Ly.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Cy.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(eg),Sx=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new qv}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new Ex(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ex(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new Ex(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===vy.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&Gy(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==wy.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Ty.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===xy.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(eg),Ix=new vv;X.a;function Cx(){this.texArray=null,this.blend=0,this.type=dy.TRIANGLES,this.start=0,this.size=0,this.data=null}function Ox(){this.elements=[],this.ids=[],this.count=0}Ox.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function Rx(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var Px={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Px.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Px.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Px.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Px.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Px.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Rx.prototype.view=function(t){
return this[t+"View"]},Rx.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Rx.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Rx.prototype,Px);var Mx=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=ox.for2d(),this.size=4*Ly.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;Ly.PREFER_ENV===oy.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Ly.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Qg.replace(/%forloop%/gi,$g(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Cx);for(;e.length<r;)e.push(new Ox);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++qv._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;qv._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=Xy[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;Ly.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Ly.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=Yy(Math.ceil(t/8)),i=Wy(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Rx(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=Yy(Math.ceil(t/12)),i=Wy(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(Sg);Mx._drawCallPool=[],Mx._textureArrayPool=[];function Nx(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}Nx.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=bg.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new tx(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new vv,default:this.defaultGroupCache[t]};return new nx(this.programCache[t],n)},
Nx.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function Lx(){}var Fx=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new pg(null,t,!1),this._indexBuffer=new pg(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,vy.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,vy.FLOAT).addAttribute("aColor",this._buffer,4,!0,vy.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,vy.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(yg),
Dx="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,Ux="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Bx={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};Lx.create=function(t){var e=Object.assign({vertex:Dx,fragment:Ux,geometryClass:Fx,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new Nx(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Mx)},Bx.defaultVertexSrc.get=function(){return Dx},Bx.defaultFragmentTemplate.get=function(){
return Ux},Object.defineProperties(Lx,Bx);Lx.create();function kx(t){this.styleID=0,this.reset(),zx(this,t,t)}var Xx={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},Gx={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,
dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Xx.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,
lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Vx=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],jx={align:{
configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{
configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{
configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{
configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}};function Hx(t){return"number"==typeof t?ky(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Yx(t){if(Array.isArray(t)
){for(var e=0;e<t.length;++e)t[e]=Hx(t[e]);return t}return Hx(t)}function zx(t,e,i){for(var r in i)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}kx.prototype.clone=function(){var t={};return zx(t,this,Gx),new kx(t)},kx.prototype.reset=function(){zx(this
,Gx,Gx)},jx.align.get=function(){return this._align},jx.align.set=function(t){this._align!==t&&(this._align=t,this.styleID++)},jx.breakWords.get=function(){return this._breakWords},jx.breakWords.set=function(t){this._breakWords!==t&&(this._breakWords=t,
this.styleID++)},jx.dropShadow.get=function(){return this._dropShadow},jx.dropShadow.set=function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},jx.dropShadowAlpha.get=function(){return this._dropShadowAlpha},
jx.dropShadowAlpha.set=function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},jx.dropShadowAngle.get=function(){return this._dropShadowAngle},jx.dropShadowAngle.set=function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,
this.styleID++)},jx.dropShadowBlur.get=function(){return this._dropShadowBlur},jx.dropShadowBlur.set=function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},jx.dropShadowColor.get=function(){return this._dropShadowColor},
jx.dropShadowColor.set=function(t){var e=Yx(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},jx.dropShadowDistance.get=function(){return this._dropShadowDistance},jx.dropShadowDistance.set=function(t){this._dropShadowDistance!==t&&(
this._dropShadowDistance=t,this.styleID++)},jx.fill.get=function(){return this._fill},jx.fill.set=function(t){var e=Yx(t);this._fill!==e&&(this._fill=e,this.styleID++)},jx.fillGradientType.get=function(){return this._fillGradientType},
jx.fillGradientType.set=function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},jx.fillGradientStops.get=function(){return this._fillGradientStops},jx.fillGradientStops.set=function(t){!function(t,e){if(!Array.isArray(t
)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}(this._fillGradientStops,t)&&(this._fillGradientStops=t,this.styleID++)},jx.fontFamily.get=function(){return this._fontFamily},
jx.fontFamily.set=function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},jx.fontSize.get=function(){return this._fontSize},jx.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},jx.fontStyle.get=function(){
return this._fontStyle},jx.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},jx.fontVariant.get=function(){return this._fontVariant},jx.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++
)},jx.fontWeight.get=function(){return this._fontWeight},jx.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},jx.letterSpacing.get=function(){return this._letterSpacing},jx.letterSpacing.set=function(t){
this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},jx.lineHeight.get=function(){return this._lineHeight},jx.lineHeight.set=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},jx.leading.get=function(){return this._leading}
,jx.leading.set=function(t){this._leading!==t&&(this._leading=t,this.styleID++)},jx.lineJoin.get=function(){return this._lineJoin},jx.lineJoin.set=function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},jx.miterLimit.get=function(){
return this._miterLimit},jx.miterLimit.set=function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},jx.padding.get=function(){return this._padding},jx.padding.set=function(t){this._padding!==t&&(this._padding=t,this.styleID++)},
jx.stroke.get=function(){return this._stroke},jx.stroke.set=function(t){var e=Yx(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},jx.strokeThickness.get=function(){return this._strokeThickness},jx.strokeThickness.set=function(t){
this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},jx.textBaseline.get=function(){return this._textBaseline},jx.textBaseline.set=function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},jx.trim.get=function(){
return this._trim},jx.trim.set=function(t){this._trim!==t&&(this._trim=t,this.styleID++)},jx.whiteSpace.get=function(){return this._whiteSpace},jx.whiteSpace.set=function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},
jx.wordWrap.get=function(){return this._wordWrap},jx.wordWrap.set=function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},jx.wordWrapWidth.get=function(){return this._wordWrapWidth},jx.wordWrapWidth.set=function(t){this._wordWrapWidth!==t&&(
this._wordWrapWidth=t,this.styleID++)},kx.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(
var i=e.length-1;0<=i;i--){var r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&Vx.indexOf(r)<0&&(r='"'+r+'"'),e[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},Object.defineProperties(kx.prototype,jx);function Wx(t,
e,i,r,n,s,o,a,h){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}Wx.measureText=function(t,e,i,r){void 0===r&&(r=Wx._canvas),i=null==i?e.wordWrap:i
;var n=e.toFontString(),s=Wx.measureFont(n);0===s.fontSize&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var o=r.getContext("2d");o.font=n;for(var a=(i?Wx.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),h=new Array(a.length),u=0,l=0;l<a.length;l++){
var c=o.measureText(a[l]).width+(a[l].length-1)*e.letterSpacing;h[l]=c,u=Math.max(u,c)}var d=u+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);var p=e.lineHeight||s.fontSize+e.strokeThickness,f=Math.max(p,s.fontSize+e.strokeThickness)+(
a.length-1)*(p+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new Wx(t,e,d,f,a,h,p+e.leading,u,s)},Wx.wordWrap=function(t,e,i){void 0===i&&(i=Wx._canvas);for(var r=i.getContext("2d"),n=0,s="",o="",a={},h=e.letterSpacing,u=e.whiteSpace,
l=Wx.collapseSpaces(u),c=Wx.collapseNewlines(u),d=!l,p=e.wordWrapWidth+h,f=Wx.tokenize(t),m=0;m<f.length;m++){var _=f[m];if(Wx.isNewline(_)){if(!c){o+=Wx.addLine(s),d=!l,s="",n=0;continue}_=" "}if(l){var y=Wx.isBreakingSpace(_),v=Wx.isBreakingSpace(
s[s.length-1]);if(y&&v)continue}var g=Wx.getFromCache(_,h,a,r);if(p<g)if(""!==s&&(o+=Wx.addLine(s),s="",n=0),Wx.canBreakWords(_,e.breakWords))for(var x=_.split(""),b=0;b<x.length;b++){for(var T=x[b],E=1;x[b+E];){var w=x[b+E],A=T[T.length-1];if(
Wx.canBreakChars(A,w,_,b,e.breakWords))break;T+=w,E++}b+=T.length-1;var S=Wx.getFromCache(T,h,a,r);p<S+n&&(o+=Wx.addLine(s),d=!1,s="",n=0),s+=T,n+=S}else{0<s.length&&(o+=Wx.addLine(s),s="",n=0);var I=m===f.length-1;o+=Wx.addLine(_,!I),d=!1,s="",n=0
}else p<g+n&&(d=!1,o+=Wx.addLine(s),s="",n=0),(0<s.length||!Wx.isBreakingSpace(_)||d)&&(s+=_,n+=g)}return o+=Wx.addLine(s,!1)},Wx.addLine=function(t,e){return void 0===e&&(e=!0),t=Wx.trimRight(t),t=e?t+"\n":t},Wx.getFromCache=function(t,e,i,r){var n=i[t]
;if(void 0===n){var s=t.length*e;n=r.measureText(t).width+s,i[t]=n}return n},Wx.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},Wx.collapseNewlines=function(t){return"normal"===t},Wx.trimRight=function(t){if("string"!=typeof t)return"";for(
var e=t.length-1;0<=e;e--){var i=t[e];if(!Wx.isBreakingSpace(i))break;t=t.slice(0,-1)}return t},Wx.isNewline=function(t){return"string"==typeof t&&0<=Wx._newlines.indexOf(t.charCodeAt(0))},Wx.isBreakingSpace=function(t){
return"string"==typeof t&&0<=Wx._breakingSpaces.indexOf(t.charCodeAt(0))},Wx.tokenize=function(t){var e=[],i="";if("string"!=typeof t)return e;for(var r=0;r<t.length;r++){var n=t[r];Wx.isBreakingSpace(n)||Wx.isNewline(n)?(""!==i&&(e.push(i),i=""),e.push(n
)):i+=n}return""!==i&&e.push(i),e},Wx.canBreakWords=function(t,e){return e},Wx.canBreakChars=function(t,e,i,r,n){return!0},Wx.measureFont=function(t){if(Wx._fonts[t])return Wx._fonts[t];var e={},i=Wx._canvas,r=Wx._context;r.font=t
;var n=Wx.METRICS_STRING+Wx.BASELINE_SYMBOL,s=Math.ceil(r.measureText(n).width),o=Math.ceil(r.measureText(Wx.BASELINE_SYMBOL).width),a=2*o;o=o*Wx.BASELINE_MULTIPLIER|0,i.width=s,i.height=a,r.fillStyle="#f00",r.fillRect(0,0,s,a),r.font=t,
r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(n,0,o);var h=r.getImageData(0,0,s,a).data,u=h.length,l=4*s,c=0,d=0,p=!1;for(c=0;c<o;++c){for(var f=0;f<l;f+=4)if(255!==h[d+f]){p=!0;break}if(p)break;d+=l}for(e.ascent=o-c,d=u-l,p=!1,c=a;o<c;--c){
for(var m=0;m<l;m+=4)if(255!==h[d+m]){p=!0;break}if(p)break;d-=l}return e.descent=c-o,e.fontSize=e.ascent+e.descent,Wx._fonts[t]=e},Wx.clearMetrics=function(t){void 0===t&&(t=""),t?delete Wx._fonts[t]:Wx._fonts={}};var qx=function(){try{
var t=new OffscreenCanvas(0,0);return t.getContext("2d")?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();qx.width=qx.height=10,Wx._canvas=qx,Wx._context=qx.getContext("2d"),Wx._fonts={},Wx.METRICS_STRING="|ÉqÅ",
Wx.BASELINE_SYMBOL="M",Wx.BASELINE_MULTIPLIER=1.4,Wx._newlines=[10,13];var Kx={texture:!0,children:!(Wx._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]),baseTexture:!0},Zx=function(n){function t(t,e,i){(
i=i||document.createElement("canvas")).width=3,i.height=3;var r=hg.from(i);r.orig=new Rv,r.trim=new Rv,n.call(this,r),this.canvas=i,this.context=this.canvas.getContext("2d"),this._resolution=Ly.RESOLUTION,this._autoResolution=!0,this._text=null,
this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}}
;return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i
,r,n=this.context,s=Wx.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,h=s.lines,u=s.lineHeight,l=s.lineWidths,c=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+2*e.padding
)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,
n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;for(var p,f=e.dropShadow?2:1,m=0;m<f;++m){var _=e.dropShadow&&0===m,y=_?2*a:0,v=y*this.resolution;if(_){n.fillStyle="black",n.strokeStyle="black";var g=e.dropShadowColor,x=By(
"number"==typeof g?g:("string"==typeof(p=g)&&"#"===p[0]&&(p=p.substr(1)),parseInt(p,16)));n.shadowColor="rgba("+255*x[0]+","+255*x[1]+","+255*x[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle
)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+v}else n.fillStyle=this._generateFillStyle(e,h),n.strokeStyle=e.stroke,n.shadowColor=0,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var b=0;b<h.length;b++
)i=e.strokeThickness/2,r=e.strokeThickness/2+b*u+d.ascent,"right"===e.align?i+=c-l[b]:"center"===e.align&&(i+=(c-l[b])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[b],i+e.padding,r+e.padding-y,!0),e.fill&&this.drawLetterSpacing(h[b],
i+e.padding,r+e.padding-y)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(t,e,i,r){void 0===r&&(r=!1);var n=this._style.letterSpacing;if(0!==n)for(var s=e,o=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,
u=0;u<o.length;++u){var l=o[u];r?this.context.strokeText(l,s,i):this.context.fillText(l,s,i),s+=a-(h=this.context.measureText(t.substring(u+1)).width)+n,a=h}else r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},
t.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,i,r,n=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,n,s).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(
e=0;e<h;e+=4)0!==a[e+3]&&(i=e/4%n,r=~~(e/4/n),null===u.top&&(u.top=r),null===u.left?u.left=i:i<u.left&&(u.left=i),null===u.right?u.right=1+i:u.right<i&&(u.right=1+i),null===u.bottom?u.bottom=r:u.bottom<r&&(u.bottom=r));return null!==u.top&&(
n=u.right-u.left,s=u.bottom-u.top+1,l=o.getImageData(u.left,u.top,n,s)),{height:s,width:n,data:l}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var i=this._texture,r=this._style,n=r.trim?0:r.padding,s=i.baseTexture
;i.trim.width=i._frame.width=Math.ceil(t.width/this._resolution),i.trim.height=i._frame.height=Math.ceil(t.height/this._resolution),i.trim.x=-n,i.trim.y=-n,i.orig.width=i._frame.width-2*n,i.orig.height=i._frame.height-2*n,this._onTextureUpdate(),
s.setRealSize(t.width,t.height,this._resolution),this.dirty=!1},t.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),n.prototype._render.call(this,t)},
t.prototype.getLocalBounds=function(t){return this.updateText(!0),n.prototype.getLocalBounds.call(this,t)},t.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},
t.prototype._onStyleChange=function(){this.dirty=!0},t.prototype._generateFillStyle=function(t,e){if(!Array.isArray(t.fill))return t.fill;if(1===t.fill.length)return t.fill[0];var i,r,n,s,o=Math.ceil(this.canvas.width/this._resolution),a=Math.ceil(
this.canvas.height/this._resolution),h=t.fill.slice(),u=t.fillGradientStops.slice();if(!u.length)for(var l=h.length+1,c=1;c<l;++c)u.push(c/l);if(h.unshift(t.fill[0]),u.unshift(0),h.push(t.fill[t.fill.length-1]),u.push(1),
t.fillGradientType===Xx.LINEAR_VERTICAL){i=this.context.createLinearGradient(o/2,0,o/2,a),r=(h.length+1)*e.length;for(var d=n=0;d<e.length;d++){n+=1;for(var p=0;p<h.length;p++)s="number"==typeof u[p]?u[p]/e.length+d/e.length:n/r,i.addColorStop(s,h[p]),n++
}}else{i=this.context.createLinearGradient(0,a/2,o,a/2),r=h.length+1,n=1;for(var f=0;f<h.length;f++)s="number"==typeof u[f]?u[f]:n/r,i.addColorStop(s,h[f]),n++}return i},t.prototype.destroy=function(t){"boolean"==typeof t&&(t={children:t}),
t=Object.assign({},Kx,t),n.prototype.destroy.call(this,t),this.context=null,this.canvas=null,this._style=null},e.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},e.width.set=function(t){this.updateText(!0)
;var e=Hy(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},e.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},e.height.set=function(t){this.updateText(!0);var e=Hy(this.scale.y)||1
;this.scale.y=e*t/this._texture.orig.height,this._height=t},e.style.get=function(){return this._style},e.style.set=function(t){t=t||{},this._style=t instanceof kx?t:new kx(t),this.localStyleID=-1,this.dirty=!0},e.text.get=function(){return this._text},
e.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},e.resolution.get=function(){return this._resolution},e.resolution.set=function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}
,Object.defineProperties(t.prototype,e),t}(ry);so.UPLOADS_PER_FRAME=4;var Jx=function(t){this.maxItemsPerFrame=t,this.itemsLeft=0};Jx.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},Jx.prototype.allowedToUpload=function(){
return 0<this.itemsLeft--};var Qx=function(t){var e=this;this.limiter=new Jx(so.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){
e.queue&&e.prepareItems()},this.registerFindHook(nb),this.registerFindHook(sb),this.registerFindHook($x),this.registerFindHook(tb),this.registerFindHook(eb),this.registerUploadHook(ib),this.registerUploadHook(rb)};function $x(t,e){var i=!1;if(
t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof Na){var n=t._textures[r].baseTexture;-1===e.indexOf(n)&&(e.push(n),i=!0)}return i}function tb(t,e){if(t.baseTexture instanceof ga){var i=t.baseTexture
;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function eb(t,e){if(t._texture&&t._texture instanceof Na){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function ib(t,e){return e instanceof Zx&&(e.updateText(!0),!0)}
function rb(t,e){if(e instanceof kx){var i=e.toFontString();return Wx.measureFont(i),!0}return!1}function nb(t,e){if(t instanceof Zx){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i
)&&e.push(i),!0}return!1}function sb(t,e){return t instanceof kx&&(-1===e.indexOf(t)&&e.push(t),!0)}Qx.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(
this.ticking=!0,Po.system.addOnce(this.tick,this,So.UTILITY))):e&&e()},Qx.prototype.tick=function(){setTimeout(this.delayedTick,0)},Qx.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){
var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)Po.system.addOnce(this.tick,this,
So.UTILITY);else{this.ticking=!1;for(var n=this.completes.slice(0),s=this.completes.length=0,o=n.length;s<o;s++)n[s]()}},Qx.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},Qx.prototype.registerUploadHook=function(t){
return t&&this.uploadHooks.push(t),this},Qx.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof la)for(var r=t.children.length-1;0<=r;r--)this.add(t.children[r]);return this},
Qx.prototype.destroy=function(){this.ticking&&Po.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null};var ob=function(e
){function t(t){e.call(this,t),this.uploadHookHelper=this.renderer,this.registerFindHook(ub),this.registerUploadHook(ab),this.registerUploadHook(hb)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Qx);function ab(t,e){
return e instanceof ga&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function hb(t,e){if(!(e instanceof xp))return!1;var i=e.geometry;e.finishPoly(),i.updateBatches();for(var r=i.batches,n=0;n<r.length;n++){var s=r[n].style.texture;s&&ab(t,
s.baseTexture)}return i.batchable||t.geometry.bind(i,e._resolveDirectShader()),!0}function ub(t,e){return t instanceof xp&&(e.push(t),!0)}var lb=function(t){this.maxMilliseconds=t,this.frameStart=0};lb.prototype.beginFrame=function(){
this.frameStart=Date.now()},lb.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds};var cb,db,pb,fb,mb,_b,yb,vb,gb,xb,bb,Tb,Eb,wb,Ab,Sb,Ib,Cb,Ob,Rb,Pb,Mb,Nb,Lb,Fb,Db,Ub,Bb,kb={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,
RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){
var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,
preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",
CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(db=cb=cb||{})[db.WEBGL_LEGACY=0]="WEBGL_LEGACY",db[db.WEBGL=1]="WEBGL",db[db.WEBGL2=2]="WEBGL2",(fb=pb=pb||{})[fb.UNKNOWN=0]="UNKNOWN",fb[fb.WEBGL=1]="WEBGL",
fb[fb.CANVAS=2]="CANVAS",(_b=mb=mb||{})[_b.NORMAL=0]="NORMAL",_b[_b.ADD=1]="ADD",_b[_b.MULTIPLY=2]="MULTIPLY",_b[_b.SCREEN=3]="SCREEN",_b[_b.OVERLAY=4]="OVERLAY",_b[_b.DARKEN=5]="DARKEN",_b[_b.LIGHTEN=6]="LIGHTEN",_b[_b.COLOR_DODGE=7]="COLOR_DODGE",
_b[_b.COLOR_BURN=8]="COLOR_BURN",_b[_b.HARD_LIGHT=9]="HARD_LIGHT",_b[_b.SOFT_LIGHT=10]="SOFT_LIGHT",_b[_b.DIFFERENCE=11]="DIFFERENCE",_b[_b.EXCLUSION=12]="EXCLUSION",_b[_b.HUE=13]="HUE",_b[_b.SATURATION=14]="SATURATION",_b[_b.COLOR=15]="COLOR",
_b[_b.LUMINOSITY=16]="LUMINOSITY",_b[_b.NORMAL_NPM=17]="NORMAL_NPM",_b[_b.ADD_NPM=18]="ADD_NPM",_b[_b.SCREEN_NPM=19]="SCREEN_NPM",_b[_b.NONE=20]="NONE",_b[_b.SRC_OVER=0]="SRC_OVER",_b[_b.SRC_IN=21]="SRC_IN",_b[_b.SRC_OUT=22]="SRC_OUT",
_b[_b.SRC_ATOP=23]="SRC_ATOP",_b[_b.DST_OVER=24]="DST_OVER",_b[_b.DST_IN=25]="DST_IN",_b[_b.DST_OUT=26]="DST_OUT",_b[_b.DST_ATOP=27]="DST_ATOP",_b[_b.ERASE=26]="ERASE",_b[_b.SUBTRACT=28]="SUBTRACT",_b[_b.XOR=29]="XOR",(vb=yb=yb||{})[vb.POINTS=0]="POINTS",
vb[vb.LINES=1]="LINES",vb[vb.LINE_LOOP=2]="LINE_LOOP",vb[vb.LINE_STRIP=3]="LINE_STRIP",vb[vb.TRIANGLES=4]="TRIANGLES",vb[vb.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",vb[vb.TRIANGLE_FAN=6]="TRIANGLE_FAN",(xb=gb=gb||{})[xb.RGBA=6408]="RGBA",xb[xb.RGB=6407]="RGB",
xb[xb.ALPHA=6406]="ALPHA",xb[xb.LUMINANCE=6409]="LUMINANCE",xb[xb.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",xb[xb.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",xb[xb.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(Tb=bb=bb||{})[Tb.TEXTURE_2D=3553]="TEXTURE_2D",
Tb[Tb.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",Tb[Tb.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Tb[Tb.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",Tb[Tb.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
Tb[Tb.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Tb[Tb.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",Tb[Tb.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
Tb[Tb.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(wb=Eb=Eb||{})[wb.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",wb[wb.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",wb[wb.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
wb[wb.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",wb[wb.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",wb[wb.FLOAT=5126]="FLOAT",wb[wb.HALF_FLOAT=36193]="HALF_FLOAT",(Sb=Ab=Ab||{})[Sb.NEAREST=0]="NEAREST",Sb[Sb.LINEAR=1]="LINEAR",(
Cb=Ib=Ib||{})[Cb.CLAMP=33071]="CLAMP",Cb[Cb.REPEAT=10497]="REPEAT",Cb[Cb.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(Rb=Ob=Ob||{})[Rb.OFF=0]="OFF",Rb[Rb.POW2=1]="POW2",Rb[Rb.ON=2]="ON",(Mb=Pb=Pb||{})[Mb.NPM=0]="NPM",Mb[Mb.UNPACK=1]="UNPACK",
Mb[Mb.PMA=2]="PMA",Mb[Mb.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Mb[Mb.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Mb[Mb.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(Lb=Nb=Nb||{})[Lb.AUTO=0]="AUTO",Lb[Lb.MANUAL=1]="MANUAL",(Db=Fb=Fb||{}
).LOW="lowp",Db.MEDIUM="mediump",Db.HIGH="highp",(Bb=Ub=Ub||{})[Bb.NONE=0]="NONE",Bb[Bb.SCISSOR=1]="SCISSOR",Bb[Bb.STENCIL=2]="STENCIL",Bb[Bb.SPRITE=3]="SPRITE",kb.RETINA_PREFIX=/@([0-9\.]+)x/;var Xb,Gb=!(kb.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),Vb="5.2.0"
;function jb(){Gb=!0}function Hb(t){if(!Gb){if(-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var e=["\n %c %c %c PixiJS "+Vb+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;",
"background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;",
"color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log(
"PixiJS "+Vb+" - "+t+" - http://www.pixijs.com/");Gb=!0}}function Yb(){return void 0===Xb&&(Xb=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:kb.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1
;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!i||!i.getContextAttributes().stencil);if(i){var n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,r}catch(t){return!1}}()),
Xb}function zb(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function Wb(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)}function qb(t){return"string"==typeof t&&"#"===t[0]&&(t=t.substr(1)),parseInt(t,16
)}function Kb(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var Zb=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[mb.NORMAL_NPM]=mb.NORMAL,t[mb.ADD_NPM]=mb.ADD,t[mb.SCREEN_NPM]=mb.SCREEN,e[mb.NORMAL]=mb.NORMAL_NPM,e[mb.ADD]=mb.ADD_NPM,
e[mb.SCREEN]=mb.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function Jb(t,e){return Zb[e?1:0][t]}function Qb(t,e,i,r){return i=i||new Float32Array(4),r||void 0===r?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e):(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=e,i}
function $b(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(n=n*e+.5|0)}function tT(t,e,i,r){return(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255
)/255,i[2]=(255&t)/255,!r&&void 0!==r||(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e,i}function eT(t,e){void 0===e&&(e=null);var i=6*t;if((e=e||new Uint16Array(i)).length!==i)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+i);for(
var r=0,n=0;r<i;r+=6,n+=4)e[r+0]=n+0,e[r+1]=n+1,e[r+2]=n+2,e[r+3]=n+0,e[r+4]=n+2,e[r+5]=n+3;return e}function iT(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var rT=0;function nT(){return++rT}
function sT(t){return 0===t?0:t<0?-1:1}function oT(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function aT(t){return!(t&t-1||!t)}function hT(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(
3<(t>>>=i))<<1)|(t>>>=i)>>1}var uT={},lT=Object.create(null),cT=Object.create(null);function dT(){var t;for(t in lT)lT[t].destroy();for(t in cT)cT[t].destroy()}function pT(){var t;for(t in lT)delete lT[t];for(t in cT)delete cT[t]}function fT(t){var e,i,r,
n=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,n,s).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(i=e/4%n,r=~~(e/4/n),null===u.top&&(u.top=r),null===u.left?u.left=i:i<u.left&&(u.left=i),
null===u.right?u.right=1+i:u.right<i&&(u.right=1+i),null===u.bottom?u.bottom=r:u.bottom<r&&(u.bottom=r));return null!==u.top&&(n=u.right-u.left,s=u.bottom-u.top+1,l=o.getImageData(u.left,u.top,n,s)),{height:s,width:n,data:l}}var mT=function(t,e,i){
this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||kb.RESOLUTION,this.resize(t,e)},_T={width:{configurable:!0},height:{configurable:!0}};mT.prototype.clear=function(){this.context.setTransform(1,0,0,1
,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},mT.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},mT.prototype.destroy=function(){this.context=null,this.canvas=null},
_T.width.get=function(){return this.canvas.width},_T.width.set=function(t){this.canvas.width=t},_T.height.get=function(){return this.canvas.height},_T.height.set=function(t){this.canvas.height=t},Object.defineProperties(mT.prototype,_T);var yT,
vT=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function gT(t){var e=vT.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,
encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function xT(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(yT=yT||document.createElement("a")).href=t;var i=!(t=H.a.parse(yT.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}function bT(t,e){var i=kb.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var TT={};function ET(t,e,i){if(void 0===i&&(i=3),
!TT[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s",
"color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),TT[e]=!0}}
var wT={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(
e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,
backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",
CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},AT=(ST.prototype.clone=function(){return new ST(this.x,this.y)},ST.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},ST.prototype.copyTo=function(t){return t.set(
this.x,this.y),t},ST.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},ST.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e},ST);function ST(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var IT=(
CT.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new CT(t,e,this._x,this._y)},CT.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(
this.scope))},CT.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},CT.prototype.copyTo=function(t){return t.set(this._x,this._y),t},CT.prototype.equals=function(t){
return t.x===this._x&&t.y===this._y},Object.defineProperty(CT.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(CT.prototype,"y",{
get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),CT);function CT(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var OT,RT,
PT=2*Math.PI,MT=180/Math.PI,NT=Math.PI/180;(RT=OT=OT||{})[RT.POLY=0]="POLY",RT[RT.RECT=1]="RECT",RT[RT.CIRC=2]="CIRC",RT[RT.ELIP=3]="ELIP",RT[RT.RREC=4]="RREC";var LT=(FT.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],
this.tx=t[2],this.ty=t[5]},FT.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},FT.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(
i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},FT.prototype.apply=function(t,e){e=e||new AT;var i=t.x,r=t.y
;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},FT.prototype.applyInverse=function(t,e){e=e||new AT;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,
e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},FT.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},FT.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},
FT.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},
FT.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},
FT.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},FT.prototype.prepend=function(t){
var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},
FT.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(PT-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),
t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},FT.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,
this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},FT.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},FT.prototype.clone=function(){var t=new FT;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,
t.tx=this.tx,t.ty=this.ty,t},FT.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},FT.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,
this},Object.defineProperty(FT,"IDENTITY",{get:function(){return new FT},enumerable:!0,configurable:!0}),Object.defineProperty(FT,"TEMP_MATRIX",{get:function(){return new FT},enumerable:!0,configurable:!0}),FT);function FT(t,e,i,r,n,s){void 0===t&&(t=1),
void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var DT=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],UT=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],
BT=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],kT=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],XT=[],GT=[],VT=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];XT.push(e);for(var i=0;i<16;i++)for(var r=VT(DT[t]*DT[i]+BT[t]*UT[i]),n=VT(UT[t]*DT[i]+kT[t]*UT[i]),
s=VT(DT[t]*BT[i]+BT[t]*kT[i]),o=VT(UT[t]*BT[i]+kT[t]*kT[i]),a=0;a<16;a++)if(DT[a]===r&&UT[a]===n&&BT[a]===s&&kT[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new LT;h.set(DT[t],UT[t],BT[t],kT[t],0,0),GT.push(h)}}();var jT={E:0,SE:1,S:2,SW:3,W:4,NW:5,
N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return DT[t]},uY:function(t){return UT[t]},vX:function(t){return BT[t]},vY:function(t){return kT[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e
){return XT[t][e]},sub:function(t,e){return XT[t][jT.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?jT.S:jT.N:2*Math.abs(e)<=Math.abs(t
)?0<t?jT.E:jT.W:0<e?0<t?jT.SE:jT.SW:0<t?jT.NE:jT.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=GT[jT.inv(e)];n.tx=i,n.ty=r,t.append(n)}},HT=(YT.prototype.onChange=function(){this._localID++},
YT.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},
YT.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(
this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},YT.prototype.updateTransform=function(t){var e=this.localTransform;if(
this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d
),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,
r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},YT.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(YT.prototype,"rotation",{get:function(){return this._rotation},set:function(t){
this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),YT.IDENTITY=new YT,YT);function YT(){this.worldTransform=new LT,this.localTransform=new LT,this.position=new IT(this.onChange,this,0,0),this.scale=new IT(
this.onChange,this,1,1),this.pivot=new IT(this.onChange,this,0,0),this.skew=new IT(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}var zT=(
Object.defineProperty(WT.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(WT.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(
WT.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(WT.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(WT,"EMPTY",{get:function(){
return new WT(0,0,0,0)},enumerable:!0,configurable:!0}),WT.prototype.clone=function(){return new WT(this.x,this.y,this.width,this.height)},WT.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},
WT.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},WT.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},
WT.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},WT.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),
n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},WT.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,
r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},WT.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,
t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},WT);function WT(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t)
,this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=OT.RECT}qT.prototype.clone=function(){return new qT(this.x,this.y,this.radius)},qT.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,
n=this.y-e;return(r*=r)+(n*=n)<=i},qT.prototype.getBounds=function(){return new zT(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)};function qT(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i
,this.type=OT.CIRC}KT.prototype.clone=function(){return new KT(this.x,this.y,this.width,this.height)},KT.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1
},KT.prototype.getBounds=function(){return new zT(this.x-this.width,this.y-this.height,this.width,this.height)};function KT(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,
this.type=OT.ELIP}ZT.prototype.clone=function(){var t=new ZT(this.points.slice());return t.closeStroke=this.closeStroke,t},ZT.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],
a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function ZT(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof AT){for(var r=[],n=0
,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=OT.POLY,this.closeStroke=!0}var JT,QT,$T,tE,eE,iE,rE,nE,sE,oE,aE,hE,uE,lE,cE,dE,pE,fE,mE,_E,yE,vE,gE,xE,bE,TE,EE,wE;AE.prototype.clone=function(){return new AE(this.x,this.y,
this.width,this.height,this.radius)},AE.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function AE(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=OT.RREC}(QT=JT=JT||{})[QT.WEBGL_LEGACY=0]="WEBGL_LEGACY",QT[QT.WEBGL=1]="WEBGL",QT[QT.WEBGL2=2]="WEBGL2",(tE=$T=$T||{})[tE.UNKNOWN=0]="UNKNOWN",
tE[tE.WEBGL=1]="WEBGL",tE[tE.CANVAS=2]="CANVAS",(iE=eE=eE||{})[iE.NORMAL=0]="NORMAL",iE[iE.ADD=1]="ADD",iE[iE.MULTIPLY=2]="MULTIPLY",iE[iE.SCREEN=3]="SCREEN",iE[iE.OVERLAY=4]="OVERLAY",iE[iE.DARKEN=5]="DARKEN",iE[iE.LIGHTEN=6]="LIGHTEN",
iE[iE.COLOR_DODGE=7]="COLOR_DODGE",iE[iE.COLOR_BURN=8]="COLOR_BURN",iE[iE.HARD_LIGHT=9]="HARD_LIGHT",iE[iE.SOFT_LIGHT=10]="SOFT_LIGHT",iE[iE.DIFFERENCE=11]="DIFFERENCE",iE[iE.EXCLUSION=12]="EXCLUSION",iE[iE.HUE=13]="HUE",iE[iE.SATURATION=14]="SATURATION",
iE[iE.COLOR=15]="COLOR",iE[iE.LUMINOSITY=16]="LUMINOSITY",iE[iE.NORMAL_NPM=17]="NORMAL_NPM",iE[iE.ADD_NPM=18]="ADD_NPM",iE[iE.SCREEN_NPM=19]="SCREEN_NPM",iE[iE.NONE=20]="NONE",iE[iE.SRC_OVER=0]="SRC_OVER",iE[iE.SRC_IN=21]="SRC_IN",
iE[iE.SRC_OUT=22]="SRC_OUT",iE[iE.SRC_ATOP=23]="SRC_ATOP",iE[iE.DST_OVER=24]="DST_OVER",iE[iE.DST_IN=25]="DST_IN",iE[iE.DST_OUT=26]="DST_OUT",iE[iE.DST_ATOP=27]="DST_ATOP",iE[iE.ERASE=26]="ERASE",iE[iE.SUBTRACT=28]="SUBTRACT",iE[iE.XOR=29]="XOR",(
nE=rE=rE||{})[nE.POINTS=0]="POINTS",nE[nE.LINES=1]="LINES",nE[nE.LINE_LOOP=2]="LINE_LOOP",nE[nE.LINE_STRIP=3]="LINE_STRIP",nE[nE.TRIANGLES=4]="TRIANGLES",nE[nE.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",nE[nE.TRIANGLE_FAN=6]="TRIANGLE_FAN",(oE=sE=sE||{}
)[oE.RGBA=6408]="RGBA",oE[oE.RGB=6407]="RGB",oE[oE.ALPHA=6406]="ALPHA",oE[oE.LUMINANCE=6409]="LUMINANCE",oE[oE.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",oE[oE.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",oE[oE.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(hE=aE=aE||{}
)[hE.TEXTURE_2D=3553]="TEXTURE_2D",hE[hE.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",hE[hE.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",hE[hE.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",
hE[hE.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",hE[hE.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",hE[hE.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",
hE[hE.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",hE[hE.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(lE=uE=uE||{})[lE.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",lE[lE.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",
lE[lE.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",lE[lE.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",lE[lE.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",lE[lE.FLOAT=5126]="FLOAT",lE[lE.HALF_FLOAT=36193]="HALF_FLOAT",(dE=cE=cE||{}
)[dE.NEAREST=0]="NEAREST",dE[dE.LINEAR=1]="LINEAR",(fE=pE=pE||{})[fE.CLAMP=33071]="CLAMP",fE[fE.REPEAT=10497]="REPEAT",fE[fE.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(_E=mE=mE||{})[_E.OFF=0]="OFF",_E[_E.POW2=1]="POW2",_E[_E.ON=2]="ON",(vE=yE=yE||{}
)[vE.NPM=0]="NPM",vE[vE.UNPACK=1]="UNPACK",vE[vE.PMA=2]="PMA",vE[vE.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",vE[vE.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",vE[vE.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(xE=gE=gE||{})[xE.AUTO=0]="AUTO",
xE[xE.MANUAL=1]="MANUAL",(TE=bE=bE||{}).LOW="lowp",TE.MEDIUM="mediump",TE.HIGH="highp",(wE=EE=EE||{})[wE.NONE=0]="NONE",wE[wE.SCISSOR=1]="SCISSOR",wE[wE.STENCIL=2]="STENCIL",wE[wE.SPRITE=3]="SPRITE",wT.RETINA_PREFIX=/@([0-9\.]+)x/;var SE,IE=!(
wT.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),CE="5.2.0";var OE=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[eE.NORMAL_NPM]=eE.NORMAL,t[eE.ADD_NPM]=eE.ADD,t[eE.SCREEN_NPM]=eE.SCREEN,e[eE.NORMAL]=eE.NORMAL_NPM,e[eE.ADD]=eE.ADD_NPM,
e[eE.SCREEN]=eE.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function RE(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var PE=0;function ME(){return++PE}function NE(t){return t+=0===t,--t
,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function LE(t){return!(t&t-1||!t)}function FE(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var DE={},UE=Object.create(null),
BE=Object.create(null);function kE(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||wT.RESOLUTION,this.resize(t,e)}var XE={width:{configurable:!0},height:{configurable:!0}}
;kE.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},kE.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},
kE.prototype.destroy=function(){this.context=null,this.canvas=null},XE.width.get=function(){return this.canvas.width},XE.width.set=function(t){this.canvas.width=t},XE.height.get=function(){return this.canvas.height},XE.height.set=function(t){
this.canvas.height=t},Object.defineProperties(kE.prototype,XE);var GE;function VE(t,e){var i=wT.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var jE={};wT.SORTABLE_CHILDREN=!1;function HE(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,
this.maxY=-1/0,this.rect=null}HE.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},HE.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},HE.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?zT.EMPTY:((t=t||new zT(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},HE.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(
this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},HE.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},HE.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(
t.worldTransform,e,i,r,n)},HE.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(
_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},HE.prototype.addVertexData=function(t,e
,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},HE.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(
t.worldTransform,e,i,r)},HE.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c
;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},HE.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,
this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},HE.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(
i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},HE.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},
HE.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY
;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},HE.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},HE.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,
e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var YE=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new HT,
this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new HE,this._boundsID=0,this._lastBoundsID=-1,
this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{
configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},
mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},
e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)
):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,
this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new zT),e=this._boundsRect),this._bounds.getRectangle(e)},
n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new zT),t=this._localBoundsRect);var r=this.getBounds(!1,t)
;return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error(
"setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0)
,void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),
this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,
this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){
return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){
return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},
e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*MT},e.angle.set=function(t){
this.transform.rotation=t*NT},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},
e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},
Object.defineProperties(n.prototype,e),n}(X.a);function zE(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}YE.prototype.displayObjectUpdateTransform=YE.prototype.updateTransform;var WE=function(n){function t(){
n.call(this),this.children=[],this.sortableChildren=wT.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t
).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,
this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);RE(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,RE(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,RE(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(zE),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(YE);WE.prototype.containerUpdateTransform=WE.prototype.updateTransform;var qE,KE,ZE=(JE.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,
u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},JE.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,
this.items=this.items.slice(0))},JE.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},JE.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(
this.ensureNonAliasedItems(),this.items.splice(e,1)),this},JE.prototype.contains=function(t){return-1!==this.items.indexOf(t)},JE.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},JE.prototype.destroy=function(){
this.removeAll(),this.items=null,this._name=null},Object.defineProperty(JE.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(JE.prototype,"name",{get:function(){return this._name},
enumerable:!0,configurable:!0}),JE);function JE(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(ZE.prototype,{dispatch:{value:ZE.prototype.emit},run:{value:ZE.prototype.emit}}),wT.TARGET_FPMS=.06,(KE=qE=qE||{}
)[KE.INTERACTION=50]="INTERACTION",KE[KE.HIGH=25]="HIGH",KE[KE.NORMAL=0]="NORMAL",KE[KE.LOW=-25]="LOW",KE[KE.UTILITY=-50]="UTILITY";var QE=($E.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},
$E.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},$E.prototype.connect=function(t){(this.previous=t).next&&(
t.next.previous=this),this.next=t.next,t.next=this},$E.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous)
;var e=this.next;return this.next=t?null:e,this.previous=null,e},$E);function $E(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}
var tw=(ew.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},ew.prototype._cancelIfNeeded=function(){
null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},ew.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},ew.prototype.add=function(t,e,i){return void 0===i&&(
i=qE.NORMAL),this._addListener(new QE(t,e,i))},ew.prototype.addOnce=function(t,e,i){return void 0===i&&(i=qE.NORMAL),this._addListener(new QE(t,e,i,!0))},ew.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(
t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},ew.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next
;return this._head.next||this._cancelIfNeeded(),this},ew.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},ew.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},
ew.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},ew.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((
e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,
this.deltaTime=this.deltaMS*wT.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(ew.prototype,"FPS",{get:function(
){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(ew.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,wT.TARGET_FPMS)
;this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(ew.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(ew,"shared",{get:function(){if(!ew._shared){var t=ew._shared=new ew;t.autoStart=!0,t._protected=!0}return ew._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(ew,"system",{get:function(){if(!ew._system){var t=ew._system=new ew;t.autoStart=!0,t._protected=!0}return ew._system},enumerable:!0,configurable:!0}),ew);function ew(){var e=this;this._head=new QE(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/wT.TARGET_FPMS,this.elapsedMS=1/wT.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}iw.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,qE.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?tw.shared:new tw,t.autoStart&&this.start()},iw.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function iw(){}function rw(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,
this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ZE("setRealSize",2),this.onUpdate=new ZE("update"),this.onError=new ZE("onError",1)}var nw={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}}
;rw.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},rw.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),
this.onError.remove(t)},rw.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},nw.valid.get=function(){return!!this._width&&!!this._height},rw.prototype.update=function(){
this.destroyed||this.onUpdate.run()},rw.prototype.load=function(){return Promise.resolve()},nw.width.get=function(){return this._width},nw.height.get=function(){return this._height},rw.prototype.upload=function(t,e,i){return!1},
rw.prototype.style=function(t,e,i){return!1},rw.prototype.dispose=function(){},rw.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,
this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(rw.prototype,nw);var sw=function(r){function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,
this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:")
)return"";e=e||window.location,(GE=GE||document.createElement("a")).href=t;var i=!(t=H.a.parse(GE.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(
t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===yE.UNPACK),
this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){
var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(rw),
ow=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,
this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==e.createBitmap?e.createBitmap:wT.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(
this.createBitmap=t),this._load||(this._load=new Promise(function(t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e(
):(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(
this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===yE.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process
):Promise.resolve(this)},t.prototype.upload=function(t,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(
o.prototype.upload.call(this,t,e,i,this.bitmap),!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},
t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(sw),aw=[];function hw(t,e){if(!t)return null;var i=""
;if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=aw.length-1;0<=n;--n){var s=aw[n];if(s.test&&s.test(t,i))return new s(t,e)}return new ow(t,e)}var uw=function(s){function t(t,e){var i=e||{},r=i.width,
n=i.height;if(!r||!n)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl
;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===yE.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,
i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(rw),lw={scaleMode:cE.NEAREST,
format:sE.RGBA,alphaMode:yE.NPM},cw=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target
,d=e.resolution,p=e.resourceOptions;!t||t instanceof rw||((t=hw(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||wT.RESOLUTION,this.mipmap=void 0!==r?r:wT.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:wT.ANISOTROPIC_LEVEL,
this.wrapMode=h||wT.WRAP_MODE,this.scaleMode=void 0!==s?s:wT.SCALE_MODE,this.format=u||sE.RGBA,this.type=l||uE.UNSIGNED_BYTE,this.target=c||aE.TEXTURE_2D,this.alphaMode=void 0!==i?i:yE.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=ME(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=LE(this.realWidth
)&&LE(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BE[this.cacheId],delete UE[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=wT.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+ME()),t._pixiId);var s=BE[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new uw(t,{width:e,height:i}),
s=t instanceof Float32Array?uE.FLOAT:uE.UNSIGNED_BYTE;return new o(n,Object.assign(lw,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),BE[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),BE[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=BE[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete BE[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete BE[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);cw._globalBatch=0;var dw=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new cw;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(hw(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=aE.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(rw),
pw=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(sw),
fw=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=aE.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=aE.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(dw);fw.SIDES=6;var mw=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+ME(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(sw)
;mw.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var _w=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=tw.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(tw.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(tw.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&tw.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(tw.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(tw.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(sw);_w.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var yw=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(sw);aw.push(ow,yw,pw,_w,mw,uw,fw,dw);function vw(t){this.renderer=t}
vw.prototype.destroy=function(){this.renderer=null};function gw(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new ZE("disposeFramebuffer",2)}var xw=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===yE.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(uw),bw={colorTexture:{configurable:!0}};bw.colorTexture.get=function(){return this.colorTextures[0]},gw.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new cw(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},gw.prototype.addDepthTexture=function(t){return this.depthTexture=t||new cw(new xw(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:sE.DEPTH_COMPONENT,type:uE.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},gw.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},gw.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},gw.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},gw.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(gw.prototype,bw);function Tw(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var Ew=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new gw(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(cw);Tw.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=jT.add(i,jT.NW),this.x0=a+s*jT.uX(i),this.y0=h+o*jT.uY(i),i=jT.add(i,2),this.x1=a+s*jT.uX(i),this.y1=h+o*jT.uY(i),i=jT.add(i,2),this.x2=a+s*jT.uX(i),this.y2=h+o*jT.uY(i),i=jT.add(i,2),
this.x3=a+s*jT.uX(i),this.y3=h+o*jT.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var ww=new Tw,Aw=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new zT(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=ww,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new AT(s.x,s.y):new AT(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&UE[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===ww&&(this._uvs=new Tw),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=wT.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+ME()),t._pixiId);var s=UE[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=VE(t)),(s=new a(new cw(t,e))).baseTexture.cacheId=n,
cw.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(cw.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new ow(t);r.url=e;var n=new a(new cw(r,{scaleMode:wT.SCALE_MODE,resolution:VE(e)}));return i=i||e,
cw.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(cw.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),UE[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),UE[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=UE[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete UE[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)UE[t.textureCacheIds[r]]===t&&delete UE[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function Sw(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Aw.EMPTY=new Aw(new cw),Sw(Aw.EMPTY),Sw(Aw.EMPTY.baseTexture),Aw.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Aw(new cw(new pw(t)))}(),Sw(Aw.WHITE),Sw(Aw.WHITE.baseTexture);function Iw(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var Cw=function(a){function n(t,e){var i=null;if(!(t instanceof Ew)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new Ew({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new Ew(t))},n}(Aw);Iw.prototype.createTexture=function(t,e){var i=new Ew(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Cw(i)},
Iw.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=Iw.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=NE(t)))<<16|65535&(e=NE(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},Iw.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
Iw.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},Iw.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Iw.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},Iw.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Iw.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Iw.SCREEN_KEY="screen";function Ow(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}Ow.prototype.destroy=function(){this.buffer=null},Ow.from=function(t,e,i,r,n){return new Ow(t,e,i,r,n)};function Rw(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=Pw++,this.disposeRunner=new ZE("disposeBuffer",2)}var Pw=0;function Mw(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Rw.prototype.update=function(t){this.data=t||this.data,this._updateID++},Rw.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Rw.prototype.destroy=function(){this.dispose(),this.data=null},Rw.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Rw(t)};var Nw={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Lw(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Dw++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ZE("disposeGeometry",2),this.refCount=0}var Fw={5126:4,5123:2,5121:1},Dw=0,Uw={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};Lw.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Rw(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Ow(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},Lw.prototype.getAttribute=function(t){return this.attributes[t]},Lw.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},Lw.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Rw(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
Lw.prototype.getIndex=function(){return this.indexBuffer},Lw.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Rw;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Fw[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Mw(c)
;n[d]||(n[d]=new Nw[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Lw.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Lw.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},Lw.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Lw.prototype.clone=function(){for(var t=new Lw,e=0;e<this.buffers.length;e++)t.buffers[e]=new Rw(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new Ow(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},Lw.merge=function(t){for(var e,i=new Lw,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(Uw[Mw(e.buffers[h].data)])(n[h]),i.buffers[h]=new Rw(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Fw[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function Bw(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=Gw++,this.static=!!e}var kw=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Lw),
Xw=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Rw(this.vertices),this.uvBuffer=new Rw(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Lw),Gw=0
;Bw.prototype.update=function(){this.dirtyId++},Bw.prototype.add=function(t,e,i){this.uniforms[t]=new Bw(e,i)},Bw.from=function(t,e){return new Bw(t,e)};function Vw(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new zT,this.destinationFrame=new zT,this.filters=[]}Vw.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function jw(t){this.renderer=t}var Hw=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new Iw,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new kw,this.quadUv=new Xw,this.tempRect=new zT,this.activeState={},this.globalUniforms=new Bw({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Vw,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(rE.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(rE.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
LT.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(vw);jw.prototype.flush=function(){},jw.prototype.destroy=function(){this.renderer=null},jw.prototype.start=function(){},jw.prototype.stop=function(){this.flush()},jw.prototype.render=function(t){};var Yw=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new jw(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(vw);wT.PREFER_ENV=u.a.any?JT.WEBGL:JT.WEBGL2,wT.STRICT_TEXTURE_CACHE=!1
;function zw(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function Ww(t){this.type=EE.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var qw=0,Kw=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=qw++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=qw++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(wT.PREFER_ENV>=JT.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(vw),Zw=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new gw(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new zT,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;wT.PREFER_ENV===JT.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new zT},Object.defineProperties(t.prototype,i),t}(vw),Jw={5126:4,5123:2,5121:1},
Qw=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;wT.PREFER_ENV===JT.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Jw[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Jw[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Jw[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new zw(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(vw);function $w(t,e,i,r){var n=tA(t,t.VERTEX_SHADER,e),s=tA(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function tA(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function eA(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return iA(2*e)
;case"bvec3":return iA(3*e);case"bvec4":return iA(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function iA(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}Ww.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=EE.NONE,this.autoDetect=!0),this._target=null},Ww.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var rA,nA={},sA=nA;function oA(){if(sA===nA||sA&&sA.isContextLost()){
var t,e=document.createElement("canvas");wT.PREFER_ENV>=JT.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),sA=t}return sA}function aA(t,e,i){if(
"precision"===t.substring(0,9))return i!==bE.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===bE.HIGH&&i!==bE.HIGH&&(r=bE.MEDIUM),"precision "+r+" float;\n"+t}var hA={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var uA=null,lA={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function cA(t,e){if(!uA){var i=Object.keys(lA)
;uA={};for(var r=0;r<i.length;++r){var n=i[r];uA[t[n]]=lA[n]}}return uA[e]}var dA={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},pA={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var fA,mA=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function _A(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function yA(t,e,i){void 0===i&&(i="pixi-shader"),this.id=vA++,this.vertexSrc=t||yA.defaultVertexSrc,
this.fragmentSrc=e||yA.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),gA[i]?(gA[i]++,i+="-"+gA[i]):gA[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=aA(this.vertexSrc,wT.PRECISION_VERTEX,bE.HIGH),this.fragmentSrc=aA(this.fragmentSrc,wT.PRECISION_FRAGMENT,function(
){if(!rA){rA=bE.MEDIUM;var t=oA();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);rA=e.precision?bE.HIGH:bE.MEDIUM}}return rA}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var vA=0,gA={},xA={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};yA.prototype.extractData=function(t,e){var i=oA();if(i){var r=$w(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},yA.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=cA(e,a.type),u={type:h,name:a.name,size:(i=h,hA[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
yA.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=cA(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:eA(h,s.size)}}return i},xA.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},xA.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},yA.from=function(t,e,i){var r=t+e,n=DE[r];return n||(DE[r]=n=new yA(t
,e,i)),n},Object.defineProperties(yA,xA);function bA(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof Bw?e:new Bw(e):new Bw({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var TA={uniforms:{configurable:!0}};bA.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
bA.prototype.destroy=function(){this.uniformGroup=null},TA.uniforms.get=function(){return this.uniformGroup.uniforms},bA.from=function(t,e,i){var r=yA.from(t,e);return new bA(r,i)},Object.defineProperties(bA.prototype,TA);function EA(){this.data=0,
this.blendMode=eE.NORMAL,this.polygonOffset=0,this.blend=!0}var wA={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};wA.blend.get=function(){return!!(1&this.data)},wA.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},wA.offsets.get=function(){return!!(2&this.data)},wA.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
wA.culling.get=function(){return!!(4&this.data)},wA.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},wA.depthTest.get=function(){return!!(8&this.data)},wA.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
wA.clockwiseFrontFace.get=function(){return!!(16&this.data)},wA.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},wA.blendMode.get=function(){return this._blendMode},wA.blendMode.set=function(t){this.blend=t!==eE.NONE,
this._blendMode=t},wA.polygonOffset.get=function(){return this._polygonOffset},wA.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},EA.for2d=function(){var t=new EA;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
EA.prototype,wA);var AA=function(n){function s(t,e,i){var r=yA.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=wT.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new EA}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(bA);AA.SOURCE_KEY_MAP={};function SA(t,e){this._texture=t,this.mapCoord=new LT,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var IA=new LT,CA={texture:{configurable:!0}};CA.texture.get=function(){return this._texture},CA.texture.set=function(t){this._texture=t,this._updateID=-1},SA.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},SA.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(IA.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(IA));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(SA.prototype,CA);function OA(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var RA=function(i){
function t(t){var e=new LT;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new SA(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(AA),PA=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new Ww;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case EE.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case EE.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case EE.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case EE.SCISSOR:this.renderer.scissor.pop();break;case EE.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case EE.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=EE.SPRITE;else if(t.type=EE.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=EE.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new RA(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(vw),MA=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(vw),NA=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(MA),LA=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(MA),FA=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new LT,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(vw),DA=new zT,UA=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new zT,this.destinationFrame=new zT}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(DA.width=s.realWidth,DA.height=s.realHeight,i=DA),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
DA.width=n.width,DA.height=n.height,i=DA),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(vw)
;OA.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var BA=0,kA=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=BA++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof fA)return fA;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;fA=!0===t({a:"b"},"a","b")}catch(t){fA=!1}return fA}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?dA:pA)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=$w(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:eA(h.type,h.size)}}var u=new OA(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(vw);function XA(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var GA=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=eE.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new EA,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[eE.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.ADD]=[t.ONE,t.ONE],e[eE.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[eE.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[eE.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[eE.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.NONE]=[0,0],e[eE.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[eE.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[eE.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[eE.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[eE.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[eE.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[eE.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[eE.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[eE.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[eE.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[eE.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(vw),VA=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=wT.GC_MAX_IDLE,
this.checkCountMax=wT.GC_MAX_CHECK_COUNT,this.mode=wT.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==gE.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(vw),jA=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new cw}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new XA(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new XA(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new XA(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===uE.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&RE(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==mE.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=pE.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===cE.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(vw),HA=new LT,YA=function(i){function r(t){void 0===t&&(t={}),i.call(this,"WebGL",t),t=this.options,this.type=$T.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new ZE("destroy"),contextChange:new ZE("contextChange",1),reset:new ZE("reset"
),update:new ZE("update"),postrender:new ZE("postrender"),prerender:new ZE("prerender"),resize:new ZE("resize",2)},this.globalUniforms=new Bw({projectionMatrix:new LT},!0),this.addSystem(PA,"mask").addSystem(Kw,"context").addSystem(GA,"state").addSystem(
kA,"shader").addSystem(jA,"texture").addSystem(Qw,"geometry").addSystem(Zw,"framebuffer").addSystem(NA,"scissor").addSystem(LA,"stencil").addSystem(FA,"projection").addSystem(VA,"textureGC").addSystem(Hw,"filter").addSystem(UA,"renderTexture").addSystem(
Yw,"batch"),this.initPlugins(r.__plugins),t.context?this.context.initFromContext(t.context):this.context.initFromOptions({alpha:this.transparent,antialias:t.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,
preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,function(t){if(!IE){if(-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var e=[
"\n %c %c %c PixiJS "+CE+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;",
"background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;",
"color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("PixiJS "+CE+" - "+t+" - http://www.pixijs.com/");IE=!0}}(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(
this.options.width,this.options.height)}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)).constructor=r).create=function(t){if(void 0===SE&&(SE=function(){var t={stencil:!0,
failIfMajorPerformanceCaveat:wT.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!i||!i.getContextAttributes(
).stencil);if(i){var n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,r}catch(t){return!1}}()),SE)return new r(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},
r.prototype.addSystem=function(t,e){e=e||t.name;var i=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=i,this.runners)this.runners[r].add(i);return this},r.prototype.render=function(t,e,i,r,n){if(
this.renderingToScreen=!e,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(e||(this._lastObjectRendered=t),!n){var s=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=s}
this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.run(),
this.projection.transform=null,this.emit("postrender")}},r.prototype.resize=function(t,e){i.prototype.resize.call(this,t,e),this.runners.resize.run(t,e)},r.prototype.reset=function(){return this.runners.reset.run(),this},r.prototype.clear=function(){
this.framebuffer.bind(),this.framebuffer.clear()},r.prototype.destroy=function(t){for(var e in this.runners.destroy.run(),this.runners)this.runners[e].destroy();i.prototype.destroy.call(this,t),this.gl=null},r.registerPlugin=function(t,e){(
r.__plugins=r.__plugins||{})[t]=e},r}(function(i){function t(t,e){i.call(this),(e=Object.assign({},wT.RENDER_OPTIONS,e)).roundPixels&&(wT.ROUND_PIXELS=e.roundPixels,function(t,e,i){if(void 0===i&&(i=3),!jE[e]){var r=(new Error).stack
;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6",
"font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),jE[e]=!0}}("5.0.0",
"Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=e,this.type=$T.UNKNOWN,this.screen=new zT(0,0,e.width,e.height),this.view=e.view||document.createElement("canvas"),
this.resolution=e.resolution||wT.RESOLUTION,this.transparent=e.transparent,this.autoDensity=e.autoDensity||e.autoResize||!1,this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.clearBeforeRender=e.clearBeforeRender,this._backgroundColor=0,
this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=e.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new WE,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}i&&(
t.__proto__=i);var e={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},
e.width.get=function(){return this.view.width},e.height.get=function(){return this.view.height},t.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,
this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},t.prototype.generateTexture=function(t,e,i,r){0===(r=r||t.getLocalBounds()).width&&(r.width=1),0===r.height&&(r.height=1);var n=Cw.create(0|r.width,0|r.height,e,i)
;return HA.tx=-r.x,HA.ty=-r.y,this.render(t,n,!1,HA,!!t.parent),n},t.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),
this.plugins=null,this.type=$T.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,
this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},e.backgroundColor.get=function(){return this._backgroundColor},e.backgroundColor.set=function(t){this._backgroundColor=t,
this._backgroundColorString=function(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)}(t),function(t,e){(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}(t,this._backgroundColorRgba)},Object.defineProperties(t.prototype,
e),t}(X.a));function zA(){this.texArray=null,this.blend=0,this.type=rE.TRIANGLES,this.start=0,this.size=0,this.data=null}function WA(){this.elements=[],this.ids=[],this.count=0}WA.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function qA(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var KA={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};KA.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},KA.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},KA.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},KA.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},KA.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},qA.prototype.view=function(t){
return this[t+"View"]},qA.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},qA.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(qA.prototype,KA);var ZA=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=EA.for2d(),this.size=4*wT.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;wT.PREFER_ENV===JT.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),wT.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=mA.replace(/%forloop%/gi,_A(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new zA);for(;e.length<r;)e.push(new WA);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++cw._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;cw._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=OE[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;wT.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),wT.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=NE(Math.ceil(t/8)),i=FE(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new qA(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=NE(Math.ceil(t/12)),i=FE(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(jw);ZA._drawCallPool=[],ZA._textureArrayPool=[];function JA(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}JA.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=Bw.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new yA(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new LT,default:this.defaultGroupCache[t]};return new bA(this.programCache[t],n)},
JA.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function QA(){}var $A=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Rw(null,t,!1),this._indexBuffer=new Rw(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,uE.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,uE.FLOAT).addAttribute("aColor",this._buffer,4,!0,uE.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,uE.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Lw),
tS="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,eS="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",iS={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};QA.create=function(t){var e=Object.assign({vertex:tS,fragment:eS,geometryClass:$A,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new JA(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(ZA)},iS.defaultVertexSrc.get=function(){return tS},iS.defaultFragmentTemplate.get=function(){
return eS},Object.defineProperties(QA,iS);function rS(e){var i=this;e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){return YA.create(t)}(e),this.stage=new WE,rS._plugins.forEach(function(t){t.init.call(i,e)})}QA.create();var nS={view:{
configurable:!0},screen:{configurable:!0}};rS.registerPlugin=function(t){rS._plugins.push(t)},rS.prototype.render=function(){this.renderer.render(this.stage)},nS.view.get=function(){return this.renderer.view},nS.screen.get=function(){
return this.renderer.screen},rS.prototype.destroy=function(t,e){var i=this,r=rS._plugins.slice(0);r.reverse(),r.forEach(function(t){t.destroy.call(i)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},
Object.defineProperties(rS.prototype,nS),rS._plugins=[];function sS(){}sS.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){window.removeEventListener("resize",this.resize),(this._resizeTo=t)&&(window.addEventListener(
"resize",this.resize),this.resize())},get:function(){return this._resizeTo}}),this.resize=function(){e._resizeTo&&(e._resizeTo===window?e.renderer.resize(window.innerWidth,window.innerHeight):e.renderer.resize(e._resizeTo.clientWidth,
e._resizeTo.clientHeight))},this._resizeTo=null,this.resizeTo=t.resizeTo||null},sS.destroy=function(){this.resizeTo=null,this.resize=null},rS.registerPlugin(sS);var oS,aS,hS=(uS.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length
)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},uS.prototype.ensureNonAliasedItems=function(){
0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},uS.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},uS.prototype.remove=function(t){
var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},uS.prototype.contains=function(t){return-1!==this.items.indexOf(t)},uS.prototype.removeAll=function(){return this.ensureNonAliasedItems(),
this.items.length=0,this},uS.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(uS.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(
uS.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),uS);function uS(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(hS.prototype,{dispatch:{value:hS.prototype.emit},run:{value:hS.prototype.emit}}
),kb.TARGET_FPMS=.06,(aS=oS=oS||{})[aS.INTERACTION=50]="INTERACTION",aS[aS.HIGH=25]="HIGH",aS[aS.NORMAL=0]="NORMAL",aS[aS.LOW=-25]="LOW",aS[aS.UTILITY=-50]="UTILITY";var lS=(cS.prototype.match=function(t,e){return void 0===e&&(e=null),
this.fn===t&&this.context===e},cS.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},cS.prototype.connect=function(t){(
this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},cS.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(
this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},cS);function cS(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,
this.previous=null,this._destroyed=!1}var dS=(pS.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},
pS.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},pS.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},
pS.prototype.add=function(t,e,i){return void 0===i&&(i=oS.NORMAL),this._addListener(new lS(t,e,i))},pS.prototype.addOnce=function(t,e,i){return void 0===i&&(i=oS.NORMAL),this._addListener(new lS(t,e,i,!0))},pS.prototype._addListener=function(t){
var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},pS.prototype.remove=function(t,e){for(var i=this._head.next;i;
)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},pS.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},pS.prototype.stop=function(){this.started&&(this.started=!1,
this._cancelIfNeeded())},pS.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},pS.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),
t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,
this.deltaTime=this.deltaMS*kb.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(pS.prototype,"FPS",{get:function(
){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(pS.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,kb.TARGET_FPMS)
;this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(pS.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(pS,"shared",{get:function(){if(!pS._shared){var t=pS._shared=new pS;t.autoStart=!0,t._protected=!0}return pS._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(pS,"system",{get:function(){if(!pS._system){var t=pS._system=new pS;t.autoStart=!0,t._protected=!0}return pS._system},enumerable:!0,configurable:!0}),pS);function pS(){var e=this;this._head=new lS(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/kb.TARGET_FPMS,this.elapsedMS=1/kb.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}var fS=(mS.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,
"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,oS.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},
this._ticker=null,this.ticker=t.sharedTicker?dS.shared:new dS,t.autoStart&&this.start()},mS.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},mS);function mS(){}var _S=(yS.prototype.clone=function(){return new yS(this.x
,this.y)},yS.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},yS.prototype.copyTo=function(t){return t.set(this.x,this.y),t},yS.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},yS.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},yS);function yS(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var vS=(gS.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new gS(t,e,this._x,this._y)},
gS.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},gS.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},gS.prototype.copyTo=function(t){return t.set(this._x,this._y),t},gS.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(gS.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(gS.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),gS);function gS(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var xS,bS,TS=2*Math.PI,ES=180/Math.PI,wS=Math.PI/180;(bS=xS=xS||{})[bS.POLY=0]="POLY",bS[bS.RECT=1]="RECT",bS[bS.CIRC=2]="CIRC",bS[bS.ELIP=3]="ELIP",
bS[bS.RREC=4]="RREC";var AS=(SS.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},SS.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
SS.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},SS.prototype.apply=function(t,e){e=e||new _S;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},SS.prototype.applyInverse=function(t,e){e=e||new _S;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},SS.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
SS.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},SS.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},SS.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},SS.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},SS.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},SS.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(TS-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},SS.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},SS.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},SS.prototype.clone=function(){
var t=new SS;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},SS.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},SS.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(SS,"IDENTITY",{get:function(){return new SS},enumerable:!0,configurable:!0}),Object.defineProperty(SS,"TEMP_MATRIX",{get:function(){return new SS},
enumerable:!0,configurable:!0}),SS);function SS(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var IS=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],CS=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],OS=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],RS=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],PS=[],MS=[],NS=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];PS.push(e);for(
var i=0;i<16;i++)for(var r=NS(IS[t]*IS[i]+OS[t]*CS[i]),n=NS(CS[t]*IS[i]+RS[t]*CS[i]),s=NS(IS[t]*OS[i]+OS[t]*RS[i]),o=NS(CS[t]*OS[i]+RS[t]*RS[i]),a=0;a<16;a++)if(IS[a]===r&&CS[a]===n&&OS[a]===s&&RS[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new AS
;h.set(IS[t],CS[t],OS[t],RS[t],0,0),MS.push(h)}}();var LS={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return IS[t]},uY:function(t){return CS[t]},vX:function(t){
return OS[t]},vY:function(t){return RS[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return PS[t][e]},sub:function(t,e){return PS[t][LS.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?LS.S:LS.N:2*Math.abs(e)<=Math.abs(t)?0<t?LS.E:LS.W:0<e?0<t?LS.SE:LS.SW:0<t?LS.NE:LS.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=MS[LS.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},FS=(DS.prototype.onChange=function(){this._localID++},DS.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},DS.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},DS.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},DS.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(DS.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),DS.IDENTITY=new DS,DS);function DS(){this.worldTransform=new AS,this.localTransform=new AS,this.position=new vS(this.onChange,
this,0,0),this.scale=new vS(this.onChange,this,1,1),this.pivot=new vS(this.onChange,this,0,0),this.skew=new vS(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var US=(Object.defineProperty(BS.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(BS.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(BS.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(BS.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(BS,"EMPTY"
,{get:function(){return new BS(0,0,0,0)},enumerable:!0,configurable:!0}),BS.prototype.clone=function(){return new BS(this.x,this.y,this.width,this.height)},BS.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},BS.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},BS.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},BS.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},BS.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},BS.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
BS.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},BS);function BS(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=xS.RECT}var kS=(XS.prototype.clone=function(){return new XS(this.x,this.y,this.radius)},
XS.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},XS.prototype.getBounds=function(){return new US(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},
XS);function XS(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=xS.CIRC}var GS=(VS.prototype.clone=function(){return new VS(this.x,this.y,this.width,this.height)},VS.prototype.contains=function(t,e){
if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},VS.prototype.getBounds=function(){return new US(this.x-this.width,this.y-this.height,this.width,this.height)},VS);function VS(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=xS.ELIP}var jS=(HS.prototype.clone=function(){var t=new HS(this.points.slice());return t.closeStroke=this.closeStroke,t},
HS.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i},HS);function HS(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof _S){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=xS.POLY,this.closeStroke=!0}var YS=(
zS.prototype.clone=function(){return new zS(this.x,this.y,this.width,this.height,this.radius)},zS.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1},zS);function zS(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=xS.RREC}kb.SORTABLE_CHILDREN=!1;function WS(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}WS.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},WS.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},WS.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?US.EMPTY:((
t=t||new US(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},WS.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},WS.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},WS.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
WS.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},WS.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},WS.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
WS.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},WS.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},WS.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},WS.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},WS.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},WS.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},WS.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var qS=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new FS,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new WS,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new US),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new US),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*ES},e.angle.set=function(t){this.transform.rotation=t*wS
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function KS(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}qS.prototype.displayObjectUpdateTransform=qS.prototype.updateTransform;var ZS=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=kb.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);iT(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,iT(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,iT(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(KS),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(qS);ZS.prototype.containerUpdateTransform=ZS.prototype.updateTransform;function JS(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new hS(
"setRealSize",2),this.onUpdate=new hS("update"),this.onError=new hS("onError",1)}var QS={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};JS.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},JS.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},JS.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},QS.valid.get=function(){return!!this._width&&!!this._height},JS.prototype.update=function(){this.destroyed||this.onUpdate.run()},JS.prototype.load=function(){return Promise.resolve()},
QS.width.get=function(){return this._width},QS.height.get=function(){return this._height},JS.prototype.upload=function(t,e,i){return!1},JS.prototype.style=function(t,e,i){return!1},JS.prototype.dispose=function(){},JS.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(JS.prototype,QS);var $S=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=xT(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight;return r=r||this.source,
n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Pb.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,
e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),
r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(JS),tI=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),
!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==e.createBitmap?e.createBitmap:kb.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,
this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(
o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,
i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),this._load},t.prototype.process=function(){var e=this
;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===Pb.UNPACK?"premultiply":"none"}
).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),
!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(
s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(
this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}($S),eI=[];function iI(t,e){if(!t)return null;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=eI.length-1;0<=n;--n){
var s=eI[n];if(s.test&&s.test(t,i))return new s(t,e)}return new tI(t,e)}var rI=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(
t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Pb.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(
e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){
return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(JS),nI={scaleMode:Ab.NEAREST,format:gb.RGBA,alphaMode:Pb.NPM},sI=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}
).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution,p=e.resourceOptions;!t||t instanceof JS||((t=iI(t,p)).internal=!0),this.width=o||0,this.height=a||0,
this.resolution=d||kb.RESOLUTION,this.mipmap=void 0!==r?r:kb.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:kb.ANISOTROPIC_LEVEL,this.wrapMode=h||kb.WRAP_MODE,this.scaleMode=void 0!==s?s:kb.SCALE_MODE,this.format=u||gb.RGBA,
this.type=l||Eb.UNSIGNED_BYTE,this.target=c||bb.TEXTURE_2D,this.alphaMode=void 0!==i?i:Pb.UNPACK,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.uid=nT(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),
this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(
o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}};return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(
this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){
return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,
this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=aT(this.realWidth)&&aT(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(
this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(
this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},
o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete cT[this.cacheId],
delete lT[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=kb.STRICT_TEXTURE_CACHE)
;var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+nT()),t._pixiId);var s=cT[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},
o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new rI(t,{width:e,height:i}),s=t instanceof Float32Array?Eb.FLOAT:Eb.UNSIGNED_BYTE;return new o(n,Object.assign(nI,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(
-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),cT[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),cT[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=cT[t];if(e){
var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete cT[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete cT[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},
Object.defineProperties(o.prototype,t),o}(X.a);sI._globalBatch=0;var oI=function(a){function t(t,e){var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new sI
;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(var o=0;o<r;o++)this.addResourceAt(iI(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(
var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds")
;return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=bb.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},
t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}
),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,
s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,
h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(JS),aI=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){
var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}($S),hI=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(
var i=0;i<o.SIDES;i++)this.items[i].target=bb.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load()}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),
t.target=bb.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(oI);hI.SIDES=6;var uI=function(i){
function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,
this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){
e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),
this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin),o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error(
"The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i
),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+nT(),n.getContext("2d").drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3]
)),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64"
)||"string"==typeof t&&0===t.indexOf("<svg")},r}($S);uI.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var lI=function(l){function i(t,e){if(e=e||{},!(
t instanceof HTMLVideoElement)){var i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(
var r=0;r<t.length;++r){var n=document.createElement("source"),s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,
this._autoUpdate=!0,this._isAutoUpdating=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),
!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l);var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){
var e=dS.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0
)}},i.prototype.load=function(){var e=this;if(this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(
this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),
this._load=new Promise(function(t){e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){
var t=this.source;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(dS.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(dS.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&dS.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(dS.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(dS.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}($S);lI.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var cI=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}($S);eI.push(tI,cI,aI,lI,uI,rI,hI,oI);function dI(t){this.renderer=t}var pI={
INSTALLED:eI,autoDetectResource:iI,ArrayResource:oI,BufferResource:rI,CanvasResource:aI,CubeResource:hI,ImageResource:tI,ImageBitmapResource:cI,SVGResource:uI,VideoResource:lI,Resource:JS,BaseImageResource:$S};dI.prototype.destroy=function(){
this.renderer=null};function fI(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},
this.disposeRunner=new hS("disposeFramebuffer",2)}var mI=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){var r=t.gl
;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Pb.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,
r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(rI),_I={colorTexture:{configurable:!0}};_I.colorTexture.get=function(){return this.colorTextures[0]},fI.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new sI(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},fI.prototype.addDepthTexture=function(t){return this.depthTexture=t||new sI(new mI(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:gb.DEPTH_COMPONENT,type:Eb.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},fI.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},fI.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},fI.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},fI.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(fI.prototype,_I);function yI(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var vI=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new fI(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(sI);yI.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=LS.add(i,LS.NW),this.x0=a+s*LS.uX(i),this.y0=h+o*LS.uY(i),i=LS.add(i,2),this.x1=a+s*LS.uX(i),this.y1=h+o*LS.uY(i),i=LS.add(i,2),this.x2=a+s*LS.uX(i),this.y2=h+o*LS.uY(i),i=LS.add(i,2),
this.x3=a+s*LS.uX(i),this.y3=h+o*LS.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var gI=new yI,xI=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new US(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=gI,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new _S(s.x,s.y):new _S(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&lT[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===gI&&(this._uvs=new yI),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=kb.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+nT()),t._pixiId);var s=lT[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=bT(t)),(s=new a(new sI(t,e))).baseTexture.cacheId=n,
sI.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(sI.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new tI(t);r.url=e;var n=new a(new sI(r,{scaleMode:kb.SCALE_MODE,resolution:bT(e)}));return i=i||e,
sI.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(sI.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),lT[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),lT[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=lT[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete lT[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)lT[t.textureCacheIds[r]]===t&&delete lT[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function bI(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}xI.EMPTY=new xI(new sI),bI(xI.EMPTY),bI(xI.EMPTY.baseTexture),xI.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new xI(new sI(new aI(t)))}(),bI(xI.WHITE),bI(xI.WHITE.baseTexture);function TI(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var EI=function(a){function n(t,e){var i=null;if(!(t instanceof vI)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new vI({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new vI(t))},n}(xI);TI.prototype.createTexture=function(t,e){var i=new vI(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new EI(i)},
TI.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=TI.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=oT(t)))<<16|65535&(e=oT(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},TI.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
TI.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},TI.prototype.returnFilterTexture=function(t){this.returnTexture(t)},TI.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},TI.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=TI.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},TI.SCREEN_KEY="screen";function wI(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}wI.prototype.destroy=function(){this.buffer=null},wI.from=function(t,e,i,r,n){return new wI(t,e,i,r,n)};function AI(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=SI++,this.disposeRunner=new hS("disposeBuffer",2)}var SI=0;function II(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}AI.prototype.update=function(t){this.data=t||this.data,this._updateID++},AI.prototype.dispose=function(){this.disposeRunner.run(this,!1)},AI.prototype.destroy=function(){this.dispose(),this.data=null},AI.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new AI(t)};var CI={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function OI(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=PI++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new hS("disposeGeometry",2),this.refCount=0}var RI={5126:4,5123:2,5121:1},PI=0,MI={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};OI.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new AI(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new wI(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},OI.prototype.getAttribute=function(t){return this.attributes[t]},OI.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},OI.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new AI(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
OI.prototype.getIndex=function(){return this.indexBuffer},OI.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new AI;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*RI[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=II(c)
;n[d]||(n[d]=new CI[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},OI.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},OI.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},OI.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},OI.prototype.clone=function(){for(var t=new OI,e=0;e<this.buffers.length;e++)t.buffers[e]=new AI(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new wI(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},OI.merge=function(t){for(var e,i=new OI,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(MI[II(e.buffers[h].data)])(n[h]),i.buffers[h]=new AI(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*RI[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function NI(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=DI++,this.static=!!e}var LI=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(OI),
FI=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new AI(this.vertices),this.uvBuffer=new AI(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(OI),DI=0
;NI.prototype.update=function(){this.dirtyId++},NI.prototype.add=function(t,e,i){this.uniforms[t]=new NI(e,i)},NI.from=function(t,e){return new NI(t,e)};function UI(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new US,this.destinationFrame=new US,this.filters=[]}UI.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function BI(t){this.renderer=t}var kI=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new TI,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new LI,this.quadUv=new FI,this.tempRect=new US,this.activeState={},this.globalUniforms=new NI({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new UI,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(yb.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(yb.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
AS.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(dI);BI.prototype.flush=function(){},BI.prototype.destroy=function(){this.renderer=null},BI.prototype.start=function(){},BI.prototype.stop=function(){this.flush()},BI.prototype.render=function(t){};var XI=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new BI(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(dI);kb.PREFER_ENV=u.a.any?cb.WEBGL:cb.WEBGL2,kb.STRICT_TEXTURE_CACHE=!1
;function GI(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function VI(t){this.type=Ub.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var jI=0,HI=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=jI++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=jI++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(kb.PREFER_ENV>=cb.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(dI),YI=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new fI(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new US,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;kb.PREFER_ENV===cb.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new US},Object.defineProperties(t.prototype,i),t}(dI),zI={5126:4,5123:2,5121:1},
WI=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;kb.PREFER_ENV===cb.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*zI[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*zI[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*zI[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new GI(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(dI);function qI(t,e,i,r){var n=KI(t,t.VERTEX_SHADER,e),s=KI(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function KI(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function ZI(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return JI(2*e)
;case"bvec3":return JI(3*e);case"bvec4":return JI(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function JI(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}VI.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Ub.NONE,this.autoDetect=!0),this._target=null},VI.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var QI,$I={},tC=$I;function eC(){if(tC===$I||tC&&tC.isContextLost()){
var t,e=document.createElement("canvas");kb.PREFER_ENV>=cb.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),tC=t}return tC}function iC(t,e,i){if(
"precision"===t.substring(0,9))return i!==Fb.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===Fb.HIGH&&i!==Fb.HIGH&&(r=Fb.MEDIUM),"precision "+r+" float;\n"+t}var rC={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var nC=null,sC={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function oC(t,e){if(!nC){var i=Object.keys(sC)
;nC={};for(var r=0;r<i.length;++r){var n=i[r];nC[t[n]]=sC[n]}}return nC[e]}var aC={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},hC={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var uC,lC=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function cC(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=lC.replace(/%forloop%/gi,dC(t));if(e.shaderSource(i
,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t}function dC(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function pC(t,e,i){void 0===i&&(i="pixi-shader"),this.id=fC++,
this.vertexSrc=t||pC.defaultVertexSrc,this.fragmentSrc=e||pC.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),mC[i]?(mC[i]++,i+="-"+mC[i]
):mC[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=iC(this.vertexSrc,kb.PRECISION_VERTEX,Fb.HIGH),this.fragmentSrc=iC(this.fragmentSrc,kb.PRECISION_FRAGMENT,
function(){if(!QI){QI=Fb.MEDIUM;var t=eC();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);QI=e.precision?Fb.HIGH:Fb.MEDIUM}}return QI}())),this.extractData(this.vertexSrc,this.fragmentSrc),
this.glPrograms={},this.syncUniforms=null}var fC=0,mC={},_C={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};pC.prototype.extractData=function(t,e){var i=eC();if(i){var r=qI(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},pC.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=oC(e,a.type),u={type:h,name:a.name,size:(i=h,rC[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
pC.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=oC(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:ZI(h,s.size)}}return i},_C.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},_C.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},pC.from=function(t,e,i){var r=t+e,n=uT[r];return n||(uT[r]=n=new pC(t
,e,i)),n},Object.defineProperties(pC,_C);function yC(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof NI?e:new NI(e):new NI({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var vC={uniforms:{configurable:!0}};yC.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
yC.prototype.destroy=function(){this.uniformGroup=null},vC.uniforms.get=function(){return this.uniformGroup.uniforms},yC.from=function(t,e,i){var r=pC.from(t,e);return new yC(r,i)},Object.defineProperties(yC.prototype,vC);function gC(){this.data=0,
this.blendMode=mb.NORMAL,this.polygonOffset=0,this.blend=!0}var xC={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};xC.blend.get=function(){return!!(1&this.data)},xC.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},xC.offsets.get=function(){return!!(2&this.data)},xC.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
xC.culling.get=function(){return!!(4&this.data)},xC.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},xC.depthTest.get=function(){return!!(8&this.data)},xC.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
xC.clockwiseFrontFace.get=function(){return!!(16&this.data)},xC.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},xC.blendMode.get=function(){return this._blendMode},xC.blendMode.set=function(t){this.blend=t!==mb.NONE,
this._blendMode=t},xC.polygonOffset.get=function(){return this._polygonOffset},xC.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},gC.for2d=function(){var t=new gC;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
gC.prototype,xC);var bC=function(n){function s(t,e,i){var r=pC.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=kb.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new gC}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(yC);bC.SOURCE_KEY_MAP={};function TC(t,e){this._texture=t,this.mapCoord=new AS,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var EC=new AS,wC={texture:{configurable:!0}};wC.texture.get=function(){return this._texture},wC.texture.set=function(t){this._texture=t,this._updateID=-1},TC.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},TC.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(EC.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(EC));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(TC.prototype,wC);function AC(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var SC=function(i){
function t(t){var e=new AS;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new TC(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(bC),IC=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new VI;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case Ub.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case Ub.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case Ub.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Ub.SCISSOR:this.renderer.scissor.pop();break;case Ub.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Ub.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Ub.SPRITE;else if(t.type=Ub.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=Ub.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new SC(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(dI),CC=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(dI),OC=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(CC),RC=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(CC),PC=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new AS,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(dI),MC=new US,NC=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new US,this.destinationFrame=new US}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(MC.width=s.realWidth,MC.height=s.realHeight,i=MC),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
MC.width=n.width,MC.height=n.height,i=MC),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(dI)
;AC.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var LC=0,FC=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=LC++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof uC)return uC;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;uC=!0===t({a:"b"},"a","b")}catch(t){uC=!1}return uC}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?aC:hC)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=qI(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:ZI(h.type,h.size)}}var u=new AC(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(dI);function DC(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var UC=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=mb.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new gC,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[mb.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.ADD]=[t.ONE,t.ONE],e[mb.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[mb.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[mb.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[mb.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.NONE]=[0,0],e[mb.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[mb.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[mb.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[mb.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[mb.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[mb.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[mb.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[mb.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[mb.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[mb.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[mb.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(dI),BC=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=kb.GC_MAX_IDLE,
this.checkCountMax=kb.GC_MAX_CHECK_COUNT,this.mode=kb.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Nb.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(dI),kC=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new sI}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new DC(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new DC(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new DC(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===Eb.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&iT(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==Ob.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Ib.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===Ab.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(dI),XC={FilterSystem:kI,BatchSystem:XI,ContextSystem:HI,FramebufferSystem:YI,GeometrySystem:WI,MaskSystem:IC,ScissorSystem:OC,StencilSystem:RC,ProjectionSystem:PC,RenderTextureSystem:NC,ShaderSystem:FC,StateSystem:UC,TextureGCSystem:BC,TextureSystem:kC
},GC=new AS,VC=function(i){function t(t,e){i.call(this),(e=Object.assign({},kb.RENDER_OPTIONS,e)).roundPixels&&(kb.ROUND_PIXELS=e.roundPixels,ET("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=e,
this.type=pb.UNKNOWN,this.screen=new US(0,0,e.width,e.height),this.view=e.view||document.createElement("canvas"),this.resolution=e.resolution||kb.RESOLUTION,this.transparent=e.transparent,this.autoDensity=e.autoDensity||e.autoResize||!1,
this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.clearBeforeRender=e.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=e.backgroundColor||this._backgroundColor,
this._tempDisplayObjectParent=new ZS,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}i&&(t.__proto__=i);var e={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return((t.prototype=Object.create(
i&&i.prototype)).constructor=t).prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},e.width.get=function(){return this.view.width},e.height.get=function(){return this.view.height},t.prototype.resize=function(t,e){
this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},t.prototype.generateTexture=function(t,e,i,r){0===(
r=r||t.getLocalBounds()).width&&(r.width=1),0===r.height&&(r.height=1);var n=EI.create(0|r.width,0|r.height,e,i);return GC.tx=-r.x,GC.ty=-r.y,this.render(t,n,!1,GC,!!t.parent),n},t.prototype.destroy=function(t){for(var e in this.plugins
)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=pb.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,
this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},
e.backgroundColor.get=function(){return this._backgroundColor},e.backgroundColor.set=function(t){this._backgroundColor=t,this._backgroundColorString=Wb(t),zb(t,this._backgroundColorRgba)},Object.defineProperties(t.prototype,e),t}(X.a),jC=function(i){
function r(t){void 0===t&&(t={}),i.call(this,"WebGL",t),t=this.options,this.type=pb.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new hS("destroy"),contextChange:new hS("contextChange",1),reset:new hS("reset"),update:new hS("update"),
postrender:new hS("postrender"),prerender:new hS("prerender"),resize:new hS("resize",2)},this.globalUniforms=new NI({projectionMatrix:new AS},!0),this.addSystem(IC,"mask").addSystem(HI,"context").addSystem(UC,"state").addSystem(FC,"shader").addSystem(kC,
"texture").addSystem(WI,"geometry").addSystem(YI,"framebuffer").addSystem(OC,"scissor").addSystem(RC,"stencil").addSystem(PC,"projection").addSystem(BC,"textureGC").addSystem(kI,"filter").addSystem(NC,"renderTexture").addSystem(XI,"batch"),
this.initPlugins(r.__plugins),t.context?this.context.initFromContext(t.context):this.context.initFromOptions({alpha:this.transparent,antialias:t.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,
preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,Hb(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return i&&(r.__proto__=i),((
r.prototype=Object.create(i&&i.prototype)).constructor=r).create=function(t){if(Yb())return new r(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},r.prototype.addSystem=function(t,e){e=e||t.name
;var i=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=i,this.runners)this.runners[r].add(i);return this},r.prototype.render=function(t,e,i,r,n){if(this.renderingToScreen=!e,
this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(e||(this._lastObjectRendered=t),!n){var s=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=s}this.renderTexture.bind(e),
this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit(
"postrender")}},r.prototype.resize=function(t,e){i.prototype.resize.call(this,t,e),this.runners.resize.run(t,e)},r.prototype.reset=function(){return this.runners.reset.run(),this},r.prototype.clear=function(){this.framebuffer.bind(),
this.framebuffer.clear()},r.prototype.destroy=function(t){for(var e in this.runners.destroy.run(),this.runners)this.runners[e].destroy();i.prototype.destroy.call(this,t),this.gl=null},r.registerPlugin=function(t,e){(r.__plugins=r.__plugins||{})[t]=e},r}(
VC);function HC(t){return jC.create(t)}function YC(){this.texArray=null,this.blend=0,this.type=yb.TRIANGLES,this.start=0,this.size=0,this.data=null}function zC(){this.elements=[],this.ids=[],this.count=0}
var WC="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}"
,qC=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),((i.prototype=Object.create(t&&t.prototype)).constructor=i).from=function(t,e){return new i(new hI(t,e))},i}(sI);zC.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function KC(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var ZC={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};ZC.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},ZC.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},ZC.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},ZC.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},ZC.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},KC.prototype.view=function(t){
return this[t+"View"]},KC.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},KC.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(KC.prototype,ZC);var JC=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=gC.for2d(),this.size=4*kb.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;kb.PREFER_ENV===cb.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),kb.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=cC(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(
this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(
i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new YC);for(;e.length<r;)e.push(new zC);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(
this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},
_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++sI._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(
n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),
this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;sI._globalBatch=o},_.prototype.buildDrawCalls=function(t,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,
a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],f=p._texture.baseTexture,m=Zb[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(
c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(
var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;kb.CAN_UPLOAD_SAME_BUFFER?(
t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),
t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,
e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},
_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),
this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),
kb.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++
)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(
this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=oT(Math.ceil(t/8)),i=hT(e),r=8*e;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(
this._aBuffers[r]=n=new KC(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=oT(Math.ceil(t/12)),i=hT(e),r=12*e;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(
this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(
t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?$b(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(BI);JC._drawCallPool=[],
JC._textureArrayPool=[];function QC(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0
)throw new Error('Fragment template must contain "%forloop%".')}QC.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=NI.from({uSamplers:e},!0);var r=this.fragTemplate
;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new pC(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new AS,default:this.defaultGroupCache[t]};return new yC(
this.programCache[t],n)},QC.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}"
;return e+="\n",e+="\n"};function $C(){}var tO=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new AI(null,t,!1),this._indexBuffer=new AI(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Eb.FLOAT).addAttribute(
"aTextureCoord",this._buffer,2,!1,Eb.FLOAT).addAttribute("aColor",this._buffer,4,!0,Eb.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Eb.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)
).constructor=t}(OI),
eO="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,iO="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",rO={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};$C.create=function(t){var e=Object.assign({vertex:eO,fragment:iO,geometryClass:tO,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new QC(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(JC)},rO.defaultVertexSrc.get=function(){return eO},rO.defaultFragmentTemplate.get=function(){
return iO},Object.defineProperties($C,rO);var nO=$C.create(),sO=i(16),oO=i.n(sO),aO=i(6),hO=i.n(aO);function uO(){}function lO(i,r,n,s){var o=0,a=i.length;!function t(e){e||o===a?n&&n(e):s?setTimeout(function(){r(i[o++],t)},1):r(i[o++],t)}()}function cO(e
){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function dO(e,t){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var i=0,n={_tasks:[],concurrency:t,
saturated:uO,unsaturated:uO,buffer:t/4,empty:uO,drain:uO,error:uO,started:!1,paused:!1,push:function(t,e){r(t,!1,e)},kill:function(){i=0,n.drain=uO,n.started=!1,n._tasks=[]},unshift:function(t,e){r(t,!0,e)},process:function(){for(
;!n.paused&&i<n.concurrency&&n._tasks.length;){var t=n._tasks.shift();0===n._tasks.length&&n.empty(),(i+=1)===n.concurrency&&n.saturated(),e(t.data,cO(s(t)))}},length:function(){return n._tasks.length},running:function(){return i},idle:function(){
return n._tasks.length+i===0},pause:function(){!0!==n.paused&&(n.paused=!0)},resume:function(){if(!1!==n.paused){n.paused=!1;for(var t=1;t<=n.concurrency;t++)n.process()}}};function r(t,e,i){if(null!=i&&"function"!=typeof i)throw new Error(
"task callback must be a function");if(n.started=!0,null==t&&n.idle())setTimeout(function(){return n.drain()},1);else{var r={data:t,callback:"function"==typeof i?i:uO};e?n._tasks.unshift(r):n._tasks.push(r),setTimeout(function(){return n.process()},1)}}
function s(e){return function(t){i-=1,e.callback.apply(e,arguments),null!=t&&n.error(t,e.data),i<=n.concurrency-n.buffer&&n.unsaturated(),n.idle()&&n.drain(),n.process()}}return n}var pO={};function fO(t,e){for(var i=0;i<e.length;i++){var r=e[i]
;r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mO(t,e,i){return e&&fO(t.prototype,e),i&&fO(t,i),t}var _O=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),yO=null
;function vO(){}var gO=function(){function s(t,e,i){if("string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(s.STATUS_FLAGS.DATA_URL,0===e.indexOf("data:")
),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,
this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=s.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=vO,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),
this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),
this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new hO.a,this.onProgress=new hO.a,this.onComplete=new hO.a,this.onAfterMiddleware=new hO.a}s.setExtensionLoadType=function(t,e){xO(
s._loadTypeMap,t,e)},s.setExtensionXhrType=function(t,e){xO(s._xhrTypeMap,t,e)};var t=s.prototype;return t.complete=function(){this._clearEvents(),this._finish()},t.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr
)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=s.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.load=function(t){var e=this;if(!this.isLoading
)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(s.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(
this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case s.LOAD_TYPE.IMAGE:this.type=s.TYPE.IMAGE,this._loadElement("image");break;case s.LOAD_TYPE.AUDIO:this.type=s.TYPE.AUDIO,this._loadSourceElement("audio");break
;case s.LOAD_TYPE.VIDEO:this.type=s.TYPE.VIDEO,this._loadSourceElement("video");break;case s.LOAD_TYPE.XHR:default:_O&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t._hasFlag=function(t){return 0!=(this._flags&t)},t._setFlag=function(t,e){
this._flags=e?this._flags|t:this._flags&~t},t._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",
this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",
this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener(
"load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.")
;this._setFlag(s.STATUS_FLAGS.COMPLETE,!0),this._setFlag(s.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t._loadElement=function(t){
this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(
this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(
this._boundOnTimeout,this.timeout))},t._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(
this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,
i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",
this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(
this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",
this.url,!0),t.timeout=this.timeout,this.xhrType===s.XHR_RESPONSE_TYPE.JSON||this.xhrType===s.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=s.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),
t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},t._loadXdr=function(){
"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,
t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t._createSource=function(t,e,i){i=i||t+"/"+this._getExtension(e);var r=document.createElement("source");return r.src=e,r.type=i,r},t._onError=function(t){
this.abort("Failed to load element using: "+t.target.nodeName)},t._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t._onTimeout=function(){this.abort("Load timed out.")},t._xhrOnError=function(){
var t=this.xhr;this.abort(bO(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t._xhrOnTimeout=function(){var t=this.xhr;this.abort(bO(t)+" Request timed out.")},t._xhrOnAbort=function(){var t=this.xhr;this.abort(bO(t
)+" Request was aborted by the user.")},t._xhrOnLoad=function(){var t=this.xhr,e="",i=void 0===t.status?200:t.status;if(""!==t.responseType&&"text"!==t.responseType&&void 0!==t.responseType||(e=t.responseText),0===i&&(
0<e.length||t.responseType===s.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2==(i/100|0)){if(this.xhrType===s.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=s.TYPE.TEXT;else if(this.xhrType===s.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),
this.type=s.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===s.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(e,"text/xml")}else{
var n=document.createElement("div");n.innerHTML=e,this.data=n}this.type=s.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=t.response||e;this.complete()}else this.abort(
"["+t.status+"] "+t.statusText+": "+t.responseURL)},t._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,(yO=yO||document.createElement("a")).href=t
;var i=!(t=oO()(yO.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,r=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&r===e.protocol?"":"anonymous"},t._determineXhrType=function(){
return s._xhrTypeMap[this.extension]||s.XHR_RESPONSE_TYPE.TEXT},t._determineLoadType=function(){return s._loadTypeMap[this.extension]||s.LOAD_TYPE.XHR},t._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(
i+1,t.indexOf(";",i))}else{var r=t.indexOf("?"),n=t.indexOf("#"),s=Math.min(-1<r?r:t.length,-1<n?n:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t._getMimeFromXhrType=function(t){switch(t){
case s.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case s.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case s.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case s.XHR_RESPONSE_TYPE.JSON:return"application/json"
;case s.XHR_RESPONSE_TYPE.DEFAULT:case s.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},mO(s,[{key:"isDataUrl",get:function(){return this._hasFlag(s.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(
s.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(s.STATUS_FLAGS.LOADING)}}]),s}();function xO(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function bO(t){return t.toString().replace("object ","")}
gO.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},gO.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},gO.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},gO.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",
DOCUMENT:"document",JSON:"json",TEXT:"text"},gO._loadTypeMap={gif:gO.LOAD_TYPE.IMAGE,png:gO.LOAD_TYPE.IMAGE,bmp:gO.LOAD_TYPE.IMAGE,jpg:gO.LOAD_TYPE.IMAGE,jpeg:gO.LOAD_TYPE.IMAGE,tif:gO.LOAD_TYPE.IMAGE,tiff:gO.LOAD_TYPE.IMAGE,webp:gO.LOAD_TYPE.IMAGE,
tga:gO.LOAD_TYPE.IMAGE,svg:gO.LOAD_TYPE.IMAGE,"svg+xml":gO.LOAD_TYPE.IMAGE,mp3:gO.LOAD_TYPE.AUDIO,ogg:gO.LOAD_TYPE.AUDIO,wav:gO.LOAD_TYPE.AUDIO,mp4:gO.LOAD_TYPE.VIDEO,webm:gO.LOAD_TYPE.VIDEO},gO._xhrTypeMap={xhtml:gO.XHR_RESPONSE_TYPE.DOCUMENT,
html:gO.XHR_RESPONSE_TYPE.DOCUMENT,htm:gO.XHR_RESPONSE_TYPE.DOCUMENT,xml:gO.XHR_RESPONSE_TYPE.DOCUMENT,tmx:gO.XHR_RESPONSE_TYPE.DOCUMENT,svg:gO.XHR_RESPONSE_TYPE.DOCUMENT,tsx:gO.XHR_RESPONSE_TYPE.DOCUMENT,gif:gO.XHR_RESPONSE_TYPE.BLOB,
png:gO.XHR_RESPONSE_TYPE.BLOB,bmp:gO.XHR_RESPONSE_TYPE.BLOB,jpg:gO.XHR_RESPONSE_TYPE.BLOB,jpeg:gO.XHR_RESPONSE_TYPE.BLOB,tif:gO.XHR_RESPONSE_TYPE.BLOB,tiff:gO.XHR_RESPONSE_TYPE.BLOB,webp:gO.XHR_RESPONSE_TYPE.BLOB,tga:gO.XHR_RESPONSE_TYPE.BLOB,
json:gO.XHR_RESPONSE_TYPE.JSON,text:gO.XHR_RESPONSE_TYPE.TEXT,txt:gO.XHR_RESPONSE_TYPE.TEXT,ttf:gO.XHR_RESPONSE_TYPE.BUFFER,otf:gO.XHR_RESPONSE_TYPE.BUFFER},gO.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="
;var TO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var EO=window.URL||window.webkitURL;var wO={caching:function(t,e){var i=this;pO[t.url]?(t.data=pO[t.url],t.complete()):t.onComplete.once(function(){return pO[i.url]=i.data}),e()},
parsing:function(t,e){if(t.data){if(t.xhr&&t.xhrType===gO.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=EO.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=i,
t.type=gO.TYPE.IMAGE,void(t.data.onload=function(){EO.revokeObjectURL(i),t.data.onload=null,e()})}}else{var r=t.xhr.getResponseHeader("content-type");if(r&&0===r.indexOf("image"))return t.data=new Image,t.data.src="data:"+r+";base64,"+function(t){for(
var e="",i=0;i<t.length;){for(var r=[0,0,0],n=[0,0,0,0],s=0;s<r.length;++s)i<t.length?r[s]=255&t.charCodeAt(i++):r[s]=0;switch(n[0]=r[0]>>2,n[1]=(3&r[0])<<4|r[1]>>4,n[2]=(15&r[1])<<2|r[2]>>6,n[3]=63&r[2],i-(t.length-1)){case 2:n[3]=64,n[2]=64;break
;case 1:n[3]=64}for(var o=0;o<n.length;++o)e+=TO.charAt(n[o])}return e}(t.xhr.responseText),t.type=gO.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}},AO=/(#[\w-]+)?$/,SO=function(){function s(t,e){var i=this;void 0===t&&(
t=""),void 0===e&&(e=10),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},
this._queue=dO(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new hO.a,this.onError=new hO.a,this.onLoad=new hO.a,this.onStart=new hO.a,this.onComplete=new hO.a;for(var r=0;r<s._defaultBeforeMiddleware.length;++r
)this.pre(s._defaultBeforeMiddleware[r]);for(var n=0;n<s._defaultAfterMiddleware.length;++n)this.use(s._defaultAfterMiddleware[n])}var t=s.prototype;return t.add=function(t,e,i,r){if(Array.isArray(t)){for(var n=0;n<t.length;++n)this.add(t[n]);return this}
if("object"==typeof t&&(r=e||t.callback||t.onComplete,e=(i=t).url,t=t.name||t.key||t.url),"string"!=typeof e&&(r=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(r=i,i=null),
this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new gO(t,e,i),
"function"==typeof r&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var s=i.parentResource,o=[],a=0;a<s.children.length;++a)s.children[a].isComplete||o.push(s.children[a]);var h=s.progressChunk*(o.length+1)/(o.length+2);s.children.push(
this.resources[t]),s.progressChunk=h;for(var u=0;u<o.length;++u)o[u].progressChunk=h;this.resources[t].progressChunk=h}return this._queue.push(this.resources[t]),this},t.pre=function(t){return this._beforeMiddleware.push(t),this},t.use=function(t){
return this._afterMiddleware.push(t),this},t.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}
return this.resources={},this},t.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,
i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},t._prepareUrl=function(t){var e,i=oO()(t,{strictMode:!0});if(e=i.protocol||!i.path||0===t.indexOf("//"
)?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=AO.exec(e)[0];-1!==(e=e.substr(0,e.length-r.length)).indexOf("?"
)?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=r}return e},t._loadResource=function(i,t){var r=this;i._dequeue=t,lO(this._beforeMiddleware,function(t,e){t.call(r,i,function(){e(i.isComplete?{}:null)})},function(){
i.isComplete?r._onLoad(i):(i._onLoadBinding=i.onComplete.once(r._onLoad,r),i.load())},!0)},t._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t._onComplete=function(){this.progress=100,this.loading=!1,
this.onComplete.dispatch(this,this.resources)},t._onLoad=function(i){var r=this;i._onLoadBinding=null,this._resourcesParsing.push(i),i._dequeue(),lO(this._afterMiddleware,function(t,e){t.call(r,i,e)},function(){i.onAfterMiddleware.dispatch(i),
r.progress=Math.min(100,r.progress+i.progressChunk),r.onProgress.dispatch(r,i),i.error?r.onError.dispatch(i.error,r,i):r.onLoad.dispatch(r,i),r._resourcesParsing.splice(r._resourcesParsing.indexOf(i),1),r._queue.idle(
)&&0===r._resourcesParsing.length&&r._onComplete()},!0)},mO(s,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),s}();SO._defaultBeforeMiddleware=[],SO._defaultAfterMiddleware=[],
SO.pre=function(t){return SO._defaultBeforeMiddleware.push(t),SO},SO.use=function(t){return SO._defaultAfterMiddleware.push(t),SO};var IO,CO,OO,RO,PO,MO,NO,LO,FO,DO,UO,BO,kO,XO,GO,VO,jO,HO,YO,zO,WO,qO,KO,ZO,JO,QO,$O,tR,eR={MIPMAP_TEXTURES:1,
ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){
var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,
preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",
CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(CO=IO=IO||{})[CO.WEBGL_LEGACY=0]="WEBGL_LEGACY",CO[CO.WEBGL=1]="WEBGL",CO[CO.WEBGL2=2]="WEBGL2",(RO=OO=OO||{})[RO.UNKNOWN=0]="UNKNOWN",RO[RO.WEBGL=1]="WEBGL",
RO[RO.CANVAS=2]="CANVAS",(MO=PO=PO||{})[MO.NORMAL=0]="NORMAL",MO[MO.ADD=1]="ADD",MO[MO.MULTIPLY=2]="MULTIPLY",MO[MO.SCREEN=3]="SCREEN",MO[MO.OVERLAY=4]="OVERLAY",MO[MO.DARKEN=5]="DARKEN",MO[MO.LIGHTEN=6]="LIGHTEN",MO[MO.COLOR_DODGE=7]="COLOR_DODGE",
MO[MO.COLOR_BURN=8]="COLOR_BURN",MO[MO.HARD_LIGHT=9]="HARD_LIGHT",MO[MO.SOFT_LIGHT=10]="SOFT_LIGHT",MO[MO.DIFFERENCE=11]="DIFFERENCE",MO[MO.EXCLUSION=12]="EXCLUSION",MO[MO.HUE=13]="HUE",MO[MO.SATURATION=14]="SATURATION",MO[MO.COLOR=15]="COLOR",
MO[MO.LUMINOSITY=16]="LUMINOSITY",MO[MO.NORMAL_NPM=17]="NORMAL_NPM",MO[MO.ADD_NPM=18]="ADD_NPM",MO[MO.SCREEN_NPM=19]="SCREEN_NPM",MO[MO.NONE=20]="NONE",MO[MO.SRC_OVER=0]="SRC_OVER",MO[MO.SRC_IN=21]="SRC_IN",MO[MO.SRC_OUT=22]="SRC_OUT",
MO[MO.SRC_ATOP=23]="SRC_ATOP",MO[MO.DST_OVER=24]="DST_OVER",MO[MO.DST_IN=25]="DST_IN",MO[MO.DST_OUT=26]="DST_OUT",MO[MO.DST_ATOP=27]="DST_ATOP",MO[MO.ERASE=26]="ERASE",MO[MO.SUBTRACT=28]="SUBTRACT",MO[MO.XOR=29]="XOR",(LO=NO=NO||{})[LO.POINTS=0]="POINTS",
LO[LO.LINES=1]="LINES",LO[LO.LINE_LOOP=2]="LINE_LOOP",LO[LO.LINE_STRIP=3]="LINE_STRIP",LO[LO.TRIANGLES=4]="TRIANGLES",LO[LO.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",LO[LO.TRIANGLE_FAN=6]="TRIANGLE_FAN",(DO=FO=FO||{})[DO.RGBA=6408]="RGBA",DO[DO.RGB=6407]="RGB",
DO[DO.ALPHA=6406]="ALPHA",DO[DO.LUMINANCE=6409]="LUMINANCE",DO[DO.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",DO[DO.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",DO[DO.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(BO=UO=UO||{})[BO.TEXTURE_2D=3553]="TEXTURE_2D",
BO[BO.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",BO[BO.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",BO[BO.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",BO[BO.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
BO[BO.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",BO[BO.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",BO[BO.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
BO[BO.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(XO=kO=kO||{})[XO.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",XO[XO.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",XO[XO.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
XO[XO.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",XO[XO.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",XO[XO.FLOAT=5126]="FLOAT",XO[XO.HALF_FLOAT=36193]="HALF_FLOAT",(VO=GO=GO||{})[VO.NEAREST=0]="NEAREST",VO[VO.LINEAR=1]="LINEAR",(
HO=jO=jO||{})[HO.CLAMP=33071]="CLAMP",HO[HO.REPEAT=10497]="REPEAT",HO[HO.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(zO=YO=YO||{})[zO.OFF=0]="OFF",zO[zO.POW2=1]="POW2",zO[zO.ON=2]="ON",(qO=WO=WO||{})[qO.NPM=0]="NPM",qO[qO.UNPACK=1]="UNPACK",
qO[qO.PMA=2]="PMA",qO[qO.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",qO[qO.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",qO[qO.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(ZO=KO=KO||{})[ZO.AUTO=0]="AUTO",ZO[ZO.MANUAL=1]="MANUAL",(QO=JO=JO||{}
).LOW="lowp",QO.MEDIUM="mediump",QO.HIGH="highp",(tR=$O=$O||{})[tR.NONE=0]="NONE",tR[tR.SCISSOR=1]="SCISSOR",tR[tR.STENCIL=2]="STENCIL",tR[tR.SPRITE=3]="SPRITE",eR.RETINA_PREFIX=/@([0-9\.]+)x/;var iR,rR=!(eR.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),nR="5.2.0"
;var sR=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[PO.NORMAL_NPM]=PO.NORMAL,t[PO.ADD_NPM]=PO.ADD,t[PO.SCREEN_NPM]=PO.SCREEN,e[PO.NORMAL]=PO.NORMAL_NPM,e[PO.ADD]=PO.ADD_NPM,e[PO.SCREEN]=PO.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function oR(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var aR=0;function hR(){return++aR}function uR(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function lR(t){
return!(t&t-1||!t)}function cR(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var dR={},pR=Object.create(null),fR=Object.create(null);function mR(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||eR.RESOLUTION,this.resize(t,e)}var _R={width:{configurable:!0},height:{configurable:!0}};mR.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},mR.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},mR.prototype.destroy=function(){this.context=null,this.canvas=null},_R.width.get=function(){
return this.canvas.width},_R.width.set=function(t){this.canvas.width=t},_R.height.get=function(){return this.canvas.height},_R.height.set=function(t){this.canvas.height=t},Object.defineProperties(mR.prototype,_R);var yR;function vR(t,e){
var i=eR.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var gR={};var xR,bR,TR=(ER.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(
var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},ER.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},
ER.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},ER.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}
,ER.prototype.contains=function(t){return-1!==this.items.indexOf(t)},ER.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},ER.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},
Object.defineProperty(ER.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(ER.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),ER);function ER(t){
this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(TR.prototype,{dispatch:{value:TR.prototype.emit},run:{value:TR.prototype.emit}}),eR.TARGET_FPMS=.06,(bR=xR=xR||{})[bR.INTERACTION=50]="INTERACTION",bR[bR.HIGH=25]="HIGH",
bR[bR.NORMAL=0]="NORMAL",bR[bR.LOW=-25]="LOW",bR[bR.UTILITY=-50]="UTILITY";var wR=(AR.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},AR.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t
):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},AR.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},AR.prototype.destroy=function(t){
void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},AR);function AR(t,e,i,r){
void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var SR=(IR.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(
this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},IR.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},
IR.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},IR.prototype.add=function(t,e,i){return void 0===i&&(i=xR.NORMAL),this._addListener(new wR(t,e,i))},IR.prototype.addOnce=function(t,e,i){
return void 0===i&&(i=xR.NORMAL),this._addListener(new wR(t,e,i,!0))},IR.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)
}else t.connect(i);return this._startIfPossible(),this},IR.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},IR.prototype.start=function(){this.started||(
this.started=!0,this._requestIfNeeded())},IR.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},IR.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0)
;this._head.destroy(),this._head=null}},IR.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){
var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*eR.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()
}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(IR.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(IR.prototype,"minFPS",{get:function(){
return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,eR.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(IR.prototype,"maxFPS",{get:function(){
return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(IR,"shared",{
get:function(){if(!IR._shared){var t=IR._shared=new IR;t.autoStart=!0,t._protected=!0}return IR._shared},enumerable:!0,configurable:!0}),Object.defineProperty(IR,"system",{get:function(){if(!IR._system){var t=IR._system=new IR;t.autoStart=!0,
t._protected=!0}return IR._system},enumerable:!0,configurable:!0}),IR);function IR(){var e=this;this._head=new wR(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,
this.deltaMS=1/eR.TARGET_FPMS,this.elapsedMS=1/eR.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),
e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}CR.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){
this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,xR.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?SR.shared:new SR,t.autoStart&&this.start()},CR.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function CR(){}var OR=(RR.prototype.clone=function(){return new RR(this.x,this.y)},
RR.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},RR.prototype.copyTo=function(t){return t.set(this.x,this.y),t},RR.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},RR.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},RR);function RR(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var PR=(MR.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new MR(t,e,this._x,this._y)},
MR.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},MR.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},MR.prototype.copyTo=function(t){return t.set(this._x,this._y),t},MR.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(MR.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(MR.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),MR);function MR(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var NR,LR,FR=2*Math.PI,DR=180/Math.PI,UR=Math.PI/180;(LR=NR=NR||{})[LR.POLY=0]="POLY",LR[LR.RECT=1]="RECT",LR[LR.CIRC=2]="CIRC",LR[LR.ELIP=3]="ELIP",
LR[LR.RREC=4]="RREC";var BR=(kR.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},kR.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
kR.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},kR.prototype.apply=function(t,e){e=e||new OR;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},kR.prototype.applyInverse=function(t,e){e=e||new OR;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},kR.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
kR.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},kR.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},kR.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},kR.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},kR.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},kR.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(FR-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},kR.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},kR.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},kR.prototype.clone=function(){
var t=new kR;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},kR.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},kR.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(kR,"IDENTITY",{get:function(){return new kR},enumerable:!0,configurable:!0}),Object.defineProperty(kR,"TEMP_MATRIX",{get:function(){return new kR},
enumerable:!0,configurable:!0}),kR);function kR(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var XR=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],GR=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],VR=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],jR=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],HR=[],YR=[],zR=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];HR.push(e);for(
var i=0;i<16;i++)for(var r=zR(XR[t]*XR[i]+VR[t]*GR[i]),n=zR(GR[t]*XR[i]+jR[t]*GR[i]),s=zR(XR[t]*VR[i]+VR[t]*jR[i]),o=zR(GR[t]*VR[i]+jR[t]*jR[i]),a=0;a<16;a++)if(XR[a]===r&&GR[a]===n&&VR[a]===s&&jR[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new BR
;h.set(XR[t],GR[t],VR[t],jR[t],0,0),YR.push(h)}}();var WR={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return XR[t]},uY:function(t){return GR[t]},vX:function(t){
return VR[t]},vY:function(t){return jR[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return HR[t][e]},sub:function(t,e){return HR[t][WR.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?WR.S:WR.N:2*Math.abs(e)<=Math.abs(t)?0<t?WR.E:WR.W:0<e?0<t?WR.SE:WR.SW:0<t?WR.NE:WR.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=YR[WR.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},qR=(KR.prototype.onChange=function(){this._localID++},KR.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},KR.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},KR.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},KR.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(KR.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),KR.IDENTITY=new KR,KR);function KR(){this.worldTransform=new BR,this.localTransform=new BR,this.position=new PR(this.onChange,
this,0,0),this.scale=new PR(this.onChange,this,1,1),this.pivot=new PR(this.onChange,this,0,0),this.skew=new PR(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var ZR=(Object.defineProperty(JR.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(JR.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(JR.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(JR.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(JR,"EMPTY"
,{get:function(){return new JR(0,0,0,0)},enumerable:!0,configurable:!0}),JR.prototype.clone=function(){return new JR(this.x,this.y,this.width,this.height)},JR.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},JR.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},JR.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},JR.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},JR.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},JR.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
JR.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},JR);function JR(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=NR.RECT}QR.prototype.clone=function(){return new QR(this.x,this.y,this.radius)},
QR.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},QR.prototype.getBounds=function(){return new ZR(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function QR(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=NR.CIRC}$R.prototype.clone=function(){return new $R(this.x,this.y,this.width,this.height)},$R.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},$R.prototype.getBounds=function(){return new ZR(this.x-this.width,this.y-this.height,this.width,this.height)};function $R(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=NR.ELIP}tP.prototype.clone=function(){var t=new tP(this.points.slice());return t.closeStroke=this.closeStroke,t},
tP.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function tP(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof OR){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=NR.POLY,this.closeStroke=!0}
eP.prototype.clone=function(){return new eP(this.x,this.y,this.width,this.height,this.radius)},eP.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function eP(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=NR.RREC}eR.SORTABLE_CHILDREN=!1;function iP(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}iP.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},iP.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},iP.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?ZR.EMPTY:((
t=t||new ZR(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},iP.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},iP.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},iP.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
iP.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},iP.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},iP.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
iP.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},iP.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},iP.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},iP.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},iP.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},iP.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},iP.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var rP=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new qR,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new iP,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new ZR),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new ZR),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*DR},e.angle.set=function(t){this.transform.rotation=t*UR
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function nP(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}rP.prototype.displayObjectUpdateTransform=rP.prototype.updateTransform;var sP=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=eR.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);oR(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,oR(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,oR(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(nP),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(rP);sP.prototype.containerUpdateTransform=sP.prototype.updateTransform;function oP(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new TR(
"setRealSize",2),this.onUpdate=new TR("update"),this.onError=new TR("onError",1)}var aP={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};oP.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},oP.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},oP.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},aP.valid.get=function(){return!!this._width&&!!this._height},oP.prototype.update=function(){this.destroyed||this.onUpdate.run()},oP.prototype.load=function(){return Promise.resolve()},
aP.width.get=function(){return this._width},aP.height.get=function(){return this._height},oP.prototype.upload=function(t,e,i){return!1},oP.prototype.style=function(t,e,i){return!1},oP.prototype.dispose=function(){},oP.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(oP.prototype,aP);var hP=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(yR=yR||document.createElement("a")).href=t;var i=!(t=H.a.parse(yR.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===WO.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(oP),uP=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:eR.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===WO.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(hP),lP=[];function cP(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=lP.length-1;0<=n;--n){var s=lP[n];if(s.test&&s.test(t,i))return new s(t,e)}return new uP(t,e)}var dP=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===WO.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(oP),pP={scaleMode:GO.NEAREST,format:FO.RGBA,
alphaMode:WO.NPM},fP=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof oP||((t=cP(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||eR.RESOLUTION,this.mipmap=void 0!==r?r:eR.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:eR.ANISOTROPIC_LEVEL,
this.wrapMode=h||eR.WRAP_MODE,this.scaleMode=void 0!==s?s:eR.SCALE_MODE,this.format=u||FO.RGBA,this.type=l||kO.UNSIGNED_BYTE,this.target=c||UO.TEXTURE_2D,this.alphaMode=void 0!==i?i:WO.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=hR(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=lR(this.realWidth
)&&lR(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete fR[this.cacheId],delete pR[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=eR.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+hR()),t._pixiId);var s=fR[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new dP(t,{width:e,height:i}),
s=t instanceof Float32Array?kO.FLOAT:kO.UNSIGNED_BYTE;return new o(n,Object.assign(pP,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),fR[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),fR[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=fR[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete fR[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete fR[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);fP._globalBatch=0;var mP=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new fP;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(cP(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=UO.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(oP),
_P=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(hP),
yP=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=UO.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=UO.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(mP);yP.SIDES=6;var vP=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+hR(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(hP)
;vP.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var gP=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=SR.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(SR.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(SR.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&SR.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(SR.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(SR.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(hP);gP.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var xP=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(hP);lP.push(uP,xP,_P,gP,vP,dP,yP,mP);function bP(t){this.renderer=t}
bP.prototype.destroy=function(){this.renderer=null};function TP(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new TR("disposeFramebuffer",2)}var EP=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===WO.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(dP),wP={colorTexture:{configurable:!0}};wP.colorTexture.get=function(){return this.colorTextures[0]},TP.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new fP(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},TP.prototype.addDepthTexture=function(t){return this.depthTexture=t||new fP(new EP(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:FO.DEPTH_COMPONENT,type:kO.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},TP.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},TP.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},TP.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},TP.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(TP.prototype,wP);function AP(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var SP=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new TP(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(fP);AP.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=WR.add(i,WR.NW),this.x0=a+s*WR.uX(i),this.y0=h+o*WR.uY(i),i=WR.add(i,2),this.x1=a+s*WR.uX(i),this.y1=h+o*WR.uY(i),i=WR.add(i,2),this.x2=a+s*WR.uX(i),this.y2=h+o*WR.uY(i),i=WR.add(i,2),
this.x3=a+s*WR.uX(i),this.y3=h+o*WR.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var IP=new AP,CP=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new ZR(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=IP,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new OR(s.x,s.y):new OR(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&pR[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===IP&&(this._uvs=new AP),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=eR.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+hR()),t._pixiId);var s=pR[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=vR(t)),(s=new a(new fP(t,e))).baseTexture.cacheId=n,
fP.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(fP.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new uP(t);r.url=e;var n=new a(new fP(r,{scaleMode:eR.SCALE_MODE,resolution:vR(e)}));return i=i||e,
fP.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(fP.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),pR[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),pR[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=pR[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete pR[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)pR[t.textureCacheIds[r]]===t&&delete pR[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function OP(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}CP.EMPTY=new CP(new fP),OP(CP.EMPTY),OP(CP.EMPTY.baseTexture),CP.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new CP(new fP(new _P(t)))}(),OP(CP.WHITE),OP(CP.WHITE.baseTexture);function RP(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var PP=function(a){function n(t,e){var i=null;if(!(t instanceof SP)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new SP({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new SP(t))},n}(CP);RP.prototype.createTexture=function(t,e){var i=new SP(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new PP(i)},
RP.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=RP.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=uR(t)))<<16|65535&(e=uR(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},RP.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
RP.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},RP.prototype.returnFilterTexture=function(t){this.returnTexture(t)},RP.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},RP.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=RP.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},RP.SCREEN_KEY="screen";function MP(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}MP.prototype.destroy=function(){this.buffer=null},MP.from=function(t,e,i,r,n){return new MP(t,e,i,r,n)};function NP(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=LP++,this.disposeRunner=new TR("disposeBuffer",2)}var LP=0;function FP(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}NP.prototype.update=function(t){this.data=t||this.data,this._updateID++},NP.prototype.dispose=function(){this.disposeRunner.run(this,!1)},NP.prototype.destroy=function(){this.dispose(),this.data=null},NP.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new NP(t)};var DP={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function UP(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=kP++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new TR("disposeGeometry",2),this.refCount=0}var BP={5126:4,5123:2,5121:1},kP=0,XP={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};UP.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new NP(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new MP(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},UP.prototype.getAttribute=function(t){return this.attributes[t]},UP.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},UP.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new NP(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
UP.prototype.getIndex=function(){return this.indexBuffer},UP.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new NP;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*BP[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=FP(c)
;n[d]||(n[d]=new DP[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},UP.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},UP.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},UP.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},UP.prototype.clone=function(){for(var t=new UP,e=0;e<this.buffers.length;e++)t.buffers[e]=new NP(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new MP(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},UP.merge=function(t){for(var e,i=new UP,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(XP[FP(e.buffers[h].data)])(n[h]),i.buffers[h]=new NP(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*BP[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function GP(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=HP++,this.static=!!e}var VP=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(UP),
jP=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new NP(this.vertices),this.uvBuffer=new NP(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(UP),HP=0
;GP.prototype.update=function(){this.dirtyId++},GP.prototype.add=function(t,e,i){this.uniforms[t]=new GP(e,i)},GP.from=function(t,e){return new GP(t,e)};function YP(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new ZR,this.destinationFrame=new ZR,this.filters=[]}YP.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function zP(t){this.renderer=t}var WP=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new RP,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new VP,this.quadUv=new jP,this.tempRect=new ZR,this.activeState={},this.globalUniforms=new GP({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new YP,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(NO.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(NO.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
BR.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(bP);zP.prototype.flush=function(){},zP.prototype.destroy=function(){this.renderer=null},zP.prototype.start=function(){},zP.prototype.stop=function(){this.flush()},zP.prototype.render=function(t){};var qP=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new zP(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(bP);eR.PREFER_ENV=u.a.any?IO.WEBGL:IO.WEBGL2,eR.STRICT_TEXTURE_CACHE=!1
;function KP(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function ZP(t){this.type=$O.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var JP=0,QP=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=JP++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=JP++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(eR.PREFER_ENV>=IO.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(bP),$P=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new TP(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ZR,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;eR.PREFER_ENV===IO.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new ZR},Object.defineProperties(t.prototype,i),t}(bP),tM={5126:4,5123:2,5121:1},
eM=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;eR.PREFER_ENV===IO.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*tM[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*tM[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*tM[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new KP(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(bP);function iM(t,e,i,r){var n=rM(t,t.VERTEX_SHADER,e),s=rM(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function rM(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function nM(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return sM(2*e)
;case"bvec3":return sM(3*e);case"bvec4":return sM(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function sM(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}ZP.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=$O.NONE,this.autoDetect=!0),this._target=null},ZP.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var oM,aM={},hM=aM;function uM(){if(hM===aM||hM&&hM.isContextLost()){
var t,e=document.createElement("canvas");eR.PREFER_ENV>=IO.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),hM=t}return hM}function lM(t,e,i){if(
"precision"===t.substring(0,9))return i!==JO.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===JO.HIGH&&i!==JO.HIGH&&(r=JO.MEDIUM),"precision "+r+" float;\n"+t}var cM={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var dM=null,pM={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function fM(t,e){if(!dM){var i=Object.keys(pM)
;dM={};for(var r=0;r<i.length;++r){var n=i[r];dM[t[n]]=pM[n]}}return dM[e]}var mM={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},_M={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var yM,vM=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function gM(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function xM(t,e,i){void 0===i&&(i="pixi-shader"),this.id=bM++,this.vertexSrc=t||xM.defaultVertexSrc,
this.fragmentSrc=e||xM.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),TM[i]?(TM[i]++,i+="-"+TM[i]):TM[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=lM(this.vertexSrc,eR.PRECISION_VERTEX,JO.HIGH),this.fragmentSrc=lM(this.fragmentSrc,eR.PRECISION_FRAGMENT,function(
){if(!oM){oM=JO.MEDIUM;var t=uM();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);oM=e.precision?JO.HIGH:JO.MEDIUM}}return oM}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var bM=0,TM={},EM={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};xM.prototype.extractData=function(t,e){var i=uM();if(i){var r=iM(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},xM.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=fM(e,a.type),u={type:h,name:a.name,size:(i=h,cM[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
xM.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=fM(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:nM(h,s.size)}}return i},EM.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},EM.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},xM.from=function(t,e,i){var r=t+e,n=dR[r];return n||(dR[r]=n=new xM(t
,e,i)),n},Object.defineProperties(xM,EM);function wM(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof GP?e:new GP(e):new GP({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var AM={uniforms:{configurable:!0}};wM.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
wM.prototype.destroy=function(){this.uniformGroup=null},AM.uniforms.get=function(){return this.uniformGroup.uniforms},wM.from=function(t,e,i){var r=xM.from(t,e);return new wM(r,i)},Object.defineProperties(wM.prototype,AM);function SM(){this.data=0,
this.blendMode=PO.NORMAL,this.polygonOffset=0,this.blend=!0}var IM={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};IM.blend.get=function(){return!!(1&this.data)},IM.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},IM.offsets.get=function(){return!!(2&this.data)},IM.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
IM.culling.get=function(){return!!(4&this.data)},IM.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},IM.depthTest.get=function(){return!!(8&this.data)},IM.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
IM.clockwiseFrontFace.get=function(){return!!(16&this.data)},IM.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},IM.blendMode.get=function(){return this._blendMode},IM.blendMode.set=function(t){this.blend=t!==PO.NONE,
this._blendMode=t},IM.polygonOffset.get=function(){return this._polygonOffset},IM.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},SM.for2d=function(){var t=new SM;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
SM.prototype,IM);var CM=function(n){function s(t,e,i){var r=xM.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=eR.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new SM}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(wM);CM.SOURCE_KEY_MAP={};function OM(t,e){this._texture=t,this.mapCoord=new BR,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var RM=new BR,PM={texture:{configurable:!0}};PM.texture.get=function(){return this._texture},PM.texture.set=function(t){this._texture=t,this._updateID=-1},OM.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},OM.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(RM.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(RM));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(OM.prototype,PM);function MM(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var NM=function(i){
function t(t){var e=new BR;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new OM(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(CM),LM=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new ZP;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case $O.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case $O.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case $O.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case $O.SCISSOR:this.renderer.scissor.pop();break;case $O.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case $O.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=$O.SPRITE;else if(t.type=$O.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=$O.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new NM(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(bP),FM=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(bP),DM=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(FM),UM=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(FM),BM=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new BR,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(bP),kM=new ZR,XM=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new ZR,this.destinationFrame=new ZR}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(kM.width=s.realWidth,kM.height=s.realHeight,i=kM),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
kM.width=n.width,kM.height=n.height,i=kM),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(bP)
;MM.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var GM=0,VM=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=GM++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof yM)return yM;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;yM=!0===t({a:"b"},"a","b")}catch(t){yM=!1}return yM}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?mM:_M)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=iM(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:nM(h.type,h.size)}}var u=new MM(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(bP);function jM(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var HM=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=PO.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new SM,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[PO.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.ADD]=[t.ONE,t.ONE],e[PO.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[PO.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[PO.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[PO.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.NONE]=[0,0],e[PO.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[PO.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[PO.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[PO.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[PO.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[PO.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[PO.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[PO.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[PO.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[PO.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[PO.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(bP),YM=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=eR.GC_MAX_IDLE,
this.checkCountMax=eR.GC_MAX_CHECK_COUNT,this.mode=eR.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==KO.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(bP),zM=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new fP}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new jM(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new jM(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new jM(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===kO.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&oR(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==YO.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=jO.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===GO.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(bP),WM=new BR;X.a;function qM(){this.texArray=null,this.blend=0,this.type=NO.TRIANGLES,this.start=0,this.size=0,this.data=null}function KM(){this.elements=[],this.ids=[],this.count=0}KM.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function ZM(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var JM={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};JM.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},JM.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},JM.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},JM.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},JM.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},ZM.prototype.view=function(t){
return this[t+"View"]},ZM.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},ZM.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(ZM.prototype,JM);var QM=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=SM.for2d(),this.size=4*eR.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;eR.PREFER_ENV===IO.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),eR.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=vM.replace(/%forloop%/gi,gM(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new qM);for(;e.length<r;)e.push(new KM);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++fP._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;fP._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=sR[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;eR.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),eR.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=uR(Math.ceil(t/8)),i=cR(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new ZM(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=uR(Math.ceil(t/12)),i=cR(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(zP);QM._drawCallPool=[],QM._textureArrayPool=[];function $M(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}$M.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=GP.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new xM(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new BR,default:this.defaultGroupCache[t]};return new wM(this.programCache[t],n)},
$M.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function tN(){}var eN=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new NP(null,t,!1),this._indexBuffer=new NP(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,kO.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,kO.FLOAT).addAttribute("aColor",this._buffer,4,!0,kO.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,kO.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(UP),
iN="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,rN="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",nN={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};tN.create=function(t){var e=Object.assign({vertex:iN,fragment:rN,geometryClass:eN,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new $M(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(QM)},nN.defaultVertexSrc.get=function(){return iN},nN.defaultFragmentTemplate.get=function(){
return rN},Object.defineProperties(tN,nN);function sN(){}tN.create();sN.use=function(t,e){t.data&&t.type===gO.TYPE.IMAGE&&(t.texture=CP.fromLoader(t.data,t.url,t.name)),e()};var oN=function(a){function h(t,e){var r=this;a.call(this,t,e),X.a.call(this)
;for(var i=0;i<h._plugins.length;++i){var n=h._plugins[i],s=n.pre,o=n.use;s&&this.pre(s),o&&this.use(o)}this.onStart.add(function(t){return r.emit("start",t)}),this.onProgress.add(function(t,e){return r.emit("progress",t,e)}),this.onError.add(function(t,e
,i){return r.emit("error",t,e,i)}),this.onLoad.add(function(t,e){return r.emit("load",t,e)}),this.onComplete.add(function(t,e){return r.emit("complete",t,e)}),this._protected=!1}a&&(h.__proto__=a);var t={shared:{configurable:!0}};return((
h.prototype=Object.create(a&&a.prototype)).constructor=h).prototype.destroy=function(){this._protected||(this.removeAllListeners(),this.reset())},t.shared.get=function(){var t=h._shared;return t||((t=new h)._protected=!0,h._shared=t),t},
Object.defineProperties(h,t),h}(SO);Object.assign(oN.prototype,X.a.prototype),oN._plugins=[],oN.registerPlugin=function(t){return oN._plugins.push(t),t.add&&t.add(),oN},oN.registerPlugin({use:wO.parsing}),oN.registerPlugin(sN);function aN(){}
aN.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?oN.shared:new oN},aN.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)};var hN,uN,lN,cN,dN,pN,fN,mN,_N,yN,vN,gN,xN,bN,TN,EN,wN,AN,SN,IN,CN,ON,RN,PN,
MN,NN,LN,FN,DN=gO;(uN=hN=hN||{})[uN.WEBGL_LEGACY=0]="WEBGL_LEGACY",uN[uN.WEBGL=1]="WEBGL",uN[uN.WEBGL2=2]="WEBGL2",(cN=lN=lN||{})[cN.UNKNOWN=0]="UNKNOWN",cN[cN.WEBGL=1]="WEBGL",cN[cN.CANVAS=2]="CANVAS",(pN=dN=dN||{})[pN.NORMAL=0]="NORMAL",
pN[pN.ADD=1]="ADD",pN[pN.MULTIPLY=2]="MULTIPLY",pN[pN.SCREEN=3]="SCREEN",pN[pN.OVERLAY=4]="OVERLAY",pN[pN.DARKEN=5]="DARKEN",pN[pN.LIGHTEN=6]="LIGHTEN",pN[pN.COLOR_DODGE=7]="COLOR_DODGE",pN[pN.COLOR_BURN=8]="COLOR_BURN",pN[pN.HARD_LIGHT=9]="HARD_LIGHT",
pN[pN.SOFT_LIGHT=10]="SOFT_LIGHT",pN[pN.DIFFERENCE=11]="DIFFERENCE",pN[pN.EXCLUSION=12]="EXCLUSION",pN[pN.HUE=13]="HUE",pN[pN.SATURATION=14]="SATURATION",pN[pN.COLOR=15]="COLOR",pN[pN.LUMINOSITY=16]="LUMINOSITY",pN[pN.NORMAL_NPM=17]="NORMAL_NPM",
pN[pN.ADD_NPM=18]="ADD_NPM",pN[pN.SCREEN_NPM=19]="SCREEN_NPM",pN[pN.NONE=20]="NONE",pN[pN.SRC_OVER=0]="SRC_OVER",pN[pN.SRC_IN=21]="SRC_IN",pN[pN.SRC_OUT=22]="SRC_OUT",pN[pN.SRC_ATOP=23]="SRC_ATOP",pN[pN.DST_OVER=24]="DST_OVER",pN[pN.DST_IN=25]="DST_IN",
pN[pN.DST_OUT=26]="DST_OUT",pN[pN.DST_ATOP=27]="DST_ATOP",pN[pN.ERASE=26]="ERASE",pN[pN.SUBTRACT=28]="SUBTRACT",pN[pN.XOR=29]="XOR",(mN=fN=fN||{})[mN.POINTS=0]="POINTS",mN[mN.LINES=1]="LINES",mN[mN.LINE_LOOP=2]="LINE_LOOP",mN[mN.LINE_STRIP=3]="LINE_STRIP"
,mN[mN.TRIANGLES=4]="TRIANGLES",mN[mN.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",mN[mN.TRIANGLE_FAN=6]="TRIANGLE_FAN",(yN=_N=_N||{})[yN.RGBA=6408]="RGBA",yN[yN.RGB=6407]="RGB",yN[yN.ALPHA=6406]="ALPHA",yN[yN.LUMINANCE=6409]="LUMINANCE",
yN[yN.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",yN[yN.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",yN[yN.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(gN=vN=vN||{})[gN.TEXTURE_2D=3553]="TEXTURE_2D",gN[gN.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",
gN[gN.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",gN[gN.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",gN[gN.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
gN[gN.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",gN[gN.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",gN[gN.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
gN[gN.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(bN=xN=xN||{})[bN.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",bN[bN.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",bN[bN.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
bN[bN.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",bN[bN.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",bN[bN.FLOAT=5126]="FLOAT",bN[bN.HALF_FLOAT=36193]="HALF_FLOAT",(EN=TN=TN||{})[EN.NEAREST=0]="NEAREST",EN[EN.LINEAR=1]="LINEAR",(
AN=wN=wN||{})[AN.CLAMP=33071]="CLAMP",AN[AN.REPEAT=10497]="REPEAT",AN[AN.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(IN=SN=SN||{})[IN.OFF=0]="OFF",IN[IN.POW2=1]="POW2",IN[IN.ON=2]="ON",(ON=CN=CN||{})[ON.NPM=0]="NPM",ON[ON.UNPACK=1]="UNPACK",
ON[ON.PMA=2]="PMA",ON[ON.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ON[ON.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ON[ON.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(PN=RN=RN||{})[PN.AUTO=0]="AUTO",PN[PN.MANUAL=1]="MANUAL",(NN=MN=MN||{}
).LOW="lowp",NN.MEDIUM="mediump",NN.HIGH="highp",(FN=LN=LN||{})[FN.NONE=0]="NONE",FN[FN.SCISSOR=1]="SCISSOR",FN[FN.STENCIL=2]="STENCIL",FN[FN.SPRITE=3]="SPRITE";var UN,BN={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,
SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/)
;if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},
GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1,
RETINA_PREFIX:/@([0-9\.]+)x/,FAIL_IF_MAJOR_PERFORMANCE_CAVEAT:!0},kN=!1,XN="5.2.0";function GN(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}var VN=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i
;t[dN.NORMAL_NPM]=dN.NORMAL,t[dN.ADD_NPM]=dN.ADD,t[dN.SCREEN_NPM]=dN.SCREEN,e[dN.NORMAL]=dN.NORMAL_NPM,e[dN.ADD]=dN.ADD_NPM,e[dN.SCREEN]=dN.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function jN(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0
;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(n=n*e+.5|0)}function HN(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var YN=0;function zN(){
return++YN}function WN(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function qN(t){return!(t&t-1||!t)}function KN(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}
var ZN={},JN=Object.create(null),QN=Object.create(null);function $N(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||BN.RESOLUTION,this.resize(t,e)}var tL={width:{configurable:!0},height:{
configurable:!0}};$N.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},$N.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,
this.canvas.height=e*this.resolution},$N.prototype.destroy=function(){this.context=null,this.canvas=null},tL.width.get=function(){return this.canvas.width},tL.width.set=function(t){this.canvas.width=t},tL.height.get=function(){return this.canvas.height},
tL.height.set=function(t){this.canvas.height=t},Object.defineProperties($N.prototype,tL);var eL;function iL(t,e){var i=BN.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var rL={};var nL=(sL.prototype.clone=function(){return new sL(this.x,
this.y)},sL.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},sL.prototype.copyTo=function(t){return t.set(this.x,this.y),t},sL.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},sL.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},sL);function sL(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var oL=(aL.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new aL(t,e,this._x,this._y)},
aL.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},aL.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},aL.prototype.copyTo=function(t){return t.set(this._x,this._y),t},aL.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(aL.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(aL.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),aL);function aL(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var hL,uL,lL=2*Math.PI,cL=180/Math.PI,dL=Math.PI/180;(uL=hL=hL||{})[uL.POLY=0]="POLY",uL[uL.RECT=1]="RECT",uL[uL.CIRC=2]="CIRC",uL[uL.ELIP=3]="ELIP",
uL[uL.RREC=4]="RREC";var pL=(fL.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},fL.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
fL.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},fL.prototype.apply=function(t,e){e=e||new nL;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},fL.prototype.applyInverse=function(t,e){e=e||new nL;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},fL.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
fL.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},fL.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},fL.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},fL.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},fL.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},fL.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(lL-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},fL.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},fL.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},fL.prototype.clone=function(){
var t=new fL;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},fL.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},fL.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(fL,"IDENTITY",{get:function(){return new fL},enumerable:!0,configurable:!0}),Object.defineProperty(fL,"TEMP_MATRIX",{get:function(){return new fL},
enumerable:!0,configurable:!0}),fL);function fL(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var mL=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],_L=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],yL=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vL=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],gL=[],xL=[],bL=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];gL.push(e);for(
var i=0;i<16;i++)for(var r=bL(mL[t]*mL[i]+yL[t]*_L[i]),n=bL(_L[t]*mL[i]+vL[t]*_L[i]),s=bL(mL[t]*yL[i]+yL[t]*vL[i]),o=bL(_L[t]*yL[i]+vL[t]*vL[i]),a=0;a<16;a++)if(mL[a]===r&&_L[a]===n&&yL[a]===s&&vL[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new pL
;h.set(mL[t],_L[t],yL[t],vL[t],0,0),xL.push(h)}}();var TL={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return mL[t]},uY:function(t){return _L[t]},vX:function(t){
return yL[t]},vY:function(t){return vL[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return gL[t][e]},sub:function(t,e){return gL[t][TL.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?TL.S:TL.N:2*Math.abs(e)<=Math.abs(t)?0<t?TL.E:TL.W:0<e?0<t?TL.SE:TL.SW:0<t?TL.NE:TL.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=xL[TL.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},EL=(wL.prototype.onChange=function(){this._localID++},wL.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},wL.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},wL.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},wL.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(wL.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),wL.IDENTITY=new wL,wL);function wL(){this.worldTransform=new pL,this.localTransform=new pL,this.position=new oL(this.onChange,
this,0,0),this.scale=new oL(this.onChange,this,1,1),this.pivot=new oL(this.onChange,this,0,0),this.skew=new oL(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var AL=(Object.defineProperty(SL.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(SL.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(SL.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(SL.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(SL,"EMPTY"
,{get:function(){return new SL(0,0,0,0)},enumerable:!0,configurable:!0}),SL.prototype.clone=function(){return new SL(this.x,this.y,this.width,this.height)},SL.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},SL.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},SL.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},SL.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},SL.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},SL.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
SL.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},SL);function SL(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=hL.RECT}IL.prototype.clone=function(){return new IL(this.x,this.y,this.radius)},
IL.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},IL.prototype.getBounds=function(){return new AL(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function IL(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=hL.CIRC}CL.prototype.clone=function(){return new CL(this.x,this.y,this.width,this.height)},CL.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},CL.prototype.getBounds=function(){return new AL(this.x-this.width,this.y-this.height,this.width,this.height)};function CL(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=hL.ELIP}OL.prototype.clone=function(){var t=new OL(this.points.slice());return t.closeStroke=this.closeStroke,t},
OL.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function OL(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof nL){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=hL.POLY,this.closeStroke=!0}
RL.prototype.clone=function(){return new RL(this.x,this.y,this.width,this.height,this.radius)},RL.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function RL(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=hL.RREC}BN.SORTABLE_CHILDREN=!1;function PL(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}PL.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},PL.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},PL.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?AL.EMPTY:((
t=t||new AL(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},PL.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},PL.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},PL.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
PL.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},PL.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},PL.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
PL.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},PL.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},PL.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},PL.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},PL.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},PL.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},PL.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var ML=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new EL,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new PL,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new AL),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new AL),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*cL},e.angle.set=function(t){this.transform.rotation=t*dL
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function NL(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}ML.prototype.displayObjectUpdateTransform=ML.prototype.updateTransform;var LL=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=BN.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);HN(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,HN(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,HN(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(NL),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(ML);LL.prototype.containerUpdateTransform=LL.prototype.updateTransform;var FL,DL,UL=(BL.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,
u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},BL.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,
this.items=this.items.slice(0))},BL.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},BL.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(
this.ensureNonAliasedItems(),this.items.splice(e,1)),this},BL.prototype.contains=function(t){return-1!==this.items.indexOf(t)},BL.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},BL.prototype.destroy=function(){
this.removeAll(),this.items=null,this._name=null},Object.defineProperty(BL.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(BL.prototype,"name",{get:function(){return this._name},
enumerable:!0,configurable:!0}),BL);function BL(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(UL.prototype,{dispatch:{value:UL.prototype.emit},run:{value:UL.prototype.emit}}),BN.TARGET_FPMS=.06,(DL=FL=FL||{}
)[DL.INTERACTION=50]="INTERACTION",DL[DL.HIGH=25]="HIGH",DL[DL.NORMAL=0]="NORMAL",DL[DL.LOW=-25]="LOW",DL[DL.UTILITY=-50]="UTILITY";var kL=(XL.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},
XL.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},XL.prototype.connect=function(t){(this.previous=t).next&&(
t.next.previous=this),this.next=t.next,t.next=this},XL.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous)
;var e=this.next;return this.next=t?null:e,this.previous=null,e},XL);function XL(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}
var GL=(VL.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},VL.prototype._cancelIfNeeded=function(){
null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},VL.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},VL.prototype.add=function(t,e,i){return void 0===i&&(
i=FL.NORMAL),this._addListener(new kL(t,e,i))},VL.prototype.addOnce=function(t,e,i){return void 0===i&&(i=FL.NORMAL),this._addListener(new kL(t,e,i,!0))},VL.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(
t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},VL.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next
;return this._head.next||this._cancelIfNeeded(),this},VL.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},VL.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},
VL.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},VL.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((
e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,
this.deltaTime=this.deltaMS*BN.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(VL.prototype,"FPS",{get:function(
){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(VL.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,BN.TARGET_FPMS)
;this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(VL.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(VL,"shared",{get:function(){if(!VL._shared){var t=VL._shared=new VL;t.autoStart=!0,t._protected=!0}return VL._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(VL,"system",{get:function(){if(!VL._system){var t=VL._system=new VL;t.autoStart=!0,t._protected=!0}return VL._system},enumerable:!0,configurable:!0}),VL);function VL(){var e=this;this._head=new kL(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/BN.TARGET_FPMS,this.elapsedMS=1/BN.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}jL.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,FL.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?GL.shared:new GL,t.autoStart&&this.start()},jL.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function jL(){}function HL(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,
this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new UL("setRealSize",2),this.onUpdate=new UL("update"),this.onError=new UL("onError",1)}var YL={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}}
;HL.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},HL.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),
this.onError.remove(t)},HL.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},YL.valid.get=function(){return!!this._width&&!!this._height},HL.prototype.update=function(){
this.destroyed||this.onUpdate.run()},HL.prototype.load=function(){return Promise.resolve()},YL.width.get=function(){return this._width},YL.height.get=function(){return this._height},HL.prototype.upload=function(t,e,i){return!1},
HL.prototype.style=function(t,e,i){return!1},HL.prototype.dispose=function(){},HL.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,
this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(HL.prototype,YL);var zL=function(r){function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,
this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:")
)return"";e=e||window.location,(eL=eL||document.createElement("a")).href=t;var i=!(t=H.a.parse(eL.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(
t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===CN.UNPACK),
this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){
var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(HL),
WL=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,
this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==e.createBitmap?e.createBitmap:BN.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(
this.createBitmap=t),this._load||(this._load=new Promise(function(t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e(
):(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(
this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===CN.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process
):Promise.resolve(this)},t.prototype.upload=function(t,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(
o.prototype.upload.call(this,t,e,i,this.bitmap),!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},
t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(zL),qL=[];function KL(t,e){if(!t)return null;var i=""
;if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=qL.length-1;0<=n;--n){var s=qL[n];if(s.test&&s.test(t,i))return new s(t,e)}return new WL(t,e)}var ZL=function(s){function t(t,e){var i=e||{},r=i.width,
n=i.height;if(!r||!n)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl
;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===CN.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,
i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(HL),JL={scaleMode:TN.NEAREST,
format:_N.RGBA,alphaMode:CN.NPM},QL=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target
,d=e.resolution,p=e.resourceOptions;!t||t instanceof HL||((t=KL(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||BN.RESOLUTION,this.mipmap=void 0!==r?r:BN.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:BN.ANISOTROPIC_LEVEL,
this.wrapMode=h||BN.WRAP_MODE,this.scaleMode=void 0!==s?s:BN.SCALE_MODE,this.format=u||_N.RGBA,this.type=l||xN.UNSIGNED_BYTE,this.target=c||vN.TEXTURE_2D,this.alphaMode=void 0!==i?i:CN.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=zN(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=qN(this.realWidth
)&&qN(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete QN[this.cacheId],delete JN[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=BN.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+zN()),t._pixiId);var s=QN[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new ZL(t,{width:e,height:i}),
s=t instanceof Float32Array?xN.FLOAT:xN.UNSIGNED_BYTE;return new o(n,Object.assign(JL,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),QN[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),QN[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=QN[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete QN[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete QN[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);QL._globalBatch=0;var $L=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new QL;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(KL(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=vN.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(HL),
tF=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(zL),
eF=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=vN.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=vN.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}($L);eF.SIDES=6;var iF=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+zN(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(zL)
;iF.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var rF=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=GL.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(GL.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(GL.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&GL.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(GL.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(GL.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(zL);rF.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var nF=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(zL);qL.push(WL,nF,tF,rF,iF,ZL,eF,$L);function sF(t){this.renderer=t}
sF.prototype.destroy=function(){this.renderer=null};function oF(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new UL("disposeFramebuffer",2)}var aF=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===CN.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(ZL),hF={colorTexture:{configurable:!0}};hF.colorTexture.get=function(){return this.colorTextures[0]},oF.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new QL(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},oF.prototype.addDepthTexture=function(t){return this.depthTexture=t||new QL(new aF(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:_N.DEPTH_COMPONENT,type:xN.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},oF.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},oF.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},oF.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},oF.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(oF.prototype,hF);function uF(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var lF=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new oF(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(QL);uF.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=TL.add(i,TL.NW),this.x0=a+s*TL.uX(i),this.y0=h+o*TL.uY(i),i=TL.add(i,2),this.x1=a+s*TL.uX(i),this.y1=h+o*TL.uY(i),i=TL.add(i,2),this.x2=a+s*TL.uX(i),this.y2=h+o*TL.uY(i),i=TL.add(i,2),
this.x3=a+s*TL.uX(i),this.y3=h+o*TL.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var cF=new uF,dF=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new AL(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=cF,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new nL(s.x,s.y):new nL(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&JN[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===cF&&(this._uvs=new uF),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=BN.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+zN()),t._pixiId);var s=JN[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=iL(t)),(s=new a(new QL(t,e))).baseTexture.cacheId=n,
QL.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(QL.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new WL(t);r.url=e;var n=new a(new QL(r,{scaleMode:BN.SCALE_MODE,resolution:iL(e)}));return i=i||e,
QL.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(QL.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),JN[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),JN[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=JN[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete JN[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)JN[t.textureCacheIds[r]]===t&&delete JN[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function pF(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}dF.EMPTY=new dF(new QL),pF(dF.EMPTY),pF(dF.EMPTY.baseTexture),dF.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new dF(new QL(new tF(t)))}(),pF(dF.WHITE),pF(dF.WHITE.baseTexture);function fF(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var mF=function(a){function n(t,e){var i=null;if(!(t instanceof lF)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new lF({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new lF(t))},n}(dF);fF.prototype.createTexture=function(t,e){var i=new lF(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new mF(i)},
fF.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=fF.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=WN(t)))<<16|65535&(e=WN(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},fF.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
fF.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},fF.prototype.returnFilterTexture=function(t){this.returnTexture(t)},fF.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},fF.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=fF.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},fF.SCREEN_KEY="screen";function _F(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}_F.prototype.destroy=function(){this.buffer=null},_F.from=function(t,e,i,r,n){return new _F(t,e,i,r,n)};function yF(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=vF++,this.disposeRunner=new UL("disposeBuffer",2)}var vF=0;function gF(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}yF.prototype.update=function(t){this.data=t||this.data,this._updateID++},yF.prototype.dispose=function(){this.disposeRunner.run(this,!1)},yF.prototype.destroy=function(){this.dispose(),this.data=null},yF.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new yF(t)};var xF={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function bF(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=EF++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new UL("disposeGeometry",2),this.refCount=0}var TF={5126:4,5123:2,5121:1},EF=0,wF={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};bF.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new yF(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new _F(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},bF.prototype.getAttribute=function(t){return this.attributes[t]},bF.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},bF.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new yF(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
bF.prototype.getIndex=function(){return this.indexBuffer},bF.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new yF;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*TF[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=gF(c)
;n[d]||(n[d]=new xF[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},bF.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},bF.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},bF.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},bF.prototype.clone=function(){for(var t=new bF,e=0;e<this.buffers.length;e++)t.buffers[e]=new yF(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new _F(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},bF.merge=function(t){for(var e,i=new bF,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(wF[gF(e.buffers[h].data)])(n[h]),i.buffers[h]=new yF(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*TF[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function AF(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=CF++,this.static=!!e}var SF=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(bF),
IF=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new yF(this.vertices),this.uvBuffer=new yF(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(bF),CF=0
;AF.prototype.update=function(){this.dirtyId++},AF.prototype.add=function(t,e,i){this.uniforms[t]=new AF(e,i)},AF.from=function(t,e){return new AF(t,e)};function OF(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new AL,this.destinationFrame=new AL,this.filters=[]}OF.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function RF(t){this.renderer=t}var PF=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new fF,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new SF,this.quadUv=new IF,this.tempRect=new AL,this.activeState={},this.globalUniforms=new AF({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new OF,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(fN.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(fN.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
pL.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(sF);RF.prototype.flush=function(){},RF.prototype.destroy=function(){this.renderer=null},RF.prototype.start=function(){},RF.prototype.stop=function(){this.flush()},RF.prototype.render=function(t){};var MF=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new RF(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(sF);BN.PREFER_ENV=u.a.any?hN.WEBGL:hN.WEBGL2,BN.STRICT_TEXTURE_CACHE=!1
;function NF(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function LF(t){this.type=LN.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var FF=0,DF=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=FF++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=FF++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(BN.PREFER_ENV>=hN.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(sF),UF=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new oF(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new AL,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;BN.PREFER_ENV===hN.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new AL},Object.defineProperties(t.prototype,i),t}(sF),BF={5126:4,5123:2,5121:1},
kF=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;BN.PREFER_ENV===hN.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*BF[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*BF[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*BF[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new NF(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(sF);function XF(t,e,i,r){var n=GF(t,t.VERTEX_SHADER,e),s=GF(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function GF(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function VF(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return jF(2*e)
;case"bvec3":return jF(3*e);case"bvec4":return jF(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function jF(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}LF.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=LN.NONE,this.autoDetect=!0),this._target=null},LF.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var HF,YF={},zF=YF;function WF(){if(zF===YF||zF&&zF.isContextLost()){
var t,e=document.createElement("canvas");BN.PREFER_ENV>=hN.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),zF=t}return zF}function qF(t,e,i){if(
"precision"===t.substring(0,9))return i!==MN.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===MN.HIGH&&i!==MN.HIGH&&(r=MN.MEDIUM),"precision "+r+" float;\n"+t}var KF={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var ZF=null,JF={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function QF(t,e){if(!ZF){var i=Object.keys(JF)
;ZF={};for(var r=0;r<i.length;++r){var n=i[r];ZF[t[n]]=JF[n]}}return ZF[e]}var $F={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},tD={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var eD,iD=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function rD(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function nD(t,e,i){void 0===i&&(i="pixi-shader"),this.id=sD++,this.vertexSrc=t||nD.defaultVertexSrc,
this.fragmentSrc=e||nD.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),oD[i]?(oD[i]++,i+="-"+oD[i]):oD[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=qF(this.vertexSrc,BN.PRECISION_VERTEX,MN.HIGH),this.fragmentSrc=qF(this.fragmentSrc,BN.PRECISION_FRAGMENT,function(
){if(!HF){HF=MN.MEDIUM;var t=WF();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);HF=e.precision?MN.HIGH:MN.MEDIUM}}return HF}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var sD=0,oD={},aD={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};nD.prototype.extractData=function(t,e){var i=WF();if(i){var r=XF(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},nD.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=QF(e,a.type),u={type:h,name:a.name,size:(i=h,KF[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
nD.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=QF(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:VF(h,s.size)}}return i},aD.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},aD.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},nD.from=function(t,e,i){var r=t+e,n=ZN[r];return n||(ZN[r]=n=new nD(t
,e,i)),n},Object.defineProperties(nD,aD);function hD(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof AF?e:new AF(e):new AF({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var uD={uniforms:{configurable:!0}};hD.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
hD.prototype.destroy=function(){this.uniformGroup=null},uD.uniforms.get=function(){return this.uniformGroup.uniforms},hD.from=function(t,e,i){var r=nD.from(t,e);return new hD(r,i)},Object.defineProperties(hD.prototype,uD);function lD(){this.data=0,
this.blendMode=dN.NORMAL,this.polygonOffset=0,this.blend=!0}var cD={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};cD.blend.get=function(){return!!(1&this.data)},cD.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},cD.offsets.get=function(){return!!(2&this.data)},cD.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
cD.culling.get=function(){return!!(4&this.data)},cD.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},cD.depthTest.get=function(){return!!(8&this.data)},cD.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
cD.clockwiseFrontFace.get=function(){return!!(16&this.data)},cD.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},cD.blendMode.get=function(){return this._blendMode},cD.blendMode.set=function(t){this.blend=t!==dN.NONE,
this._blendMode=t},cD.polygonOffset.get=function(){return this._polygonOffset},cD.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},lD.for2d=function(){var t=new lD;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
lD.prototype,cD);var dD=function(n){function s(t,e,i){var r=nD.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=BN.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new lD}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(hD);dD.SOURCE_KEY_MAP={};function pD(t,e){this._texture=t,this.mapCoord=new pL,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var fD=new pL,mD={texture:{configurable:!0}};mD.texture.get=function(){return this._texture},mD.texture.set=function(t){this._texture=t,this._updateID=-1},pD.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},pD.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(fD.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(fD));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(pD.prototype,mD);function _D(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var yD=function(i){
function t(t){var e=new pL;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new pD(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(dD),vD=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new LF;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case LN.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case LN.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case LN.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case LN.SCISSOR:this.renderer.scissor.pop();break;case LN.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case LN.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=LN.SPRITE;else if(t.type=LN.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=LN.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new yD(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(sF),gD=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(sF),xD=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(gD),bD=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(gD),TD=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new pL,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(sF),ED=new AL,wD=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new AL,this.destinationFrame=new AL}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(ED.width=s.realWidth,ED.height=s.realHeight,i=ED),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
ED.width=n.width,ED.height=n.height,i=ED),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(sF)
;_D.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var AD=0,SD=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=AD++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof eD)return eD;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;eD=!0===t({a:"b"},"a","b")}catch(t){eD=!1}return eD}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?$F:tD)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=XF(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:VF(h.type,h.size)}}var u=new _D(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(sF);function ID(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var CD=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=dN.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new lD,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[dN.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.ADD]=[t.ONE,t.ONE],e[dN.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[dN.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[dN.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[dN.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.NONE]=[0,0],e[dN.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[dN.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[dN.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[dN.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[dN.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[dN.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[dN.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[dN.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[dN.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[dN.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[dN.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(sF),OD=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=BN.GC_MAX_IDLE,
this.checkCountMax=BN.GC_MAX_CHECK_COUNT,this.mode=BN.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==RN.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(sF),RD=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new QL}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new ID(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new ID(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new ID(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===xN.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&HN(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==SN.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=wN.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===TN.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(sF),PD=new pL;X.a;function MD(){this.texArray=null,this.blend=0,this.type=fN.TRIANGLES,this.start=0,this.size=0,this.data=null}function ND(){this.elements=[],this.ids=[],this.count=0}ND.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function LD(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var FD={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};FD.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},FD.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},FD.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},FD.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},FD.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},LD.prototype.view=function(t){
return this[t+"View"]},LD.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},LD.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(LD.prototype,FD);var DD=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=lD.for2d(),this.size=4*BN.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;BN.PREFER_ENV===hN.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),BN.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=iD.replace(/%forloop%/gi,rD(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new MD);for(;e.length<r;)e.push(new ND);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++QL._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;QL._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=VN[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;BN.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),BN.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=WN(Math.ceil(t/8)),i=KN(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new LD(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=WN(Math.ceil(t/12)),i=KN(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?jN(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(
var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(RF);DD._drawCallPool=[],DD._textureArrayPool=[];function UD(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error(
'Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}UD.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i
;this.defaultGroupCache[t]=AF.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new nD(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),
translationMatrix:new pL,default:this.defaultGroupCache[t]};return new hD(this.programCache[t],n)},UD.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",
e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};function BD(){}var kD=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new yF(null,t,!1),this._indexBuffer=new yF(null,t,!0),
this.addAttribute("aVertexPosition",this._buffer,2,!1,xN.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,xN.FLOAT).addAttribute("aColor",this._buffer,4,!0,xN.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,xN.FLOAT).addIndex(
this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(bF),
XD="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,GD="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",VD={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};BD.create=function(t){var e=Object.assign({vertex:XD,fragment:GD,geometryClass:kD,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new UD(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(DD)},VD.defaultVertexSrc.get=function(){return XD},VD.defaultFragmentTemplate.get=function(){
return GD},Object.defineProperties(BD,VD);BD.create();function jD(t,e,i){this.geometry=new bF,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var n=t[r];n={attributeName:n.attributeName,
size:n.size,uploadFunction:n.uploadFunction,type:n.type||xN.FLOAT,offset:n.offset},e[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,
this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}var HD=function(n){function t(t,e,i,r){void 0===t&&(t=1500),void 0===i&&(i=16384),void 0===r&&(r=!1),n.call(this);16384<i&&(
i=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=dN.NORMAL,this.autoResize=r,this.roundPixels=!0,this.baseTexture=null,
this.setProperties(e),this._tint=0,this.tintRgb=new Float32Array(4),this.tint=16777215}n&&(t.__proto__=n);var e={tint:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.setProperties=function(t){t&&(
this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],
this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},e.tint.get=function(){
return this._tint},e.tint.set=function(t){GN(this._tint=t,this.tintRgb)},t.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(
this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},
t.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},t.prototype.dispose=function(){if(this._buffers){for(
var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},t.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},
Object.defineProperties(t.prototype,e),t}(LL);jD.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new yF(function(t,e){void 0===e&&(e=null);var i=6*t;if((e=e||new Uint16Array(i)).length!==i)throw new Error(
"Out buffer length is incorrect, got "+e.length+" and expected "+i);for(var r=0,n=0;r<i;r+=6,n+=4)e[r+0]=n+0,e[r+1]=n+1,e[r+2]=n+2,e[r+3]=n+0,e[r+4]=n+2,e[r+5]=n+3;return e}(this.size),!0,!0),t.addIndex(this.indexBuffer);for(
var i=this.dynamicStride=0;i<this.dynamicProperties.length;++i){var r=this.dynamicProperties[i];r.offset=e,e+=r.size,this.dynamicStride+=r.size}var n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),
this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new yF(this.dynamicData,!1,!1);for(var s=0,o=this.staticStride=0;o<this.staticProperties.length;++o){var a=this.staticProperties[o];a.offset=s,s+=a.size,this.staticStride+=a.size}
var h=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new yF(this.staticData,!0,!1);for(var u=0;u<this.dynamicProperties.length;++u){
var l=this.dynamicProperties[u];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===xN.UNSIGNED_BYTE,l.type,4*this.dynamicStride,4*l.offset)}for(var c=0;c<this.staticProperties.length;++c){var d=this.staticProperties[c];t.addAttribute(
d.attributeName,this.staticBuffer,0,d.type===xN.UNSIGNED_BYTE,d.type,4*this.staticStride,4*d.offset)}},jD.prototype.uploadDynamic=function(t,e,i){for(var r=0;r<this.dynamicProperties.length;r++){var n=this.dynamicProperties[r];n.uploadFunction(t,e,i,
n.type===xN.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},jD.prototype.uploadStatic=function(t,e,i){for(var r=0;r<this.staticProperties.length;r++){var n=this.staticProperties[r]
;n.uploadFunction(t,e,i,n.type===xN.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},jD.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,
this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()};var YD=function(e){function t(t){e.call(this,t),this.shader=null,
this.properties=null,this.tempMatrix=new pL,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{
attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:xN.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],
this.shader=hD.from(
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n"
,"varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{})}return e&&(t.__proto__=e),((t.prototype=Object.create(
e&&e.prototype)).constructor=t).prototype.render=function(t){var e=t.children,i=t._maxSize,r=t._batchSize,n=this.renderer,s=e.length;if(0!==s){i<s&&!t.autoResize&&(s=i);var o=t._buffers;o=o||(t._buffers=this.generateBuffers(t))
;var a=e[0]._texture.baseTexture;this.renderer.state.setBlendMode(function(t,e){return VN[e?1:0][t]}(t.blendMode,a.alphaMode));var h=n.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),
this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=function(t,e,i,r){return i=i||new Float32Array(4),r||void 0===r?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e):(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=e,i}(t.tintRgb,t.worldAlpha,
this.shader.uniforms.uColor,a.alphaMode),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var l=!1,c=0,d=0;c<s;c+=r,d+=1){var p=s-c;r<p&&(p=r),d>=o.length&&o.push(this._generateOneMoreBuffer(t));var f=o[d];f.uploadDynamic(e,c,p)
;var m=t._bufferUpdateIDs[d]||0;(l=l||f._updateID<m)&&(f._updateID=t._updateID,f.uploadStatic(e,c,p)),n.geometry.bind(f.geometry),h.drawElements(h.TRIANGLES,6*p,h.UNSIGNED_SHORT,0)}}},t.prototype.generateBuffers=function(t){for(var e=[],i=t._maxSize,
r=t._batchSize,n=t._properties,s=0;s<i;s+=r)e.push(new jD(this.properties,n,r));return e},t.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,i=t._properties;return new jD(this.properties,i,e)},t.prototype.uploadVertices=function(t,e,i,r,n,s
){for(var o=0,a=0,h=0,u=0,l=0;l<i;++l){var c=t[e+l],d=c._texture,p=c.scale.x,f=c.scale.y,m=d.trim,_=d.orig;m?(o=(a=m.x-c.anchor.x*_.width)+m.width,h=(u=m.y-c.anchor.y*_.height)+m.height):(o=_.width*(1-c.anchor.x),a=_.width*-c.anchor.x,h=_.height*(
1-c.anchor.y),u=_.height*-c.anchor.y),r[s]=a*p,r[s+1]=u*f,r[s+n]=o*p,r[s+n+1]=u*f,r[s+2*n]=o*p,r[s+2*n+1]=h*f,r[s+3*n]=a*p,r[s+3*n+1]=h*f,s+=4*n}},t.prototype.uploadPosition=function(t,e,i,r,n,s){for(var o=0;o<i;o++){var a=t[e+o].position;r[s]=a.x,
r[s+1]=a.y,r[s+n]=a.x,r[s+n+1]=a.y,r[s+2*n]=a.x,r[s+2*n+1]=a.y,r[s+3*n]=a.x,r[s+3*n+1]=a.y,s+=4*n}},t.prototype.uploadRotation=function(t,e,i,r,n,s){for(var o=0;o<i;o++){var a=t[e+o].rotation;r[s]=a,r[s+n]=a,r[s+2*n]=a,r[s+3*n]=a,s+=4*n}},
t.prototype.uploadUvs=function(t,e,i,r,n,s){for(var o=0;o<i;++o){var a=t[e+o]._texture._uvs;a?(r[s]=a.x0,r[s+1]=a.y0,r[s+n]=a.x1,r[s+n+1]=a.y1,r[s+2*n]=a.x2,r[s+2*n+1]=a.y2,r[s+3*n]=a.x3,r[s+3*n+1]=a.y3):(r[s]=0,r[s+1]=0,r[s+n]=0,r[s+n+1]=0,r[s+2*n]=0,
r[s+2*n+1]=0,r[s+3*n]=0,r[s+3*n+1]=0),s+=4*n}},t.prototype.uploadTint=function(t,e,i,r,n,s){for(var o=0;o<i;++o){var a=t[e+o],h=0<a._texture.baseTexture.alphaMode,u=a.alpha,l=u<1&&h?jN(a._tintRGB,u):a._tintRGB+(255*u<<24);r[s]=l,r[s+n]=l,r[s+2*n]=l,
r[s+3*n]=l,s+=4*n}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},t}(RF),zD=(WD.prototype.clone=function(){return new WD(this.x,this.y)},
WD.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},WD.prototype.copyTo=function(t){return t.set(this.x,this.y),t},WD.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},WD.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},WD);function WD(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var qD=(KD.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new KD(t,e,this._x,this._y)},
KD.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},KD.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},KD.prototype.copyTo=function(t){return t.set(this._x,this._y),t},KD.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(KD.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(KD.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),KD);function KD(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var ZD,JD,QD=2*Math.PI,$D=180/Math.PI,tU=Math.PI/180;(JD=ZD=ZD||{})[JD.POLY=0]="POLY",JD[JD.RECT=1]="RECT",JD[JD.CIRC=2]="CIRC",JD[JD.ELIP=3]="ELIP",
JD[JD.RREC=4]="RREC";var eU=(iU.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},iU.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
iU.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},iU.prototype.apply=function(t,e){e=e||new zD;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},iU.prototype.applyInverse=function(t,e){e=e||new zD;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},iU.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
iU.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},iU.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},iU.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},iU.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},iU.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},iU.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(QD-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},iU.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},iU.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},iU.prototype.clone=function(){
var t=new iU;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},iU.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},iU.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(iU,"IDENTITY",{get:function(){return new iU},enumerable:!0,configurable:!0}),Object.defineProperty(iU,"TEMP_MATRIX",{get:function(){return new iU},
enumerable:!0,configurable:!0}),iU);function iU(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var rU=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],nU=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],sU=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],oU=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],aU=[],hU=[],uU=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];aU.push(e);for(
var i=0;i<16;i++)for(var r=uU(rU[t]*rU[i]+sU[t]*nU[i]),n=uU(nU[t]*rU[i]+oU[t]*nU[i]),s=uU(rU[t]*sU[i]+sU[t]*oU[i]),o=uU(nU[t]*sU[i]+oU[t]*oU[i]),a=0;a<16;a++)if(rU[a]===r&&nU[a]===n&&sU[a]===s&&oU[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new eU
;h.set(rU[t],nU[t],sU[t],oU[t],0,0),hU.push(h)}}();var lU={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return rU[t]},uY:function(t){return nU[t]},vX:function(t){
return sU[t]},vY:function(t){return oU[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return aU[t][e]},sub:function(t,e){return aU[t][lU.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?lU.S:lU.N:2*Math.abs(e)<=Math.abs(t)?0<t?lU.E:lU.W:0<e?0<t?lU.SE:lU.SW:0<t?lU.NE:lU.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=hU[lU.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},cU=(dU.prototype.onChange=function(){this._localID++},dU.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},dU.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},dU.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},dU.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(dU.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),dU.IDENTITY=new dU,dU);function dU(){this.worldTransform=new eU,this.localTransform=new eU,this.position=new qD(this.onChange,
this,0,0),this.scale=new qD(this.onChange,this,1,1),this.pivot=new qD(this.onChange,this,0,0),this.skew=new qD(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var pU=(Object.defineProperty(fU.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(fU.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(fU.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(fU.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(fU,"EMPTY"
,{get:function(){return new fU(0,0,0,0)},enumerable:!0,configurable:!0}),fU.prototype.clone=function(){return new fU(this.x,this.y,this.width,this.height)},fU.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},fU.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},fU.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},fU.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},fU.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},fU.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
fU.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},fU);function fU(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=ZD.RECT}mU.prototype.clone=function(){return new mU(this.x,this.y,this.radius)},
mU.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},mU.prototype.getBounds=function(){return new pU(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function mU(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=ZD.CIRC}_U.prototype.clone=function(){return new _U(this.x,this.y,this.width,this.height)},_U.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},_U.prototype.getBounds=function(){return new pU(this.x-this.width,this.y-this.height,this.width,this.height)};function _U(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=ZD.ELIP}yU.prototype.clone=function(){var t=new yU(this.points.slice());return t.closeStroke=this.closeStroke,t},
yU.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function yU(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof zD){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=ZD.POLY,this.closeStroke=!0}
vU.prototype.clone=function(){return new vU(this.x,this.y,this.width,this.height,this.radius)},vU.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function vU(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=ZD.RREC}var gU=(xU.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,
u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},xU.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,
this.items=this.items.slice(0))},xU.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},xU.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(
this.ensureNonAliasedItems(),this.items.splice(e,1)),this},xU.prototype.contains=function(t){return-1!==this.items.indexOf(t)},xU.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},xU.prototype.destroy=function(){
this.removeAll(),this.items=null,this._name=null},Object.defineProperty(xU.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(xU.prototype,"name",{get:function(){return this._name},
enumerable:!0,configurable:!0}),xU);function xU(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(gU.prototype,{dispatch:{value:gU.prototype.emit},run:{value:gU.prototype.emit}});var bU,TU,EU,wU,AU,SU,IU,CU,OU,RU,PU,MU,NU,LU,FU,DU,
UU,BU,kU,XU,GU,VU,jU,HU,YU,zU,WU,qU,KU={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/)
;if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,
autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",
PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(TU=bU=bU||{})[TU.WEBGL_LEGACY=0]="WEBGL_LEGACY",TU[TU.WEBGL=1]="WEBGL",TU[TU.WEBGL2=2]="WEBGL2",(wU=EU=EU||{}
)[wU.UNKNOWN=0]="UNKNOWN",wU[wU.WEBGL=1]="WEBGL",wU[wU.CANVAS=2]="CANVAS",(SU=AU=AU||{})[SU.NORMAL=0]="NORMAL",SU[SU.ADD=1]="ADD",SU[SU.MULTIPLY=2]="MULTIPLY",SU[SU.SCREEN=3]="SCREEN",SU[SU.OVERLAY=4]="OVERLAY",SU[SU.DARKEN=5]="DARKEN",
SU[SU.LIGHTEN=6]="LIGHTEN",SU[SU.COLOR_DODGE=7]="COLOR_DODGE",SU[SU.COLOR_BURN=8]="COLOR_BURN",SU[SU.HARD_LIGHT=9]="HARD_LIGHT",SU[SU.SOFT_LIGHT=10]="SOFT_LIGHT",SU[SU.DIFFERENCE=11]="DIFFERENCE",SU[SU.EXCLUSION=12]="EXCLUSION",SU[SU.HUE=13]="HUE",
SU[SU.SATURATION=14]="SATURATION",SU[SU.COLOR=15]="COLOR",SU[SU.LUMINOSITY=16]="LUMINOSITY",SU[SU.NORMAL_NPM=17]="NORMAL_NPM",SU[SU.ADD_NPM=18]="ADD_NPM",SU[SU.SCREEN_NPM=19]="SCREEN_NPM",SU[SU.NONE=20]="NONE",SU[SU.SRC_OVER=0]="SRC_OVER",
SU[SU.SRC_IN=21]="SRC_IN",SU[SU.SRC_OUT=22]="SRC_OUT",SU[SU.SRC_ATOP=23]="SRC_ATOP",SU[SU.DST_OVER=24]="DST_OVER",SU[SU.DST_IN=25]="DST_IN",SU[SU.DST_OUT=26]="DST_OUT",SU[SU.DST_ATOP=27]="DST_ATOP",SU[SU.ERASE=26]="ERASE",SU[SU.SUBTRACT=28]="SUBTRACT",
SU[SU.XOR=29]="XOR",(CU=IU=IU||{})[CU.POINTS=0]="POINTS",CU[CU.LINES=1]="LINES",CU[CU.LINE_LOOP=2]="LINE_LOOP",CU[CU.LINE_STRIP=3]="LINE_STRIP",CU[CU.TRIANGLES=4]="TRIANGLES",CU[CU.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",CU[CU.TRIANGLE_FAN=6]="TRIANGLE_FAN",(
RU=OU=OU||{})[RU.RGBA=6408]="RGBA",RU[RU.RGB=6407]="RGB",RU[RU.ALPHA=6406]="ALPHA",RU[RU.LUMINANCE=6409]="LUMINANCE",RU[RU.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",RU[RU.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",RU[RU.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(
MU=PU=PU||{})[MU.TEXTURE_2D=3553]="TEXTURE_2D",MU[MU.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",MU[MU.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",MU[MU.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",
MU[MU.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",MU[MU.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",MU[MU.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",
MU[MU.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",MU[MU.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(LU=NU=NU||{})[LU.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",LU[LU.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",
LU[LU.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",LU[LU.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",LU[LU.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",LU[LU.FLOAT=5126]="FLOAT",LU[LU.HALF_FLOAT=36193]="HALF_FLOAT",(DU=FU=FU||{}
)[DU.NEAREST=0]="NEAREST",DU[DU.LINEAR=1]="LINEAR",(BU=UU=UU||{})[BU.CLAMP=33071]="CLAMP",BU[BU.REPEAT=10497]="REPEAT",BU[BU.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(XU=kU=kU||{})[XU.OFF=0]="OFF",XU[XU.POW2=1]="POW2",XU[XU.ON=2]="ON",(VU=GU=GU||{}
)[VU.NPM=0]="NPM",VU[VU.UNPACK=1]="UNPACK",VU[VU.PMA=2]="PMA",VU[VU.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",VU[VU.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",VU[VU.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(HU=jU=jU||{})[HU.AUTO=0]="AUTO",
HU[HU.MANUAL=1]="MANUAL",(zU=YU=YU||{}).LOW="lowp",zU.MEDIUM="mediump",zU.HIGH="highp",(qU=WU=WU||{})[qU.NONE=0]="NONE",qU[qU.SCISSOR=1]="SCISSOR",qU[qU.STENCIL=2]="STENCIL",qU[qU.SPRITE=3]="SPRITE",KU.RETINA_PREFIX=/@([0-9\.]+)x/;var ZU,JU=!(
KU.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),QU="5.2.0";var $U=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[AU.NORMAL_NPM]=AU.NORMAL,t[AU.ADD_NPM]=AU.ADD,t[AU.SCREEN_NPM]=AU.SCREEN,e[AU.NORMAL]=AU.NORMAL_NPM,e[AU.ADD]=AU.ADD_NPM,
e[AU.SCREEN]=AU.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function tB(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var eB=0;function iB(){return++eB}function rB(t){return t+=0===t,--t
,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function nB(t){return!(t&t-1||!t)}function sB(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var oB={},aB=Object.create(null),
hB=Object.create(null);function uB(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||KU.RESOLUTION,this.resize(t,e)}var lB={width:{configurable:!0},height:{configurable:!0}}
;uB.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},uB.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},
uB.prototype.destroy=function(){this.context=null,this.canvas=null},lB.width.get=function(){return this.canvas.width},lB.width.set=function(t){this.canvas.width=t},lB.height.get=function(){return this.canvas.height},lB.height.set=function(t){
this.canvas.height=t},Object.defineProperties(uB.prototype,lB);var cB;function dB(t,e){var i=KU.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var pB,fB,mB={};KU.TARGET_FPMS=.06,(fB=pB=pB||{})[fB.INTERACTION=50]="INTERACTION",
fB[fB.HIGH=25]="HIGH",fB[fB.NORMAL=0]="NORMAL",fB[fB.LOW=-25]="LOW",fB[fB.UTILITY=-50]="UTILITY";var _B=(yB.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},yB.prototype.emit=function(t){this.fn&&(
this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},yB.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},
yB.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,
e},yB);function yB(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var vB=(gB.prototype._requestIfNeeded=function(){
null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},gB.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(
this._requestId),this._requestId=null)},gB.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},gB.prototype.add=function(t,e,i){return void 0===i&&(i=pB.NORMAL),this._addListener(new _B(t,e,i))},
gB.prototype.addOnce=function(t,e,i){return void 0===i&&(i=pB.NORMAL),this._addListener(new _B(t,e,i,!0))},gB.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}
t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},gB.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},
gB.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},gB.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},gB.prototype.destroy=function(){if(!this._protected){this.stop();for(
var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},gB.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),
e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*KU.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime)
;r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(gB.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(gB.prototype,
"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,KU.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(gB.prototype,"maxFPS",{
get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(gB,
"shared",{get:function(){if(!gB._shared){var t=gB._shared=new gB;t.autoStart=!0,t._protected=!0}return gB._shared},enumerable:!0,configurable:!0}),Object.defineProperty(gB,"system",{get:function(){if(!gB._system){var t=gB._system=new gB;t.autoStart=!0,
t._protected=!0}return gB._system},enumerable:!0,configurable:!0}),gB);function gB(){var e=this;this._head=new _B(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,
this.deltaMS=1/KU.TARGET_FPMS,this.elapsedMS=1/KU.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),
e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}xB.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){
this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,pB.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?vB.shared:new vB,t.autoStart&&this.start()},xB.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function xB(){}KU.SORTABLE_CHILDREN=!1;function bB(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0
,this.maxY=-1/0,this.rect=null}bB.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},bB.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},bB.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?pU.EMPTY:((t=t||new pU(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},bB.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(
this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},bB.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},bB.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(
t.worldTransform,e,i,r,n)},bB.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(
_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},bB.prototype.addVertexData=function(t,e
,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},bB.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(
t.worldTransform,e,i,r)},bB.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c
;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},bB.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,
this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},bB.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(
i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},bB.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},
bB.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY
;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},bB.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},bB.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,
e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var TB=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new cU,
this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new bB,this._boundsID=0,this._lastBoundsID=-1,
this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{
configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},
mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},
e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)
):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,
this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new pU),e=this._boundsRect),this._bounds.getRectangle(e)},
n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new pU),t=this._localBoundsRect);var r=this.getBounds(!1,t)
;return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error(
"setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0)
,void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),
this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,
this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){
return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){
return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},
e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*$D},e.angle.set=function(t){
this.transform.rotation=t*tU},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},
e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},
Object.defineProperties(n.prototype,e),n}(X.a);function EB(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}TB.prototype.displayObjectUpdateTransform=TB.prototype.updateTransform;var wB=function(n){function t(){
n.call(this),this.children=[],this.sortableChildren=KU.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t
).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,
this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);tB(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,tB(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,tB(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(EB),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(TB);wB.prototype.containerUpdateTransform=wB.prototype.updateTransform;function AB(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new gU(
"setRealSize",2),this.onUpdate=new gU("update"),this.onError=new gU("onError",1)}var SB={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};AB.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},AB.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},AB.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},SB.valid.get=function(){return!!this._width&&!!this._height},AB.prototype.update=function(){this.destroyed||this.onUpdate.run()},AB.prototype.load=function(){return Promise.resolve()},
SB.width.get=function(){return this._width},SB.height.get=function(){return this._height},AB.prototype.upload=function(t,e,i){return!1},AB.prototype.style=function(t,e,i){return!1},AB.prototype.dispose=function(){},AB.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(AB.prototype,SB);var IB=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(cB=cB||document.createElement("a")).href=t;var i=!(t=H.a.parse(cB.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===GU.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(AB),CB=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:KU.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===GU.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(IB),OB=[];function RB(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=OB.length-1;0<=n;--n){var s=OB[n];if(s.test&&s.test(t,i))return new s(t,e)}return new CB(t,e)}var PB=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===GU.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(AB),MB={scaleMode:FU.NEAREST,format:OU.RGBA,
alphaMode:GU.NPM},NB=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof AB||((t=RB(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||KU.RESOLUTION,this.mipmap=void 0!==r?r:KU.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:KU.ANISOTROPIC_LEVEL,
this.wrapMode=h||KU.WRAP_MODE,this.scaleMode=void 0!==s?s:KU.SCALE_MODE,this.format=u||OU.RGBA,this.type=l||NU.UNSIGNED_BYTE,this.target=c||PU.TEXTURE_2D,this.alphaMode=void 0!==i?i:GU.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=iB(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=nB(this.realWidth
)&&nB(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete hB[this.cacheId],delete aB[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=KU.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+iB()),t._pixiId);var s=hB[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new PB(t,{width:e,height:i}),
s=t instanceof Float32Array?NU.FLOAT:NU.UNSIGNED_BYTE;return new o(n,Object.assign(MB,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),hB[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),hB[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=hB[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete hB[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete hB[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);NB._globalBatch=0;var LB=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new NB;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(RB(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=PU.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(AB),
FB=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(IB),
DB=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=PU.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=PU.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(LB);DB.SIDES=6;var UB=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+iB(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(IB)
;UB.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var BB=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=vB.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(vB.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(vB.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&vB.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(vB.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(vB.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(IB);BB.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var kB=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(IB);OB.push(CB,kB,FB,BB,UB,PB,DB,LB);function XB(t){this.renderer=t}
XB.prototype.destroy=function(){this.renderer=null};function GB(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new gU("disposeFramebuffer",2)}var VB=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===GU.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(PB),jB={colorTexture:{configurable:!0}};jB.colorTexture.get=function(){return this.colorTextures[0]},GB.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new NB(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},GB.prototype.addDepthTexture=function(t){return this.depthTexture=t||new NB(new VB(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:OU.DEPTH_COMPONENT,type:NU.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},GB.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},GB.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},GB.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},GB.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(GB.prototype,jB);function HB(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var YB=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new GB(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(NB);HB.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=lU.add(i,lU.NW),this.x0=a+s*lU.uX(i),this.y0=h+o*lU.uY(i),i=lU.add(i,2),this.x1=a+s*lU.uX(i),this.y1=h+o*lU.uY(i),i=lU.add(i,2),this.x2=a+s*lU.uX(i),this.y2=h+o*lU.uY(i),i=lU.add(i,2),
this.x3=a+s*lU.uX(i),this.y3=h+o*lU.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var zB=new HB,WB=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new pU(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=zB,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new zD(s.x,s.y):new zD(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&aB[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===zB&&(this._uvs=new HB),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=KU.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+iB()),t._pixiId);var s=aB[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=dB(t)),(s=new a(new NB(t,e))).baseTexture.cacheId=n,
NB.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(NB.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new CB(t);r.url=e;var n=new a(new NB(r,{scaleMode:KU.SCALE_MODE,resolution:dB(e)}));return i=i||e,
NB.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(NB.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),aB[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),aB[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=aB[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete aB[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)aB[t.textureCacheIds[r]]===t&&delete aB[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function qB(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}WB.EMPTY=new WB(new NB),qB(WB.EMPTY),qB(WB.EMPTY.baseTexture),WB.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new WB(new NB(new FB(t)))}(),qB(WB.WHITE),qB(WB.WHITE.baseTexture);function KB(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var ZB=function(a){function n(t,e){var i=null;if(!(t instanceof YB)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new YB({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new YB(t))},n}(WB);KB.prototype.createTexture=function(t,e){var i=new YB(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new ZB(i)},
KB.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=KB.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=rB(t)))<<16|65535&(e=rB(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},KB.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
KB.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},KB.prototype.returnFilterTexture=function(t){this.returnTexture(t)},KB.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},KB.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=KB.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},KB.SCREEN_KEY="screen";function JB(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}JB.prototype.destroy=function(){this.buffer=null},JB.from=function(t,e,i,r,n){return new JB(t,e,i,r,n)};function QB(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=$B++,this.disposeRunner=new gU("disposeBuffer",2)}var $B=0;function tk(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}QB.prototype.update=function(t){this.data=t||this.data,this._updateID++},QB.prototype.dispose=function(){this.disposeRunner.run(this,!1)},QB.prototype.destroy=function(){this.dispose(),this.data=null},QB.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new QB(t)};var ek={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function ik(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=nk++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new gU("disposeGeometry",2),this.refCount=0}var rk={5126:4,5123:2,5121:1},nk=0,sk={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};ik.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new QB(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new JB(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},ik.prototype.getAttribute=function(t){return this.attributes[t]},ik.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},ik.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new QB(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
ik.prototype.getIndex=function(){return this.indexBuffer},ik.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new QB;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*rk[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=tk(c)
;n[d]||(n[d]=new ek[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},ik.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},ik.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},ik.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},ik.prototype.clone=function(){for(var t=new ik,e=0;e<this.buffers.length;e++)t.buffers[e]=new QB(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new JB(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},ik.merge=function(t){for(var e,i=new ik,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(sk[tk(e.buffers[h].data)])(n[h]),i.buffers[h]=new QB(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*rk[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function ok(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=uk++,this.static=!!e}var ak=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(ik),
hk=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new QB(this.vertices),this.uvBuffer=new QB(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(ik),uk=0
;ok.prototype.update=function(){this.dirtyId++},ok.prototype.add=function(t,e,i){this.uniforms[t]=new ok(e,i)},ok.from=function(t,e){return new ok(t,e)};function lk(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new pU,this.destinationFrame=new pU,this.filters=[]}lk.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function ck(t){this.renderer=t}var dk=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new KB,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new ak,this.quadUv=new hk,this.tempRect=new pU,this.activeState={},this.globalUniforms=new ok({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new lk,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(IU.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(IU.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
eU.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(XB);ck.prototype.flush=function(){},ck.prototype.destroy=function(){this.renderer=null},ck.prototype.start=function(){},ck.prototype.stop=function(){this.flush()},ck.prototype.render=function(t){};var pk=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new ck(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(XB);KU.PREFER_ENV=u.a.any?bU.WEBGL:bU.WEBGL2,KU.STRICT_TEXTURE_CACHE=!1
;function fk(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function mk(t){this.type=WU.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var _k=0,yk=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=_k++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=_k++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(KU.PREFER_ENV>=bU.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(XB),vk=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new GB(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new pU,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;KU.PREFER_ENV===bU.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new pU},Object.defineProperties(t.prototype,i),t}(XB),gk={5126:4,5123:2,5121:1},
xk=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;KU.PREFER_ENV===bU.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*gk[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*gk[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*gk[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new fk(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(XB);function bk(t,e,i,r){var n=Tk(t,t.VERTEX_SHADER,e),s=Tk(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Tk(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function Ek(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return wk(2*e)
;case"bvec3":return wk(3*e);case"bvec4":return wk(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function wk(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}mk.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=WU.NONE,this.autoDetect=!0),this._target=null},mk.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var Ak,Sk={},Ik=Sk;function Ck(){if(Ik===Sk||Ik&&Ik.isContextLost()){
var t,e=document.createElement("canvas");KU.PREFER_ENV>=bU.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),Ik=t}return Ik}function Ok(t,e,i){if(
"precision"===t.substring(0,9))return i!==YU.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===YU.HIGH&&i!==YU.HIGH&&(r=YU.MEDIUM),"precision "+r+" float;\n"+t}var Rk={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var Pk=null,Mk={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function Nk(t,e){if(!Pk){var i=Object.keys(Mk)
;Pk={};for(var r=0;r<i.length;++r){var n=i[r];Pk[t[n]]=Mk[n]}}return Pk[e]}var Lk={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Fk={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Dk,Uk=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function Bk(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function kk(t,e,i){void 0===i&&(i="pixi-shader"),this.id=Xk++,this.vertexSrc=t||kk.defaultVertexSrc,
this.fragmentSrc=e||kk.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Gk[i]?(Gk[i]++,i+="-"+Gk[i]):Gk[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Ok(this.vertexSrc,KU.PRECISION_VERTEX,YU.HIGH),this.fragmentSrc=Ok(this.fragmentSrc,KU.PRECISION_FRAGMENT,function(
){if(!Ak){Ak=YU.MEDIUM;var t=Ck();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Ak=e.precision?YU.HIGH:YU.MEDIUM}}return Ak}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var Xk=0,Gk={},Vk={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};kk.prototype.extractData=function(t,e){var i=Ck();if(i){var r=bk(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},kk.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=Nk(e,a.type),u={type:h,name:a.name,size:(i=h,Rk[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
kk.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=Nk(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:Ek(h,s.size)}}return i},Vk.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},Vk.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},kk.from=function(t,e,i){var r=t+e,n=oB[r];return n||(oB[r]=n=new kk(t
,e,i)),n},Object.defineProperties(kk,Vk);function jk(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof ok?e:new ok(e):new ok({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var Hk={uniforms:{configurable:!0}};jk.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
jk.prototype.destroy=function(){this.uniformGroup=null},Hk.uniforms.get=function(){return this.uniformGroup.uniforms},jk.from=function(t,e,i){var r=kk.from(t,e);return new jk(r,i)},Object.defineProperties(jk.prototype,Hk);function Yk(){this.data=0,
this.blendMode=AU.NORMAL,this.polygonOffset=0,this.blend=!0}var zk={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};zk.blend.get=function(){return!!(1&this.data)},zk.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},zk.offsets.get=function(){return!!(2&this.data)},zk.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
zk.culling.get=function(){return!!(4&this.data)},zk.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},zk.depthTest.get=function(){return!!(8&this.data)},zk.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
zk.clockwiseFrontFace.get=function(){return!!(16&this.data)},zk.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},zk.blendMode.get=function(){return this._blendMode},zk.blendMode.set=function(t){this.blend=t!==AU.NONE,
this._blendMode=t},zk.polygonOffset.get=function(){return this._polygonOffset},zk.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Yk.for2d=function(){var t=new Yk;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
Yk.prototype,zk);var Wk=function(n){function s(t,e,i){var r=kk.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=KU.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Yk}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(jk);Wk.SOURCE_KEY_MAP={};function qk(t,e){this._texture=t,this.mapCoord=new eU,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var Kk=new eU,Zk={texture:{configurable:!0}};Zk.texture.get=function(){return this._texture},Zk.texture.set=function(t){this._texture=t,this._updateID=-1},qk.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},qk.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(Kk.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Kk));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(qk.prototype,Zk);function Jk(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Qk=function(i){
function t(t){var e=new eU;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new qk(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(Wk),$k=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new mk;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case WU.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case WU.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case WU.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case WU.SCISSOR:this.renderer.scissor.pop();break;case WU.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case WU.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=WU.SPRITE;else if(t.type=WU.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=WU.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new Qk(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(XB),tX=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(XB),eX=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(tX),iX=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(tX),rX=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new eU,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(XB),nX=new pU,sX=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new pU,this.destinationFrame=new pU}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(nX.width=s.realWidth,nX.height=s.realHeight,i=nX),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
nX.width=n.width,nX.height=n.height,i=nX),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(XB)
;Jk.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var oX=0,aX=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=oX++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Dk)return Dk;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;Dk=!0===t({a:"b"},"a","b")}catch(t){Dk=!1}return Dk}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?Lk:Fk)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=bk(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Ek(h.type,h.size)}}var u=new Jk(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(XB);function hX(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var uX=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=AU.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Yk,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[AU.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.ADD]=[t.ONE,t.ONE],e[AU.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[AU.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[AU.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[AU.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.NONE]=[0,0],e[AU.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[AU.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[AU.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[AU.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[AU.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[AU.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[AU.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[AU.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[AU.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[AU.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[AU.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(XB),lX=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=KU.GC_MAX_IDLE,
this.checkCountMax=KU.GC_MAX_CHECK_COUNT,this.mode=KU.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==jU.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(XB),cX=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new NB}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new hX(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new hX(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new hX(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===NU.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&tB(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==kU.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=UU.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===FU.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(XB),dX=new eU;X.a;function pX(){this.texArray=null,this.blend=0,this.type=IU.TRIANGLES,this.start=0,this.size=0,this.data=null}function fX(){this.elements=[],this.ids=[],this.count=0}fX.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function mX(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var _X={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};_X.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},_X.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},_X.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},_X.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},_X.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},mX.prototype.view=function(t){
return this[t+"View"]},mX.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},mX.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(mX.prototype,_X);var yX=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Yk.for2d(),this.size=4*KU.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;KU.PREFER_ENV===bU.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),KU.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Uk.replace(/%forloop%/gi,Bk(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new pX);for(;e.length<r;)e.push(new fX);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++NB._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;NB._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=$U[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;KU.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),KU.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=rB(Math.ceil(t/8)),i=sB(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new mX(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=rB(Math.ceil(t/12)),i=sB(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(ck);yX._drawCallPool=[],yX._textureArrayPool=[];function vX(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}vX.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=ok.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new kk(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new eU,default:this.defaultGroupCache[t]};return new jk(this.programCache[t],n)},
vX.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function gX(){}var xX=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new QB(null,t,!1),this._indexBuffer=new QB(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,NU.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,NU.FLOAT).addAttribute("aColor",this._buffer,4,!0,NU.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,NU.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(ik),
bX="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,TX="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",EX={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};gX.create=function(t){var e=Object.assign({vertex:bX,fragment:TX,geometryClass:xX,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new vX(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(yX)},EX.defaultVertexSrc.get=function(){return bX},EX.defaultFragmentTemplate.get=function(){
return TX},Object.defineProperties(gX,EX);function wX(t,e,i){void 0===i&&(i=null),this.baseTexture=t,this.textures={},this.animations={},this.data=e,this.resolution=this._updateResolution(i||(this.baseTexture.resource?this.baseTexture.resource.url:null)),
this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}gX.create();var AX={BATCH_SIZE:{configurable:!0}};AX.BATCH_SIZE.get=function(){return 1e3},wX.prototype._updateResolution=function(t){
var e=this.data.meta.scale,i=dB(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&this.baseTexture.setResolution(i),i},wX.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=wX.BATCH_SIZE?(
this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},wX.prototype._processFrames=function(t){for(var e=t,i=wX.BATCH_SIZE;e-t<i&&e<this._frameKeys.length;){var r=this._frameKeys[e],n=this._frames[r],s=n.frame;if(s){
var o=null,a=null,h=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,u=new pU(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);o=n.rotated?new pU(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h
)/this.resolution,Math.floor(s.w)/this.resolution):new pU(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(a=new pU(Math.floor(
n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[r]=new WB(this.baseTexture,o,u,a,n.rotated?2:0,n.anchor),WB.addToCache(this.textures[r],
r)}e++}},wX.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var i=0;i<t[e].length;i++){var r=t[e][i];this.animations[e].push(this.textures[r])}}},wX.prototype._parseComplete=function(){
var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},wX.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*wX.BATCH_SIZE),this._batchIndex++,setTimeout(function(){
t._batchIndex*wX.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},wX.prototype.destroy=function(t){for(var e in void 0===t&&(t=!1),this.textures)this.textures[e].destroy();this._frames=null,
this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},Object.defineProperties(wX,AX);function SX(){}SX.use=function(i,r){var t=i.name+"_image";if(
i.data&&i.type===DN.TYPE.JSON&&i.data.frames&&!this.resources[t]){var e={crossOrigin:i.crossOrigin,metadata:i.metadata.imageMetadata,parentResource:i},n=SX.getResourcePath(i,this.baseUrl);this.add(t,n,e,function(t){if(t.error)r(t.error);else{var e=new wX(
t.texture.baseTexture,i.data,i.url);e.parse(function(){i.spritesheet=e,i.textures=e.textures,r()})}})}else r()},SX.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:H.a.resolve(t.url.replace(e,""),t.data.meta.image)};var IX=(
CX.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,
this},CX.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},CX.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),
this.items.push(t)),this},CX.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},CX.prototype.contains=function(t){return-1!==this.items.indexOf(t)},
CX.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},CX.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(CX.prototype,"empty",{get:function(){
return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(CX.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),CX);function CX(t){this.items=[],this._name=t,this._aliasCount=0}
Object.defineProperties(IX.prototype,{dispatch:{value:IX.prototype.emit},run:{value:IX.prototype.emit}});var OX,RX,PX,MX,NX,LX,FX,DX,UX,BX,kX,XX,GX,VX,jX,HX,YX,zX,WX,qX,KX,ZX,JX,QX,$X,tG,eG,iG,rG={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,
FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(
/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,
height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,
ROUND_PIXELS:!1};(RX=OX=OX||{})[RX.WEBGL_LEGACY=0]="WEBGL_LEGACY",RX[RX.WEBGL=1]="WEBGL",RX[RX.WEBGL2=2]="WEBGL2",(MX=PX=PX||{})[MX.UNKNOWN=0]="UNKNOWN",MX[MX.WEBGL=1]="WEBGL",MX[MX.CANVAS=2]="CANVAS",(LX=NX=NX||{})[LX.NORMAL=0]="NORMAL",
LX[LX.ADD=1]="ADD",LX[LX.MULTIPLY=2]="MULTIPLY",LX[LX.SCREEN=3]="SCREEN",LX[LX.OVERLAY=4]="OVERLAY",LX[LX.DARKEN=5]="DARKEN",LX[LX.LIGHTEN=6]="LIGHTEN",LX[LX.COLOR_DODGE=7]="COLOR_DODGE",LX[LX.COLOR_BURN=8]="COLOR_BURN",LX[LX.HARD_LIGHT=9]="HARD_LIGHT",
LX[LX.SOFT_LIGHT=10]="SOFT_LIGHT",LX[LX.DIFFERENCE=11]="DIFFERENCE",LX[LX.EXCLUSION=12]="EXCLUSION",LX[LX.HUE=13]="HUE",LX[LX.SATURATION=14]="SATURATION",LX[LX.COLOR=15]="COLOR",LX[LX.LUMINOSITY=16]="LUMINOSITY",LX[LX.NORMAL_NPM=17]="NORMAL_NPM",
LX[LX.ADD_NPM=18]="ADD_NPM",LX[LX.SCREEN_NPM=19]="SCREEN_NPM",LX[LX.NONE=20]="NONE",LX[LX.SRC_OVER=0]="SRC_OVER",LX[LX.SRC_IN=21]="SRC_IN",LX[LX.SRC_OUT=22]="SRC_OUT",LX[LX.SRC_ATOP=23]="SRC_ATOP",LX[LX.DST_OVER=24]="DST_OVER",LX[LX.DST_IN=25]="DST_IN",
LX[LX.DST_OUT=26]="DST_OUT",LX[LX.DST_ATOP=27]="DST_ATOP",LX[LX.ERASE=26]="ERASE",LX[LX.SUBTRACT=28]="SUBTRACT",LX[LX.XOR=29]="XOR",(DX=FX=FX||{})[DX.POINTS=0]="POINTS",DX[DX.LINES=1]="LINES",DX[DX.LINE_LOOP=2]="LINE_LOOP",DX[DX.LINE_STRIP=3]="LINE_STRIP"
,DX[DX.TRIANGLES=4]="TRIANGLES",DX[DX.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",DX[DX.TRIANGLE_FAN=6]="TRIANGLE_FAN",(BX=UX=UX||{})[BX.RGBA=6408]="RGBA",BX[BX.RGB=6407]="RGB",BX[BX.ALPHA=6406]="ALPHA",BX[BX.LUMINANCE=6409]="LUMINANCE",
BX[BX.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",BX[BX.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",BX[BX.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(XX=kX=kX||{})[XX.TEXTURE_2D=3553]="TEXTURE_2D",XX[XX.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",
XX[XX.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",XX[XX.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",XX[XX.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
XX[XX.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",XX[XX.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",XX[XX.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
XX[XX.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(VX=GX=GX||{})[VX.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",VX[VX.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",VX[VX.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
VX[VX.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",VX[VX.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",VX[VX.FLOAT=5126]="FLOAT",VX[VX.HALF_FLOAT=36193]="HALF_FLOAT",(HX=jX=jX||{})[HX.NEAREST=0]="NEAREST",HX[HX.LINEAR=1]="LINEAR",(
zX=YX=YX||{})[zX.CLAMP=33071]="CLAMP",zX[zX.REPEAT=10497]="REPEAT",zX[zX.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(qX=WX=WX||{})[qX.OFF=0]="OFF",qX[qX.POW2=1]="POW2",qX[qX.ON=2]="ON",(ZX=KX=KX||{})[ZX.NPM=0]="NPM",ZX[ZX.UNPACK=1]="UNPACK",
ZX[ZX.PMA=2]="PMA",ZX[ZX.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ZX[ZX.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ZX[ZX.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(QX=JX=JX||{})[QX.AUTO=0]="AUTO",QX[QX.MANUAL=1]="MANUAL",(tG=$X=$X||{}
).LOW="lowp",tG.MEDIUM="mediump",tG.HIGH="highp",(iG=eG=eG||{})[iG.NONE=0]="NONE",iG[iG.SCISSOR=1]="SCISSOR",iG[iG.STENCIL=2]="STENCIL",iG[iG.SPRITE=3]="SPRITE",rG.RETINA_PREFIX=/@([0-9\.]+)x/;var nG,sG=!(rG.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),oG="5.2.0"
;var aG=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[NX.NORMAL_NPM]=NX.NORMAL,t[NX.ADD_NPM]=NX.ADD,t[NX.SCREEN_NPM]=NX.SCREEN,e[NX.NORMAL]=NX.NORMAL_NPM,e[NX.ADD]=NX.ADD_NPM,e[NX.SCREEN]=NX.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function hG(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var uG=0;function lG(){return++uG}function cG(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function dG(t){
return!(t&t-1||!t)}function pG(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var fG={},mG=Object.create(null),_G=Object.create(null);function yG(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||rG.RESOLUTION,this.resize(t,e)}var vG={width:{configurable:!0},height:{configurable:!0}};yG.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},yG.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},yG.prototype.destroy=function(){this.context=null,this.canvas=null},vG.width.get=function(){
return this.canvas.width},vG.width.set=function(t){this.canvas.width=t},vG.height.get=function(){return this.canvas.height},vG.height.set=function(t){this.canvas.height=t},Object.defineProperties(yG.prototype,vG);var gG;function xG(t,e){
var i=rG.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var bG,TG,EG={};rG.TARGET_FPMS=.06,(TG=bG=bG||{})[TG.INTERACTION=50]="INTERACTION",TG[TG.HIGH=25]="HIGH",TG[TG.NORMAL=0]="NORMAL",TG[TG.LOW=-25]="LOW",TG[TG.UTILITY=-50]="UTILITY"
;var wG=(AG.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},AG.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),
this._destroyed&&(this.next=null),e},AG.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},AG.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,
this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},AG);function AG(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,
this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var SG=(IG.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},IG.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},IG.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},IG.prototype.add=function(t,e,i){return void 0===i&&(i=bG.NORMAL),this._addListener(new wG(t,e,i))},IG.prototype.addOnce=function(t,e,i){return void 0===i&&(i=bG.NORMAL),this._addListener(new wG(t,e,i,!0))},
IG.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},IG.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},IG.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},IG.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},IG.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},IG.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*rG.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(IG.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(IG.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,rG.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(IG.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(IG,"shared",{get:function(){if(!IG._shared){var t=IG._shared=new IG;t.autoStart=!0,t._protected=!0}return IG._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(IG,"system",{get:function(){if(!IG._system){var t=IG._system=new IG;t.autoStart=!0,t._protected=!0}return IG._system},enumerable:!0,configurable:!0}),IG);function IG(){var e=this;this._head=new wG(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/rG.TARGET_FPMS,this.elapsedMS=1/rG.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}CG.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,bG.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?SG.shared:new SG,t.autoStart&&this.start()},CG.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function CG(){}var OG=(RG.prototype.clone=function(){return new RG(this.x,this.y)},
RG.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},RG.prototype.copyTo=function(t){return t.set(this.x,this.y),t},RG.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},RG.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},RG);function RG(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var PG=(MG.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new MG(t,e,this._x,this._y)},
MG.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},MG.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},MG.prototype.copyTo=function(t){return t.set(this._x,this._y),t},MG.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(MG.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(MG.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),MG);function MG(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var NG,LG,FG=2*Math.PI,DG=180/Math.PI,UG=Math.PI/180;(LG=NG=NG||{})[LG.POLY=0]="POLY",LG[LG.RECT=1]="RECT",LG[LG.CIRC=2]="CIRC",LG[LG.ELIP=3]="ELIP",
LG[LG.RREC=4]="RREC";var BG=(kG.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},kG.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
kG.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},kG.prototype.apply=function(t,e){e=e||new OG;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},kG.prototype.applyInverse=function(t,e){e=e||new OG;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},kG.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
kG.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},kG.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},kG.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},kG.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},kG.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},kG.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(FG-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},kG.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},kG.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},kG.prototype.clone=function(){
var t=new kG;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},kG.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},kG.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(kG,"IDENTITY",{get:function(){return new kG},enumerable:!0,configurable:!0}),Object.defineProperty(kG,"TEMP_MATRIX",{get:function(){return new kG},
enumerable:!0,configurable:!0}),kG);function kG(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var XG=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],GG=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],VG=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],jG=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],HG=[],YG=[],zG=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];HG.push(e);for(
var i=0;i<16;i++)for(var r=zG(XG[t]*XG[i]+VG[t]*GG[i]),n=zG(GG[t]*XG[i]+jG[t]*GG[i]),s=zG(XG[t]*VG[i]+VG[t]*jG[i]),o=zG(GG[t]*VG[i]+jG[t]*jG[i]),a=0;a<16;a++)if(XG[a]===r&&GG[a]===n&&VG[a]===s&&jG[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new BG
;h.set(XG[t],GG[t],VG[t],jG[t],0,0),YG.push(h)}}();var WG={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return XG[t]},uY:function(t){return GG[t]},vX:function(t){
return VG[t]},vY:function(t){return jG[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return HG[t][e]},sub:function(t,e){return HG[t][WG.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?WG.S:WG.N:2*Math.abs(e)<=Math.abs(t)?0<t?WG.E:WG.W:0<e?0<t?WG.SE:WG.SW:0<t?WG.NE:WG.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=YG[WG.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},qG=(KG.prototype.onChange=function(){this._localID++},KG.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},KG.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},KG.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},KG.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(KG.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),KG.IDENTITY=new KG,KG);function KG(){this.worldTransform=new BG,this.localTransform=new BG,this.position=new PG(this.onChange,
this,0,0),this.scale=new PG(this.onChange,this,1,1),this.pivot=new PG(this.onChange,this,0,0),this.skew=new PG(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var ZG=(Object.defineProperty(JG.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(JG.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(JG.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(JG.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(JG,"EMPTY"
,{get:function(){return new JG(0,0,0,0)},enumerable:!0,configurable:!0}),JG.prototype.clone=function(){return new JG(this.x,this.y,this.width,this.height)},JG.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},JG.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},JG.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},JG.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},JG.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},JG.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
JG.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},JG);function JG(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=NG.RECT}QG.prototype.clone=function(){return new QG(this.x,this.y,this.radius)},
QG.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},QG.prototype.getBounds=function(){return new ZG(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function QG(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=NG.CIRC}$G.prototype.clone=function(){return new $G(this.x,this.y,this.width,this.height)},$G.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},$G.prototype.getBounds=function(){return new ZG(this.x-this.width,this.y-this.height,this.width,this.height)};function $G(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=NG.ELIP}tV.prototype.clone=function(){var t=new tV(this.points.slice());return t.closeStroke=this.closeStroke,t},
tV.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function tV(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof OG){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=NG.POLY,this.closeStroke=!0}
eV.prototype.clone=function(){return new eV(this.x,this.y,this.width,this.height,this.radius)},eV.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function eV(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=NG.RREC}rG.SORTABLE_CHILDREN=!1;function iV(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}iV.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},iV.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},iV.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?ZG.EMPTY:((
t=t||new ZG(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},iV.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},iV.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},iV.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
iV.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},iV.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},iV.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
iV.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},iV.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},iV.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},iV.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},iV.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},iV.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},iV.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var rV=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new qG,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new iV,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new ZG),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new ZG),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*DG},e.angle.set=function(t){this.transform.rotation=t*UG
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function nV(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}rV.prototype.displayObjectUpdateTransform=rV.prototype.updateTransform;var sV=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=rG.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);hG(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,hG(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,hG(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(nV),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(rV);sV.prototype.containerUpdateTransform=sV.prototype.updateTransform;function oV(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new IX(
"setRealSize",2),this.onUpdate=new IX("update"),this.onError=new IX("onError",1)}var aV={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};oV.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},oV.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},oV.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},aV.valid.get=function(){return!!this._width&&!!this._height},oV.prototype.update=function(){this.destroyed||this.onUpdate.run()},oV.prototype.load=function(){return Promise.resolve()},
aV.width.get=function(){return this._width},aV.height.get=function(){return this._height},oV.prototype.upload=function(t,e,i){return!1},oV.prototype.style=function(t,e,i){return!1},oV.prototype.dispose=function(){},oV.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(oV.prototype,aV);var hV=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(gG=gG||document.createElement("a")).href=t;var i=!(t=H.a.parse(gG.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===KX.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(oV),uV=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:rG.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===KX.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(hV),lV=[];function cV(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=lV.length-1;0<=n;--n){var s=lV[n];if(s.test&&s.test(t,i))return new s(t,e)}return new uV(t,e)}var dV=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===KX.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(oV),pV={scaleMode:jX.NEAREST,format:UX.RGBA,
alphaMode:KX.NPM},fV=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof oV||((t=cV(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||rG.RESOLUTION,this.mipmap=void 0!==r?r:rG.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:rG.ANISOTROPIC_LEVEL,
this.wrapMode=h||rG.WRAP_MODE,this.scaleMode=void 0!==s?s:rG.SCALE_MODE,this.format=u||UX.RGBA,this.type=l||GX.UNSIGNED_BYTE,this.target=c||kX.TEXTURE_2D,this.alphaMode=void 0!==i?i:KX.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=lG(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=dG(this.realWidth
)&&dG(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete _G[this.cacheId],delete mG[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=rG.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+lG()),t._pixiId);var s=_G[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new dV(t,{width:e,height:i}),
s=t instanceof Float32Array?GX.FLOAT:GX.UNSIGNED_BYTE;return new o(n,Object.assign(pV,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),_G[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),_G[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=_G[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete _G[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete _G[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);fV._globalBatch=0;var mV=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new fV;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(cV(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=kX.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(oV),
_V=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(hV),
yV=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=kX.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=kX.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(mV);yV.SIDES=6;var vV=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+lG(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(hV)
;vV.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var gV=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=SG.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(SG.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(SG.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&SG.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(SG.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(SG.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(hV);gV.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var xV=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(hV);lV.push(uV,xV,_V,gV,vV,dV,yV,mV);function bV(t){this.renderer=t}
bV.prototype.destroy=function(){this.renderer=null};function TV(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new IX("disposeFramebuffer",2)}var EV=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===KX.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(dV),wV={colorTexture:{configurable:!0}};wV.colorTexture.get=function(){return this.colorTextures[0]},TV.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new fV(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},TV.prototype.addDepthTexture=function(t){return this.depthTexture=t||new fV(new EV(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:UX.DEPTH_COMPONENT,type:GX.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},TV.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},TV.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},TV.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},TV.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(TV.prototype,wV);function AV(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var SV=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new TV(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(fV);AV.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=WG.add(i,WG.NW),this.x0=a+s*WG.uX(i),this.y0=h+o*WG.uY(i),i=WG.add(i,2),this.x1=a+s*WG.uX(i),this.y1=h+o*WG.uY(i),i=WG.add(i,2),this.x2=a+s*WG.uX(i),this.y2=h+o*WG.uY(i),i=WG.add(i,2),
this.x3=a+s*WG.uX(i),this.y3=h+o*WG.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var IV=new AV,CV=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new ZG(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=IV,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new OG(s.x,s.y):new OG(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&mG[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===IV&&(this._uvs=new AV),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=rG.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+lG()),t._pixiId);var s=mG[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=xG(t)),(s=new a(new fV(t,e))).baseTexture.cacheId=n,
fV.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(fV.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new uV(t);r.url=e;var n=new a(new fV(r,{scaleMode:rG.SCALE_MODE,resolution:xG(e)}));return i=i||e,
fV.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(fV.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),mG[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),mG[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=mG[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete mG[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)mG[t.textureCacheIds[r]]===t&&delete mG[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function OV(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}CV.EMPTY=new CV(new fV),OV(CV.EMPTY),OV(CV.EMPTY.baseTexture),CV.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new CV(new fV(new _V(t)))}(),OV(CV.WHITE),OV(CV.WHITE.baseTexture);function RV(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var PV=function(a){function n(t,e){var i=null;if(!(t instanceof SV)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new SV({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new SV(t))},n}(CV);RV.prototype.createTexture=function(t,e){var i=new SV(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new PV(i)},
RV.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=RV.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=cG(t)))<<16|65535&(e=cG(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},RV.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
RV.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},RV.prototype.returnFilterTexture=function(t){this.returnTexture(t)},RV.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},RV.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=RV.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},RV.SCREEN_KEY="screen";function MV(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}MV.prototype.destroy=function(){this.buffer=null},MV.from=function(t,e,i,r,n){return new MV(t,e,i,r,n)};function NV(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=LV++,this.disposeRunner=new IX("disposeBuffer",2)}var LV=0;function FV(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}NV.prototype.update=function(t){this.data=t||this.data,this._updateID++},NV.prototype.dispose=function(){this.disposeRunner.run(this,!1)},NV.prototype.destroy=function(){this.dispose(),this.data=null},NV.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new NV(t)};var DV={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function UV(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=kV++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new IX("disposeGeometry",2),this.refCount=0}var BV={5126:4,5123:2,5121:1},kV=0,XV={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};UV.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new NV(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new MV(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},UV.prototype.getAttribute=function(t){return this.attributes[t]},UV.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},UV.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new NV(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
UV.prototype.getIndex=function(){return this.indexBuffer},UV.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new NV;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*BV[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=FV(c)
;n[d]||(n[d]=new DV[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},UV.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},UV.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},UV.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},UV.prototype.clone=function(){for(var t=new UV,e=0;e<this.buffers.length;e++)t.buffers[e]=new NV(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new MV(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},UV.merge=function(t){for(var e,i=new UV,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(XV[FV(e.buffers[h].data)])(n[h]),i.buffers[h]=new NV(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*BV[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function GV(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=HV++,this.static=!!e}var VV=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(UV),
jV=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new NV(this.vertices),this.uvBuffer=new NV(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(UV),HV=0
;GV.prototype.update=function(){this.dirtyId++},GV.prototype.add=function(t,e,i){this.uniforms[t]=new GV(e,i)},GV.from=function(t,e){return new GV(t,e)};function YV(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new ZG,this.destinationFrame=new ZG,this.filters=[]}YV.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function zV(t){this.renderer=t}var WV=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new RV,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new VV,this.quadUv=new jV,this.tempRect=new ZG,this.activeState={},this.globalUniforms=new GV({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new YV,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(FX.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(FX.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
BG.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(bV);zV.prototype.flush=function(){},zV.prototype.destroy=function(){this.renderer=null},zV.prototype.start=function(){},zV.prototype.stop=function(){this.flush()},zV.prototype.render=function(t){};var qV=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new zV(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(bV);rG.PREFER_ENV=u.a.any?OX.WEBGL:OX.WEBGL2,rG.STRICT_TEXTURE_CACHE=!1
;function KV(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function ZV(t){this.type=eG.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var JV=0,QV=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=JV++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=JV++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(rG.PREFER_ENV>=OX.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(bV),$V=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new TV(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ZG,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;rG.PREFER_ENV===OX.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new ZG},Object.defineProperties(t.prototype,i),t}(bV),tj={5126:4,5123:2,5121:1},
ej=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;rG.PREFER_ENV===OX.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*tj[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*tj[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*tj[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new KV(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(bV);function ij(t,e,i,r){var n=rj(t,t.VERTEX_SHADER,e),s=rj(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function rj(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function nj(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return sj(2*e)
;case"bvec3":return sj(3*e);case"bvec4":return sj(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function sj(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}ZV.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=eG.NONE,this.autoDetect=!0),this._target=null},ZV.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var oj,aj={},hj=aj;function uj(){if(hj===aj||hj&&hj.isContextLost()){
var t,e=document.createElement("canvas");rG.PREFER_ENV>=OX.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),hj=t}return hj}function lj(t,e,i){if(
"precision"===t.substring(0,9))return i!==$X.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===$X.HIGH&&i!==$X.HIGH&&(r=$X.MEDIUM),"precision "+r+" float;\n"+t}var cj={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var dj=null,pj={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function fj(t,e){if(!dj){var i=Object.keys(pj)
;dj={};for(var r=0;r<i.length;++r){var n=i[r];dj[t[n]]=pj[n]}}return dj[e]}var mj={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},_j={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var yj,vj=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function gj(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function xj(t,e,i){void 0===i&&(i="pixi-shader"),this.id=bj++,this.vertexSrc=t||xj.defaultVertexSrc,
this.fragmentSrc=e||xj.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Tj[i]?(Tj[i]++,i+="-"+Tj[i]):Tj[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=lj(this.vertexSrc,rG.PRECISION_VERTEX,$X.HIGH),this.fragmentSrc=lj(this.fragmentSrc,rG.PRECISION_FRAGMENT,function(
){if(!oj){oj=$X.MEDIUM;var t=uj();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);oj=e.precision?$X.HIGH:$X.MEDIUM}}return oj}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var bj=0,Tj={},Ej={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};xj.prototype.extractData=function(t,e){var i=uj();if(i){var r=ij(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},xj.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=fj(e,a.type),u={type:h,name:a.name,size:(i=h,cj[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
xj.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=fj(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:nj(h,s.size)}}return i},Ej.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},Ej.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},xj.from=function(t,e,i){var r=t+e,n=fG[r];return n||(fG[r]=n=new xj(t
,e,i)),n},Object.defineProperties(xj,Ej);function wj(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof GV?e:new GV(e):new GV({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var Aj={uniforms:{configurable:!0}};wj.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
wj.prototype.destroy=function(){this.uniformGroup=null},Aj.uniforms.get=function(){return this.uniformGroup.uniforms},wj.from=function(t,e,i){var r=xj.from(t,e);return new wj(r,i)},Object.defineProperties(wj.prototype,Aj);function Sj(){this.data=0,
this.blendMode=NX.NORMAL,this.polygonOffset=0,this.blend=!0}var Ij={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};Ij.blend.get=function(){return!!(1&this.data)},Ij.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Ij.offsets.get=function(){return!!(2&this.data)},Ij.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
Ij.culling.get=function(){return!!(4&this.data)},Ij.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Ij.depthTest.get=function(){return!!(8&this.data)},Ij.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
Ij.clockwiseFrontFace.get=function(){return!!(16&this.data)},Ij.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Ij.blendMode.get=function(){return this._blendMode},Ij.blendMode.set=function(t){this.blend=t!==NX.NONE,
this._blendMode=t},Ij.polygonOffset.get=function(){return this._polygonOffset},Ij.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Sj.for2d=function(){var t=new Sj;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
Sj.prototype,Ij);var Cj=function(n){function s(t,e,i){var r=xj.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=rG.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Sj}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(wj);Cj.SOURCE_KEY_MAP={};function Oj(t,e){this._texture=t,this.mapCoord=new BG,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var Rj=new BG,Pj={texture:{configurable:!0}};Pj.texture.get=function(){return this._texture},Pj.texture.set=function(t){this._texture=t,this._updateID=-1},Oj.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},Oj.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(Rj.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Rj));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(Oj.prototype,Pj);function Mj(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Nj=function(i){
function t(t){var e=new BG;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new Oj(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(Cj),Lj=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new ZV;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case eG.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case eG.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case eG.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case eG.SCISSOR:this.renderer.scissor.pop();break;case eG.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case eG.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=eG.SPRITE;else if(t.type=eG.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=eG.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new Nj(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(bV),Fj=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(bV),Dj=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(Fj),Uj=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Fj),Bj=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new BG,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(bV),kj=new ZG,Xj=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new ZG,this.destinationFrame=new ZG}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(kj.width=s.realWidth,kj.height=s.realHeight,i=kj),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
kj.width=n.width,kj.height=n.height,i=kj),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(bV)
;Mj.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Gj=0,Vj=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Gj++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof yj)return yj;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;yj=!0===t({a:"b"},"a","b")}catch(t){yj=!1}return yj}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?mj:_j)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=ij(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:nj(h.type,h.size)}}var u=new Mj(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(bV);function jj(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var Hj=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=NX.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Sj,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[NX.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.ADD]=[t.ONE,t.ONE],e[NX.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[NX.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[NX.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[NX.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.NONE]=[0,0],e[NX.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[NX.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[NX.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[NX.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[NX.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[NX.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[NX.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[NX.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[NX.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[NX.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[NX.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(bV),Yj=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=rG.GC_MAX_IDLE,
this.checkCountMax=rG.GC_MAX_CHECK_COUNT,this.mode=rG.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==JX.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(bV),zj=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new fV}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new jj(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new jj(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new jj(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===GX.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&hG(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==WX.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=YX.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===jX.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(bV),Wj=new BG;X.a;function qj(){this.texArray=null,this.blend=0,this.type=FX.TRIANGLES,this.start=0,this.size=0,this.data=null}function Kj(){this.elements=[],this.ids=[],this.count=0}Kj.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function Zj(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var Jj={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Jj.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Jj.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Jj.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Jj.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Jj.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Zj.prototype.view=function(t){
return this[t+"View"]},Zj.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Zj.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Zj.prototype,Jj);var Qj=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Sj.for2d(),this.size=4*rG.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;rG.PREFER_ENV===OX.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),rG.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=vj.replace(/%forloop%/gi,gj(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new qj);for(;e.length<r;)e.push(new Kj);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++fV._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;fV._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=aG[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;rG.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),rG.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=cG(Math.ceil(t/8)),i=pG(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Zj(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=cG(Math.ceil(t/12)),i=pG(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(zV);Qj._drawCallPool=[],Qj._textureArrayPool=[];function $j(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}$j.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=GV.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new xj(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new BG,default:this.defaultGroupCache[t]};return new wj(this.programCache[t],n)},
$j.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function tH(){}var eH=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new NV(null,t,!1),this._indexBuffer=new NV(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,GX.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,GX.FLOAT).addAttribute("aColor",this._buffer,4,!0,GX.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,GX.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(UV),
iH="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,rH="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",nH={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};tH.create=function(t){var e=Object.assign({vertex:iH,fragment:rH,geometryClass:eH,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new $j(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Qj)},nH.defaultVertexSrc.get=function(){return iH},nH.defaultFragmentTemplate.get=function(){
return rH},Object.defineProperties(tH,nH);tH.create();var sH=new OG,oH=function(r){function s(t,e,i){void 0===e&&(e=100),void 0===i&&(i=100),r.call(this,t),this.tileTransform=new qG,this._width=e,this._height=i,this._canvasPattern=null,
this.uvMatrix=t.uvMatrix||new Oj(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}r&&(s.__proto__=r),(s.prototype=Object.create(r&&r.prototype)).constructor=s;var t={clampMargin:{configurable:!0},tileScale:{configurable:!0},tilePosition:{
configurable:!0},width:{configurable:!0},height:{configurable:!0}};return t.clampMargin.get=function(){return this.uvMatrix.clampMargin},t.clampMargin.set=function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},t.tileScale.get=function(){
return this.tileTransform.scale},t.tileScale.set=function(t){this.tileTransform.scale.copyFrom(t)},t.tilePosition.get=function(){return this.tileTransform.position},t.tilePosition.set=function(t){this.tileTransform.position.copyFrom(t)},
s.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},s.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),
t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},s.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),r=this._height*(
1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,r)},s.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,
this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new ZG),t=this._localBoundsRect),this._bounds.getRectangle(t)):r.prototype.getLocalBounds.call(this,t)},
s.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,sH);var e=this._width,i=this._height,r=-e*this.anchor._x;if(sH.x>=r&&sH.x<r+e){var n=-i*this.anchor._y;if(sH.y>=n&&sH.y<n+i)return!0}return!1},s.prototype.destroy=function(t){
r.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},s.from=function(t,e,i){return new s(CV.from(t),e,i)},s.fromFrame=function(t,e,i){var r=mG[t];if(!r)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this
);return new s(r,e,i)},s.fromImage=function(t,e,i,r,n){return r&&"object"!=typeof r&&(r={scaleMode:n,resourceOptions:{crossorigin:arguments[3]}}),new s(CV.from(t,r),e,i)},t.width.get=function(){return this._width},t.width.set=function(t){this._width=t},
t.height.get=function(){return this._height},t.height.set=function(t){this._height=t},Object.defineProperties(s.prototype,t),s}(ry),
aH="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n"
,hH=new BG,uH=function(i){function t(t){i.call(this,t);var e={globals:this.renderer.globalUniforms};this.shader=wj.from(aH,
"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord - floor(vTextureCoord - uClampOffset);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n"
,e),this.simpleShader=wj.from(aH,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",e),this.quad=new jV}
return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.render=function(t){var e=this.renderer,i=this.quad,r=i.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x
),r[5]=r[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((r=i.uvs)[0]=r[6]=-t.anchor.x,r[1]=r[3]=-t.anchor.y,r[2]=r[4]=1-t.anchor.x,r[5]=r[7]=1-t.anchor.y),i.invalidate();var n=t._texture,s=n.baseTexture,o=t.tileTransform.localTransform,a=t.uvMatrix,
h=s.isPowerOfTwo&&n.frame.width===s.width&&n.frame.height===s.height;h&&(s._glTextures[e.CONTEXT_UID]?h=s.wrapMode!==YX.CLAMP:s.wrapMode===YX.CLAMP&&(s.wrapMode=YX.REPEAT));var u=h?this.simpleShader:this.shader,l=n.width,c=n.height,d=t._width,p=t._height
;hH.set(o.a*l/d,o.b*l/p,o.c*c/d,o.d*c/p,o.tx/d,o.ty/p),hH.invert(),h?hH.prepend(a.mapCoord):(u.uniforms.uMapCoord=a.mapCoord.toArray(!0),u.uniforms.uClampFrame=a.uClampFrame,u.uniforms.uClampOffset=a.uClampOffset),u.uniforms.uTransform=hH.toArray(!0),
u.uniforms.uColor=function(t,e,i,r){return(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,!r&&void 0!==r||(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e,i}(t.tint,t.worldAlpha,u.uniforms.uColor,s.alphaMode),
u.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),u.uniforms.uSampler=n,e.shader.bind(u),e.geometry.bind(i),e.state.setBlendMode(function(t,e){return aG[e?1:0][t]}(t.blendMode,s.alphaMode)),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)
},t}(zV),lH=(cH.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a)
;return u===this.items&&this._aliasCount--,this},cH.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},cH.prototype.add=function(t){return t[this._name]&&(
this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},cH.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},cH.prototype.contains=function(t){
return-1!==this.items.indexOf(t)},cH.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},cH.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(cH.prototype,"empty",
{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(cH.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),cH);function cH(t){this.items=[],this._name=t,this._aliasCount=0}
Object.defineProperties(lH.prototype,{dispatch:{value:lH.prototype.emit},run:{value:lH.prototype.emit}});var dH,pH,fH,mH,_H,yH,vH,gH,xH,bH,TH,EH,wH,AH,SH,IH,CH,OH,RH,PH,MH,NH,LH,FH,DH,UH,BH,kH,XH={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,
FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(
/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,
height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,
ROUND_PIXELS:!1};(pH=dH=dH||{})[pH.WEBGL_LEGACY=0]="WEBGL_LEGACY",pH[pH.WEBGL=1]="WEBGL",pH[pH.WEBGL2=2]="WEBGL2",(mH=fH=fH||{})[mH.UNKNOWN=0]="UNKNOWN",mH[mH.WEBGL=1]="WEBGL",mH[mH.CANVAS=2]="CANVAS",(yH=_H=_H||{})[yH.NORMAL=0]="NORMAL",
yH[yH.ADD=1]="ADD",yH[yH.MULTIPLY=2]="MULTIPLY",yH[yH.SCREEN=3]="SCREEN",yH[yH.OVERLAY=4]="OVERLAY",yH[yH.DARKEN=5]="DARKEN",yH[yH.LIGHTEN=6]="LIGHTEN",yH[yH.COLOR_DODGE=7]="COLOR_DODGE",yH[yH.COLOR_BURN=8]="COLOR_BURN",yH[yH.HARD_LIGHT=9]="HARD_LIGHT",
yH[yH.SOFT_LIGHT=10]="SOFT_LIGHT",yH[yH.DIFFERENCE=11]="DIFFERENCE",yH[yH.EXCLUSION=12]="EXCLUSION",yH[yH.HUE=13]="HUE",yH[yH.SATURATION=14]="SATURATION",yH[yH.COLOR=15]="COLOR",yH[yH.LUMINOSITY=16]="LUMINOSITY",yH[yH.NORMAL_NPM=17]="NORMAL_NPM",
yH[yH.ADD_NPM=18]="ADD_NPM",yH[yH.SCREEN_NPM=19]="SCREEN_NPM",yH[yH.NONE=20]="NONE",yH[yH.SRC_OVER=0]="SRC_OVER",yH[yH.SRC_IN=21]="SRC_IN",yH[yH.SRC_OUT=22]="SRC_OUT",yH[yH.SRC_ATOP=23]="SRC_ATOP",yH[yH.DST_OVER=24]="DST_OVER",yH[yH.DST_IN=25]="DST_IN",
yH[yH.DST_OUT=26]="DST_OUT",yH[yH.DST_ATOP=27]="DST_ATOP",yH[yH.ERASE=26]="ERASE",yH[yH.SUBTRACT=28]="SUBTRACT",yH[yH.XOR=29]="XOR",(gH=vH=vH||{})[gH.POINTS=0]="POINTS",gH[gH.LINES=1]="LINES",gH[gH.LINE_LOOP=2]="LINE_LOOP",gH[gH.LINE_STRIP=3]="LINE_STRIP"
,gH[gH.TRIANGLES=4]="TRIANGLES",gH[gH.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",gH[gH.TRIANGLE_FAN=6]="TRIANGLE_FAN",(bH=xH=xH||{})[bH.RGBA=6408]="RGBA",bH[bH.RGB=6407]="RGB",bH[bH.ALPHA=6406]="ALPHA",bH[bH.LUMINANCE=6409]="LUMINANCE",
bH[bH.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",bH[bH.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",bH[bH.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(EH=TH=TH||{})[EH.TEXTURE_2D=3553]="TEXTURE_2D",EH[EH.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",
EH[EH.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",EH[EH.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",EH[EH.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
EH[EH.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",EH[EH.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",EH[EH.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
EH[EH.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(AH=wH=wH||{})[AH.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",AH[AH.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",AH[AH.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
AH[AH.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",AH[AH.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",AH[AH.FLOAT=5126]="FLOAT",AH[AH.HALF_FLOAT=36193]="HALF_FLOAT",(IH=SH=SH||{})[IH.NEAREST=0]="NEAREST",IH[IH.LINEAR=1]="LINEAR",(
OH=CH=CH||{})[OH.CLAMP=33071]="CLAMP",OH[OH.REPEAT=10497]="REPEAT",OH[OH.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(PH=RH=RH||{})[PH.OFF=0]="OFF",PH[PH.POW2=1]="POW2",PH[PH.ON=2]="ON",(NH=MH=MH||{})[NH.NPM=0]="NPM",NH[NH.UNPACK=1]="UNPACK",
NH[NH.PMA=2]="PMA",NH[NH.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",NH[NH.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",NH[NH.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(FH=LH=LH||{})[FH.AUTO=0]="AUTO",FH[FH.MANUAL=1]="MANUAL",(UH=DH=DH||{}
).LOW="lowp",UH.MEDIUM="mediump",UH.HIGH="highp",(kH=BH=BH||{})[kH.NONE=0]="NONE",kH[kH.SCISSOR=1]="SCISSOR",kH[kH.STENCIL=2]="STENCIL",kH[kH.SPRITE=3]="SPRITE",XH.RETINA_PREFIX=/@([0-9\.]+)x/;var GH,VH=!(XH.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),jH="5.2.0"
;var HH=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[_H.NORMAL_NPM]=_H.NORMAL,t[_H.ADD_NPM]=_H.ADD,t[_H.SCREEN_NPM]=_H.SCREEN,e[_H.NORMAL]=_H.NORMAL_NPM,e[_H.ADD]=_H.ADD_NPM,e[_H.SCREEN]=_H.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function YH(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var zH=0;function WH(){return++zH}function qH(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function KH(t){
return!(t&t-1||!t)}function ZH(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var JH={},QH=Object.create(null),$H=Object.create(null);function tY(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||XH.RESOLUTION,this.resize(t,e)}var eY={width:{configurable:!0},height:{configurable:!0}};tY.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},tY.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},tY.prototype.destroy=function(){this.context=null,this.canvas=null},eY.width.get=function(){
return this.canvas.width},eY.width.set=function(t){this.canvas.width=t},eY.height.get=function(){return this.canvas.height},eY.height.set=function(t){this.canvas.height=t},Object.defineProperties(tY.prototype,eY);var iY;function rY(t,e){
var i=XH.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var nY,sY,oY={};XH.TARGET_FPMS=.06,(sY=nY=nY||{})[sY.INTERACTION=50]="INTERACTION",sY[sY.HIGH=25]="HIGH",sY[sY.NORMAL=0]="NORMAL",sY[sY.LOW=-25]="LOW",sY[sY.UTILITY=-50]="UTILITY"
;var aY=(hY.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},hY.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),
this._destroyed&&(this.next=null),e},hY.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},hY.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,
this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},hY);function hY(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,
this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var uY=(lY.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},lY.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},lY.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},lY.prototype.add=function(t,e,i){return void 0===i&&(i=nY.NORMAL),this._addListener(new aY(t,e,i))},lY.prototype.addOnce=function(t,e,i){return void 0===i&&(i=nY.NORMAL),this._addListener(new aY(t,e,i,!0))},
lY.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},lY.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},lY.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},lY.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},lY.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},lY.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*XH.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(lY.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(lY.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,XH.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(lY.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(lY,"shared",{get:function(){if(!lY._shared){var t=lY._shared=new lY;t.autoStart=!0,t._protected=!0}return lY._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(lY,"system",{get:function(){if(!lY._system){var t=lY._system=new lY;t.autoStart=!0,t._protected=!0}return lY._system},enumerable:!0,configurable:!0}),lY);function lY(){var e=this;this._head=new aY(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/XH.TARGET_FPMS,this.elapsedMS=1/XH.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}cY.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,nY.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?uY.shared:new uY,t.autoStart&&this.start()},cY.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function cY(){}var dY=(pY.prototype.clone=function(){return new pY(this.x,this.y)},
pY.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},pY.prototype.copyTo=function(t){return t.set(this.x,this.y),t},pY.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},pY.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},pY);function pY(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var fY=(mY.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new mY(t,e,this._x,this._y)},
mY.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},mY.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},mY.prototype.copyTo=function(t){return t.set(this._x,this._y),t},mY.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(mY.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(mY.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),mY);function mY(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var _Y,yY,vY=2*Math.PI,gY=180/Math.PI,xY=Math.PI/180;(yY=_Y=_Y||{})[yY.POLY=0]="POLY",yY[yY.RECT=1]="RECT",yY[yY.CIRC=2]="CIRC",yY[yY.ELIP=3]="ELIP",
yY[yY.RREC=4]="RREC";var bY=(TY.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},TY.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
TY.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},TY.prototype.apply=function(t,e){e=e||new dY;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},TY.prototype.applyInverse=function(t,e){e=e||new dY;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},TY.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
TY.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},TY.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},TY.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},TY.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},TY.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},TY.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(vY-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},TY.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},TY.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},TY.prototype.clone=function(){
var t=new TY;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},TY.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},TY.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(TY,"IDENTITY",{get:function(){return new TY},enumerable:!0,configurable:!0}),Object.defineProperty(TY,"TEMP_MATRIX",{get:function(){return new TY},
enumerable:!0,configurable:!0}),TY);function TY(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var EY=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],wY=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],AY=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],SY=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],IY=[],CY=[],OY=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];IY.push(e);for(
var i=0;i<16;i++)for(var r=OY(EY[t]*EY[i]+AY[t]*wY[i]),n=OY(wY[t]*EY[i]+SY[t]*wY[i]),s=OY(EY[t]*AY[i]+AY[t]*SY[i]),o=OY(wY[t]*AY[i]+SY[t]*SY[i]),a=0;a<16;a++)if(EY[a]===r&&wY[a]===n&&AY[a]===s&&SY[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new bY
;h.set(EY[t],wY[t],AY[t],SY[t],0,0),CY.push(h)}}();var RY={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return EY[t]},uY:function(t){return wY[t]},vX:function(t){
return AY[t]},vY:function(t){return SY[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return IY[t][e]},sub:function(t,e){return IY[t][RY.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?RY.S:RY.N:2*Math.abs(e)<=Math.abs(t)?0<t?RY.E:RY.W:0<e?0<t?RY.SE:RY.SW:0<t?RY.NE:RY.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=CY[RY.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},PY=(MY.prototype.onChange=function(){this._localID++},MY.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},MY.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},MY.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},MY.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(MY.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),MY.IDENTITY=new MY,MY);function MY(){this.worldTransform=new bY,this.localTransform=new bY,this.position=new fY(this.onChange,
this,0,0),this.scale=new fY(this.onChange,this,1,1),this.pivot=new fY(this.onChange,this,0,0),this.skew=new fY(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var NY=(Object.defineProperty(LY.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(LY.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(LY.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(LY.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(LY,"EMPTY"
,{get:function(){return new LY(0,0,0,0)},enumerable:!0,configurable:!0}),LY.prototype.clone=function(){return new LY(this.x,this.y,this.width,this.height)},LY.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},LY.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},LY.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},LY.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},LY.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},LY.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
LY.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},LY);function LY(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=_Y.RECT}FY.prototype.clone=function(){return new FY(this.x,this.y,this.radius)},
FY.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},FY.prototype.getBounds=function(){return new NY(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function FY(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=_Y.CIRC}DY.prototype.clone=function(){return new DY(this.x,this.y,this.width,this.height)},DY.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},DY.prototype.getBounds=function(){return new NY(this.x-this.width,this.y-this.height,this.width,this.height)};function DY(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=_Y.ELIP}UY.prototype.clone=function(){var t=new UY(this.points.slice());return t.closeStroke=this.closeStroke,t},
UY.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function UY(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof dY){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=_Y.POLY,this.closeStroke=!0}
BY.prototype.clone=function(){return new BY(this.x,this.y,this.width,this.height,this.radius)},BY.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function BY(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=_Y.RREC}XH.SORTABLE_CHILDREN=!1;function kY(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}kY.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},kY.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},kY.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?NY.EMPTY:((
t=t||new NY(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},kY.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},kY.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},kY.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
kY.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},kY.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},kY.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
kY.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},kY.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},kY.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},kY.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},kY.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},kY.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},kY.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var XY=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new PY,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new kY,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new NY),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new NY),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*gY},e.angle.set=function(t){this.transform.rotation=t*xY
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function GY(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}XY.prototype.displayObjectUpdateTransform=XY.prototype.updateTransform;var VY=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=XH.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);YH(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,YH(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,YH(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(GY),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(XY);VY.prototype.containerUpdateTransform=VY.prototype.updateTransform;function jY(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new lH(
"setRealSize",2),this.onUpdate=new lH("update"),this.onError=new lH("onError",1)}var HY={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};jY.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},jY.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},jY.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},HY.valid.get=function(){return!!this._width&&!!this._height},jY.prototype.update=function(){this.destroyed||this.onUpdate.run()},jY.prototype.load=function(){return Promise.resolve()},
HY.width.get=function(){return this._width},HY.height.get=function(){return this._height},jY.prototype.upload=function(t,e,i){return!1},jY.prototype.style=function(t,e,i){return!1},jY.prototype.dispose=function(){},jY.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(jY.prototype,HY);var YY=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(iY=iY||document.createElement("a")).href=t;var i=!(t=H.a.parse(iY.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===MH.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(jY),zY=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:XH.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===MH.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(YY),WY=[];function qY(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=WY.length-1;0<=n;--n){var s=WY[n];if(s.test&&s.test(t,i))return new s(t,e)}return new zY(t,e)}var KY=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===MH.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(jY),ZY={scaleMode:SH.NEAREST,format:xH.RGBA,
alphaMode:MH.NPM},JY=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof jY||((t=qY(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||XH.RESOLUTION,this.mipmap=void 0!==r?r:XH.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:XH.ANISOTROPIC_LEVEL,
this.wrapMode=h||XH.WRAP_MODE,this.scaleMode=void 0!==s?s:XH.SCALE_MODE,this.format=u||xH.RGBA,this.type=l||wH.UNSIGNED_BYTE,this.target=c||TH.TEXTURE_2D,this.alphaMode=void 0!==i?i:MH.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=WH(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=KH(this.realWidth
)&&KH(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete $H[this.cacheId],delete QH[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=XH.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+WH()),t._pixiId);var s=$H[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new KY(t,{width:e,height:i}),
s=t instanceof Float32Array?wH.FLOAT:wH.UNSIGNED_BYTE;return new o(n,Object.assign(ZY,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),$H[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),$H[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=$H[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete $H[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete $H[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);JY._globalBatch=0;var QY=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new JY;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(qY(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=TH.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(jY),
$Y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(YY),
tz=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=TH.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=TH.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(QY);tz.SIDES=6;var ez=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+WH(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(YY)
;ez.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var iz=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=uY.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(uY.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(uY.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&uY.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(uY.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(uY.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(YY);iz.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var rz=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(YY);WY.push(zY,rz,$Y,iz,ez,KY,tz,QY);function nz(t){this.renderer=t}
nz.prototype.destroy=function(){this.renderer=null};function sz(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new lH("disposeFramebuffer",2)}var oz=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===MH.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(KY),az={colorTexture:{configurable:!0}};az.colorTexture.get=function(){return this.colorTextures[0]},sz.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new JY(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},sz.prototype.addDepthTexture=function(t){return this.depthTexture=t||new JY(new oz(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:xH.DEPTH_COMPONENT,type:wH.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},sz.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},sz.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},sz.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},sz.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(sz.prototype,az);function hz(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var uz=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new sz(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(JY);hz.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=RY.add(i,RY.NW),this.x0=a+s*RY.uX(i),this.y0=h+o*RY.uY(i),i=RY.add(i,2),this.x1=a+s*RY.uX(i),this.y1=h+o*RY.uY(i),i=RY.add(i,2),this.x2=a+s*RY.uX(i),this.y2=h+o*RY.uY(i),i=RY.add(i,2),
this.x3=a+s*RY.uX(i),this.y3=h+o*RY.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var lz=new hz,cz=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new NY(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=lz,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new dY(s.x,s.y):new dY(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&QH[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===lz&&(this._uvs=new hz),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=XH.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+WH()),t._pixiId);var s=QH[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=rY(t)),(s=new a(new JY(t,e))).baseTexture.cacheId=n,
JY.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(JY.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new zY(t);r.url=e;var n=new a(new JY(r,{scaleMode:XH.SCALE_MODE,resolution:rY(e)}));return i=i||e,
JY.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(JY.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),QH[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),QH[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=QH[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete QH[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)QH[t.textureCacheIds[r]]===t&&delete QH[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function dz(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}cz.EMPTY=new cz(new JY),dz(cz.EMPTY),dz(cz.EMPTY.baseTexture),cz.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new cz(new JY(new $Y(t)))}(),dz(cz.WHITE),dz(cz.WHITE.baseTexture);function pz(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var fz=function(a){function n(t,e){var i=null;if(!(t instanceof uz)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new uz({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new uz(t))},n}(cz);pz.prototype.createTexture=function(t,e){var i=new uz(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new fz(i)},
pz.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=pz.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=qH(t)))<<16|65535&(e=qH(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},pz.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
pz.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},pz.prototype.returnFilterTexture=function(t){this.returnTexture(t)},pz.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},pz.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=pz.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},pz.SCREEN_KEY="screen";function mz(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}mz.prototype.destroy=function(){this.buffer=null},mz.from=function(t,e,i,r,n){return new mz(t,e,i,r,n)};function _z(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=yz++,this.disposeRunner=new lH("disposeBuffer",2)}var yz=0;function vz(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}_z.prototype.update=function(t){this.data=t||this.data,this._updateID++},_z.prototype.dispose=function(){this.disposeRunner.run(this,!1)},_z.prototype.destroy=function(){this.dispose(),this.data=null},_z.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new _z(t)};var gz={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function xz(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Tz++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new lH("disposeGeometry",2),this.refCount=0}var bz={5126:4,5123:2,5121:1},Tz=0,Ez={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};xz.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new _z(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new mz(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},xz.prototype.getAttribute=function(t){return this.attributes[t]},xz.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},xz.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new _z(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
xz.prototype.getIndex=function(){return this.indexBuffer},xz.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new _z;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*bz[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=vz(c)
;n[d]||(n[d]=new gz[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},xz.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},xz.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},xz.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},xz.prototype.clone=function(){for(var t=new xz,e=0;e<this.buffers.length;e++)t.buffers[e]=new _z(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new mz(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},xz.merge=function(t){for(var e,i=new xz,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(Ez[vz(e.buffers[h].data)])(n[h]),i.buffers[h]=new _z(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*bz[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function wz(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=Iz++,this.static=!!e}var Az=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(xz),
Sz=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new _z(this.vertices),this.uvBuffer=new _z(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(xz),Iz=0
;wz.prototype.update=function(){this.dirtyId++},wz.prototype.add=function(t,e,i){this.uniforms[t]=new wz(e,i)},wz.from=function(t,e){return new wz(t,e)};function Cz(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new NY,this.destinationFrame=new NY,this.filters=[]}Cz.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function Oz(t){this.renderer=t}var Rz=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new pz,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Az,this.quadUv=new Sz,this.tempRect=new NY,this.activeState={},this.globalUniforms=new wz({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Cz,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(vH.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(vH.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
bY.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(nz);Oz.prototype.flush=function(){},Oz.prototype.destroy=function(){this.renderer=null},Oz.prototype.start=function(){},Oz.prototype.stop=function(){this.flush()},Oz.prototype.render=function(t){};var Pz=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new Oz(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(nz);XH.PREFER_ENV=u.a.any?dH.WEBGL:dH.WEBGL2,XH.STRICT_TEXTURE_CACHE=!1
;function Mz(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function Nz(t){this.type=BH.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var Lz=0,Fz=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Lz++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Lz++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(XH.PREFER_ENV>=dH.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(nz),Dz=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new sz(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new NY,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;XH.PREFER_ENV===dH.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new NY},Object.defineProperties(t.prototype,i),t}(nz),Uz={5126:4,5123:2,5121:1},
Bz=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;XH.PREFER_ENV===dH.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Uz[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Uz[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Uz[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new Mz(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(nz);function kz(t,e,i,r){var n=Xz(t,t.VERTEX_SHADER,e),s=Xz(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Xz(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function Gz(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Vz(2*e)
;case"bvec3":return Vz(3*e);case"bvec4":return Vz(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Vz(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}Nz.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=BH.NONE,this.autoDetect=!0),this._target=null},Nz.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var jz,Hz={},Yz=Hz;function zz(){if(Yz===Hz||Yz&&Yz.isContextLost()){
var t,e=document.createElement("canvas");XH.PREFER_ENV>=dH.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),Yz=t}return Yz}function Wz(t,e,i){if(
"precision"===t.substring(0,9))return i!==DH.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===DH.HIGH&&i!==DH.HIGH&&(r=DH.MEDIUM),"precision "+r+" float;\n"+t}var qz={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var Kz=null,Zz={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function Jz(t,e){if(!Kz){var i=Object.keys(Zz)
;Kz={};for(var r=0;r<i.length;++r){var n=i[r];Kz[t[n]]=Zz[n]}}return Kz[e]}var Qz={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},$z={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var tW,eW=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function iW(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function rW(t,e,i){void 0===i&&(i="pixi-shader"),this.id=nW++,this.vertexSrc=t||rW.defaultVertexSrc,
this.fragmentSrc=e||rW.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),sW[i]?(sW[i]++,i+="-"+sW[i]):sW[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Wz(this.vertexSrc,XH.PRECISION_VERTEX,DH.HIGH),this.fragmentSrc=Wz(this.fragmentSrc,XH.PRECISION_FRAGMENT,function(
){if(!jz){jz=DH.MEDIUM;var t=zz();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);jz=e.precision?DH.HIGH:DH.MEDIUM}}return jz}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var nW=0,sW={},oW={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};rW.prototype.extractData=function(t,e){var i=zz();if(i){var r=kz(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},rW.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=Jz(e,a.type),u={type:h,name:a.name,size:(i=h,qz[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
rW.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=Jz(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:Gz(h,s.size)}}return i},oW.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},oW.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},rW.from=function(t,e,i){var r=t+e,n=JH[r];return n||(JH[r]=n=new rW(t
,e,i)),n},Object.defineProperties(rW,oW);function aW(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof wz?e:new wz(e):new wz({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var hW={uniforms:{configurable:!0}};aW.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
aW.prototype.destroy=function(){this.uniformGroup=null},hW.uniforms.get=function(){return this.uniformGroup.uniforms},aW.from=function(t,e,i){var r=rW.from(t,e);return new aW(r,i)},Object.defineProperties(aW.prototype,hW);function uW(){this.data=0,
this.blendMode=_H.NORMAL,this.polygonOffset=0,this.blend=!0}var lW={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};lW.blend.get=function(){return!!(1&this.data)},lW.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},lW.offsets.get=function(){return!!(2&this.data)},lW.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
lW.culling.get=function(){return!!(4&this.data)},lW.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},lW.depthTest.get=function(){return!!(8&this.data)},lW.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
lW.clockwiseFrontFace.get=function(){return!!(16&this.data)},lW.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},lW.blendMode.get=function(){return this._blendMode},lW.blendMode.set=function(t){this.blend=t!==_H.NONE,
this._blendMode=t},lW.polygonOffset.get=function(){return this._polygonOffset},lW.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},uW.for2d=function(){var t=new uW;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
uW.prototype,lW);var cW=function(n){function s(t,e,i){var r=rW.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=XH.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new uW}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(aW);cW.SOURCE_KEY_MAP={};function dW(t,e){this._texture=t,this.mapCoord=new bY,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var pW=new bY,fW={texture:{configurable:!0}};fW.texture.get=function(){return this._texture},fW.texture.set=function(t){this._texture=t,this._updateID=-1},dW.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},dW.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(pW.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(pW));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(dW.prototype,fW);function mW(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var _W=function(i){
function t(t){var e=new bY;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new dW(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(cW),yW=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new Nz;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case BH.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case BH.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case BH.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case BH.SCISSOR:this.renderer.scissor.pop();break;case BH.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case BH.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=BH.SPRITE;else if(t.type=BH.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=BH.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new _W(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(nz),vW=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(nz),gW=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(vW),xW=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(vW),bW=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new bY,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(nz),TW=new NY,EW=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new NY,this.destinationFrame=new NY}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(TW.width=s.realWidth,TW.height=s.realHeight,i=TW),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
TW.width=n.width,TW.height=n.height,i=TW),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(nz)
;mW.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var wW=0,AW=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=wW++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof tW)return tW;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;tW=!0===t({a:"b"},"a","b")}catch(t){tW=!1}return tW}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?Qz:$z)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=kz(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Gz(h.type,h.size)}}var u=new mW(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(nz);function SW(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var IW=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=_H.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new uW,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[_H.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.ADD]=[t.ONE,t.ONE],e[_H.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[_H.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[_H.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[_H.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.NONE]=[0,0],e[_H.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[_H.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[_H.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[_H.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[_H.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[_H.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[_H.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[_H.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[_H.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[_H.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[_H.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(nz),CW=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=XH.GC_MAX_IDLE,
this.checkCountMax=XH.GC_MAX_CHECK_COUNT,this.mode=XH.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==LH.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(nz),OW=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new JY}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new SW(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new SW(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new SW(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===wH.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&YH(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==RH.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=CH.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===SH.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(nz),RW=new bY;X.a;function PW(){this.texArray=null,this.blend=0,this.type=vH.TRIANGLES,this.start=0,this.size=0,this.data=null}function MW(){this.elements=[],this.ids=[],this.count=0}MW.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function NW(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var LW={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};LW.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},LW.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},LW.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},LW.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},LW.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},NW.prototype.view=function(t){
return this[t+"View"]},NW.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},NW.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(NW.prototype,LW);var FW=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=uW.for2d(),this.size=4*XH.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;XH.PREFER_ENV===dH.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),XH.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=eW.replace(/%forloop%/gi,iW(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new PW);for(;e.length<r;)e.push(new MW);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++JY._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;JY._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=HH[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;XH.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),XH.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=qH(Math.ceil(t/8)),i=ZH(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new NW(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=qH(Math.ceil(t/12)),i=ZH(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(Oz);FW._drawCallPool=[],FW._textureArrayPool=[];function DW(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}DW.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=wz.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new rW(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new bY,default:this.defaultGroupCache[t]};return new aW(this.programCache[t],n)},
DW.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function UW(){}var BW=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new _z(null,t,!1),this._indexBuffer=new _z(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,wH.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,wH.FLOAT).addAttribute("aColor",this._buffer,4,!0,wH.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,wH.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(xz),
kW="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,XW="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",GW={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};UW.create=function(t){var e=Object.assign({vertex:kW,fragment:XW,geometryClass:BW,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new DW(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(FW)},GW.defaultVertexSrc.get=function(){return kW},GW.defaultFragmentTemplate.get=function(){
return XW},Object.defineProperties(UW,GW);UW.create();var VW=function(r){function R(t,e){var i=this;void 0===e&&(e={}),r.call(this),this._textWidth=0,this._textHeight=0,this._glyphs=[],this._font={tint:void 0!==e.tint?e.tint:16777215,
align:e.align||"left",name:null,size:0},this.font=e.font,this._text=t,this._maxWidth=0,this._maxLineHeight=0,this._letterSpacing=0,this._anchor=new fY(function(){i.dirty=!0},this,0,0),this.dirty=!1,this.roundPixels=XH.ROUND_PIXELS,this.updateText()}r&&(
R.__proto__=r);var t={tint:{configurable:!0},align:{configurable:!0},anchor:{configurable:!0},font:{configurable:!0},text:{configurable:!0},maxWidth:{configurable:!0},maxLineHeight:{configurable:!0},textWidth:{configurable:!0},letterSpacing:{
configurable:!0},textHeight:{configurable:!0}};return((R.prototype=Object.create(r&&r.prototype)).constructor=R).prototype.updateText=function(){for(var t=R.fonts[this._font.name],e=this._font.size/t.size,i=new dY,r=[],n=[],s=this._text.replace(
/(?:\r\n|\r)/g,"\n")||" ",o=s.length,a=this._maxWidth*t.size/this._font.size,h=null,u=0,l=0,c=0,d=-1,p=0,f=0,m=0,_=0;_<o;_++){var y=s.charCodeAt(_),v=s.charAt(_);if(/(?:\s)/.test(v)&&(d=_,p=u),"\r"!==v&&"\n"!==v){var g=t.chars[y];g&&(h&&g.kerning[h]&&(
i.x+=g.kerning[h]),r.push({texture:g.texture,line:c,charCode:y,position:new dY(i.x+g.xOffset+this._letterSpacing/2,i.y+g.yOffset)}),i.x+=g.xAdvance+this._letterSpacing,u=i.x,m=Math.max(m,g.yOffset+g.texture.height),h=y,-1!==d&&0<a&&i.x>a&&(YH(r,1+d-++f,
1+_-d),_=d,d=-1,n.push(p),l=Math.max(l,p),c++,i.x=0,i.y+=t.lineHeight,h=null))}else n.push(u),l=Math.max(l,u),++c,++f,i.x=0,i.y+=t.lineHeight,h=null}var x=s.charAt(s.length-1);"\r"!==x&&"\n"!==x&&(/(?:\s)/.test(x)&&(u=p),n.push(u),l=Math.max(l,u));for(
var b=[],T=0;T<=c;T++){var E=0;"right"===this._font.align?E=l-n[T]:"center"===this._font.align&&(E=(l-n[T])/2),b.push(E)}for(var w=r.length,A=this.tint,S=0;S<w;S++){var I=this._glyphs[S];I?I.texture=r[S].texture:((I=new ry(r[S].texture)
).roundPixels=this.roundPixels,this._glyphs.push(I)),I.position.x=(r[S].position.x+b[r[S].line])*e,I.position.y=r[S].position.y*e,I.scale.x=I.scale.y=e,I.tint=A,I.parent||this.addChild(I)}for(var C=w;C<this._glyphs.length;++C)this.removeChild(
this._glyphs[C]);if(this._textWidth=l*e,this._textHeight=(i.y+t.lineHeight)*e,0!==this.anchor.x||0!==this.anchor.y)for(var O=0;O<w;O++)this._glyphs[O].x-=this._textWidth*this.anchor.x,this._glyphs[O].y-=this._textHeight*this.anchor.y
;this._maxLineHeight=m*e},R.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},R.prototype.getLocalBounds=function(){return this.validate(),r.prototype.getLocalBounds.call(this)},R.prototype.validate=function(){
this.dirty&&(this.updateText(),this.dirty=!1)},t.tint.get=function(){return this._font.tint},t.tint.set=function(t){this._font.tint="number"==typeof t&&0<=t?t:16777215,this.dirty=!0},t.align.get=function(){return this._font.align},t.align.set=function(t){
this._font.align=t||"left",this.dirty=!0},t.anchor.get=function(){return this._anchor},t.anchor.set=function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},t.font.get=function(){return this._font},t.font.set=function(t){t&&(
"string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=2<=t.length?parseInt(t[0],10):R.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,
10)),this.dirty=!0)},t.text.get=function(){return this._text},t.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},t.maxWidth.get=function(){return this._maxWidth},t.maxWidth.set=function(t){this._maxWidth!==t&&(
this._maxWidth=t,this.dirty=!0)},t.maxLineHeight.get=function(){return this.validate(),this._maxLineHeight},t.textWidth.get=function(){return this.validate(),this._textWidth},t.letterSpacing.get=function(){return this._letterSpacing},
t.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},t.textHeight.get=function(){return this.validate(),this._textHeight},R.registerFont=function(t,e){var i={},r=t.getElementsByTagName("info")[0],
n=t.getElementsByTagName("common")[0],s=t.getElementsByTagName("page"),o=rY(s[0].getAttribute("file"),XH.RESOLUTION),a={};i.font=r.getAttribute("face"),i.size=parseInt(r.getAttribute("size"),10),i.lineHeight=parseInt(n.getAttribute("lineHeight"),10)/o,
i.chars={},e instanceof cz&&(e=[e]);for(var h=0;h<s.length;h++){var u=s[h].getAttribute("id"),l=s[h].getAttribute("file");a[u]=e instanceof Array?e[h]:e[l]}for(var c=t.getElementsByTagName("char"),d=0;d<c.length;d++){var p=c[d],f=parseInt(p.getAttribute(
"id"),10),m=p.getAttribute("page")||0,_=new NY(parseInt(p.getAttribute("x"),10)/o+a[m].frame.x/o,parseInt(p.getAttribute("y"),10)/o+a[m].frame.y/o,parseInt(p.getAttribute("width"),10)/o,parseInt(p.getAttribute("height"),10)/o);i.chars[f]={
xOffset:parseInt(p.getAttribute("xoffset"),10)/o,yOffset:parseInt(p.getAttribute("yoffset"),10)/o,xAdvance:parseInt(p.getAttribute("xadvance"),10)/o,kerning:{},texture:new cz(a[m].baseTexture,_),page:m}}for(var y=t.getElementsByTagName("kerning"),
v=0;v<y.length;v++){var g=y[v],x=parseInt(g.getAttribute("first"),10)/o,b=parseInt(g.getAttribute("second"),10)/o,T=parseInt(g.getAttribute("amount"),10)/o;i.chars[b]&&(i.chars[b].kerning[x]=T)}return R.fonts[i.font]=i},Object.defineProperties(R.prototype
,t),R}(VY);VW.fonts={};function jW(){}jW.parse=function(t,e){t.bitmapFont=VW.registerFont(t.data,e)},jW.add=function(){DN.setExtensionXhrType("fnt",DN.XHR_RESPONSE_TYPE.DOCUMENT)},jW.dirname=function(t){var e=t.replace(/\/$/,"").replace(/\/[^\/]*$/,"")
;return e===t?".":""===e?"/":e},jW.use=function(e,i){if(e.data&&e.type===DN.TYPE.XML)if(0!==e.data.getElementsByTagName("page").length&&0!==e.data.getElementsByTagName("info").length&&null!==e.data.getElementsByTagName("info")[0].getAttribute("face")){
var t=e.isDataUrl?"":jW.dirname(e.url);e.isDataUrl&&("."===t&&(t=""),this.baseUrl&&t&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(t+="/")),(t=t.replace(this.baseUrl,""))&&"/"!==t.charAt(t.length-1)&&(t+="/");for(var r=e.data.getElementsByTagName(
"page"),n={},s=function(t){n[t.metadata.pageFile]=t.texture,Object.keys(n).length===r.length&&(jW.parse(e,n),i())},o=0;o<r.length;++o){var a=r[o].getAttribute("file"),h=t+a,u=!1;for(var l in this.resources){var c=this.resources[l];if(c.url===h){
c.metadata.pageFile=a,c.texture?s(c):c.onAfterMiddleware.add(s),u=!0;break}}if(!u){var d={crossOrigin:e.crossOrigin,loadType:DN.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:a},e.metadata.imageMetadata),parentResource:e};this.add(h,d,s)}}}else i(
);else i()};var HW=function(e){function t(t){void 0===t&&(t=1),e.call(this,WC,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{
uAlpha:1}),this.alpha=t}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={alpha:{configurable:!0}};return i.alpha.get=function(){return this.uniforms.uAlpha},i.alpha.set=function(t){this.uniforms.uAlpha=t},
Object.defineProperties(t.prototype,i),t}(bC),
YW="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }"
;var zW={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,
.02784,.065602,.120999,.174697,.197448]},WW=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var qW=function(a){function t(t,e,i,r,n){var s=function(t,
e){var i,r=Math.ceil(t/2),n=YW,s="";i=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<t;o++){var a=i.replace("%index%",o)
;s+=a=a.replace("%sampleIndex%",o-(r-1)+".0"),s+="\n"}return n=(n=n.replace("%blur%",s)).replace("%size%",t)}(n=n||5,t),o=function(t){for(var e,i=zW[t],r=i.length,n=WW,s="",o=0;o<t;o++){
var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o);r<=(e=o)&&(e=t-o-1),s+=a=a.replace("%value%",i[e]),s+="\n"}return n=(n=n.replace("%blur%",s)).replace("%size%",t)}(n);a.call(this,s,o),this.horizontal=t,
this.resolution=r||kb.RESOLUTION,this._quality=0,this.quality=i||4,this.blur=e||8}a&&(t.__proto__=a);var e={blur:{configurable:!0},quality:{configurable:!0}};return((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.apply=function(t,e,i,
r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width
):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,r);else{var n=t.getFilterTexture(),s=t.renderer,o=e,a=n
;this.state.blend=!1,t.applyFilter(this,o,a,!1);for(var h=1;h<this.passes-1;h++){s.renderTexture.bind(o,o.filterFrame);var u=this.uniforms.uSampler=a;a=o,o=u,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,i,r),
t.returnFilterTexture(n)}},e.blur.get=function(){return this.strength},e.blur.set=function(t){this.padding=1+2*Math.abs(t),this.strength=t},e.quality.get=function(){return this._quality},e.quality.set=function(t){this._quality=t,this.passes=t},
Object.defineProperties(t.prototype,e),t}(bC),KW=function(n){function t(t,e,i,r){n.call(this),this.blurXFilter=new qW(!0,t,e,i,r),this.blurYFilter=new qW(!1,t,e,i,r),this.resolution=i||kb.RESOLUTION,this.quality=e||4,this.blur=t||8,
this.repeatEdgePixels=!1}n&&(t.__proto__=n);var e={blur:{configurable:!0},quality:{configurable:!0},blurX:{configurable:!0},blurY:{configurable:!0},blendMode:{configurable:!0},repeatEdgePixels:{configurable:!0}};return((t.prototype=Object.create(
n&&n.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(n&&s){var o=t.getFilterTexture();this.blurXFilter.apply(t,e,o,!0),this.blurYFilter.apply(t,o,i,r),
t.returnFilterTexture(o)}else s?this.blurYFilter.apply(t,e,i,r):this.blurXFilter.apply(t,e,i,r)},t.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(
this.blurYFilter.strength))},e.blur.get=function(){return this.blurXFilter.blur},e.blur.set=function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},e.quality.get=function(){return this.blurXFilter.quality},e.quality.set=function(t
){this.blurXFilter.quality=this.blurYFilter.quality=t},e.blurX.get=function(){return this.blurXFilter.blur},e.blurX.set=function(t){this.blurXFilter.blur=t,this.updatePadding()},e.blurY.get=function(){return this.blurYFilter.blur},e.blurY.set=function(t){
this.blurYFilter.blur=t,this.updatePadding()},e.blendMode.get=function(){return this.blurYFilter.blendMode},e.blendMode.set=function(t){this.blurYFilter.blendMode=t},e.repeatEdgePixels.get=function(){return this._repeatEdgePixels},
e.repeatEdgePixels.set=function(t){this._repeatEdgePixels=t,this.updatePadding()},Object.defineProperties(t.prototype,e),t}(bC),ZW=(JW.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,
u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},JW.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,
this.items=this.items.slice(0))},JW.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},JW.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(
this.ensureNonAliasedItems(),this.items.splice(e,1)),this},JW.prototype.contains=function(t){return-1!==this.items.indexOf(t)},JW.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},JW.prototype.destroy=function(){
this.removeAll(),this.items=null,this._name=null},Object.defineProperty(JW.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(JW.prototype,"name",{get:function(){return this._name},
enumerable:!0,configurable:!0}),JW);function JW(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(ZW.prototype,{dispatch:{value:ZW.prototype.emit},run:{value:ZW.prototype.emit}});var QW,$W,tq,eq,iq,rq,nq,sq,oq,aq,hq,uq,lq,cq,dq,pq,
fq,mq,_q,yq,vq,gq,xq,bq,Tq,Eq,wq,Aq,Sq={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/)
;if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,
autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",
PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};($W=QW=QW||{})[$W.WEBGL_LEGACY=0]="WEBGL_LEGACY",$W[$W.WEBGL=1]="WEBGL",$W[$W.WEBGL2=2]="WEBGL2",(eq=tq=tq||{}
)[eq.UNKNOWN=0]="UNKNOWN",eq[eq.WEBGL=1]="WEBGL",eq[eq.CANVAS=2]="CANVAS",(rq=iq=iq||{})[rq.NORMAL=0]="NORMAL",rq[rq.ADD=1]="ADD",rq[rq.MULTIPLY=2]="MULTIPLY",rq[rq.SCREEN=3]="SCREEN",rq[rq.OVERLAY=4]="OVERLAY",rq[rq.DARKEN=5]="DARKEN",
rq[rq.LIGHTEN=6]="LIGHTEN",rq[rq.COLOR_DODGE=7]="COLOR_DODGE",rq[rq.COLOR_BURN=8]="COLOR_BURN",rq[rq.HARD_LIGHT=9]="HARD_LIGHT",rq[rq.SOFT_LIGHT=10]="SOFT_LIGHT",rq[rq.DIFFERENCE=11]="DIFFERENCE",rq[rq.EXCLUSION=12]="EXCLUSION",rq[rq.HUE=13]="HUE",
rq[rq.SATURATION=14]="SATURATION",rq[rq.COLOR=15]="COLOR",rq[rq.LUMINOSITY=16]="LUMINOSITY",rq[rq.NORMAL_NPM=17]="NORMAL_NPM",rq[rq.ADD_NPM=18]="ADD_NPM",rq[rq.SCREEN_NPM=19]="SCREEN_NPM",rq[rq.NONE=20]="NONE",rq[rq.SRC_OVER=0]="SRC_OVER",
rq[rq.SRC_IN=21]="SRC_IN",rq[rq.SRC_OUT=22]="SRC_OUT",rq[rq.SRC_ATOP=23]="SRC_ATOP",rq[rq.DST_OVER=24]="DST_OVER",rq[rq.DST_IN=25]="DST_IN",rq[rq.DST_OUT=26]="DST_OUT",rq[rq.DST_ATOP=27]="DST_ATOP",rq[rq.ERASE=26]="ERASE",rq[rq.SUBTRACT=28]="SUBTRACT",
rq[rq.XOR=29]="XOR",(sq=nq=nq||{})[sq.POINTS=0]="POINTS",sq[sq.LINES=1]="LINES",sq[sq.LINE_LOOP=2]="LINE_LOOP",sq[sq.LINE_STRIP=3]="LINE_STRIP",sq[sq.TRIANGLES=4]="TRIANGLES",sq[sq.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",sq[sq.TRIANGLE_FAN=6]="TRIANGLE_FAN",(
aq=oq=oq||{})[aq.RGBA=6408]="RGBA",aq[aq.RGB=6407]="RGB",aq[aq.ALPHA=6406]="ALPHA",aq[aq.LUMINANCE=6409]="LUMINANCE",aq[aq.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",aq[aq.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",aq[aq.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(
uq=hq=hq||{})[uq.TEXTURE_2D=3553]="TEXTURE_2D",uq[uq.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",uq[uq.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",uq[uq.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",
uq[uq.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",uq[uq.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",uq[uq.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",
uq[uq.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",uq[uq.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(cq=lq=lq||{})[cq.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",cq[cq.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",
cq[cq.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",cq[cq.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",cq[cq.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",cq[cq.FLOAT=5126]="FLOAT",cq[cq.HALF_FLOAT=36193]="HALF_FLOAT",(pq=dq=dq||{}
)[pq.NEAREST=0]="NEAREST",pq[pq.LINEAR=1]="LINEAR",(mq=fq=fq||{})[mq.CLAMP=33071]="CLAMP",mq[mq.REPEAT=10497]="REPEAT",mq[mq.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(yq=_q=_q||{})[yq.OFF=0]="OFF",yq[yq.POW2=1]="POW2",yq[yq.ON=2]="ON",(gq=vq=vq||{}
)[gq.NPM=0]="NPM",gq[gq.UNPACK=1]="UNPACK",gq[gq.PMA=2]="PMA",gq[gq.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",gq[gq.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",gq[gq.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(bq=xq=xq||{})[bq.AUTO=0]="AUTO",
bq[bq.MANUAL=1]="MANUAL",(Eq=Tq=Tq||{}).LOW="lowp",Eq.MEDIUM="mediump",Eq.HIGH="highp",(Aq=wq=wq||{})[Aq.NONE=0]="NONE",Aq[Aq.SCISSOR=1]="SCISSOR",Aq[Aq.STENCIL=2]="STENCIL",Aq[Aq.SPRITE=3]="SPRITE",Sq.RETINA_PREFIX=/@([0-9\.]+)x/;var Iq,Cq=!(
Sq.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),Oq="5.2.0";var Rq=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[iq.NORMAL_NPM]=iq.NORMAL,t[iq.ADD_NPM]=iq.ADD,t[iq.SCREEN_NPM]=iq.SCREEN,e[iq.NORMAL]=iq.NORMAL_NPM,e[iq.ADD]=iq.ADD_NPM,
e[iq.SCREEN]=iq.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function Pq(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var Mq=0;function Nq(){return++Mq}function Lq(t){return t+=0===t,--t
,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Fq(t){return!(t&t-1||!t)}function Dq(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var Uq={},Bq=Object.create(null),
kq=Object.create(null);function Xq(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||Sq.RESOLUTION,this.resize(t,e)}var Gq={width:{configurable:!0},height:{configurable:!0}}
;Xq.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},Xq.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},
Xq.prototype.destroy=function(){this.context=null,this.canvas=null},Gq.width.get=function(){return this.canvas.width},Gq.width.set=function(t){this.canvas.width=t},Gq.height.get=function(){return this.canvas.height},Gq.height.set=function(t){
this.canvas.height=t},Object.defineProperties(Xq.prototype,Gq);var Vq;function jq(t,e){var i=Sq.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var Hq,Yq,zq={};Sq.TARGET_FPMS=.06,(Yq=Hq=Hq||{})[Yq.INTERACTION=50]="INTERACTION",
Yq[Yq.HIGH=25]="HIGH",Yq[Yq.NORMAL=0]="NORMAL",Yq[Yq.LOW=-25]="LOW",Yq[Yq.UTILITY=-50]="UTILITY";var Wq=(qq.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},qq.prototype.emit=function(t){this.fn&&(
this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},qq.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},
qq.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,
e},qq);function qq(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var Kq=(Zq.prototype._requestIfNeeded=function(){
null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},Zq.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(
this._requestId),this._requestId=null)},Zq.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Zq.prototype.add=function(t,e,i){return void 0===i&&(i=Hq.NORMAL),this._addListener(new Wq(t,e,i))},
Zq.prototype.addOnce=function(t,e,i){return void 0===i&&(i=Hq.NORMAL),this._addListener(new Wq(t,e,i,!0))},Zq.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}
t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},Zq.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},
Zq.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Zq.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Zq.prototype.destroy=function(){if(!this._protected){this.stop();for(
var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},Zq.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),
e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Sq.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime)
;r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(Zq.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(Zq.prototype,
"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Sq.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(Zq.prototype,"maxFPS",{
get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(Zq,
"shared",{get:function(){if(!Zq._shared){var t=Zq._shared=new Zq;t.autoStart=!0,t._protected=!0}return Zq._shared},enumerable:!0,configurable:!0}),Object.defineProperty(Zq,"system",{get:function(){if(!Zq._system){var t=Zq._system=new Zq;t.autoStart=!0,
t._protected=!0}return Zq._system},enumerable:!0,configurable:!0}),Zq);function Zq(){var e=this;this._head=new Wq(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,
this.deltaMS=1/Sq.TARGET_FPMS,this.elapsedMS=1/Sq.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),
e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}Jq.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){
this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,Hq.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?Kq.shared:new Kq,t.autoStart&&this.start()},Jq.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function Jq(){}var Qq=($q.prototype.clone=function(){return new $q(this.x,this.y)},
$q.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},$q.prototype.copyTo=function(t){return t.set(this.x,this.y),t},$q.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},$q.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},$q);function $q(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var tK=(eK.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new eK(t,e,this._x,this._y)},
eK.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},eK.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},eK.prototype.copyTo=function(t){return t.set(this._x,this._y),t},eK.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(eK.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(eK.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),eK);function eK(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var iK,rK,nK=2*Math.PI,sK=180/Math.PI,oK=Math.PI/180;(rK=iK=iK||{})[rK.POLY=0]="POLY",rK[rK.RECT=1]="RECT",rK[rK.CIRC=2]="CIRC",rK[rK.ELIP=3]="ELIP",
rK[rK.RREC=4]="RREC";var aK=(hK.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},hK.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
hK.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},hK.prototype.apply=function(t,e){e=e||new Qq;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},hK.prototype.applyInverse=function(t,e){e=e||new Qq;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},hK.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
hK.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},hK.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},hK.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},hK.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},hK.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},hK.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(nK-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},hK.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},hK.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},hK.prototype.clone=function(){
var t=new hK;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},hK.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},hK.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(hK,"IDENTITY",{get:function(){return new hK},enumerable:!0,configurable:!0}),Object.defineProperty(hK,"TEMP_MATRIX",{get:function(){return new hK},
enumerable:!0,configurable:!0}),hK);function hK(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var uK=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],lK=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],cK=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],dK=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],pK=[],fK=[],mK=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];pK.push(e);for(
var i=0;i<16;i++)for(var r=mK(uK[t]*uK[i]+cK[t]*lK[i]),n=mK(lK[t]*uK[i]+dK[t]*lK[i]),s=mK(uK[t]*cK[i]+cK[t]*dK[i]),o=mK(lK[t]*cK[i]+dK[t]*dK[i]),a=0;a<16;a++)if(uK[a]===r&&lK[a]===n&&cK[a]===s&&dK[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new aK
;h.set(uK[t],lK[t],cK[t],dK[t],0,0),fK.push(h)}}();var _K={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return uK[t]},uY:function(t){return lK[t]},vX:function(t){
return cK[t]},vY:function(t){return dK[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return pK[t][e]},sub:function(t,e){return pK[t][_K.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?_K.S:_K.N:2*Math.abs(e)<=Math.abs(t)?0<t?_K.E:_K.W:0<e?0<t?_K.SE:_K.SW:0<t?_K.NE:_K.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=fK[_K.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},yK=(vK.prototype.onChange=function(){this._localID++},vK.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},vK.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},vK.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},vK.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(vK.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),vK.IDENTITY=new vK,vK);function vK(){this.worldTransform=new aK,this.localTransform=new aK,this.position=new tK(this.onChange,
this,0,0),this.scale=new tK(this.onChange,this,1,1),this.pivot=new tK(this.onChange,this,0,0),this.skew=new tK(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var gK=(Object.defineProperty(xK.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(xK.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(xK.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(xK.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(xK,"EMPTY"
,{get:function(){return new xK(0,0,0,0)},enumerable:!0,configurable:!0}),xK.prototype.clone=function(){return new xK(this.x,this.y,this.width,this.height)},xK.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},xK.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},xK.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},xK.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},xK.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},xK.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
xK.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},xK);function xK(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=iK.RECT}bK.prototype.clone=function(){return new bK(this.x,this.y,this.radius)},
bK.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},bK.prototype.getBounds=function(){return new gK(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function bK(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=iK.CIRC}TK.prototype.clone=function(){return new TK(this.x,this.y,this.width,this.height)},TK.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},TK.prototype.getBounds=function(){return new gK(this.x-this.width,this.y-this.height,this.width,this.height)};function TK(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=iK.ELIP}EK.prototype.clone=function(){var t=new EK(this.points.slice());return t.closeStroke=this.closeStroke,t},
EK.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function EK(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof Qq){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=iK.POLY,this.closeStroke=!0}
wK.prototype.clone=function(){return new wK(this.x,this.y,this.width,this.height,this.radius)},wK.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function wK(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=iK.RREC}Sq.SORTABLE_CHILDREN=!1;function AK(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}AK.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},AK.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},AK.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?gK.EMPTY:((
t=t||new gK(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},AK.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},AK.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},AK.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
AK.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},AK.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},AK.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
AK.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},AK.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},AK.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},AK.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},AK.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},AK.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},AK.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var SK=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new yK,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new AK,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new gK),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new gK),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*sK},e.angle.set=function(t){this.transform.rotation=t*oK
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function IK(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}SK.prototype.displayObjectUpdateTransform=SK.prototype.updateTransform;var CK=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=Sq.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Pq(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,Pq(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,Pq(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(IK),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(SK);CK.prototype.containerUpdateTransform=CK.prototype.updateTransform;function OK(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ZW(
"setRealSize",2),this.onUpdate=new ZW("update"),this.onError=new ZW("onError",1)}var RK={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};OK.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},OK.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},OK.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},RK.valid.get=function(){return!!this._width&&!!this._height},OK.prototype.update=function(){this.destroyed||this.onUpdate.run()},OK.prototype.load=function(){return Promise.resolve()},
RK.width.get=function(){return this._width},RK.height.get=function(){return this._height},OK.prototype.upload=function(t,e,i){return!1},OK.prototype.style=function(t,e,i){return!1},OK.prototype.dispose=function(){},OK.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(OK.prototype,RK);var PK=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(Vq=Vq||document.createElement("a")).href=t;var i=!(t=H.a.parse(Vq.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===vq.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(OK),MK=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:Sq.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===vq.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(PK),NK=[];function LK(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=NK.length-1;0<=n;--n){var s=NK[n];if(s.test&&s.test(t,i))return new s(t,e)}return new MK(t,e)}var FK=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===vq.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(OK),DK={scaleMode:dq.NEAREST,format:oq.RGBA,
alphaMode:vq.NPM},UK=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof OK||((t=LK(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||Sq.RESOLUTION,this.mipmap=void 0!==r?r:Sq.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:Sq.ANISOTROPIC_LEVEL,
this.wrapMode=h||Sq.WRAP_MODE,this.scaleMode=void 0!==s?s:Sq.SCALE_MODE,this.format=u||oq.RGBA,this.type=l||lq.UNSIGNED_BYTE,this.target=c||hq.TEXTURE_2D,this.alphaMode=void 0!==i?i:vq.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=Nq(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=Fq(this.realWidth
)&&Fq(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete kq[this.cacheId],delete Bq[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=Sq.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Nq()),t._pixiId);var s=kq[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new FK(t,{width:e,height:i}),
s=t instanceof Float32Array?lq.FLOAT:lq.UNSIGNED_BYTE;return new o(n,Object.assign(DK,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),kq[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),kq[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=kq[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete kq[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete kq[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);UK._globalBatch=0;var BK=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new UK;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(LK(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=hq.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(OK),
kK=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(PK),
XK=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=hq.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=hq.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(BK);XK.SIDES=6;var GK=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+Nq(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(PK)
;GK.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var VK=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=Kq.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(Kq.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(Kq.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&Kq.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(Kq.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(Kq.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(PK);VK.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var jK=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(PK);NK.push(MK,jK,kK,VK,GK,FK,XK,BK);function HK(t){this.renderer=t}
HK.prototype.destroy=function(){this.renderer=null};function YK(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new ZW("disposeFramebuffer",2)}var zK=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===vq.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(FK),WK={colorTexture:{configurable:!0}};WK.colorTexture.get=function(){return this.colorTextures[0]},YK.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new UK(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},YK.prototype.addDepthTexture=function(t){return this.depthTexture=t||new UK(new zK(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:oq.DEPTH_COMPONENT,type:lq.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},YK.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},YK.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},YK.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},YK.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(YK.prototype,WK);function qK(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var KK=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new YK(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(UK);qK.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=_K.add(i,_K.NW),this.x0=a+s*_K.uX(i),this.y0=h+o*_K.uY(i),i=_K.add(i,2),this.x1=a+s*_K.uX(i),this.y1=h+o*_K.uY(i),i=_K.add(i,2),this.x2=a+s*_K.uX(i),this.y2=h+o*_K.uY(i),i=_K.add(i,2),
this.x3=a+s*_K.uX(i),this.y3=h+o*_K.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var ZK=new qK,JK=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new gK(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=ZK,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new Qq(s.x,s.y):new Qq(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&Bq[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===ZK&&(this._uvs=new qK),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=Sq.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Nq()),t._pixiId);var s=Bq[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=jq(t)),(s=new a(new UK(t,e))).baseTexture.cacheId=n,
UK.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(UK.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new MK(t);r.url=e;var n=new a(new UK(r,{scaleMode:Sq.SCALE_MODE,resolution:jq(e)}));return i=i||e,
UK.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(UK.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Bq[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),Bq[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=Bq[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Bq[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Bq[t.textureCacheIds[r]]===t&&delete Bq[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function QK(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}JK.EMPTY=new JK(new UK),QK(JK.EMPTY),QK(JK.EMPTY.baseTexture),JK.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new JK(new UK(new kK(t)))}(),QK(JK.WHITE),QK(JK.WHITE.baseTexture);function $K(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var tZ=function(a){function n(t,e){var i=null;if(!(t instanceof KK)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new KK({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new KK(t))},n}(JK);$K.prototype.createTexture=function(t,e){var i=new KK(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new tZ(i)},
$K.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=$K.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=Lq(t)))<<16|65535&(e=Lq(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},$K.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
$K.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},$K.prototype.returnFilterTexture=function(t){this.returnTexture(t)},$K.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},$K.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=$K.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},$K.SCREEN_KEY="screen";function eZ(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}eZ.prototype.destroy=function(){this.buffer=null},eZ.from=function(t,e,i,r,n){return new eZ(t,e,i,r,n)};function iZ(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=rZ++,this.disposeRunner=new ZW("disposeBuffer",2)}var rZ=0;function nZ(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}iZ.prototype.update=function(t){this.data=t||this.data,this._updateID++},iZ.prototype.dispose=function(){this.disposeRunner.run(this,!1)},iZ.prototype.destroy=function(){this.dispose(),this.data=null},iZ.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new iZ(t)};var sZ={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function oZ(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=hZ++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ZW("disposeGeometry",2),this.refCount=0}var aZ={5126:4,5123:2,5121:1},hZ=0,uZ={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};oZ.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new iZ(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new eZ(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},oZ.prototype.getAttribute=function(t){return this.attributes[t]},oZ.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},oZ.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new iZ(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
oZ.prototype.getIndex=function(){return this.indexBuffer},oZ.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new iZ;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*aZ[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=nZ(c)
;n[d]||(n[d]=new sZ[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},oZ.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},oZ.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},oZ.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},oZ.prototype.clone=function(){for(var t=new oZ,e=0;e<this.buffers.length;e++)t.buffers[e]=new iZ(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new eZ(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},oZ.merge=function(t){for(var e,i=new oZ,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(uZ[nZ(e.buffers[h].data)])(n[h]),i.buffers[h]=new iZ(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*aZ[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function lZ(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=pZ++,this.static=!!e}var cZ=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(oZ),
dZ=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new iZ(this.vertices),this.uvBuffer=new iZ(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(oZ),pZ=0
;lZ.prototype.update=function(){this.dirtyId++},lZ.prototype.add=function(t,e,i){this.uniforms[t]=new lZ(e,i)},lZ.from=function(t,e){return new lZ(t,e)};function fZ(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new gK,this.destinationFrame=new gK,this.filters=[]}fZ.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function mZ(t){this.renderer=t}var _Z=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new $K,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new cZ,this.quadUv=new dZ,this.tempRect=new gK,this.activeState={},this.globalUniforms=new lZ({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new fZ,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(nq.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(nq.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
aK.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(HK);mZ.prototype.flush=function(){},mZ.prototype.destroy=function(){this.renderer=null},mZ.prototype.start=function(){},mZ.prototype.stop=function(){this.flush()},mZ.prototype.render=function(t){};var yZ=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new mZ(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(HK);Sq.PREFER_ENV=u.a.any?QW.WEBGL:QW.WEBGL2,Sq.STRICT_TEXTURE_CACHE=!1
;function vZ(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function gZ(t){this.type=wq.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var xZ=0,bZ=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=xZ++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=xZ++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(Sq.PREFER_ENV>=QW.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(HK),TZ=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new YK(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new gK,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Sq.PREFER_ENV===QW.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new gK},Object.defineProperties(t.prototype,i),t}(HK),EZ={5126:4,5123:2,5121:1},
wZ=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;Sq.PREFER_ENV===QW.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*EZ[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*EZ[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*EZ[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new vZ(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(HK);function AZ(t,e,i,r){var n=SZ(t,t.VERTEX_SHADER,e),s=SZ(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function SZ(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function IZ(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return CZ(2*e)
;case"bvec3":return CZ(3*e);case"bvec4":return CZ(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function CZ(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}gZ.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=wq.NONE,this.autoDetect=!0),this._target=null},gZ.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var OZ,RZ={},PZ=RZ;function MZ(){if(PZ===RZ||PZ&&PZ.isContextLost()){
var t,e=document.createElement("canvas");Sq.PREFER_ENV>=QW.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),PZ=t}return PZ}function NZ(t,e,i){if(
"precision"===t.substring(0,9))return i!==Tq.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===Tq.HIGH&&i!==Tq.HIGH&&(r=Tq.MEDIUM),"precision "+r+" float;\n"+t}var LZ={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var FZ=null,DZ={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function UZ(t,e){if(!FZ){var i=Object.keys(DZ)
;FZ={};for(var r=0;r<i.length;++r){var n=i[r];FZ[t[n]]=DZ[n]}}return FZ[e]}var BZ={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},kZ={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var XZ,GZ=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function VZ(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function jZ(t,e,i){void 0===i&&(i="pixi-shader"),this.id=HZ++,this.vertexSrc=t||jZ.defaultVertexSrc,
this.fragmentSrc=e||jZ.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),YZ[i]?(YZ[i]++,i+="-"+YZ[i]):YZ[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=NZ(this.vertexSrc,Sq.PRECISION_VERTEX,Tq.HIGH),this.fragmentSrc=NZ(this.fragmentSrc,Sq.PRECISION_FRAGMENT,function(
){if(!OZ){OZ=Tq.MEDIUM;var t=MZ();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);OZ=e.precision?Tq.HIGH:Tq.MEDIUM}}return OZ}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var HZ=0,YZ={},zZ={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};jZ.prototype.extractData=function(t,e){var i=MZ();if(i){var r=AZ(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},jZ.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=UZ(e,a.type),u={type:h,name:a.name,size:(i=h,LZ[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
jZ.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=UZ(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:IZ(h,s.size)}}return i},zZ.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},zZ.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},jZ.from=function(t,e,i){var r=t+e,n=Uq[r];return n||(Uq[r]=n=new jZ(t
,e,i)),n},Object.defineProperties(jZ,zZ);function WZ(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof lZ?e:new lZ(e):new lZ({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var qZ={uniforms:{configurable:!0}};WZ.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
WZ.prototype.destroy=function(){this.uniformGroup=null},qZ.uniforms.get=function(){return this.uniformGroup.uniforms},WZ.from=function(t,e,i){var r=jZ.from(t,e);return new WZ(r,i)},Object.defineProperties(WZ.prototype,qZ);function KZ(){this.data=0,
this.blendMode=iq.NORMAL,this.polygonOffset=0,this.blend=!0}var ZZ={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};ZZ.blend.get=function(){return!!(1&this.data)},ZZ.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},ZZ.offsets.get=function(){return!!(2&this.data)},ZZ.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
ZZ.culling.get=function(){return!!(4&this.data)},ZZ.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},ZZ.depthTest.get=function(){return!!(8&this.data)},ZZ.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
ZZ.clockwiseFrontFace.get=function(){return!!(16&this.data)},ZZ.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},ZZ.blendMode.get=function(){return this._blendMode},ZZ.blendMode.set=function(t){this.blend=t!==iq.NONE,
this._blendMode=t},ZZ.polygonOffset.get=function(){return this._polygonOffset},ZZ.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},KZ.for2d=function(){var t=new KZ;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
KZ.prototype,ZZ);var JZ=function(n){function s(t,e,i){var r=jZ.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=Sq.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new KZ}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(WZ);JZ.SOURCE_KEY_MAP={};function QZ(t,e){this._texture=t,this.mapCoord=new aK,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var $Z=new aK,tJ={texture:{configurable:!0}};tJ.texture.get=function(){return this._texture},tJ.texture.set=function(t){this._texture=t,this._updateID=-1},QZ.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},QZ.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&($Z.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append($Z));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(QZ.prototype,tJ);function eJ(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var iJ=function(i){
function t(t){var e=new aK;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new QZ(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(JZ),rJ=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new gZ;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case wq.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case wq.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case wq.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case wq.SCISSOR:this.renderer.scissor.pop();break;case wq.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case wq.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=wq.SPRITE;else if(t.type=wq.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=wq.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new iJ(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(HK),nJ=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(HK),sJ=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(nJ),oJ=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(nJ),aJ=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new aK,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(HK),hJ=new gK,uJ=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new gK,this.destinationFrame=new gK}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(hJ.width=s.realWidth,hJ.height=s.realHeight,i=hJ),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
hJ.width=n.width,hJ.height=n.height,i=hJ),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(HK)
;eJ.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var lJ=0,cJ=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=lJ++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof XZ)return XZ;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;XZ=!0===t({a:"b"},"a","b")}catch(t){XZ=!1}return XZ}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?BZ:kZ)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=AZ(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:IZ(h.type,h.size)}}var u=new eJ(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(HK);function dJ(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var pJ=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=iq.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new KZ,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[iq.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.ADD]=[t.ONE,t.ONE],e[iq.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[iq.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[iq.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[iq.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.NONE]=[0,0],e[iq.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[iq.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[iq.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[iq.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[iq.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[iq.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[iq.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[iq.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[iq.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[iq.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[iq.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(HK),fJ=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=Sq.GC_MAX_IDLE,
this.checkCountMax=Sq.GC_MAX_CHECK_COUNT,this.mode=Sq.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==xq.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(HK),mJ=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new UK}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new dJ(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new dJ(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new dJ(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===lq.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&Pq(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==_q.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=fq.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===dq.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(HK),_J=new aK;X.a;function yJ(){this.texArray=null,this.blend=0,this.type=nq.TRIANGLES,this.start=0,this.size=0,this.data=null}function vJ(){this.elements=[],this.ids=[],this.count=0}vJ.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function gJ(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var xJ={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};xJ.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},xJ.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},xJ.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},xJ.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},xJ.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},gJ.prototype.view=function(t){
return this[t+"View"]},gJ.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},gJ.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(gJ.prototype,xJ);var bJ=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=KZ.for2d(),this.size=4*Sq.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;Sq.PREFER_ENV===QW.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Sq.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=GZ.replace(/%forloop%/gi,VZ(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new yJ);for(;e.length<r;)e.push(new vJ);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++UK._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;UK._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=Rq[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;Sq.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Sq.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=Lq(Math.ceil(t/8)),i=Dq(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new gJ(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=Lq(Math.ceil(t/12)),i=Dq(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(mZ);bJ._drawCallPool=[],bJ._textureArrayPool=[];function TJ(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}TJ.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=lZ.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new jZ(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new aK,default:this.defaultGroupCache[t]};return new WZ(this.programCache[t],n)},
TJ.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function EJ(){}var wJ=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new iZ(null,t,!1),this._indexBuffer=new iZ(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,lq.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,lq.FLOAT).addAttribute("aColor",this._buffer,4,!0,lq.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,lq.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(oZ),
AJ="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,SJ="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",IJ={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};EJ.create=function(t){var e=Object.assign({vertex:AJ,fragment:SJ,geometryClass:wJ,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new TJ(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(bJ)},IJ.defaultVertexSrc.get=function(){return AJ},IJ.defaultFragmentTemplate.get=function(){
return SJ},Object.defineProperties(EJ,IJ);EJ.create();var CJ=function(e){function t(){var t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};e.call(this,
"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
,
"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"
,t),this.alpha=1}e&&(t.__proto__=e);var i={matrix:{configurable:!0},alpha:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var i=t;e&&(this._multiply(i,
this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},t.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],
t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],
t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],
t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],
t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},t.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,
e[14]/=255,e[19]/=255,e},t.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},t.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},
t.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},t.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),r=Math.sin(t),n=(0,Math.sqrt)(1/3),s=[i+1/3*(1-i),1/3*(1-i)-n*r,1/3*(1-i
)+n*r,0,0,1/3*(1-i)+n*r,i+1/3*(1-i),1/3*(1-i)-n*r,0,0,1/3*(1-i)-n*r,1/3*(1-i)+n*r,i+1/3*(1-i),0,0,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.contrast=function(t,e){var i=(t||0)+1,r=-.5*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(
n,e)},t.prototype.saturate=function(t,e){void 0===t&&(t=0);var i=2*t/3+1,r=-.5*(i-1),n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(t){this._loadMatrix(
[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},t.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},t.prototype.technicolor=function(t){this._loadMatrix([
1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},
t.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},t.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},
t.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,
1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},t.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,
-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},t.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,
.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},t.prototype.colorTone=function(t,e,i,r,n){var s=((i=i||16770432)>>16&255)/255,o=(i>>8&255
)/255,a=(255&i)/255,h=((r=r||3375104)>>16&255)/255,u=(r>>8&255)/255,l=(255&r)/255,c=[.3,.59,.11,0,0,s,o,a,t=t||.2,0,h,u,l,e=e||.15,0,s-h,o-u,a-l,0,0];this._loadMatrix(c,n)},t.prototype.night=function(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,
0,0,0,0,1,0];this._loadMatrix(i,e)},t.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,
-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},t.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},t.prototype.reset=function(){
this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},i.matrix.get=function(){return this.uniforms.m},i.matrix.set=function(t){this.uniforms.m=t},i.alpha.get=function(){return this.uniforms.uAlpha},i.alpha.set=function(t){this.uniforms.uAlpha=t}
,Object.defineProperties(t.prototype,i),t}(JZ);CJ.prototype.grayscale=CJ.prototype.greyscale;var OJ=(RJ.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++
;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},RJ.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},
RJ.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},RJ.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}
,RJ.prototype.contains=function(t){return-1!==this.items.indexOf(t)},RJ.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},RJ.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},
Object.defineProperty(RJ.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(RJ.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),RJ);function RJ(t){
this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(OJ.prototype,{dispatch:{value:OJ.prototype.emit},run:{value:OJ.prototype.emit}});var PJ,MJ,NJ,LJ,FJ,DJ,UJ,BJ,kJ,XJ,GJ,VJ,jJ,HJ,YJ,zJ,WJ,qJ,KJ,ZJ,JJ,QJ,$J,tQ,eQ,iQ,rQ,nQ,sQ={
MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(
u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,
clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",
CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(MJ=PJ=PJ||{})[MJ.WEBGL_LEGACY=0]="WEBGL_LEGACY",MJ[MJ.WEBGL=1]="WEBGL",MJ[MJ.WEBGL2=2]="WEBGL2",(LJ=NJ=NJ||{})[LJ.UNKNOWN=0]="UNKNOWN",LJ[LJ.WEBGL=1]="WEBGL",
LJ[LJ.CANVAS=2]="CANVAS",(DJ=FJ=FJ||{})[DJ.NORMAL=0]="NORMAL",DJ[DJ.ADD=1]="ADD",DJ[DJ.MULTIPLY=2]="MULTIPLY",DJ[DJ.SCREEN=3]="SCREEN",DJ[DJ.OVERLAY=4]="OVERLAY",DJ[DJ.DARKEN=5]="DARKEN",DJ[DJ.LIGHTEN=6]="LIGHTEN",DJ[DJ.COLOR_DODGE=7]="COLOR_DODGE",
DJ[DJ.COLOR_BURN=8]="COLOR_BURN",DJ[DJ.HARD_LIGHT=9]="HARD_LIGHT",DJ[DJ.SOFT_LIGHT=10]="SOFT_LIGHT",DJ[DJ.DIFFERENCE=11]="DIFFERENCE",DJ[DJ.EXCLUSION=12]="EXCLUSION",DJ[DJ.HUE=13]="HUE",DJ[DJ.SATURATION=14]="SATURATION",DJ[DJ.COLOR=15]="COLOR",
DJ[DJ.LUMINOSITY=16]="LUMINOSITY",DJ[DJ.NORMAL_NPM=17]="NORMAL_NPM",DJ[DJ.ADD_NPM=18]="ADD_NPM",DJ[DJ.SCREEN_NPM=19]="SCREEN_NPM",DJ[DJ.NONE=20]="NONE",DJ[DJ.SRC_OVER=0]="SRC_OVER",DJ[DJ.SRC_IN=21]="SRC_IN",DJ[DJ.SRC_OUT=22]="SRC_OUT",
DJ[DJ.SRC_ATOP=23]="SRC_ATOP",DJ[DJ.DST_OVER=24]="DST_OVER",DJ[DJ.DST_IN=25]="DST_IN",DJ[DJ.DST_OUT=26]="DST_OUT",DJ[DJ.DST_ATOP=27]="DST_ATOP",DJ[DJ.ERASE=26]="ERASE",DJ[DJ.SUBTRACT=28]="SUBTRACT",DJ[DJ.XOR=29]="XOR",(BJ=UJ=UJ||{})[BJ.POINTS=0]="POINTS",
BJ[BJ.LINES=1]="LINES",BJ[BJ.LINE_LOOP=2]="LINE_LOOP",BJ[BJ.LINE_STRIP=3]="LINE_STRIP",BJ[BJ.TRIANGLES=4]="TRIANGLES",BJ[BJ.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",BJ[BJ.TRIANGLE_FAN=6]="TRIANGLE_FAN",(XJ=kJ=kJ||{})[XJ.RGBA=6408]="RGBA",XJ[XJ.RGB=6407]="RGB",
XJ[XJ.ALPHA=6406]="ALPHA",XJ[XJ.LUMINANCE=6409]="LUMINANCE",XJ[XJ.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",XJ[XJ.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",XJ[XJ.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(VJ=GJ=GJ||{})[VJ.TEXTURE_2D=3553]="TEXTURE_2D",
VJ[VJ.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",VJ[VJ.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",VJ[VJ.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",VJ[VJ.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
VJ[VJ.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",VJ[VJ.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",VJ[VJ.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
VJ[VJ.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(HJ=jJ=jJ||{})[HJ.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",HJ[HJ.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",HJ[HJ.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
HJ[HJ.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",HJ[HJ.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",HJ[HJ.FLOAT=5126]="FLOAT",HJ[HJ.HALF_FLOAT=36193]="HALF_FLOAT",(zJ=YJ=YJ||{})[zJ.NEAREST=0]="NEAREST",zJ[zJ.LINEAR=1]="LINEAR",(
qJ=WJ=WJ||{})[qJ.CLAMP=33071]="CLAMP",qJ[qJ.REPEAT=10497]="REPEAT",qJ[qJ.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(ZJ=KJ=KJ||{})[ZJ.OFF=0]="OFF",ZJ[ZJ.POW2=1]="POW2",ZJ[ZJ.ON=2]="ON",(QJ=JJ=JJ||{})[QJ.NPM=0]="NPM",QJ[QJ.UNPACK=1]="UNPACK",
QJ[QJ.PMA=2]="PMA",QJ[QJ.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",QJ[QJ.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",QJ[QJ.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(tQ=$J=$J||{})[tQ.AUTO=0]="AUTO",tQ[tQ.MANUAL=1]="MANUAL",(iQ=eQ=eQ||{}
).LOW="lowp",iQ.MEDIUM="mediump",iQ.HIGH="highp",(nQ=rQ=rQ||{})[nQ.NONE=0]="NONE",nQ[nQ.SCISSOR=1]="SCISSOR",nQ[nQ.STENCIL=2]="STENCIL",nQ[nQ.SPRITE=3]="SPRITE",sQ.RETINA_PREFIX=/@([0-9\.]+)x/;var oQ,aQ=!(sQ.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),hQ="5.2.0"
;var uQ=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[FJ.NORMAL_NPM]=FJ.NORMAL,t[FJ.ADD_NPM]=FJ.ADD,t[FJ.SCREEN_NPM]=FJ.SCREEN,e[FJ.NORMAL]=FJ.NORMAL_NPM,e[FJ.ADD]=FJ.ADD_NPM,e[FJ.SCREEN]=FJ.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function lQ(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var cQ=0;function dQ(){return++cQ}function pQ(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function fQ(t){
return!(t&t-1||!t)}function mQ(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var _Q={},yQ=Object.create(null),vQ=Object.create(null);function gQ(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||sQ.RESOLUTION,this.resize(t,e)}var xQ={width:{configurable:!0},height:{configurable:!0}};gQ.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},gQ.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},gQ.prototype.destroy=function(){this.context=null,this.canvas=null},xQ.width.get=function(){
return this.canvas.width},xQ.width.set=function(t){this.canvas.width=t},xQ.height.get=function(){return this.canvas.height},xQ.height.set=function(t){this.canvas.height=t},Object.defineProperties(gQ.prototype,xQ);var bQ;function TQ(t,e){
var i=sQ.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var EQ,wQ,AQ={};sQ.TARGET_FPMS=.06,(wQ=EQ=EQ||{})[wQ.INTERACTION=50]="INTERACTION",wQ[wQ.HIGH=25]="HIGH",wQ[wQ.NORMAL=0]="NORMAL",wQ[wQ.LOW=-25]="LOW",wQ[wQ.UTILITY=-50]="UTILITY"
;var SQ=(IQ.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},IQ.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),
this._destroyed&&(this.next=null),e},IQ.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},IQ.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,
this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},IQ);function IQ(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,
this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var CQ=(OQ.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},OQ.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},OQ.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},OQ.prototype.add=function(t,e,i){return void 0===i&&(i=EQ.NORMAL),this._addListener(new SQ(t,e,i))},OQ.prototype.addOnce=function(t,e,i){return void 0===i&&(i=EQ.NORMAL),this._addListener(new SQ(t,e,i,!0))},
OQ.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},OQ.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},OQ.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},OQ.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},OQ.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},OQ.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*sQ.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(OQ.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(OQ.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,sQ.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(OQ.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(OQ,"shared",{get:function(){if(!OQ._shared){var t=OQ._shared=new OQ;t.autoStart=!0,t._protected=!0}return OQ._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(OQ,"system",{get:function(){if(!OQ._system){var t=OQ._system=new OQ;t.autoStart=!0,t._protected=!0}return OQ._system},enumerable:!0,configurable:!0}),OQ);function OQ(){var e=this;this._head=new SQ(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/sQ.TARGET_FPMS,this.elapsedMS=1/sQ.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}RQ.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,EQ.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?CQ.shared:new CQ,t.autoStart&&this.start()},RQ.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function RQ(){}var PQ=(MQ.prototype.clone=function(){return new MQ(this.x,this.y)},
MQ.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},MQ.prototype.copyTo=function(t){return t.set(this.x,this.y),t},MQ.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},MQ.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},MQ);function MQ(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var NQ=(LQ.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new LQ(t,e,this._x,this._y)},
LQ.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},LQ.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},LQ.prototype.copyTo=function(t){return t.set(this._x,this._y),t},LQ.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(LQ.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(LQ.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),LQ);function LQ(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var FQ,DQ,UQ=2*Math.PI,BQ=180/Math.PI,kQ=Math.PI/180;(DQ=FQ=FQ||{})[DQ.POLY=0]="POLY",DQ[DQ.RECT=1]="RECT",DQ[DQ.CIRC=2]="CIRC",DQ[DQ.ELIP=3]="ELIP",
DQ[DQ.RREC=4]="RREC";var XQ=(GQ.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},GQ.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
GQ.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},GQ.prototype.apply=function(t,e){e=e||new PQ;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},GQ.prototype.applyInverse=function(t,e){e=e||new PQ;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},GQ.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
GQ.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},GQ.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},GQ.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},GQ.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},GQ.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},GQ.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(UQ-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},GQ.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},GQ.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},GQ.prototype.clone=function(){
var t=new GQ;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},GQ.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},GQ.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(GQ,"IDENTITY",{get:function(){return new GQ},enumerable:!0,configurable:!0}),Object.defineProperty(GQ,"TEMP_MATRIX",{get:function(){return new GQ},
enumerable:!0,configurable:!0}),GQ);function GQ(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var VQ=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],jQ=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],HQ=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],YQ=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],zQ=[],WQ=[],qQ=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];zQ.push(e);for(
var i=0;i<16;i++)for(var r=qQ(VQ[t]*VQ[i]+HQ[t]*jQ[i]),n=qQ(jQ[t]*VQ[i]+YQ[t]*jQ[i]),s=qQ(VQ[t]*HQ[i]+HQ[t]*YQ[i]),o=qQ(jQ[t]*HQ[i]+YQ[t]*YQ[i]),a=0;a<16;a++)if(VQ[a]===r&&jQ[a]===n&&HQ[a]===s&&YQ[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new XQ
;h.set(VQ[t],jQ[t],HQ[t],YQ[t],0,0),WQ.push(h)}}();var KQ={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return VQ[t]},uY:function(t){return jQ[t]},vX:function(t){
return HQ[t]},vY:function(t){return YQ[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return zQ[t][e]},sub:function(t,e){return zQ[t][KQ.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?KQ.S:KQ.N:2*Math.abs(e)<=Math.abs(t)?0<t?KQ.E:KQ.W:0<e?0<t?KQ.SE:KQ.SW:0<t?KQ.NE:KQ.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=WQ[KQ.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},ZQ=(JQ.prototype.onChange=function(){this._localID++},JQ.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},JQ.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},JQ.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},JQ.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(JQ.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),JQ.IDENTITY=new JQ,JQ);function JQ(){this.worldTransform=new XQ,this.localTransform=new XQ,this.position=new NQ(this.onChange,
this,0,0),this.scale=new NQ(this.onChange,this,1,1),this.pivot=new NQ(this.onChange,this,0,0),this.skew=new NQ(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var QQ=(Object.defineProperty($Q.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty($Q.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty($Q.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty($Q.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty($Q,"EMPTY"
,{get:function(){return new $Q(0,0,0,0)},enumerable:!0,configurable:!0}),$Q.prototype.clone=function(){return new $Q(this.x,this.y,this.width,this.height)},$Q.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},$Q.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},$Q.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},$Q.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},$Q.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},$Q.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
$Q.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},$Q);function $Q(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=FQ.RECT}t$.prototype.clone=function(){return new t$(this.x,this.y,this.radius)},
t$.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},t$.prototype.getBounds=function(){return new QQ(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function t$(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=FQ.CIRC}e$.prototype.clone=function(){return new e$(this.x,this.y,this.width,this.height)},e$.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},e$.prototype.getBounds=function(){return new QQ(this.x-this.width,this.y-this.height,this.width,this.height)};function e$(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=FQ.ELIP}i$.prototype.clone=function(){var t=new i$(this.points.slice());return t.closeStroke=this.closeStroke,t},
i$.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function i$(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof PQ){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=FQ.POLY,this.closeStroke=!0}
r$.prototype.clone=function(){return new r$(this.x,this.y,this.width,this.height,this.radius)},r$.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function r$(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=FQ.RREC}sQ.SORTABLE_CHILDREN=!1;function n$(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}n$.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},n$.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},n$.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?QQ.EMPTY:((
t=t||new QQ(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},n$.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},n$.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},n$.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
n$.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},n$.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},n$.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
n$.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},n$.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},n$.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},n$.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},n$.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},n$.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},n$.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var s$=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new ZQ,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new n$,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new QQ),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new QQ),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*BQ},e.angle.set=function(t){this.transform.rotation=t*kQ
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function o$(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}s$.prototype.displayObjectUpdateTransform=s$.prototype.updateTransform;var a$=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=sQ.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);lQ(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,lQ(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,lQ(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(o$),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(s$);a$.prototype.containerUpdateTransform=a$.prototype.updateTransform;function h$(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new OJ(
"setRealSize",2),this.onUpdate=new OJ("update"),this.onError=new OJ("onError",1)}var u$={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};h$.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},h$.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},h$.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},u$.valid.get=function(){return!!this._width&&!!this._height},h$.prototype.update=function(){this.destroyed||this.onUpdate.run()},h$.prototype.load=function(){return Promise.resolve()},
u$.width.get=function(){return this._width},u$.height.get=function(){return this._height},h$.prototype.upload=function(t,e,i){return!1},h$.prototype.style=function(t,e,i){return!1},h$.prototype.dispose=function(){},h$.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(h$.prototype,u$);var l$=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(bQ=bQ||document.createElement("a")).href=t;var i=!(t=H.a.parse(bQ.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===JJ.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(h$),c$=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:sQ.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===JJ.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(l$),d$=[];function p$(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=d$.length-1;0<=n;--n){var s=d$[n];if(s.test&&s.test(t,i))return new s(t,e)}return new c$(t,e)}var f$=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===JJ.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(h$),m$={scaleMode:YJ.NEAREST,format:kJ.RGBA,
alphaMode:JJ.NPM},_$=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof h$||((t=p$(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||sQ.RESOLUTION,this.mipmap=void 0!==r?r:sQ.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:sQ.ANISOTROPIC_LEVEL,
this.wrapMode=h||sQ.WRAP_MODE,this.scaleMode=void 0!==s?s:sQ.SCALE_MODE,this.format=u||kJ.RGBA,this.type=l||jJ.UNSIGNED_BYTE,this.target=c||GJ.TEXTURE_2D,this.alphaMode=void 0!==i?i:JJ.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=dQ(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=fQ(this.realWidth
)&&fQ(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete vQ[this.cacheId],delete yQ[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=sQ.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+dQ()),t._pixiId);var s=vQ[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new f$(t,{width:e,height:i}),
s=t instanceof Float32Array?jJ.FLOAT:jJ.UNSIGNED_BYTE;return new o(n,Object.assign(m$,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),vQ[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),vQ[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=vQ[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete vQ[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete vQ[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);_$._globalBatch=0;var y$=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new _$;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(p$(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=GJ.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(h$),
v$=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(l$),
g$=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=GJ.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=GJ.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(y$);g$.SIDES=6;var x$=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+dQ(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(l$)
;x$.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var b$=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=CQ.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(CQ.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(CQ.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&CQ.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(CQ.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(CQ.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(l$);b$.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var T$=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(l$);d$.push(c$,T$,v$,b$,x$,f$,g$,y$);function E$(t){this.renderer=t}
E$.prototype.destroy=function(){this.renderer=null};function w$(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new OJ("disposeFramebuffer",2)}var A$=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===JJ.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(f$),S$={colorTexture:{configurable:!0}};S$.colorTexture.get=function(){return this.colorTextures[0]},w$.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new _$(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},w$.prototype.addDepthTexture=function(t){return this.depthTexture=t||new _$(new A$(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:kJ.DEPTH_COMPONENT,type:jJ.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},w$.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},w$.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},w$.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},w$.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(w$.prototype,S$);function I$(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var C$=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new w$(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(_$);I$.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=KQ.add(i,KQ.NW),this.x0=a+s*KQ.uX(i),this.y0=h+o*KQ.uY(i),i=KQ.add(i,2),this.x1=a+s*KQ.uX(i),this.y1=h+o*KQ.uY(i),i=KQ.add(i,2),this.x2=a+s*KQ.uX(i),this.y2=h+o*KQ.uY(i),i=KQ.add(i,2),
this.x3=a+s*KQ.uX(i),this.y3=h+o*KQ.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var O$=new I$,R$=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new QQ(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=O$,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new PQ(s.x,s.y):new PQ(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&yQ[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===O$&&(this._uvs=new I$),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=sQ.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+dQ()),t._pixiId);var s=yQ[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=TQ(t)),(s=new a(new _$(t,e))).baseTexture.cacheId=n,
_$.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(_$.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new c$(t);r.url=e;var n=new a(new _$(r,{scaleMode:sQ.SCALE_MODE,resolution:TQ(e)}));return i=i||e,
_$.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(_$.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),yQ[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),yQ[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=yQ[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete yQ[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)yQ[t.textureCacheIds[r]]===t&&delete yQ[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function P$(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}R$.EMPTY=new R$(new _$),P$(R$.EMPTY),P$(R$.EMPTY.baseTexture),R$.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new R$(new _$(new v$(t)))}(),P$(R$.WHITE),P$(R$.WHITE.baseTexture);function M$(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var N$=function(a){function n(t,e){var i=null;if(!(t instanceof C$)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new C$({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new C$(t))},n}(R$);M$.prototype.createTexture=function(t,e){var i=new C$(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new N$(i)},
M$.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=M$.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=pQ(t)))<<16|65535&(e=pQ(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},M$.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
M$.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},M$.prototype.returnFilterTexture=function(t){this.returnTexture(t)},M$.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},M$.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=M$.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},M$.SCREEN_KEY="screen";function L$(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}L$.prototype.destroy=function(){this.buffer=null},L$.from=function(t,e,i,r,n){return new L$(t,e,i,r,n)};function F$(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=D$++,this.disposeRunner=new OJ("disposeBuffer",2)}var D$=0;function U$(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}F$.prototype.update=function(t){this.data=t||this.data,this._updateID++},F$.prototype.dispose=function(){this.disposeRunner.run(this,!1)},F$.prototype.destroy=function(){this.dispose(),this.data=null},F$.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new F$(t)};var B$={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function k$(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=G$++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new OJ("disposeGeometry",2),this.refCount=0}var X$={5126:4,5123:2,5121:1},G$=0,V$={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};k$.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new F$(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new L$(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},k$.prototype.getAttribute=function(t){return this.attributes[t]},k$.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},k$.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new F$(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
k$.prototype.getIndex=function(){return this.indexBuffer},k$.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new F$;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*X$[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=U$(c)
;n[d]||(n[d]=new B$[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},k$.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},k$.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},k$.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},k$.prototype.clone=function(){for(var t=new k$,e=0;e<this.buffers.length;e++)t.buffers[e]=new F$(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new L$(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},k$.merge=function(t){for(var e,i=new k$,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(V$[U$(e.buffers[h].data)])(n[h]),i.buffers[h]=new F$(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*X$[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function j$(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=z$++,this.static=!!e}var H$=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(k$),
Y$=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new F$(this.vertices),this.uvBuffer=new F$(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(k$),z$=0
;j$.prototype.update=function(){this.dirtyId++},j$.prototype.add=function(t,e,i){this.uniforms[t]=new j$(e,i)},j$.from=function(t,e){return new j$(t,e)};function W$(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new QQ,this.destinationFrame=new QQ,this.filters=[]}W$.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function q$(t){this.renderer=t}var K$=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new M$,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new H$,this.quadUv=new Y$,this.tempRect=new QQ,this.activeState={},this.globalUniforms=new j$({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new W$,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(UJ.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(UJ.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
XQ.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(E$);q$.prototype.flush=function(){},q$.prototype.destroy=function(){this.renderer=null},q$.prototype.start=function(){},q$.prototype.stop=function(){this.flush()},q$.prototype.render=function(t){};var Z$=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new q$(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(E$);sQ.PREFER_ENV=u.a.any?PJ.WEBGL:PJ.WEBGL2,sQ.STRICT_TEXTURE_CACHE=!1
;function J$(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function Q$(t){this.type=rQ.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var $$=0,t0=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=$$++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=$$++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(sQ.PREFER_ENV>=PJ.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(E$),e0=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new w$(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new QQ,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;sQ.PREFER_ENV===PJ.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new QQ},Object.defineProperties(t.prototype,i),t}(E$),i0={5126:4,5123:2,5121:1},
r0=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;sQ.PREFER_ENV===PJ.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*i0[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*i0[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*i0[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new J$(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(E$);function n0(t,e,i,r){var n=s0(t,t.VERTEX_SHADER,e),s=s0(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function s0(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function o0(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return a0(2*e)
;case"bvec3":return a0(3*e);case"bvec4":return a0(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function a0(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}Q$.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=rQ.NONE,this.autoDetect=!0),this._target=null},Q$.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var h0,u0={},l0=u0;function c0(){if(l0===u0||l0&&l0.isContextLost()){
var t,e=document.createElement("canvas");sQ.PREFER_ENV>=PJ.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),l0=t}return l0}function d0(t,e,i){if(
"precision"===t.substring(0,9))return i!==eQ.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===eQ.HIGH&&i!==eQ.HIGH&&(r=eQ.MEDIUM),"precision "+r+" float;\n"+t}var p0={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var f0=null,m0={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function _0(t,e){if(!f0){var i=Object.keys(m0)
;f0={};for(var r=0;r<i.length;++r){var n=i[r];f0[t[n]]=m0[n]}}return f0[e]}var y0={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},v0={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var g0,x0=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function b0(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function T0(t,e,i){void 0===i&&(i="pixi-shader"),this.id=E0++,this.vertexSrc=t||T0.defaultVertexSrc,
this.fragmentSrc=e||T0.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),w0[i]?(w0[i]++,i+="-"+w0[i]):w0[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=d0(this.vertexSrc,sQ.PRECISION_VERTEX,eQ.HIGH),this.fragmentSrc=d0(this.fragmentSrc,sQ.PRECISION_FRAGMENT,function(
){if(!h0){h0=eQ.MEDIUM;var t=c0();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);h0=e.precision?eQ.HIGH:eQ.MEDIUM}}return h0}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var E0=0,w0={},A0={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};T0.prototype.extractData=function(t,e){var i=c0();if(i){var r=n0(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},T0.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=_0(e,a.type),u={type:h,name:a.name,size:(i=h,p0[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
T0.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=_0(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:o0(h,s.size)}}return i},A0.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},A0.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},T0.from=function(t,e,i){var r=t+e,n=_Q[r];return n||(_Q[r]=n=new T0(t
,e,i)),n},Object.defineProperties(T0,A0);function S0(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof j$?e:new j$(e):new j$({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var I0={uniforms:{configurable:!0}};S0.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
S0.prototype.destroy=function(){this.uniformGroup=null},I0.uniforms.get=function(){return this.uniformGroup.uniforms},S0.from=function(t,e,i){var r=T0.from(t,e);return new S0(r,i)},Object.defineProperties(S0.prototype,I0);function C0(){this.data=0,
this.blendMode=FJ.NORMAL,this.polygonOffset=0,this.blend=!0}var O0={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};O0.blend.get=function(){return!!(1&this.data)},O0.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},O0.offsets.get=function(){return!!(2&this.data)},O0.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
O0.culling.get=function(){return!!(4&this.data)},O0.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},O0.depthTest.get=function(){return!!(8&this.data)},O0.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
O0.clockwiseFrontFace.get=function(){return!!(16&this.data)},O0.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},O0.blendMode.get=function(){return this._blendMode},O0.blendMode.set=function(t){this.blend=t!==FJ.NONE,
this._blendMode=t},O0.polygonOffset.get=function(){return this._polygonOffset},O0.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},C0.for2d=function(){var t=new C0;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
C0.prototype,O0);var R0=function(n){function s(t,e,i){var r=T0.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=sQ.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new C0}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(S0);R0.SOURCE_KEY_MAP={};function P0(t,e){this._texture=t,this.mapCoord=new XQ,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var M0=new XQ,N0={texture:{configurable:!0}};N0.texture.get=function(){return this._texture},N0.texture.set=function(t){this._texture=t,this._updateID=-1},P0.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},P0.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(M0.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(M0));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(P0.prototype,N0);function L0(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var F0=function(i){
function t(t){var e=new XQ;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new P0(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(R0),D0=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new Q$;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case rQ.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case rQ.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case rQ.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case rQ.SCISSOR:this.renderer.scissor.pop();break;case rQ.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case rQ.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=rQ.SPRITE;else if(t.type=rQ.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=rQ.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new F0(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(E$),U0=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(E$),B0=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(U0),k0=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(U0),X0=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new XQ,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(E$),G0=new QQ,V0=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new QQ,this.destinationFrame=new QQ}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(G0.width=s.realWidth,G0.height=s.realHeight,i=G0),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
G0.width=n.width,G0.height=n.height,i=G0),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(E$)
;L0.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var j0=0,H0=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=j0++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof g0)return g0;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;g0=!0===t({a:"b"},"a","b")}catch(t){g0=!1}return g0}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?y0:v0)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=n0(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:o0(h.type,h.size)}}var u=new L0(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(E$);function Y0(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var z0=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=FJ.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new C0,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[FJ.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.ADD]=[t.ONE,t.ONE],e[FJ.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[FJ.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[FJ.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[FJ.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.NONE]=[0,0],e[FJ.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[FJ.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[FJ.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[FJ.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[FJ.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[FJ.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[FJ.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[FJ.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[FJ.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[FJ.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[FJ.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(E$),W0=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=sQ.GC_MAX_IDLE,
this.checkCountMax=sQ.GC_MAX_CHECK_COUNT,this.mode=sQ.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==$J.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(E$),q0=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new _$}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new Y0(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Y0(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new Y0(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===jJ.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&lQ(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==KJ.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=WJ.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===YJ.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(E$),K0=new XQ;X.a;function Z0(){this.texArray=null,this.blend=0,this.type=UJ.TRIANGLES,this.start=0,this.size=0,this.data=null}function J0(){this.elements=[],this.ids=[],this.count=0}J0.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function Q0(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var $0={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};$0.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},$0.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},$0.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},$0.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},$0.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Q0.prototype.view=function(t){
return this[t+"View"]},Q0.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Q0.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Q0.prototype,$0);var t1=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=C0.for2d(),this.size=4*sQ.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;sQ.PREFER_ENV===PJ.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),sQ.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=x0.replace(/%forloop%/gi,b0(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Z0);for(;e.length<r;)e.push(new J0);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++_$._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;_$._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=uQ[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;sQ.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),sQ.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=pQ(Math.ceil(t/8)),i=mQ(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Q0(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=pQ(Math.ceil(t/12)),i=mQ(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(q$);t1._drawCallPool=[],t1._textureArrayPool=[];function e1(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}e1.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=j$.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new T0(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new XQ,default:this.defaultGroupCache[t]};return new S0(this.programCache[t],n)},
e1.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function i1(){}var r1=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new F$(null,t,!1),this._indexBuffer=new F$(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,jJ.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,jJ.FLOAT).addAttribute("aColor",this._buffer,4,!0,jJ.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,jJ.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(k$),
n1="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,s1="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",o1={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};i1.create=function(t){var e=Object.assign({vertex:n1,fragment:s1,geometryClass:r1,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new e1(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(t1)},o1.defaultVertexSrc.get=function(){return n1},o1.defaultFragmentTemplate.get=function(){
return s1},Object.defineProperties(i1,o1);i1.create();var a1=function(r){function t(t,e){var i=new XQ;t.renderable=!1,r.call(this,
"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n"
,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,null==e&&(e=20),this.scale=new PQ(e,e)}r&&(t.__proto__=r);var e={map:{configurable:!0}};return((t.prototype=Object.create(
r&&r.prototype)).constructor=t).prototype.apply=function(t,e,i,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y
;var n=this.maskSprite.transform.worldTransform,s=Math.sqrt(n.a*n.a+n.b*n.b),o=Math.sqrt(n.c*n.c+n.d*n.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=n.a/s,this.uniforms.rotation[1]=n.b/s,this.uniforms.rotation[2]=n.c/o,this.uniforms.rotation[3]=n.d/o),
t.applyFilter(this,e,i,r)},e.map.get=function(){return this.uniforms.mapSampler},e.map.set=function(t){this.uniforms.mapSampler=t},Object.defineProperties(t.prototype,e),t}(R0),h1=(u1.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length
)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},u1.prototype.ensureNonAliasedItems=function(){
0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},u1.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},u1.prototype.remove=function(t){
var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},u1.prototype.contains=function(t){return-1!==this.items.indexOf(t)},u1.prototype.removeAll=function(){return this.ensureNonAliasedItems(),
this.items.length=0,this},u1.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(u1.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(
u1.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),u1);function u1(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(h1.prototype,{dispatch:{value:h1.prototype.emit},run:{value:h1.prototype.emit}}
);var l1,c1,d1,p1,f1,m1,_1,y1,v1,g1,x1,b1,T1,E1,w1,A1,S1,I1,C1,O1,R1,P1,M1,N1,L1,F1,D1,U1,B1={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,
u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),
SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,
WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(c1=l1=l1||{})[c1.WEBGL_LEGACY=0]="WEBGL_LEGACY",
c1[c1.WEBGL=1]="WEBGL",c1[c1.WEBGL2=2]="WEBGL2",(p1=d1=d1||{})[p1.UNKNOWN=0]="UNKNOWN",p1[p1.WEBGL=1]="WEBGL",p1[p1.CANVAS=2]="CANVAS",(m1=f1=f1||{})[m1.NORMAL=0]="NORMAL",m1[m1.ADD=1]="ADD",m1[m1.MULTIPLY=2]="MULTIPLY",m1[m1.SCREEN=3]="SCREEN",
m1[m1.OVERLAY=4]="OVERLAY",m1[m1.DARKEN=5]="DARKEN",m1[m1.LIGHTEN=6]="LIGHTEN",m1[m1.COLOR_DODGE=7]="COLOR_DODGE",m1[m1.COLOR_BURN=8]="COLOR_BURN",m1[m1.HARD_LIGHT=9]="HARD_LIGHT",m1[m1.SOFT_LIGHT=10]="SOFT_LIGHT",m1[m1.DIFFERENCE=11]="DIFFERENCE",
m1[m1.EXCLUSION=12]="EXCLUSION",m1[m1.HUE=13]="HUE",m1[m1.SATURATION=14]="SATURATION",m1[m1.COLOR=15]="COLOR",m1[m1.LUMINOSITY=16]="LUMINOSITY",m1[m1.NORMAL_NPM=17]="NORMAL_NPM",m1[m1.ADD_NPM=18]="ADD_NPM",m1[m1.SCREEN_NPM=19]="SCREEN_NPM",
m1[m1.NONE=20]="NONE",m1[m1.SRC_OVER=0]="SRC_OVER",m1[m1.SRC_IN=21]="SRC_IN",m1[m1.SRC_OUT=22]="SRC_OUT",m1[m1.SRC_ATOP=23]="SRC_ATOP",m1[m1.DST_OVER=24]="DST_OVER",m1[m1.DST_IN=25]="DST_IN",m1[m1.DST_OUT=26]="DST_OUT",m1[m1.DST_ATOP=27]="DST_ATOP",
m1[m1.ERASE=26]="ERASE",m1[m1.SUBTRACT=28]="SUBTRACT",m1[m1.XOR=29]="XOR",(y1=_1=_1||{})[y1.POINTS=0]="POINTS",y1[y1.LINES=1]="LINES",y1[y1.LINE_LOOP=2]="LINE_LOOP",y1[y1.LINE_STRIP=3]="LINE_STRIP",y1[y1.TRIANGLES=4]="TRIANGLES",
y1[y1.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",y1[y1.TRIANGLE_FAN=6]="TRIANGLE_FAN",(g1=v1=v1||{})[g1.RGBA=6408]="RGBA",g1[g1.RGB=6407]="RGB",g1[g1.ALPHA=6406]="ALPHA",g1[g1.LUMINANCE=6409]="LUMINANCE",g1[g1.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",
g1[g1.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",g1[g1.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(b1=x1=x1||{})[b1.TEXTURE_2D=3553]="TEXTURE_2D",b1[b1.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",b1[b1.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",
b1[b1.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",b1[b1.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",b1[b1.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",
b1[b1.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",b1[b1.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",b1[b1.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(E1=T1=T1||{}
)[E1.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",E1[E1.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",E1[E1.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",E1[E1.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",
E1[E1.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",E1[E1.FLOAT=5126]="FLOAT",E1[E1.HALF_FLOAT=36193]="HALF_FLOAT",(A1=w1=w1||{})[A1.NEAREST=0]="NEAREST",A1[A1.LINEAR=1]="LINEAR",(I1=S1=S1||{})[I1.CLAMP=33071]="CLAMP",I1[I1.REPEAT=10497]="REPEAT"
,I1[I1.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(O1=C1=C1||{})[O1.OFF=0]="OFF",O1[O1.POW2=1]="POW2",O1[O1.ON=2]="ON",(P1=R1=R1||{})[P1.NPM=0]="NPM",P1[P1.UNPACK=1]="UNPACK",P1[P1.PMA=2]="PMA",P1[P1.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",
P1[P1.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",P1[P1.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(N1=M1=M1||{})[N1.AUTO=0]="AUTO",N1[N1.MANUAL=1]="MANUAL",(F1=L1=L1||{}).LOW="lowp",F1.MEDIUM="mediump",F1.HIGH="highp",(U1=D1=D1||{})[U1.NONE=0]="NONE",
U1[U1.SCISSOR=1]="SCISSOR",U1[U1.STENCIL=2]="STENCIL",U1[U1.SPRITE=3]="SPRITE",B1.RETINA_PREFIX=/@([0-9\.]+)x/;var k1,X1=!(B1.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),G1="5.2.0";var V1=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i
;t[f1.NORMAL_NPM]=f1.NORMAL,t[f1.ADD_NPM]=f1.ADD,t[f1.SCREEN_NPM]=f1.SCREEN,e[f1.NORMAL]=f1.NORMAL_NPM,e[f1.ADD]=f1.ADD_NPM,e[f1.SCREEN]=f1.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function j1(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){
var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var H1=0;function Y1(){return++H1}function z1(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function W1(t){return!(t&t-1||!t)}function q1(t){var e=(65535<t)<<4,i=(
255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var K1={},Z1=Object.create(null),J1=Object.create(null);function Q1(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),
this.resolution=i||B1.RESOLUTION,this.resize(t,e)}var $1={width:{configurable:!0},height:{configurable:!0}};Q1.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},
Q1.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},Q1.prototype.destroy=function(){this.context=null,this.canvas=null},$1.width.get=function(){return this.canvas.width},$1.width.set=function(t){
this.canvas.width=t},$1.height.get=function(){return this.canvas.height},$1.height.set=function(t){this.canvas.height=t},Object.defineProperties(Q1.prototype,$1);var t2;function e2(t,e){var i=B1.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]
):void 0!==e?e:1}var i2,r2,n2={};B1.TARGET_FPMS=.06,(r2=i2=i2||{})[r2.INTERACTION=50]="INTERACTION",r2[r2.HIGH=25]="HIGH",r2[r2.NORMAL=0]="NORMAL",r2[r2.LOW=-25]="LOW",r2[r2.UTILITY=-50]="UTILITY";var s2=(o2.prototype.match=function(t,e){
return void 0===e&&(e=null),this.fn===t&&this.context===e},o2.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},
o2.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},o2.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(
this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},o2);function o2(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,
this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var a2=(h2.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},h2.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},h2.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},h2.prototype.add=function(t,e,i){return void 0===i&&(i=i2.NORMAL),this._addListener(new s2(t,e,i))},h2.prototype.addOnce=function(t,e,i){return void 0===i&&(i=i2.NORMAL),this._addListener(new s2(t,e,i,!0))},
h2.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},h2.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},h2.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},h2.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},h2.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},h2.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*B1.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(h2.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(h2.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,B1.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(h2.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(h2,"shared",{get:function(){if(!h2._shared){var t=h2._shared=new h2;t.autoStart=!0,t._protected=!0}return h2._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(h2,"system",{get:function(){if(!h2._system){var t=h2._system=new h2;t.autoStart=!0,t._protected=!0}return h2._system},enumerable:!0,configurable:!0}),h2);function h2(){var e=this;this._head=new s2(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/B1.TARGET_FPMS,this.elapsedMS=1/B1.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}u2.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,i2.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?a2.shared:new a2,t.autoStart&&this.start()},u2.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function u2(){}var l2=(c2.prototype.clone=function(){return new c2(this.x,this.y)},
c2.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},c2.prototype.copyTo=function(t){return t.set(this.x,this.y),t},c2.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},c2.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},c2);function c2(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var d2=(p2.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new p2(t,e,this._x,this._y)},
p2.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},p2.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},p2.prototype.copyTo=function(t){return t.set(this._x,this._y),t},p2.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(p2.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(p2.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),p2);function p2(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var f2,m2,_2=2*Math.PI,y2=180/Math.PI,v2=Math.PI/180;(m2=f2=f2||{})[m2.POLY=0]="POLY",m2[m2.RECT=1]="RECT",m2[m2.CIRC=2]="CIRC",m2[m2.ELIP=3]="ELIP",
m2[m2.RREC=4]="RREC";var g2=(x2.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},x2.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
x2.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},x2.prototype.apply=function(t,e){e=e||new l2;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},x2.prototype.applyInverse=function(t,e){e=e||new l2;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},x2.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
x2.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},x2.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},x2.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},x2.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},x2.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},x2.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(_2-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},x2.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},x2.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},x2.prototype.clone=function(){
var t=new x2;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},x2.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},x2.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(x2,"IDENTITY",{get:function(){return new x2},enumerable:!0,configurable:!0}),Object.defineProperty(x2,"TEMP_MATRIX",{get:function(){return new x2},
enumerable:!0,configurable:!0}),x2);function x2(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var b2=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],T2=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],E2=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],w2=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],A2=[],S2=[],I2=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];A2.push(e);for(
var i=0;i<16;i++)for(var r=I2(b2[t]*b2[i]+E2[t]*T2[i]),n=I2(T2[t]*b2[i]+w2[t]*T2[i]),s=I2(b2[t]*E2[i]+E2[t]*w2[i]),o=I2(T2[t]*E2[i]+w2[t]*w2[i]),a=0;a<16;a++)if(b2[a]===r&&T2[a]===n&&E2[a]===s&&w2[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new g2
;h.set(b2[t],T2[t],E2[t],w2[t],0,0),S2.push(h)}}();var C2={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return b2[t]},uY:function(t){return T2[t]},vX:function(t){
return E2[t]},vY:function(t){return w2[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return A2[t][e]},sub:function(t,e){return A2[t][C2.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?C2.S:C2.N:2*Math.abs(e)<=Math.abs(t)?0<t?C2.E:C2.W:0<e?0<t?C2.SE:C2.SW:0<t?C2.NE:C2.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=S2[C2.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},O2=(R2.prototype.onChange=function(){this._localID++},R2.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},R2.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},R2.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},R2.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(R2.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),R2.IDENTITY=new R2,R2);function R2(){this.worldTransform=new g2,this.localTransform=new g2,this.position=new d2(this.onChange,
this,0,0),this.scale=new d2(this.onChange,this,1,1),this.pivot=new d2(this.onChange,this,0,0),this.skew=new d2(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var P2=(Object.defineProperty(M2.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(M2.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(M2.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(M2.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(M2,"EMPTY"
,{get:function(){return new M2(0,0,0,0)},enumerable:!0,configurable:!0}),M2.prototype.clone=function(){return new M2(this.x,this.y,this.width,this.height)},M2.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},M2.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},M2.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},M2.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},M2.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},M2.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
M2.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},M2);function M2(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=f2.RECT}N2.prototype.clone=function(){return new N2(this.x,this.y,this.radius)},
N2.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},N2.prototype.getBounds=function(){return new P2(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function N2(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=f2.CIRC}L2.prototype.clone=function(){return new L2(this.x,this.y,this.width,this.height)},L2.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},L2.prototype.getBounds=function(){return new P2(this.x-this.width,this.y-this.height,this.width,this.height)};function L2(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=f2.ELIP}F2.prototype.clone=function(){var t=new F2(this.points.slice());return t.closeStroke=this.closeStroke,t},
F2.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function F2(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof l2){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=f2.POLY,this.closeStroke=!0}
D2.prototype.clone=function(){return new D2(this.x,this.y,this.width,this.height,this.radius)},D2.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function D2(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=f2.RREC}B1.SORTABLE_CHILDREN=!1;function U2(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}U2.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},U2.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},U2.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?P2.EMPTY:((
t=t||new P2(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},U2.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},U2.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},U2.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
U2.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},U2.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},U2.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
U2.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},U2.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},U2.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},U2.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},U2.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},U2.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},U2.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var B2=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new O2,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new U2,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new P2),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new P2),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*y2},e.angle.set=function(t){this.transform.rotation=t*v2
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function k2(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}B2.prototype.displayObjectUpdateTransform=B2.prototype.updateTransform;var X2=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=B1.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);j1(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,j1(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,j1(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(k2),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(B2);X2.prototype.containerUpdateTransform=X2.prototype.updateTransform;function G2(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new h1(
"setRealSize",2),this.onUpdate=new h1("update"),this.onError=new h1("onError",1)}var V2={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};G2.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},G2.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},G2.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},V2.valid.get=function(){return!!this._width&&!!this._height},G2.prototype.update=function(){this.destroyed||this.onUpdate.run()},G2.prototype.load=function(){return Promise.resolve()},
V2.width.get=function(){return this._width},V2.height.get=function(){return this._height},G2.prototype.upload=function(t,e,i){return!1},G2.prototype.style=function(t,e,i){return!1},G2.prototype.dispose=function(){},G2.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(G2.prototype,V2);var j2=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(t2=t2||document.createElement("a")).href=t;var i=!(t=H.a.parse(t2.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===R1.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(G2),H2=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:B1.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===R1.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(j2),Y2=[];function z2(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=Y2.length-1;0<=n;--n){var s=Y2[n];if(s.test&&s.test(t,i))return new s(t,e)}return new H2(t,e)}var W2=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===R1.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(G2),q2={scaleMode:w1.NEAREST,format:v1.RGBA,
alphaMode:R1.NPM},K2=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof G2||((t=z2(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||B1.RESOLUTION,this.mipmap=void 0!==r?r:B1.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:B1.ANISOTROPIC_LEVEL,
this.wrapMode=h||B1.WRAP_MODE,this.scaleMode=void 0!==s?s:B1.SCALE_MODE,this.format=u||v1.RGBA,this.type=l||T1.UNSIGNED_BYTE,this.target=c||x1.TEXTURE_2D,this.alphaMode=void 0!==i?i:R1.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=Y1(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=W1(this.realWidth
)&&W1(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete J1[this.cacheId],delete Z1[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=B1.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Y1()),t._pixiId);var s=J1[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new W2(t,{width:e,height:i}),
s=t instanceof Float32Array?T1.FLOAT:T1.UNSIGNED_BYTE;return new o(n,Object.assign(q2,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),J1[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),J1[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=J1[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete J1[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete J1[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);K2._globalBatch=0;var Z2=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new K2;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(z2(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=x1.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(G2),
J2=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(j2),
Q2=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=x1.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=x1.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(Z2);Q2.SIDES=6;var $2=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+Y1(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(j2)
;$2.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var t3=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=a2.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(a2.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(a2.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&a2.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(a2.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(a2.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(j2);t3.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var e3=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(j2);Y2.push(H2,e3,J2,t3,$2,W2,Q2,Z2);function i3(t){this.renderer=t}
i3.prototype.destroy=function(){this.renderer=null};function r3(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new h1("disposeFramebuffer",2)}var n3=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===R1.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(W2),s3={colorTexture:{configurable:!0}};s3.colorTexture.get=function(){return this.colorTextures[0]},r3.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new K2(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},r3.prototype.addDepthTexture=function(t){return this.depthTexture=t||new K2(new n3(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:v1.DEPTH_COMPONENT,type:T1.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},r3.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},r3.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},r3.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},r3.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(r3.prototype,s3);function o3(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var a3=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new r3(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(K2);o3.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=C2.add(i,C2.NW),this.x0=a+s*C2.uX(i),this.y0=h+o*C2.uY(i),i=C2.add(i,2),this.x1=a+s*C2.uX(i),this.y1=h+o*C2.uY(i),i=C2.add(i,2),this.x2=a+s*C2.uX(i),this.y2=h+o*C2.uY(i),i=C2.add(i,2),
this.x3=a+s*C2.uX(i),this.y3=h+o*C2.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var h3=new o3,u3=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new P2(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=h3,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new l2(s.x,s.y):new l2(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&Z1[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===h3&&(this._uvs=new o3),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=B1.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Y1()),t._pixiId);var s=Z1[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=e2(t)),(s=new a(new K2(t,e))).baseTexture.cacheId=n,
K2.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(K2.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new H2(t);r.url=e;var n=new a(new K2(r,{scaleMode:B1.SCALE_MODE,resolution:e2(e)}));return i=i||e,
K2.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(K2.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Z1[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),Z1[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=Z1[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Z1[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Z1[t.textureCacheIds[r]]===t&&delete Z1[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function l3(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}u3.EMPTY=new u3(new K2),l3(u3.EMPTY),l3(u3.EMPTY.baseTexture),u3.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new u3(new K2(new J2(t)))}(),l3(u3.WHITE),l3(u3.WHITE.baseTexture);function c3(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var d3=function(a){function n(t,e){var i=null;if(!(t instanceof a3)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new a3({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new a3(t))},n}(u3);c3.prototype.createTexture=function(t,e){var i=new a3(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new d3(i)},
c3.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=c3.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=z1(t)))<<16|65535&(e=z1(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},c3.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
c3.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},c3.prototype.returnFilterTexture=function(t){this.returnTexture(t)},c3.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},c3.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=c3.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},c3.SCREEN_KEY="screen";function p3(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}p3.prototype.destroy=function(){this.buffer=null},p3.from=function(t,e,i,r,n){return new p3(t,e,i,r,n)};function f3(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=m3++,this.disposeRunner=new h1("disposeBuffer",2)}var m3=0;function _3(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}f3.prototype.update=function(t){this.data=t||this.data,this._updateID++},f3.prototype.dispose=function(){this.disposeRunner.run(this,!1)},f3.prototype.destroy=function(){this.dispose(),this.data=null},f3.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new f3(t)};var y3={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function v3(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=x3++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new h1("disposeGeometry",2),this.refCount=0}var g3={5126:4,5123:2,5121:1},x3=0,b3={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};v3.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new f3(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new p3(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},v3.prototype.getAttribute=function(t){return this.attributes[t]},v3.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},v3.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new f3(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
v3.prototype.getIndex=function(){return this.indexBuffer},v3.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new f3;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*g3[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=_3(c)
;n[d]||(n[d]=new y3[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},v3.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},v3.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},v3.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},v3.prototype.clone=function(){for(var t=new v3,e=0;e<this.buffers.length;e++)t.buffers[e]=new f3(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new p3(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},v3.merge=function(t){for(var e,i=new v3,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(b3[_3(e.buffers[h].data)])(n[h]),i.buffers[h]=new f3(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*g3[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function T3(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=A3++,this.static=!!e}var E3=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(v3),
w3=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new f3(this.vertices),this.uvBuffer=new f3(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(v3),A3=0
;T3.prototype.update=function(){this.dirtyId++},T3.prototype.add=function(t,e,i){this.uniforms[t]=new T3(e,i)},T3.from=function(t,e){return new T3(t,e)};function S3(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new P2,this.destinationFrame=new P2,this.filters=[]}S3.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function I3(t){this.renderer=t}var C3=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new c3,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new E3,this.quadUv=new w3,this.tempRect=new P2,this.activeState={},this.globalUniforms=new T3({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new S3,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(_1.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(_1.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
g2.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(i3);I3.prototype.flush=function(){},I3.prototype.destroy=function(){this.renderer=null},I3.prototype.start=function(){},I3.prototype.stop=function(){this.flush()},I3.prototype.render=function(t){};var O3=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new I3(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(i3);B1.PREFER_ENV=u.a.any?l1.WEBGL:l1.WEBGL2,B1.STRICT_TEXTURE_CACHE=!1
;function R3(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function P3(t){this.type=D1.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var M3=0,N3=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=M3++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=M3++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(B1.PREFER_ENV>=l1.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(i3),L3=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new r3(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new P2,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;B1.PREFER_ENV===l1.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new P2},Object.defineProperties(t.prototype,i),t}(i3),F3={5126:4,5123:2,5121:1},
D3=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;B1.PREFER_ENV===l1.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*F3[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*F3[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*F3[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new R3(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(i3);function U3(t,e,i,r){var n=B3(t,t.VERTEX_SHADER,e),s=B3(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function B3(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function k3(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return X3(2*e)
;case"bvec3":return X3(3*e);case"bvec4":return X3(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function X3(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}P3.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=D1.NONE,this.autoDetect=!0),this._target=null},P3.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var G3,V3={},j3=V3;function H3(){if(j3===V3||j3&&j3.isContextLost()){
var t,e=document.createElement("canvas");B1.PREFER_ENV>=l1.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),j3=t}return j3}function Y3(t,e,i){if(
"precision"===t.substring(0,9))return i!==L1.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===L1.HIGH&&i!==L1.HIGH&&(r=L1.MEDIUM),"precision "+r+" float;\n"+t}var z3={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var W3=null,q3={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function K3(t,e){if(!W3){var i=Object.keys(q3)
;W3={};for(var r=0;r<i.length;++r){var n=i[r];W3[t[n]]=q3[n]}}return W3[e]}var Z3={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},J3={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Q3,$3=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function t4(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function e4(t,e,i){void 0===i&&(i="pixi-shader"),this.id=i4++,this.vertexSrc=t||e4.defaultVertexSrc,
this.fragmentSrc=e||e4.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),r4[i]?(r4[i]++,i+="-"+r4[i]):r4[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Y3(this.vertexSrc,B1.PRECISION_VERTEX,L1.HIGH),this.fragmentSrc=Y3(this.fragmentSrc,B1.PRECISION_FRAGMENT,function(
){if(!G3){G3=L1.MEDIUM;var t=H3();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);G3=e.precision?L1.HIGH:L1.MEDIUM}}return G3}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var i4=0,r4={},n4={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};e4.prototype.extractData=function(t,e){var i=H3();if(i){var r=U3(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},e4.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=K3(e,a.type),u={type:h,name:a.name,size:(i=h,z3[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
e4.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=K3(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:k3(h,s.size)}}return i},n4.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},n4.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},e4.from=function(t,e,i){var r=t+e,n=K1[r];return n||(K1[r]=n=new e4(t
,e,i)),n},Object.defineProperties(e4,n4);function s4(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof T3?e:new T3(e):new T3({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var o4={uniforms:{configurable:!0}};s4.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
s4.prototype.destroy=function(){this.uniformGroup=null},o4.uniforms.get=function(){return this.uniformGroup.uniforms},s4.from=function(t,e,i){var r=e4.from(t,e);return new s4(r,i)},Object.defineProperties(s4.prototype,o4);function a4(){this.data=0,
this.blendMode=f1.NORMAL,this.polygonOffset=0,this.blend=!0}var h4={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};h4.blend.get=function(){return!!(1&this.data)},h4.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},h4.offsets.get=function(){return!!(2&this.data)},h4.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
h4.culling.get=function(){return!!(4&this.data)},h4.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},h4.depthTest.get=function(){return!!(8&this.data)},h4.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
h4.clockwiseFrontFace.get=function(){return!!(16&this.data)},h4.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},h4.blendMode.get=function(){return this._blendMode},h4.blendMode.set=function(t){this.blend=t!==f1.NONE,
this._blendMode=t},h4.polygonOffset.get=function(){return this._polygonOffset},h4.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},a4.for2d=function(){var t=new a4;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
a4.prototype,h4);var u4=function(n){function s(t,e,i){var r=e4.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=B1.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new a4}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(s4);u4.SOURCE_KEY_MAP={};function l4(t,e){this._texture=t,this.mapCoord=new g2,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var c4=new g2,d4={texture:{configurable:!0}};d4.texture.get=function(){return this._texture},d4.texture.set=function(t){this._texture=t,this._updateID=-1},l4.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},l4.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(c4.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(c4));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(l4.prototype,d4);function p4(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var f4=function(i){
function t(t){var e=new g2;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new l4(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(u4),m4=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new P3;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case D1.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case D1.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case D1.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case D1.SCISSOR:this.renderer.scissor.pop();break;case D1.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case D1.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=D1.SPRITE;else if(t.type=D1.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=D1.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new f4(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(i3),_4=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(i3),y4=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(_4),v4=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(_4),g4=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new g2,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(i3),x4=new P2,b4=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new P2,this.destinationFrame=new P2}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(x4.width=s.realWidth,x4.height=s.realHeight,i=x4),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
x4.width=n.width,x4.height=n.height,i=x4),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(i3)
;p4.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var T4=0,E4=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=T4++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Q3)return Q3;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;Q3=!0===t({a:"b"},"a","b")}catch(t){Q3=!1}return Q3}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?Z3:J3)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=U3(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:k3(h.type,h.size)}}var u=new p4(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(i3);function w4(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var A4=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=f1.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new a4,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[f1.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.ADD]=[t.ONE,t.ONE],e[f1.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[f1.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[f1.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[f1.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.NONE]=[0,0],e[f1.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[f1.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[f1.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[f1.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[f1.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[f1.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[f1.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[f1.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[f1.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[f1.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[f1.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(i3),S4=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=B1.GC_MAX_IDLE,
this.checkCountMax=B1.GC_MAX_CHECK_COUNT,this.mode=B1.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==M1.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(i3),I4=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new K2}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new w4(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new w4(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new w4(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===T1.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&j1(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==C1.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=S1.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===w1.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(i3),C4=new g2;X.a;function O4(){this.texArray=null,this.blend=0,this.type=_1.TRIANGLES,this.start=0,this.size=0,this.data=null}function R4(){this.elements=[],this.ids=[],this.count=0}R4.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function P4(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var M4={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};M4.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},M4.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},M4.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},M4.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},M4.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},P4.prototype.view=function(t){
return this[t+"View"]},P4.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},P4.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(P4.prototype,M4);var N4=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=a4.for2d(),this.size=4*B1.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;B1.PREFER_ENV===l1.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),B1.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=$3.replace(/%forloop%/gi,t4(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new O4);for(;e.length<r;)e.push(new R4);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++K2._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;K2._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=V1[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;B1.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),B1.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=z1(Math.ceil(t/8)),i=q1(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new P4(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=z1(Math.ceil(t/12)),i=q1(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(I3);N4._drawCallPool=[],N4._textureArrayPool=[];function L4(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}L4.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=T3.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new e4(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new g2,default:this.defaultGroupCache[t]};return new s4(this.programCache[t],n)},
L4.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function F4(){}var D4=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new f3(null,t,!1),this._indexBuffer=new f3(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,T1.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,T1.FLOAT).addAttribute("aColor",this._buffer,4,!0,T1.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,T1.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(v3),
U4="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,B4="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",k4={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};F4.create=function(t){var e=Object.assign({vertex:U4,fragment:B4,geometryClass:D4,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new L4(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(N4)},k4.defaultVertexSrc.get=function(){return U4},k4.defaultFragmentTemplate.get=function(){
return B4},Object.defineProperties(F4,k4);F4.create();var X4=function(t){function e(){t.call(this,
"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n"
,
'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'
)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(u4),G4=(V4.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(
var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},V4.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},
V4.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},V4.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}
,V4.prototype.contains=function(t){return-1!==this.items.indexOf(t)},V4.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},V4.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},
Object.defineProperty(V4.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(V4.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),V4);function V4(t){
this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(G4.prototype,{dispatch:{value:G4.prototype.emit},run:{value:G4.prototype.emit}});var j4,H4,Y4,z4,W4,q4,K4,Z4,J4,Q4,$4,t5,e5,i5,r5,n5,s5,o5,a5,h5,u5,l5,c5,d5,p5,f5,m5,_5,y5={
MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(
u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,
clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",
CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(H4=j4=j4||{})[H4.WEBGL_LEGACY=0]="WEBGL_LEGACY",H4[H4.WEBGL=1]="WEBGL",H4[H4.WEBGL2=2]="WEBGL2",(z4=Y4=Y4||{})[z4.UNKNOWN=0]="UNKNOWN",z4[z4.WEBGL=1]="WEBGL",
z4[z4.CANVAS=2]="CANVAS",(q4=W4=W4||{})[q4.NORMAL=0]="NORMAL",q4[q4.ADD=1]="ADD",q4[q4.MULTIPLY=2]="MULTIPLY",q4[q4.SCREEN=3]="SCREEN",q4[q4.OVERLAY=4]="OVERLAY",q4[q4.DARKEN=5]="DARKEN",q4[q4.LIGHTEN=6]="LIGHTEN",q4[q4.COLOR_DODGE=7]="COLOR_DODGE",
q4[q4.COLOR_BURN=8]="COLOR_BURN",q4[q4.HARD_LIGHT=9]="HARD_LIGHT",q4[q4.SOFT_LIGHT=10]="SOFT_LIGHT",q4[q4.DIFFERENCE=11]="DIFFERENCE",q4[q4.EXCLUSION=12]="EXCLUSION",q4[q4.HUE=13]="HUE",q4[q4.SATURATION=14]="SATURATION",q4[q4.COLOR=15]="COLOR",
q4[q4.LUMINOSITY=16]="LUMINOSITY",q4[q4.NORMAL_NPM=17]="NORMAL_NPM",q4[q4.ADD_NPM=18]="ADD_NPM",q4[q4.SCREEN_NPM=19]="SCREEN_NPM",q4[q4.NONE=20]="NONE",q4[q4.SRC_OVER=0]="SRC_OVER",q4[q4.SRC_IN=21]="SRC_IN",q4[q4.SRC_OUT=22]="SRC_OUT",
q4[q4.SRC_ATOP=23]="SRC_ATOP",q4[q4.DST_OVER=24]="DST_OVER",q4[q4.DST_IN=25]="DST_IN",q4[q4.DST_OUT=26]="DST_OUT",q4[q4.DST_ATOP=27]="DST_ATOP",q4[q4.ERASE=26]="ERASE",q4[q4.SUBTRACT=28]="SUBTRACT",q4[q4.XOR=29]="XOR",(Z4=K4=K4||{})[Z4.POINTS=0]="POINTS",
Z4[Z4.LINES=1]="LINES",Z4[Z4.LINE_LOOP=2]="LINE_LOOP",Z4[Z4.LINE_STRIP=3]="LINE_STRIP",Z4[Z4.TRIANGLES=4]="TRIANGLES",Z4[Z4.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Z4[Z4.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Q4=J4=J4||{})[Q4.RGBA=6408]="RGBA",Q4[Q4.RGB=6407]="RGB",
Q4[Q4.ALPHA=6406]="ALPHA",Q4[Q4.LUMINANCE=6409]="LUMINANCE",Q4[Q4.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Q4[Q4.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Q4[Q4.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(t5=$4=$4||{})[t5.TEXTURE_2D=3553]="TEXTURE_2D",
t5[t5.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t5[t5.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t5[t5.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t5[t5.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
t5[t5.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t5[t5.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t5[t5.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
t5[t5.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(i5=e5=e5||{})[i5.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i5[i5.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i5[i5.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
i5[i5.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i5[i5.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i5[i5.FLOAT=5126]="FLOAT",i5[i5.HALF_FLOAT=36193]="HALF_FLOAT",(n5=r5=r5||{})[n5.NEAREST=0]="NEAREST",n5[n5.LINEAR=1]="LINEAR",(
o5=s5=s5||{})[o5.CLAMP=33071]="CLAMP",o5[o5.REPEAT=10497]="REPEAT",o5[o5.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(h5=a5=a5||{})[h5.OFF=0]="OFF",h5[h5.POW2=1]="POW2",h5[h5.ON=2]="ON",(l5=u5=u5||{})[l5.NPM=0]="NPM",l5[l5.UNPACK=1]="UNPACK",
l5[l5.PMA=2]="PMA",l5[l5.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",l5[l5.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",l5[l5.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(d5=c5=c5||{})[d5.AUTO=0]="AUTO",d5[d5.MANUAL=1]="MANUAL",(f5=p5=p5||{}
).LOW="lowp",f5.MEDIUM="mediump",f5.HIGH="highp",(_5=m5=m5||{})[_5.NONE=0]="NONE",_5[_5.SCISSOR=1]="SCISSOR",_5[_5.STENCIL=2]="STENCIL",_5[_5.SPRITE=3]="SPRITE",y5.RETINA_PREFIX=/@([0-9\.]+)x/;var v5,g5=!(y5.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),x5="5.2.0"
;var b5=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[W4.NORMAL_NPM]=W4.NORMAL,t[W4.ADD_NPM]=W4.ADD,t[W4.SCREEN_NPM]=W4.SCREEN,e[W4.NORMAL]=W4.NORMAL_NPM,e[W4.ADD]=W4.ADD_NPM,e[W4.SCREEN]=W4.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function T5(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var E5=0;function w5(){return++E5}function A5(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function S5(t){
return!(t&t-1||!t)}function I5(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var C5={},O5=Object.create(null),R5=Object.create(null);function P5(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||y5.RESOLUTION,this.resize(t,e)}var M5={width:{configurable:!0},height:{configurable:!0}};P5.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},P5.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},P5.prototype.destroy=function(){this.context=null,this.canvas=null},M5.width.get=function(){
return this.canvas.width},M5.width.set=function(t){this.canvas.width=t},M5.height.get=function(){return this.canvas.height},M5.height.set=function(t){this.canvas.height=t},Object.defineProperties(P5.prototype,M5);var N5;function L5(t,e){
var i=y5.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var F5,D5,U5={};y5.TARGET_FPMS=.06,(D5=F5=F5||{})[D5.INTERACTION=50]="INTERACTION",D5[D5.HIGH=25]="HIGH",D5[D5.NORMAL=0]="NORMAL",D5[D5.LOW=-25]="LOW",D5[D5.UTILITY=-50]="UTILITY"
;var B5=(k5.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},k5.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),
this._destroyed&&(this.next=null),e},k5.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},k5.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,
this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},k5);function k5(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,
this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var X5=(G5.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},G5.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},G5.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},G5.prototype.add=function(t,e,i){return void 0===i&&(i=F5.NORMAL),this._addListener(new B5(t,e,i))},G5.prototype.addOnce=function(t,e,i){return void 0===i&&(i=F5.NORMAL),this._addListener(new B5(t,e,i,!0))},
G5.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},G5.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},G5.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},G5.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},G5.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},G5.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*y5.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(G5.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(G5.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,y5.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(G5.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(G5,"shared",{get:function(){if(!G5._shared){var t=G5._shared=new G5;t.autoStart=!0,t._protected=!0}return G5._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(G5,"system",{get:function(){if(!G5._system){var t=G5._system=new G5;t.autoStart=!0,t._protected=!0}return G5._system},enumerable:!0,configurable:!0}),G5);function G5(){var e=this;this._head=new B5(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/y5.TARGET_FPMS,this.elapsedMS=1/y5.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}V5.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,F5.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?X5.shared:new X5,t.autoStart&&this.start()},V5.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function V5(){}var j5=(H5.prototype.clone=function(){return new H5(this.x,this.y)},
H5.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},H5.prototype.copyTo=function(t){return t.set(this.x,this.y),t},H5.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},H5.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},H5);function H5(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var Y5=(z5.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new z5(t,e,this._x,this._y)},
z5.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},z5.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},z5.prototype.copyTo=function(t){return t.set(this._x,this._y),t},z5.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(z5.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(z5.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),z5);function z5(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var W5,q5,K5=2*Math.PI,Z5=180/Math.PI,J5=Math.PI/180;(q5=W5=W5||{})[q5.POLY=0]="POLY",q5[q5.RECT=1]="RECT",q5[q5.CIRC=2]="CIRC",q5[q5.ELIP=3]="ELIP",
q5[q5.RREC=4]="RREC";var Q5=($5.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},$5.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
$5.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},$5.prototype.apply=function(t,e){e=e||new j5;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},$5.prototype.applyInverse=function(t,e){e=e||new j5;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},$5.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
$5.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},$5.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},$5.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},$5.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},$5.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},$5.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(K5-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},$5.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},$5.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},$5.prototype.clone=function(){
var t=new $5;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},$5.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},$5.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty($5,"IDENTITY",{get:function(){return new $5},enumerable:!0,configurable:!0}),Object.defineProperty($5,"TEMP_MATRIX",{get:function(){return new $5},
enumerable:!0,configurable:!0}),$5);function $5(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var t6=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],e6=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],i6=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],r6=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],n6=[],s6=[],o6=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];n6.push(e);for(
var i=0;i<16;i++)for(var r=o6(t6[t]*t6[i]+i6[t]*e6[i]),n=o6(e6[t]*t6[i]+r6[t]*e6[i]),s=o6(t6[t]*i6[i]+i6[t]*r6[i]),o=o6(e6[t]*i6[i]+r6[t]*r6[i]),a=0;a<16;a++)if(t6[a]===r&&e6[a]===n&&i6[a]===s&&r6[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Q5
;h.set(t6[t],e6[t],i6[t],r6[t],0,0),s6.push(h)}}();var a6={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return t6[t]},uY:function(t){return e6[t]},vX:function(t){
return i6[t]},vY:function(t){return r6[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return n6[t][e]},sub:function(t,e){return n6[t][a6.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?a6.S:a6.N:2*Math.abs(e)<=Math.abs(t)?0<t?a6.E:a6.W:0<e?0<t?a6.SE:a6.SW:0<t?a6.NE:a6.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=s6[a6.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},h6=(u6.prototype.onChange=function(){this._localID++},u6.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},u6.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},u6.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},u6.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(u6.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),u6.IDENTITY=new u6,u6);function u6(){this.worldTransform=new Q5,this.localTransform=new Q5,this.position=new Y5(this.onChange,
this,0,0),this.scale=new Y5(this.onChange,this,1,1),this.pivot=new Y5(this.onChange,this,0,0),this.skew=new Y5(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var l6=(Object.defineProperty(c6.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(c6.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(c6.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(c6.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(c6,"EMPTY"
,{get:function(){return new c6(0,0,0,0)},enumerable:!0,configurable:!0}),c6.prototype.clone=function(){return new c6(this.x,this.y,this.width,this.height)},c6.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},c6.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},c6.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},c6.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},c6.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},c6.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
c6.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},c6);function c6(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=W5.RECT}d6.prototype.clone=function(){return new d6(this.x,this.y,this.radius)},
d6.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},d6.prototype.getBounds=function(){return new l6(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function d6(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=W5.CIRC}p6.prototype.clone=function(){return new p6(this.x,this.y,this.width,this.height)},p6.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},p6.prototype.getBounds=function(){return new l6(this.x-this.width,this.y-this.height,this.width,this.height)};function p6(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=W5.ELIP}f6.prototype.clone=function(){var t=new f6(this.points.slice());return t.closeStroke=this.closeStroke,t},
f6.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function f6(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof j5){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=W5.POLY,this.closeStroke=!0}
m6.prototype.clone=function(){return new m6(this.x,this.y,this.width,this.height,this.radius)},m6.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function m6(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=W5.RREC}y5.SORTABLE_CHILDREN=!1;function _6(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}_6.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},_6.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},_6.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?l6.EMPTY:((
t=t||new l6(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},_6.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},_6.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},_6.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
_6.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},_6.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},_6.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
_6.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},_6.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},_6.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},_6.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},_6.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},_6.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},_6.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var y6=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new h6,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new _6,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new l6),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new l6),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*Z5},e.angle.set=function(t){this.transform.rotation=t*J5
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function v6(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}y6.prototype.displayObjectUpdateTransform=y6.prototype.updateTransform;var g6=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=y5.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);T5(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,T5(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,T5(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(v6),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(y6);g6.prototype.containerUpdateTransform=g6.prototype.updateTransform;function x6(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new G4(
"setRealSize",2),this.onUpdate=new G4("update"),this.onError=new G4("onError",1)}var b6={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};x6.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),
(this._width||this._height)&&this.onResize.run(this._width,this._height)},x6.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},x6.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},b6.valid.get=function(){return!!this._width&&!!this._height},x6.prototype.update=function(){this.destroyed||this.onUpdate.run()},x6.prototype.load=function(){return Promise.resolve()},
b6.width.get=function(){return this._width},b6.height.get=function(){return this._height},x6.prototype.upload=function(t,e,i){return!1},x6.prototype.style=function(t,e,i){return!1},x6.prototype.dispose=function(){},x6.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(x6.prototype,b6);var T6=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(N5=N5||document.createElement("a")).href=t;var i=!(t=H.a.parse(N5.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===u5.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(x6),E6=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:y5.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===u5.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(T6),w6=[];function A6(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=w6.length-1;0<=n;--n){var s=w6[n];if(s.test&&s.test(t,i))return new s(t,e)}return new E6(t,e)}var S6=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===u5.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(x6),I6={scaleMode:r5.NEAREST,format:J4.RGBA,
alphaMode:u5.NPM},C6=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution
,p=e.resourceOptions;!t||t instanceof x6||((t=A6(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||y5.RESOLUTION,this.mipmap=void 0!==r?r:y5.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:y5.ANISOTROPIC_LEVEL,
this.wrapMode=h||y5.WRAP_MODE,this.scaleMode=void 0!==s?s:y5.SCALE_MODE,this.format=u||J4.RGBA,this.type=l||e5.UNSIGNED_BYTE,this.target=c||$4.TEXTURE_2D,this.alphaMode=void 0!==i?i:u5.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=w5(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=S5(this.realWidth
)&&S5(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete R5[this.cacheId],delete O5[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=y5.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+w5()),t._pixiId);var s=R5[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new S6(t,{width:e,height:i}),
s=t instanceof Float32Array?e5.FLOAT:e5.UNSIGNED_BYTE;return new o(n,Object.assign(I6,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),R5[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),R5[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=R5[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete R5[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete R5[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);C6._globalBatch=0;var O6=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new C6;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(A6(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=$4.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(x6),
R6=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(T6),
P6=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=$4.TEXTURE_CUBE_MAP_POSITIVE_X+i;!1!==e.autoLoad&&this.load(
)}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=$4.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++
){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(O6);P6.SIDES=6;var M6=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,
this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)
).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error(
"Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin)
,o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,
r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+w5(),n.getContext("2d"
).drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(T6)
;M6.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var N6=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=X5.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(X5.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(X5.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&X5.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(X5.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(X5.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(T6);N6.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var L6=function(t){function e(){t.apply(this,
arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(T6);w6.push(E6,L6,R6,N6,M6,S6,P6,O6);function F6(t){this.renderer=t}
F6.prototype.destroy=function(){this.renderer=null};function D6(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],
this.glFramebuffers={},this.disposeRunner=new G4("disposeFramebuffer",2)}var U6=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){
var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===u5.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(
e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(S6),B6={colorTexture:{configurable:!0}};B6.colorTexture.get=function(){return this.colorTextures[0]},D6.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new C6(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},D6.prototype.addDepthTexture=function(t){return this.depthTexture=t||new C6(new U6(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:J4.DEPTH_COMPONENT,type:e5.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},D6.prototype.enableDepth=function(){
return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},D6.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},D6.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),
t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution
;this.depthTexture.setSize(t/s,e/s)}}},D6.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(D6.prototype,B6);function k6(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,
this.uvsFloat32=new Float32Array(8)}var X6=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,
this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new D6(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],
this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},
t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(C6);k6.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){
var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=a6.add(i,a6.NW),this.x0=a+s*a6.uX(i),this.y0=h+o*a6.uY(i),i=a6.add(i,2),this.x1=a+s*a6.uX(i),this.y1=h+o*a6.uY(i),i=a6.add(i,2),this.x2=a+s*a6.uX(i),this.y2=h+o*a6.uY(i),i=a6.add(i,2),
this.x3=a+s*a6.uX(i),this.y3=h+o*a6.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,
this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var G6=new k6,V6=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(
this.noFrame=!0,e=new l6(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=G6,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(
this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new j5(s.x,s.y):new j5(0,0),this._updateID=0,this.textureCacheIds=[],
t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{configurable:!0},frame:{
configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},
a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},
a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&O5[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}
this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},
a.prototype.updateUvs=function(){this._uvs===G6&&(this._uvs=new k6),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i=y5.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null
;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+w5()),t._pixiId);var s=O5[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=L5(t)),(s=new a(new C6(t,e))).baseTexture.cacheId=n,
C6.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(C6.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new E6(t);r.url=e;var n=new a(new C6(r,{scaleMode:y5.SCALE_MODE,resolution:L5(e)}));return i=i||e,
C6.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(C6.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),O5[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),O5[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=O5[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete O5[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)O5[t.textureCacheIds[r]]===t&&delete O5[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},
t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r
)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,
this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){
return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function j6(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}V6.EMPTY=new V6(new C6),j6(V6.EMPTY),j6(V6.EMPTY.baseTexture),V6.WHITE=function(){
var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new V6(new C6(new R6(t)))}(),j6(V6.WHITE),j6(V6.WHITE.baseTexture);function H6(t){this.texturePool={},
this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var Y6=function(a){function n(t,e){var i=null;if(!(t instanceof X6)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn(
"Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,t=new X6({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,
this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,
this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){
return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new X6(t))},n}(V6);H6.prototype.createTexture=function(t,e){var i=new X6(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Y6(i)},
H6.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=H6.SCREEN_KEY;t*=i,e*=i,this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=A5(t)))<<16|65535&(e=A5(e))),this.texturePool[r]||(this.texturePool[r]=[])
;var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,n.setResolution(i),n},H6.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},
H6.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},H6.prototype.returnFilterTexture=function(t){this.returnTexture(t)},H6.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){
var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},H6.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=H6.SCREEN_KEY,i=this.texturePool[e];if(
this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},H6.SCREEN_KEY="screen";function z6(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(
r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}z6.prototype.destroy=function(){this.buffer=null},z6.from=function(t,e,i,r,n){return new z6(t,e,i,r,n)};function W6(t,e,i){void 0===e&&(e=!0),
void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=q6++,this.disposeRunner=new G4("disposeBuffer",2)}var q6=0;function K6(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}W6.prototype.update=function(t){this.data=t||this.data,this._updateID++},W6.prototype.dispose=function(){this.disposeRunner.run(this,!1)},W6.prototype.destroy=function(){this.dispose(),this.data=null},W6.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new W6(t)};var Z6={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function J6(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=$6++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new G4("disposeGeometry",2),this.refCount=0}var Q6={5126:4,5123:2,5121:1},$6=0,t8={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};J6.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new W6(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new z6(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},J6.prototype.getAttribute=function(t){return this.attributes[t]},J6.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},J6.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new W6(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
J6.prototype.getIndex=function(){return this.indexBuffer},J6.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new W6;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Q6[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=K6(c)
;n[d]||(n[d]=new Z6[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},J6.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},J6.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},J6.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},J6.prototype.clone=function(){for(var t=new J6,e=0;e<this.buffers.length;e++)t.buffers[e]=new W6(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new z6(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},J6.merge=function(t){for(var e,i=new J6,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(t8[K6(e.buffers[h].data)])(n[h]),i.buffers[h]=new W6(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Q6[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function e8(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=n8++,this.static=!!e}var i8=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(J6),
r8=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new W6(this.vertices),this.uvBuffer=new W6(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(J6),n8=0
;e8.prototype.update=function(){this.dirtyId++},e8.prototype.add=function(t,e,i){this.uniforms[t]=new e8(e,i)},e8.from=function(t,e){return new e8(t,e)};function s8(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new l6,this.destinationFrame=new l6,this.filters=[]}s8.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function o8(t){this.renderer=t}var a8=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new H6,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new i8,this.quadUv=new r8,this.tempRect=new l6,this.activeState={},this.globalUniforms=new e8({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new s8,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(K4.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(K4.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
Q5.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(F6);o8.prototype.flush=function(){},o8.prototype.destroy=function(){this.renderer=null},o8.prototype.start=function(){},o8.prototype.stop=function(){this.flush()},o8.prototype.render=function(t){};var h8=function(e){function t(t){
e.call(this,t),this.emptyRenderer=new o8(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(F6);y5.PREFER_ENV=u.a.any?j4.WEBGL:j4.WEBGL2,y5.STRICT_TEXTURE_CACHE=!1
;function u8(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function l8(t){this.type=m5.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,
this._scissorRect=null,this._target=null}var c8=0,d8=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),
t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0
}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=c8++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=c8++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(y5.PREFER_ENV>=j4.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(F6),p8=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new D6(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new l6,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;y5.PREFER_ENV===j4.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new l6},Object.defineProperties(t.prototype,i),t}(F6),f8={5126:4,5123:2,5121:1},
m8=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),
((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;y5.PREFER_ENV===j4.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*f8[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*f8[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*f8[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new u8(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e
){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(F6);function _8(t,e,i,r){var n=y8(t,t.VERTEX_SHADER,e),s=y8(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function y8(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function v8(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return g8(2*e)
;case"bvec3":return g8(3*e);case"bvec4":return g8(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function g8(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}l8.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=m5.NONE,this.autoDetect=!0),this._target=null},l8.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var x8,b8={},T8=b8;function E8(){if(T8===b8||T8&&T8.isContextLost()){
var t,e=document.createElement("canvas");y5.PREFER_ENV>=j4.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),T8=t}return T8}function w8(t,e,i){if(
"precision"===t.substring(0,9))return i!==p5.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===p5.HIGH&&i!==p5.HIGH&&(r=p5.MEDIUM),"precision "+r+" float;\n"+t}var A8={float:1,vec2:2,vec3:3,
vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var S8=null,I8={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",
BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function C8(t,e){if(!S8){var i=Object.keys(I8)
;S8={};for(var r=0;r<i.length;++r){var n=i[r];S8[t[n]]=I8[n]}}return S8[e]}var O8={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},R8={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var P8,M8=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function N8(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function L8(t,e,i){void 0===i&&(i="pixi-shader"),this.id=F8++,this.vertexSrc=t||L8.defaultVertexSrc,
this.fragmentSrc=e||L8.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),D8[i]?(D8[i]++,i+="-"+D8[i]):D8[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=w8(this.vertexSrc,y5.PRECISION_VERTEX,p5.HIGH),this.fragmentSrc=w8(this.fragmentSrc,y5.PRECISION_FRAGMENT,function(
){if(!x8){x8=p5.MEDIUM;var t=E8();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);x8=e.precision?p5.HIGH:p5.MEDIUM}}return x8}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},
this.syncUniforms=null}var F8=0,D8={},U8={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};L8.prototype.extractData=function(t,e){var i=E8();if(i){var r=_8(i,t,e);this.attributeData=this.getAttributeData(r,i),
this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},L8.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){
var a=e.getActiveAttrib(t,o),h=C8(e,a.type),u={type:h,name:a.name,size:(i=h,A8[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
L8.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=C8(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:v8(h,s.size)}}return i},U8.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},U8.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},L8.from=function(t,e,i){var r=t+e,n=C5[r];return n||(C5[r]=n=new L8(t
,e,i)),n},Object.defineProperties(L8,U8);function B8(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof e8?e:new e8(e):new e8({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var k8={uniforms:{configurable:!0}};B8.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
B8.prototype.destroy=function(){this.uniformGroup=null},k8.uniforms.get=function(){return this.uniformGroup.uniforms},B8.from=function(t,e,i){var r=L8.from(t,e);return new B8(r,i)},Object.defineProperties(B8.prototype,k8);function X8(){this.data=0,
this.blendMode=W4.NORMAL,this.polygonOffset=0,this.blend=!0}var G8={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};G8.blend.get=function(){return!!(1&this.data)},G8.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},G8.offsets.get=function(){return!!(2&this.data)},G8.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
G8.culling.get=function(){return!!(4&this.data)},G8.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},G8.depthTest.get=function(){return!!(8&this.data)},G8.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
G8.clockwiseFrontFace.get=function(){return!!(16&this.data)},G8.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},G8.blendMode.get=function(){return this._blendMode},G8.blendMode.set=function(t){this.blend=t!==W4.NONE,
this._blendMode=t},G8.polygonOffset.get=function(){return this._polygonOffset},G8.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},X8.for2d=function(){var t=new X8;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(
X8.prototype,G8);var V8=function(n){function s(t,e,i){var r=L8.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=y5.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,
this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new X8}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)
).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(B8);V8.SOURCE_KEY_MAP={};function j8(t,e){this._texture=t,this.mapCoord=new Q5,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var H8=new Q5,Y8={texture:{configurable:!0}};Y8.texture.get=function(){return this._texture},Y8.texture.set=function(t){this._texture=t,this._updateID=-1},j8.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},j8.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(H8.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(H8));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(j8.prototype,Y8);function z8(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var W8=function(i){
function t(t){var e=new Q5;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new j8(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(V8),q8=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new l8;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case m5.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case m5.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case m5.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case m5.SCISSOR:this.renderer.scissor.pop();break;case m5.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case m5.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=m5.SPRITE;else if(t.type=m5.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=m5.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new W8(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(F6),K8=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(
this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(F6),Z8=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(K8),J8=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(
){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),
t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},
t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(K8),Q8=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Q5,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(F6),$8=new l6,t7=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new l6,this.destinationFrame=new l6}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||($8.width=s.realWidth,$8.height=s.realHeight,i=$8),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
$8.width=n.width,$8.height=n.height,i=$8),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(F6)
;z8.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var e7=0,i7=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=e7++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof P8)return P8;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;P8=!0===t({a:"b"},"a","b")}catch(t){P8=!1}return P8}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?O8:R8)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=_8(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:v8(h.type,h.size)}}var u=new z8(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(F6);function r7(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var n7=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=W4.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new X8,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[W4.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.ADD]=[t.ONE,t.ONE],e[W4.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[W4.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[W4.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.SATURATION]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[W4.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.NONE]=[0,0],e[W4.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE]
,e[W4.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[W4.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[W4.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[W4.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[W4.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE
],e[W4.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[W4.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[W4.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[W4.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[W4.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,
t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(
var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)
;this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](
this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){
this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(
this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){
this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(
i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(F6),s7=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=y5.GC_MAX_IDLE,
this.checkCountMax=y5.GC_MAX_CHECK_COUNT,this.mode=y5.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==c5.MANUAL&&(
this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(
t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(
var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(F6),o7=function(e){function t(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new C6}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion
;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new r7(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,
0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new r7(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++
)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(
var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(
t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},
t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(
this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),
e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new r7(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",
this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===e5.HALF_FLOAT&&(
e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(
i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),
e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),
delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&T5(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(
t.mipmap!==a5.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=s5.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===r5.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(F6),a7=new Q5;X.a;function h7(){this.texArray=null,this.blend=0,this.type=K4.TRIANGLES,this.start=0,this.size=0,this.data=null}function u7(){this.elements=[],this.ids=[],this.count=0}u7.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function l7(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var c7={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};c7.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},c7.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},c7.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},c7.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},c7.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},l7.prototype.view=function(t){
return this[t+"View"]},l7.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},l7.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(l7.prototype,c7);var d7=function(e){function _(t){
e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=X8.for2d(),this.size=4*y5.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;y5.PREFER_ENV===j4.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),y5.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=M8.replace(/%forloop%/gi,N8(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t
}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},_.prototype.initFlushBuffers=function(){
for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new h7);for(;e.length<r;)e.push(new u7);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},
_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,i=_._textureArrayPool,r=this.renderer.batch,
n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++C6._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u
,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null;C6._globalBatch=o},_.prototype.buildDrawCalls=function(t
,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,c.texArray=t;for(var d=e;d<i;++d){var p=r[d],
f=p._texture.baseTexture,m=b5[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,l+=p.indices.length,c.blend=m}e<i&&(
c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},
_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;y5.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),y5.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=A5(Math.ceil(t/8)),i=I5(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new l7(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=A5(Math.ceil(t/12)),i=I5(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(o8);d7._drawCallPool=[],d7._textureArrayPool=[];function p7(t,e
){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}p7.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=e8.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new L8(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Q5,default:this.defaultGroupCache[t]};return new B8(this.programCache[t],n)},
p7.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function f7(){}var m7=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new W6(null,t,!1),this._indexBuffer=new W6(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,e5.FLOAT).addAttribute("aTextureCoord",this._buffer,2
,!1,e5.FLOAT).addAttribute("aColor",this._buffer,4,!0,e5.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,e5.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(J6),
_7="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,y7="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",v7={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};f7.create=function(t){var e=Object.assign({vertex:_7,fragment:y7,geometryClass:m7,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new p7(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(d7)},v7.defaultVertexSrc.get=function(){return _7},v7.defaultFragmentTemplate.get=function(){
return y7},Object.defineProperties(f7,v7);f7.create();var g7=function(i){function t(t,e){void 0===t&&(t=.5),void 0===e&&(e=Math.random()),i.call(this,
"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
,
"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"
,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}i&&(t.__proto__=i),(t.prototype=Object.create(i&&i.prototype)).constructor=t;var e={noise:{configurable:!0},seed:{configurable:!0}};return e.noise.get=function(){return this.uniforms.uNoise},
e.noise.set=function(t){this.uniforms.uNoise=t},e.seed.get=function(){return this.uniforms.uSeed},e.seed.set=function(t){this.uniforms.uSeed=t},Object.defineProperties(t.prototype,e),t}(V8),x7=(b7.prototype.emit=function(t,e,i,r,n,s,o,a){if(
8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},
b7.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},b7.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t))
,this},b7.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},b7.prototype.contains=function(t){return-1!==this.items.indexOf(t)},b7.prototype.removeAll=function(){
return this.ensureNonAliasedItems(),this.items.length=0,this},b7.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(b7.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,
configurable:!0}),Object.defineProperty(b7.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),b7);function b7(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(x7.prototype,{dispatch:{
value:x7.prototype.emit},run:{value:x7.prototype.emit}});var T7,E7,w7,A7,S7,I7,C7,O7,R7,P7,M7,N7,L7,F7,D7,U7,B7,k7,X7,G7,V7,j7,H7,Y7,z7,W7,q7,K7,Z7={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){
var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(
e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,
GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(E7=T7=T7||{}
)[E7.WEBGL_LEGACY=0]="WEBGL_LEGACY",E7[E7.WEBGL=1]="WEBGL",E7[E7.WEBGL2=2]="WEBGL2",(A7=w7=w7||{})[A7.UNKNOWN=0]="UNKNOWN",A7[A7.WEBGL=1]="WEBGL",A7[A7.CANVAS=2]="CANVAS",(I7=S7=S7||{})[I7.NORMAL=0]="NORMAL",I7[I7.ADD=1]="ADD",I7[I7.MULTIPLY=2]="MULTIPLY"
,I7[I7.SCREEN=3]="SCREEN",I7[I7.OVERLAY=4]="OVERLAY",I7[I7.DARKEN=5]="DARKEN",I7[I7.LIGHTEN=6]="LIGHTEN",I7[I7.COLOR_DODGE=7]="COLOR_DODGE",I7[I7.COLOR_BURN=8]="COLOR_BURN",I7[I7.HARD_LIGHT=9]="HARD_LIGHT",I7[I7.SOFT_LIGHT=10]="SOFT_LIGHT",
I7[I7.DIFFERENCE=11]="DIFFERENCE",I7[I7.EXCLUSION=12]="EXCLUSION",I7[I7.HUE=13]="HUE",I7[I7.SATURATION=14]="SATURATION",I7[I7.COLOR=15]="COLOR",I7[I7.LUMINOSITY=16]="LUMINOSITY",I7[I7.NORMAL_NPM=17]="NORMAL_NPM",I7[I7.ADD_NPM=18]="ADD_NPM",
I7[I7.SCREEN_NPM=19]="SCREEN_NPM",I7[I7.NONE=20]="NONE",I7[I7.SRC_OVER=0]="SRC_OVER",I7[I7.SRC_IN=21]="SRC_IN",I7[I7.SRC_OUT=22]="SRC_OUT",I7[I7.SRC_ATOP=23]="SRC_ATOP",I7[I7.DST_OVER=24]="DST_OVER",I7[I7.DST_IN=25]="DST_IN",I7[I7.DST_OUT=26]="DST_OUT",
I7[I7.DST_ATOP=27]="DST_ATOP",I7[I7.ERASE=26]="ERASE",I7[I7.SUBTRACT=28]="SUBTRACT",I7[I7.XOR=29]="XOR",(O7=C7=C7||{})[O7.POINTS=0]="POINTS",O7[O7.LINES=1]="LINES",O7[O7.LINE_LOOP=2]="LINE_LOOP",O7[O7.LINE_STRIP=3]="LINE_STRIP",
O7[O7.TRIANGLES=4]="TRIANGLES",O7[O7.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",O7[O7.TRIANGLE_FAN=6]="TRIANGLE_FAN",(P7=R7=R7||{})[P7.RGBA=6408]="RGBA",P7[P7.RGB=6407]="RGB",P7[P7.ALPHA=6406]="ALPHA",P7[P7.LUMINANCE=6409]="LUMINANCE",
P7[P7.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",P7[P7.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",P7[P7.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(N7=M7=M7||{})[N7.TEXTURE_2D=3553]="TEXTURE_2D",N7[N7.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",
N7[N7.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",N7[N7.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",N7[N7.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
N7[N7.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",N7[N7.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",N7[N7.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
N7[N7.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(F7=L7=L7||{})[F7.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",F7[F7.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",F7[F7.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
F7[F7.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",F7[F7.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",F7[F7.FLOAT=5126]="FLOAT",F7[F7.HALF_FLOAT=36193]="HALF_FLOAT",(U7=D7=D7||{})[U7.NEAREST=0]="NEAREST",U7[U7.LINEAR=1]="LINEAR",(
k7=B7=B7||{})[k7.CLAMP=33071]="CLAMP",k7[k7.REPEAT=10497]="REPEAT",k7[k7.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(G7=X7=X7||{})[G7.OFF=0]="OFF",G7[G7.POW2=1]="POW2",G7[G7.ON=2]="ON",(j7=V7=V7||{})[j7.NPM=0]="NPM",j7[j7.UNPACK=1]="UNPACK",
j7[j7.PMA=2]="PMA",j7[j7.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",j7[j7.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",j7[j7.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(Y7=H7=H7||{})[Y7.AUTO=0]="AUTO",Y7[Y7.MANUAL=1]="MANUAL",(W7=z7=z7||{}
).LOW="lowp",W7.MEDIUM="mediump",W7.HIGH="highp",(K7=q7=q7||{})[K7.NONE=0]="NONE",K7[K7.SCISSOR=1]="SCISSOR",K7[K7.STENCIL=2]="STENCIL",K7[K7.SPRITE=3]="SPRITE",Z7.RETINA_PREFIX=/@([0-9\.]+)x/;var J7,Q7=!(Z7.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),$7="5.2.0"
;var t9=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[S7.NORMAL_NPM]=S7.NORMAL,t[S7.ADD_NPM]=S7.ADD,t[S7.SCREEN_NPM]=S7.SCREEN,e[S7.NORMAL]=S7.NORMAL_NPM,e[S7.ADD]=S7.ADD_NPM,e[S7.SCREEN]=S7.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}()
;function e9(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var i9=0;function r9(){return++i9}function n9(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function s9(t){
return!(t&t-1||!t)}function o9(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var a9={},h9=Object.create(null),u9=Object.create(null);function l9(t,e,i){this.canvas=document.createElement(
"canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||Z7.RESOLUTION,this.resize(t,e)}var c9={width:{configurable:!0},height:{configurable:!0}};l9.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0
,this.canvas.width,this.canvas.height)},l9.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},l9.prototype.destroy=function(){this.context=null,this.canvas=null},c9.width.get=function(){
return this.canvas.width},c9.width.set=function(t){this.canvas.width=t},c9.height.get=function(){return this.canvas.height},c9.height.set=function(t){this.canvas.height=t},Object.defineProperties(l9.prototype,c9);var d9;function p9(t,e){
var i=Z7.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var f9,m9,_9={};Z7.TARGET_FPMS=.06,(m9=f9=f9||{})[m9.INTERACTION=50]="INTERACTION",m9[m9.HIGH=25]="HIGH",m9[m9.NORMAL=0]="NORMAL",m9[m9.LOW=-25]="LOW",m9[m9.UTILITY=-50]="UTILITY"
;var y9=(v9.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},v9.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),
this._destroyed&&(this.next=null),e},v9.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},v9.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,
this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},v9);function v9(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,
this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var g9=(x9.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},x9.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},x9.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},x9.prototype.add=function(t,e,i){return void 0===i&&(i=f9.NORMAL),this._addListener(new y9(t,e,i))},x9.prototype.addOnce=function(t,e,i){return void 0===i&&(i=f9.NORMAL),this._addListener(new y9(t,e,i,!0))},
x9.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},x9.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},x9.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},x9.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},x9.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},x9.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}
this.deltaMS=e,this.deltaTime=this.deltaMS*Z7.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(x9.prototype,"FPS",
{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(x9.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Z7.TARGET_FPMS
);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(x9.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(
this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(x9,"shared",{get:function(){if(!x9._shared){var t=x9._shared=new x9;t.autoStart=!0,t._protected=!0}return x9._shared},enumerable:!0,configurable:!0}),
Object.defineProperty(x9,"system",{get:function(){if(!x9._system){var t=x9._system=new x9;t.autoStart=!0,t._protected=!0}return x9._system},enumerable:!0,configurable:!0}),x9);function x9(){var e=this;this._head=new y9(null,null,1/0),this._requestId=null,
this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Z7.TARGET_FPMS,this.elapsedMS=1/Z7.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){
e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}b9.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{
set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,f9.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?g9.shared:new g9,t.autoStart&&this.start()},b9.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function b9(){}var T9=(E9.prototype.clone=function(){return new E9(this.x,this.y)},
E9.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},E9.prototype.copyTo=function(t){return t.set(this.x,this.y),t},E9.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},E9.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},E9);function E9(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var w9=(A9.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new A9(t,e,this._x,this._y)},
A9.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},A9.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},A9.prototype.copyTo=function(t){return t.set(this._x,this._y),t},A9.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(A9.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(
this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(A9.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),A9);function A9(
t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var S9,I9,C9=2*Math.PI,O9=180/Math.PI,R9=Math.PI/180;(I9=S9=S9||{})[I9.POLY=0]="POLY",I9[I9.RECT=1]="RECT",I9[I9.CIRC=2]="CIRC",I9[I9.ELIP=3]="ELIP",
I9[I9.RREC=4]="RREC";var P9=(M9.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},M9.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},
M9.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,
i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},M9.prototype.apply=function(t,e){e=e||new T9;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},M9.prototype.applyInverse=function(t,e){e=e||new T9;var i=1/(
this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},M9.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},
M9.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},M9.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,
this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},M9.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,
this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},M9.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),
this.ty=e-(i*this.b+r*this.d),this},M9.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}
return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},M9.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(C9-a)<1e-5?(t.rotation=o,
t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},M9.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i
;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},M9.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},M9.prototype.clone=function(){
var t=new M9;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},M9.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},M9.prototype.copyFrom=function(t){
return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(M9,"IDENTITY",{get:function(){return new M9},enumerable:!0,configurable:!0}),Object.defineProperty(M9,"TEMP_MATRIX",{get:function(){return new M9},
enumerable:!0,configurable:!0}),M9);function M9(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var N9=[1,1,0,
-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],L9=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],F9=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],D9=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],U9=[],B9=[],k9=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];U9.push(e);for(
var i=0;i<16;i++)for(var r=k9(N9[t]*N9[i]+F9[t]*L9[i]),n=k9(L9[t]*N9[i]+D9[t]*L9[i]),s=k9(N9[t]*F9[i]+F9[t]*D9[i]),o=k9(L9[t]*F9[i]+D9[t]*D9[i]),a=0;a<16;a++)if(N9[a]===r&&L9[a]===n&&F9[a]===s&&D9[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new P9
;h.set(N9[t],L9[t],F9[t],D9[t],0,0),B9.push(h)}}();var X9={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return N9[t]},uY:function(t){return L9[t]},vX:function(t){
return F9[t]},vY:function(t){return D9[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return U9[t][e]},sub:function(t,e){return U9[t][X9.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t
,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?X9.S:X9.N:2*Math.abs(e)<=Math.abs(t)?0<t?X9.E:X9.W:0<e?0<t?X9.SE:X9.SW:0<t?X9.NE:X9.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=B9[X9.inv(e)];n.tx=i,n.ty=r,t.append(n)}
},G9=(V9.prototype.onChange=function(){this._localID++},V9.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},V9.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},V9.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},V9.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(V9.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),V9.IDENTITY=new V9,V9);function V9(){this.worldTransform=new P9,this.localTransform=new P9,this.position=new w9(this.onChange,
this,0,0),this.scale=new w9(this.onChange,this,1,1),this.pivot=new w9(this.onChange,this,0,0),this.skew=new w9(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var j9=(Object.defineProperty(H9.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(H9.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),
Object.defineProperty(H9.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(H9.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(H9,"EMPTY"
,{get:function(){return new H9(0,0,0,0)},enumerable:!0,configurable:!0}),H9.prototype.clone=function(){return new H9(this.x,this.y,this.width,this.height)},H9.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,
this.height=t.height,this},H9.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},H9.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},H9.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},H9.prototype.fit=function(t){var e=Math.max(this.x,t.x
),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},H9.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
H9.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},H9);function H9(t,e,i,r
){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=S9.RECT}Y9.prototype.clone=function(){return new Y9(this.x,this.y,this.radius)},
Y9.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},Y9.prototype.getBounds=function(){return new j9(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}
;function Y9(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=S9.CIRC}z9.prototype.clone=function(){return new z9(this.x,this.y,this.width,this.height)},z9.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},z9.prototype.getBounds=function(){return new j9(this.x-this.width,this.y-this.height,this.width,this.height)};function z9(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=S9.ELIP}W9.prototype.clone=function(){var t=new W9(this.points.slice());return t.closeStroke=this.closeStroke,t},
W9.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function W9(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof T9){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=S9.POLY,this.closeStroke=!0}
q9.prototype.clone=function(){return new q9(this.x,this.y,this.width,this.height,this.radius)},q9.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function q9(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=S9.RREC}Z7.SORTABLE_CHILDREN=!1;function K9(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}K9.prototype.isEmpty=function(
){return this.minX>this.maxX||this.minY>this.maxY},K9.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},K9.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?j9.EMPTY:((
t=t||new j9(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},K9.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),
this.maxY=Math.max(this.maxY,t.y)},K9.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5]
)<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},K9.prototype.addFrame=function(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)},
K9.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p
,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},K9.prototype.addVertexData=function(t,e,i){for(var r=this.minX,
n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},K9.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},
K9.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,
g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},K9.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,
this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},K9.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,
a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},K9.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},K9.prototype.addBoundsArea=function(t,e){
var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},K9.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},K9.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,
this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var Z9=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new G9,this.alpha=1,this.visible=!0,this.renderable=!0,
this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new K9,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,
this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{
configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(
t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){
return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,
this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(
this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new j9),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,
i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new j9),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},
n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),
this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,
this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container")
;return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),
this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),
this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){
return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},
e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},
e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){
this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*O9},e.angle.set=function(t){this.transform.rotation=t*R9
},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){
return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(
n.prototype,e),n}(X.a);function J9(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Z9.prototype.displayObjectUpdateTransform=Z9.prototype.updateTransform;var Q9=function(n){function t(){n.call(this),this.children=[]
,this.sortableChildren=Z7.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},
t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,
this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(
t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit(
"added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},
t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error(
"The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);e9(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error(
"getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null
;t.parent=null,t.transform._parentID=-1,e9(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null
,e.transform._parentID=-1,e9(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,
n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a
)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1
,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(J9),this.sortDirty=!1},t.prototype.updateTransform=function(){
this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t]
;i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){
var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},
t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,
i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++
)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),
i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1
;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){
var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},
Object.defineProperties(t.prototype,e),t}(Z9);Q9.prototype.containerUpdateTransform=Q9.prototype.updateTransform;function $9(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new x7(
"setRealSize",2),this.onUpdate=new x7("update"),this.onError=new x7("onError",1)}var ttt={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};$9.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t)
,(this._width||this._height)&&this.onResize.run(this._width,this._height)},$9.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},$9.prototype.resize=function(t,e){t===this._width&&e===this._height||(
this._width=t,this._height=e,this.onResize.run(t,e))},ttt.valid.get=function(){return!!this._width&&!!this._height},$9.prototype.update=function(){this.destroyed||this.onUpdate.run()},$9.prototype.load=function(){return Promise.resolve()},
ttt.width.get=function(){return this._width},ttt.height.get=function(){return this._height},$9.prototype.upload=function(t,e,i){return!1},$9.prototype.style=function(t,e,i){return!1},$9.prototype.dispose=function(){},$9.prototype.destroy=function(){
this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties($9.prototype,ttt);var ett=function(r){
function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t
).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(d9=d9||document.createElement("a")).href=t;var i=!(t=H.a.parse(d9.href)
).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight
;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===V7.UNPACK),this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)
):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,
e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}($9),itt=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){
var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(
void 0!==e.createBitmap?e.createBitmap:Z7.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,
this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(
t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),
this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{
premultiplyAlpha:this.premultiplyAlpha===V7.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t
,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),
!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,
this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(ett),rtt=[];function ntt(t,e){if(!t)return null;var i="";if("string"==typeof t){
var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=rtt.length-1;0<=n;--n){var s=rtt[n];if(s.test&&s.test(t,i))return new s(t,e)}return new itt(t,e)}var stt=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n
)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(
r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===V7.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width
,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}($9),ott={scaleMode:D7.NEAREST,format:R7.RGBA,
alphaMode:V7.NPM},att=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,
d=e.resolution,p=e.resourceOptions;!t||t instanceof $9||((t=ntt(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||Z7.RESOLUTION,this.mipmap=void 0!==r?r:Z7.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:Z7.ANISOTROPIC_LEVEL,
this.wrapMode=h||Z7.WRAP_MODE,this.scaleMode=void 0!==s?s:Z7.SCALE_MODE,this.format=u||R7.RGBA,this.type=l||L7.UNSIGNED_BYTE,this.target=c||M7.TEXTURE_2D,this.alphaMode=void 0!==i?i:V7.UNPACK,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.uid=r9(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,
this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}}
;return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(
this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},
o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=s9(this.realWidth
)&&s9(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),
this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete u9[this.cacheId],delete h9[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},
o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=Z7.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+r9()),t._pixiId);var s=u9[n];if(r&&i&&!s)throw new Error(
'The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new stt(t,{width:e,height:i}),
s=t instanceof Float32Array?L7.FLOAT:L7.UNSIGNED_BYTE;return new o(n,Object.assign(ott,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),u9[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),u9[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=u9[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete u9[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete u9[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);att._globalBatch=0;var htt=function(a){function t(t,e
){var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new att;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(ntt(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=M7.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}($9),
utt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(ett),
ltt=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=M7.TEXTURE_CUBE_MAP_POSITIVE_X+i
;!1!==e.autoLoad&&this.load()}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=M7.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(
var r=this.itemDirtyIds,n=0;n<o.SIDES;n++){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(htt);ltt.SIDES=6;var ctt=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),
this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((
r.prototype=Object.create(i&&i.prototype)).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(
!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,
this.svg,this._crossorigin),o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them."
);var i=t*s.scale,r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+r9(),
n.getContext("2d").drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(ett)
;ctt.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var dtt=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=g9.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(g9.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(g9.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&g9.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(g9.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(g9.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(ett);dtt.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var ptt=function(t){function e(){t.apply(
this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(ett);rtt.push(itt,ptt,utt,dtt,ctt,stt,ltt,htt);function ftt(t){
this.renderer=t}ftt.prototype.destroy=function(){this.renderer=null};function mtt(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,
this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new x7("disposeFramebuffer",2)}var _tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e
).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===V7.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width
,i.height=e.height,r.texImage2D(e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(stt),ytt={colorTexture:{configurable:!0}};ytt.colorTexture.get=function(){return this.colorTextures[0]},
mtt.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new att(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},
mtt.prototype.addDepthTexture=function(t){return this.depthTexture=t||new att(new _tt(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:R7.DEPTH_COMPONENT,type:L7.UNSIGNED_SHORT}),
this.dirtyId++,this.dirtyFormat++,this},mtt.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},mtt.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},
mtt.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution
;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},mtt.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(mtt.prototype,ytt);function vtt(){this.x0=0,
this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}var gtt=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]})
;n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new mtt(this.width*this.resolution,
this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),
this.framebuffer.resize(t*this.resolution,e*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(att)
;vtt.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=X9.add(i,X9.NW),this.x0=a+s*X9.uX(i),this.y0=h+o*X9.uY(i),i=X9.add(i,2),this.x1=a+s*X9.uX(i),this.y1=h+o*X9.uY(i),i=X9.add(i,2),
this.x2=a+s*X9.uX(i),this.y2=h+o*X9.uY(i),i=X9.add(i,2),this.x3=a+s*X9.uX(i),this.y3=h+o*X9.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height
)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var xtt=new vtt,btt=function(o){
function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new j9(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=xtt,this.uvMatrix=null,
this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new T9(s.x,s.y):new T9(0,0),this._updateID=0,
this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={resolution:{
configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){
this.baseTexture.resource&&this.baseTexture.resource.update()},a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()
}else this.frame=this._frame;this.emit("update",this)},a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&h9[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",
this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,
this.orig,this.trim,this.rotate,this.defaultAnchor)},a.prototype.updateUvs=function(){this._uvs===xtt&&(this._uvs=new vtt),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(
i=Z7.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+r9()),t._pixiId);var s=h9[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(e.resolution=p9(t))
,(s=new a(new att(t,e))).baseTexture.cacheId=n,att.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(att.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new itt(t);r.url=e;var n=new a(new att(r,{
scaleMode:Z7.SCALE_MODE,resolution:p9(e)}));return i=i||e,att.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(att.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e
)&&t.textureCacheIds.push(e),h9[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),h9[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=h9[t];if(e){var i=e.textureCacheIds.indexOf(t)
;return-1<i&&e.textureCacheIds.splice(i,1),delete h9[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)h9[t.textureCacheIds[r]]===t&&delete h9[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},
t.resolution.get=function(){return this.baseTexture.resolution},t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,
o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error(
"Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},
t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function Ttt(t){t.destroy=function(){},
t.on=function(){},t.once=function(){},t.emit=function(){}}btt.EMPTY=new btt(new att),Ttt(btt.EMPTY),Ttt(btt.EMPTY.baseTexture),btt.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d")
;return e.fillStyle="white",e.fillRect(0,0,16,16),new btt(new att(new utt(t)))}(),Ttt(btt.WHITE),Ttt(btt.WHITE.baseTexture);function Ett(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}
var wtt=function(a){function n(t,e){var i=null;if(!(t instanceof gtt)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn("Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,
t=new gtt({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n
).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},
n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new gtt(t))},n
}(btt);Ett.prototype.createTexture=function(t,e){var i=new gtt(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new wtt(i)},Ett.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=Ett.SCREEN_KEY;t*=i,e*=i,
this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=n9(t)))<<16|65535&(e=n9(e))),this.texturePool[r]||(this.texturePool[r]=[]);var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,
n.setResolution(i),n},Ett.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},Ett.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,
this.texturePool[e].push(t)},Ett.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Ett.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}
this.texturePool={}},Ett.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Ett.SCREEN_KEY,i=this.texturePool[e];if(this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++
)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Ett.SCREEN_KEY="screen";function Att(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,
this.stride=n,this.start=s,this.instance=o}Att.prototype.destroy=function(){this.buffer=null},Att.from=function(t,e,i,r,n){return new Att(t,e,i,r,n)};function Stt(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),
this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=Itt++,this.disposeRunner=new x7("disposeBuffer",2)}var Itt=0;function Ctt(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Stt.prototype.update=function(t){this.data=t||this.data,this._updateID++},Stt.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Stt.prototype.destroy=function(){this.dispose(),this.data=null},Stt.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Stt(t)};var Ott={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Rtt(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Mtt++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new x7("disposeGeometry",2),this.refCount=0}var Ptt={5126:4,5123:2,5121:1},Mtt=0,Ntt={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};Rtt.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Stt(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Att(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},Rtt.prototype.getAttribute=function(t){return this.attributes[t]},Rtt.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},Rtt.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Stt(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
Rtt.prototype.getIndex=function(){return this.indexBuffer},Rtt.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Stt;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Ptt[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Ctt(c
);n[d]||(n[d]=new Ott[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Rtt.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Rtt.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},Rtt.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Rtt.prototype.clone=function(){for(var t=new Rtt,e=0;e<this.buffers.length;e++)t.buffers[e]=new Stt(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new Att(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},Rtt.merge=function(t){for(var e,i=new Rtt,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(Ntt[Ctt(e.buffers[h].data)])(n[h]),i.buffers[h]=new Stt(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Ptt[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function Ltt(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=Utt++,this.static=!!e}var Ftt=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Rtt)
,Dtt=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Stt(this.vertices),this.uvBuffer=new Stt(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Rtt),Utt=0
;Ltt.prototype.update=function(){this.dirtyId++},Ltt.prototype.add=function(t,e,i){this.uniforms[t]=new Ltt(e,i)},Ltt.from=function(t,e){return new Ltt(t,e)};function Btt(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new j9,this.destinationFrame=new j9,this.filters=[]}Btt.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function ktt(t){this.renderer=t}var Xtt=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new Ett,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Ftt,this.quadUv=new Dtt,this.tempRect=new j9,this.activeState={},this.globalUniforms=new Ltt({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Btt,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(C7.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(C7.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
P9.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(ftt);ktt.prototype.flush=function(){},ktt.prototype.destroy=function(){this.renderer=null},ktt.prototype.start=function(){},ktt.prototype.stop=function(){this.flush()},ktt.prototype.render=function(t){};var Gtt=function(e){
function t(t){e.call(this,t),this.emptyRenderer=new ktt(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(ftt);Z7.PREFER_ENV=u.a.any?T7.WEBGL:T7.WEBGL2,
Z7.STRICT_TEXTURE_CACHE=!1;function Vtt(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function jtt(t){this.type=q7.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,
this._scissorCounter=0,this._scissorRect=null,this._target=null}var Htt=0,Ytt=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),
this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(
t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,
this.renderer.CONTEXT_UID=Htt++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,
this.renderer.CONTEXT_UID=Htt++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(
Z7.PREFER_ENV>=T7.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error(
"This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension(
"WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension(
"WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension(
"OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension(
"EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){t.preventDefault()},
t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener(
"webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(ftt),ztt=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new mtt(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new j9,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Z7.PREFER_ENV===T7.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new j9},Object.defineProperties(t.prototype,i),t}(ftt),Wtt={5126:4,5123:2,5121:1},
qtt=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e)
,((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;Z7.PREFER_ENV===T7.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Wtt[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Wtt[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Wtt[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new Vtt(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,
e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(ftt);function Ktt(t,e,i,r){var n=Ztt(t,t.VERTEX_SHADER,e),s=Ztt(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Ztt(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function Jtt(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Qtt(2*e)
;case"bvec3":return Qtt(3*e);case"bvec4":return Qtt(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Qtt(t
){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}jtt.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=q7.NONE,this.autoDetect=!0),this._target=null},jtt.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var $tt,tet={},eet=tet;function iet(){if(
eet===tet||eet&&eet.isContextLost()){var t,e=document.createElement("canvas");Z7.PREFER_ENV>=T7.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),
eet=t}return eet}function ret(t,e,i){if("precision"===t.substring(0,9))return i!==z7.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===z7.HIGH&&i!==z7.HIGH&&(r=z7.MEDIUM),
"precision "+r+" float;\n"+t}var net={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var set=null,oet={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",
INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",
SAMPLER_2D_ARRAY:"sampler2DArray"};function aet(t,e){if(!set){var i=Object.keys(oet);set={};for(var r=0;r<i.length;++r){var n=i[r];set[t[n]]=oet[n]}}return set[e]}var het={
float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},uet={
float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",
mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",
bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var cet,det=["precision mediump float;","void main(void){",
"float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function pet(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function fet(t,e,i){void 0===i&&(i="pixi-shader"),this.id=met++,
this.vertexSrc=t||fet.defaultVertexSrc,this.fragmentSrc=e||fet.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),_et[i]?(_et[i]++,
i+="-"+_et[i]):_et[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=ret(this.vertexSrc,Z7.PRECISION_VERTEX,z7.HIGH),this.fragmentSrc=ret(this.fragmentSrc,
Z7.PRECISION_FRAGMENT,function(){if(!$tt){$tt=z7.MEDIUM;var t=iet();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);$tt=e.precision?z7.HIGH:z7.MEDIUM}}return $tt}())),this.extractData(this.vertexSrc,
this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}var met=0,_et={},yet={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};fet.prototype.extractData=function(t,e){var i=iet();if(i){var r=Ktt(i,t,e)
;this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},fet.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,
e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){var a=e.getActiveAttrib(t,o),h=aet(e,a.type),u={type:h,name:a.name,size:(i=h,net[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
fet.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=aet(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:Jtt(h,s.size)}}return i},yet.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},yet.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},fet.from=function(t,e,i){var r=t+e,n=a9[r];return n||(
a9[r]=n=new fet(t,e,i)),n},Object.defineProperties(fet,yet);function vet(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof Ltt?e:new Ltt(e):new Ltt({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(
this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))}var get={uniforms:{configurable:!0}};vet.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(
r.group&&this.checkUniformExists(t,r))return!0}return!1},vet.prototype.destroy=function(){this.uniformGroup=null},get.uniforms.get=function(){return this.uniformGroup.uniforms},vet.from=function(t,e,i){var r=fet.from(t,e);return new vet(r,i)},
Object.defineProperties(vet.prototype,get);function xet(){this.data=0,this.blendMode=S7.NORMAL,this.polygonOffset=0,this.blend=!0}var bet={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},
clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};bet.blend.get=function(){return!!(1&this.data)},bet.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},bet.offsets.get=function(){return!!(
2&this.data)},bet.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},bet.culling.get=function(){return!!(4&this.data)},bet.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},bet.depthTest.get=function(){return!!(8&this.data)},
bet.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},bet.clockwiseFrontFace.get=function(){return!!(16&this.data)},bet.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},bet.blendMode.get=function(){
return this._blendMode},bet.blendMode.set=function(t){this.blend=t!==S7.NONE,this._blendMode=t},bet.polygonOffset.get=function(){return this._polygonOffset},bet.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},xet.for2d=function(){
var t=new xet;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(xet.prototype,bet);var Tet=function(n){function s(t,e,i){var r=fet.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,
this.resolution=Z7.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new xet}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},
defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){
this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(vet);Tet.SOURCE_KEY_MAP={};function Eet(t,e){this._texture=t,this.mapCoord=new P9,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var wet=new P9,Aet={texture:{configurable:!0}};Aet.texture.get=function(){return this._texture},Aet.texture.set=function(t){this._texture=t,this._updateID=-1},Eet.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,
r=0;r<t.length;r+=2){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},Eet.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID
;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(wet.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(wet));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(Eet.prototype,Aet);function Set(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Iet=function(
i){function t(t){var e=new P9;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new Eet(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(Tet),Cet=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new jtt;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case q7.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case q7.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case q7.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case q7.SCISSOR:this.renderer.scissor.pop();break;case q7.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case q7.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e
)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=q7.SPRITE;else if(t.type=q7.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI
)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=q7.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(
this.alphaMaskPool[this.alphaMaskIndex]=[new Iet(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,this.alphaMaskIndex++},
t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(ftt),Oet=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)
).constructor=t).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(
e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(ftt),Ret=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(Oet),Pet=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),
i.enable(i.STENCIL_TEST)),t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()
},t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Oet),Met=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new P9,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(ftt),Net=new j9,Let=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new j9,this.destinationFrame=new j9}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(Net.width=s.realWidth,Net.height=s.realHeight,i=Net),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
Net.width=n.width,Net.height=n.height,i=Net),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(ftt)
;Set.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Fet=0,Det=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Fet++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof cet)return cet;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;"
);cet=!0===t({a:"b"},"a","b")}catch(t){cet=!1}return cet}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?het:uet)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=Ktt(e,i.vertexSrc,i.fragmentSrc,r)
,o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Jtt(h.type,h.size)}}var u=new Set(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,
this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(ftt);function Uet(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}
var Bet=function(e){function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=S7.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,
this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new xet,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i
).prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[S7.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.ADD]=[t.ONE,t.ONE],e[S7.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[S7.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[S7.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.HUE]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[S7.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.NONE]=[0,0],e[S7.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA
],e[S7.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[S7.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[S7.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[S7.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[S7.SRC_ATOP]=[t.DST_ALPHA,
t.ONE_MINUS_SRC_ALPHA],e[S7.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[S7.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[S7.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[S7.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[S7.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],
e[S7.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;
)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(
t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t);this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){
this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](
this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]
):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){
this.gl.polygonOffset(t,e)},i.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t)
;e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(ftt),ket=function(e){function t(t){e.call(this,t),
this.count=0,this.checkCount=0,this.maxIdle=Z7.GC_MAX_IDLE,this.checkCountMax=Z7.GC_MAX_CHECK_COUNT,this.mode=Z7.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){
this.renderer.renderingToScreen&&(this.count++,this.mode!==H7.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,
r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){
var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(ftt),Xet=function(e){function t(t){e.call(this,t),this.boundTextures=[],
this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new att}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null
;this.emptyTextures={};var r=new Uet(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,
this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Uet(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null)
;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0)
;var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(
i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(
this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(
var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++
)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},
t.prototype.initTexture=function(t){var e=new Uet(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(
e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===L7.HALF_FLOAT&&(e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(
e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(
e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e
){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){
var r=this.managedTextures.indexOf(t);-1!==r&&e9(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==X7.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,
2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=B7.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(
e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,
t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===D7.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT
));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},t}(ftt),Get=new P9;X.a
;function Vet(){this.texArray=null,this.blend=0,this.type=C7.TRIANGLES,this.start=0,this.size=0,this.data=null}function jet(){this.elements=[],this.ids=[],this.count=0}jet.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null
;this.count=0};function Het(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var Yet={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{
configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Yet.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Yet.uint8View.get=function(){return this._uint8View||(
this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Yet.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Yet.uint16View.get=function(){return this._uint16View||(
this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Yet.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Het.prototype.view=function(t){return this[t+"View"]},
Het.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Het.sizeOf=function(t){switch(t){case"int8":
case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Het.prototype,Yet);var zet=function(e){function _(t){e.call(this,t),
this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=xet.for2d(),this.size=4*Z7.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,
this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,
this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;Z7.PREFER_ENV===T7.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Z7.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=det.replace(/%forloop%/gi,pet(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}
return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},
_.prototype.initFlushBuffers=function(){for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Vet);for(;e.length<r;)e.push(new jet);for(var n=0;n<this.MAX_TEXTURES;n++
)this._tempBoundTextures[n]=null},_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,
this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,
i=_._textureArrayPool,r=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++att._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(
r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null
;att._globalBatch=o},_.prototype.buildDrawCalls=function(t,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,
c.texArray=t;for(var d=e;d<i;++d){var p=r[d],f=p._texture.baseTexture,m=t9[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o,
l+=p.indices.length,c.blend=m}e<i&&(c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null
;t.count=0},_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;Z7.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Z7.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=n9(Math.ceil(t/8)),i=o9(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Het(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=n9(Math.ceil(t/12)),i=o9(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(ktt);zet._drawCallPool=[],zet._textureArrayPool=[]
;function Wet(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}Wet.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=Ltt.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new fet(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new P9,default:this.defaultGroupCache[t]};return new vet(this.programCache[t],n)},
Wet.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function qet(){}var Ket=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Stt(null,t,!1),this._indexBuffer=new Stt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,L7.FLOAT).addAttribute("aTextureCoord",
this._buffer,2,!1,L7.FLOAT).addAttribute("aColor",this._buffer,4,!0,L7.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,L7.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(
Rtt),
Zet="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,Jet="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Qet={defaultVertexSrc:{configurable:!0
},defaultFragmentTemplate:{configurable:!0}};qet.create=function(t){var e=Object.assign({vertex:Zet,fragment:Jet,geometryClass:Ket,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new Wet(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(zet)},Qet.defaultVertexSrc.get=function(){return Zet},Qet.defaultFragmentTemplate.get=function(){
return Jet},Object.defineProperties(qet,Qet);qet.create();var $et=new P9;Z9.prototype._cacheAsBitmap=!1,Z9.prototype._cacheData=!1;function tit(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,
this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null}Object.defineProperties(
Z9.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&((this._cacheAsBitmap=t)?(this._cacheData||(this._cacheData=new tit),(e=this._cacheData).originalRender=this.render,
e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,
e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),
this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,
this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),Z9.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),
this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},Z9.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){
var e=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds().clone();if(this.filters){var r=this.filters[0].padding;i.pad(r)}i.ceil(Z7.RESOLUTION);var n=t.renderTexture.current,s=t.renderTexture.sourceFrame,o=t.projection.transform,
a=wtt.create(i.width,i.height),h="cacheAsBitmap_"+r9();this._cacheData.textureCacheId=h,att.addToCache(a.baseTexture,h),btt.addToCache(a,h);var u=$et;u.tx=-i.x,u.ty=-i.y,this.transform.worldTransform.identity(),this.render=this._cacheData.originalRender,
t.render(this,a,!0,u,!0),t.projection.transform=o,t.renderTexture.bind(n,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,
this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var l=new ry(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-i.x/i.width,l.anchor.y=-i.y/i.height,l.alpha=e,l._bounds=this._bounds,
this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},
Z9.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},
Z9.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),i=this.alpha;this.alpha=1;var r=t.context;e.ceil(Z7.RESOLUTION);var n=wtt.create(e.width,e.height),s="cacheAsBitmap_"+r9()
;this._cacheData.textureCacheId=s,att.addToCache(n.baseTexture,s),btt.addToCache(n,s);var o=$et;this.transform.localTransform.copyTo(o),o.invert(),o.tx-=e.x,o.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,n,!0,o,!1),
t.context=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null
;var a=new ry(n);a.transform.worldTransform=this.transform.worldTransform,a.anchor.x=-e.x/e.width,a.anchor.y=-e.y/e.height,a.alpha=i,a._bounds=this._bounds,this._cacheData.sprite=a,this.transform._parentID=-1,this.parent?this.updateTransform():(
this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=a.containsPoint.bind(a)}},Z9.prototype._calculateCachedBounds=function(){this._bounds.clear(),
this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID},Z9.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},
Z9.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,att.removeFromCache(this._cacheData.textureCacheId),btt.removeFromCache(this._cacheData.textureCacheId),
this._cacheData.textureCacheId=null},Z9.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};var eit={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(
u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}
return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,
GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},iit=(rit.prototype.clone=function(){
return new rit(this.x,this.y)},rit.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},rit.prototype.copyTo=function(t){return t.set(this.x,this.y),t},rit.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},
rit.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e},rit);function rit(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var nit=(sit.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(
e=this.scope),new sit(t,e,this._x,this._y)},sit.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},sit.prototype.copyFrom=function(t){
return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},sit.prototype.copyTo=function(t){return t.set(this._x,this._y),t},sit.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(
sit.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(sit.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(
this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),sit);function sit(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var oit,ait,hit=2*Math.PI,uit=180/Math.PI,lit=Math.PI/180;(ait=oit=oit||{}
)[ait.POLY=0]="POLY",ait[ait.RECT=1]="RECT",ait[ait.CIRC=2]="CIRC",ait[ait.ELIP=3]="ELIP",ait[ait.RREC=4]="RREC";var cit=(dit.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},
dit.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},dit.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,
i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},dit.prototype.apply=function(t,e){e=e||new iit;var i=t.x,r=t.y
;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},dit.prototype.applyInverse=function(t,e){e=e||new iit;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,
e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},dit.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},dit.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},
dit.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},
dit.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},
dit.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},dit.prototype.prepend=function(t){
var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},
dit.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(hit-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),
t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},dit.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,
this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},dit.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},dit.prototype.clone=function(){var t=new dit;return t.a=this.a,t.b=this.b,t.c=this.c,
t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},dit.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},dit.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,
this.ty=t.ty,this},Object.defineProperty(dit,"IDENTITY",{get:function(){return new dit},enumerable:!0,configurable:!0}),Object.defineProperty(dit,"TEMP_MATRIX",{get:function(){return new dit},enumerable:!0,configurable:!0}),dit);function dit(t,e,i,r,n,s){
void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var pit=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],fit=[0,1,1,1,0,-1,-1,-1,0,1
,1,1,0,-1,-1,-1],mit=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],_it=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],yit=[],vit=[],git=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];yit.push(e);for(var i=0;i<16;i++)for(var r=git(pit[t]*pit[i]+mit[t]*fit[i]),
n=git(fit[t]*pit[i]+_it[t]*fit[i]),s=git(pit[t]*mit[i]+mit[t]*_it[i]),o=git(fit[t]*mit[i]+_it[t]*_it[i]),a=0;a<16;a++)if(pit[a]===r&&fit[a]===n&&mit[a]===s&&_it[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new cit;h.set(pit[t],fit[t],mit[t],_it[t],0,0
),vit.push(h)}}();var xit=(bit.prototype.onChange=function(){this._localID++},bit.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),
this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},bit.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},bit.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},bit.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(bit.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),bit.IDENTITY=new bit,bit);function bit(){this.worldTransform=new cit,this.localTransform=new cit,this.position=new nit(
this.onChange,this,0,0),this.scale=new nit(this.onChange,this,1,1),this.pivot=new nit(this.onChange,this,0,0),this.skew=new nit(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,
this._worldID=0,this._parentID=0}var Tit=(Object.defineProperty(Eit.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Eit.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,
configurable:!0}),Object.defineProperty(Eit.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Eit.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),
Object.defineProperty(Eit,"EMPTY",{get:function(){return new Eit(0,0,0,0)},enumerable:!0,configurable:!0}),Eit.prototype.clone=function(){return new Eit(this.x,this.y,this.width,this.height)},Eit.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y
,this.width=t.width,this.height=t.height,this},Eit.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},Eit.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},Eit.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},Eit.prototype.fit=function(t){var e=Math.max(this.x,
t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},Eit.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
Eit.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},Eit);function Eit(t,e,i
,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=oit.RECT}wit.prototype.clone=function(){return new wit(this.x,this.y,this.radius)},
wit.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},wit.prototype.getBounds=function(){return new Tit(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius
)};function wit(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=oit.CIRC}Ait.prototype.clone=function(){return new Ait(this.x,this.y,this.width,this.height)},Ait.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},Ait.prototype.getBounds=function(){return new Tit(this.x-this.width,this.y-this.height,this.width,this.height)};function Ait(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=oit.ELIP}Sit.prototype.clone=function(){var t=new Sit(this.points.slice());return t.closeStroke=this.closeStroke,t},
Sit.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function Sit(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof iit){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=oit.POLY,this.closeStroke=!0}var Iit,Cit,Oit,Rit,Pit,
Mit,Nit,Lit,Fit,Dit,Uit,Bit,kit,Xit,Git,Vit,jit,Hit,Yit,zit,Wit,qit,Kit,Zit,Jit,Qit,$it,trt;ert.prototype.clone=function(){return new ert(this.x,this.y,this.width,this.height,this.radius)},ert.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(
this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n
)return!0}return!1};function ert(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=oit.RREC}(Cit=Iit=Iit||{}
)[Cit.WEBGL_LEGACY=0]="WEBGL_LEGACY",Cit[Cit.WEBGL=1]="WEBGL",Cit[Cit.WEBGL2=2]="WEBGL2",(Rit=Oit=Oit||{})[Rit.UNKNOWN=0]="UNKNOWN",Rit[Rit.WEBGL=1]="WEBGL",Rit[Rit.CANVAS=2]="CANVAS",(Mit=Pit=Pit||{})[Mit.NORMAL=0]="NORMAL",Mit[Mit.ADD=1]="ADD",
Mit[Mit.MULTIPLY=2]="MULTIPLY",Mit[Mit.SCREEN=3]="SCREEN",Mit[Mit.OVERLAY=4]="OVERLAY",Mit[Mit.DARKEN=5]="DARKEN",Mit[Mit.LIGHTEN=6]="LIGHTEN",Mit[Mit.COLOR_DODGE=7]="COLOR_DODGE",Mit[Mit.COLOR_BURN=8]="COLOR_BURN",Mit[Mit.HARD_LIGHT=9]="HARD_LIGHT",
Mit[Mit.SOFT_LIGHT=10]="SOFT_LIGHT",Mit[Mit.DIFFERENCE=11]="DIFFERENCE",Mit[Mit.EXCLUSION=12]="EXCLUSION",Mit[Mit.HUE=13]="HUE",Mit[Mit.SATURATION=14]="SATURATION",Mit[Mit.COLOR=15]="COLOR",Mit[Mit.LUMINOSITY=16]="LUMINOSITY",
Mit[Mit.NORMAL_NPM=17]="NORMAL_NPM",Mit[Mit.ADD_NPM=18]="ADD_NPM",Mit[Mit.SCREEN_NPM=19]="SCREEN_NPM",Mit[Mit.NONE=20]="NONE",Mit[Mit.SRC_OVER=0]="SRC_OVER",Mit[Mit.SRC_IN=21]="SRC_IN",Mit[Mit.SRC_OUT=22]="SRC_OUT",Mit[Mit.SRC_ATOP=23]="SRC_ATOP",
Mit[Mit.DST_OVER=24]="DST_OVER",Mit[Mit.DST_IN=25]="DST_IN",Mit[Mit.DST_OUT=26]="DST_OUT",Mit[Mit.DST_ATOP=27]="DST_ATOP",Mit[Mit.ERASE=26]="ERASE",Mit[Mit.SUBTRACT=28]="SUBTRACT",Mit[Mit.XOR=29]="XOR",(Lit=Nit=Nit||{})[Lit.POINTS=0]="POINTS",
Lit[Lit.LINES=1]="LINES",Lit[Lit.LINE_LOOP=2]="LINE_LOOP",Lit[Lit.LINE_STRIP=3]="LINE_STRIP",Lit[Lit.TRIANGLES=4]="TRIANGLES",Lit[Lit.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Lit[Lit.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Dit=Fit=Fit||{})[Dit.RGBA=6408]="RGBA",
Dit[Dit.RGB=6407]="RGB",Dit[Dit.ALPHA=6406]="ALPHA",Dit[Dit.LUMINANCE=6409]="LUMINANCE",Dit[Dit.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Dit[Dit.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Dit[Dit.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(Bit=Uit=Uit||{}
)[Bit.TEXTURE_2D=3553]="TEXTURE_2D",Bit[Bit.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",Bit[Bit.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Bit[Bit.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",
Bit[Bit.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",Bit[Bit.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Bit[Bit.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",
Bit[Bit.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",Bit[Bit.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(Xit=kit=kit||{})[Xit.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",Xit[Xit.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",
Xit[Xit.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",Xit[Xit.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",Xit[Xit.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",Xit[Xit.FLOAT=5126]="FLOAT",Xit[Xit.HALF_FLOAT=36193]="HALF_FLOAT",(
Vit=Git=Git||{})[Vit.NEAREST=0]="NEAREST",Vit[Vit.LINEAR=1]="LINEAR",(Hit=jit=jit||{})[Hit.CLAMP=33071]="CLAMP",Hit[Hit.REPEAT=10497]="REPEAT",Hit[Hit.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(zit=Yit=Yit||{})[zit.OFF=0]="OFF",zit[zit.POW2=1]="POW2",
zit[zit.ON=2]="ON",(qit=Wit=Wit||{})[qit.NPM=0]="NPM",qit[qit.UNPACK=1]="UNPACK",qit[qit.PMA=2]="PMA",qit[qit.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",qit[qit.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",
qit[qit.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(Zit=Kit=Kit||{})[Zit.AUTO=0]="AUTO",Zit[Zit.MANUAL=1]="MANUAL",(Qit=Jit=Jit||{}).LOW="lowp",Qit.MEDIUM="mediump",Qit.HIGH="highp",(trt=$it=$it||{})[trt.NONE=0]="NONE",trt[trt.SCISSOR=1]="SCISSOR",
trt[trt.STENCIL=2]="STENCIL",trt[trt.SPRITE=3]="SPRITE",eit.RETINA_PREFIX=/@([0-9\.]+)x/;eit.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;!function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[Pit.NORMAL_NPM]=Pit.NORMAL,t[Pit.ADD_NPM]=Pit.ADD,
t[Pit.SCREEN_NPM]=Pit.SCREEN,e[Pit.NORMAL]=Pit.NORMAL_NPM,e[Pit.ADD]=Pit.ADD_NPM,e[Pit.SCREEN]=Pit.SCREEN_NPM;var r=[];r.push(e),r.push(t)}();function irt(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i]
;t.length=s}}Object.create(null),Object.create(null);function rrt(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||eit.RESOLUTION,this.resize(t,e)}var nrt={width:{configurable:!0},height:{
configurable:!0}};rrt.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},rrt.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,
this.canvas.height=e*this.resolution},rrt.prototype.destroy=function(){this.context=null,this.canvas=null},nrt.width.get=function(){return this.canvas.width},nrt.width.set=function(t){this.canvas.width=t},nrt.height.get=function(){
return this.canvas.height},nrt.height.set=function(t){this.canvas.height=t},Object.defineProperties(rrt.prototype,nrt);eit.SORTABLE_CHILDREN=!1;function srt(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}
srt.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},srt.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},srt.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?Tit.EMPTY:((t=t||new Tit(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},srt.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),
this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},srt.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2]
)<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},srt.prototype.addFrame=function(t,e,i,r,n){
this.addFrameMatrix(t.worldTransform,e,i,r,n)},srt.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(
m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},
srt.prototype.addVertexData=function(t,e,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},
srt.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},srt.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,
m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},srt.prototype.addBounds=function(t){var e=this.minX,i=this.minY,
r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},srt.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,
n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},srt.prototype.addBoundsMatrix=function(t,e){
this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},srt.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){
var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},srt.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},
srt.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var ort=function(t){function n(){t.call(this),
this.tempDisplayObjectParent=null,this.transform=new xit,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,
this._bounds=new srt,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{
configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},
zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r
,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){
this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),
this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(
this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Tit),e=this._boundsRect),
this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Tit),
t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),
this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(
!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),
void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){
this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,
this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},
e.worldTransform.get=function(){return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){
this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)
},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){
return this.transform.rotation*uit},e.angle.set=function(t){this.transform.rotation=t*lit},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){
var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){
var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(n.prototype,e),n}(X.a);function art(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}
ort.prototype.displayObjectUpdateTransform=ort.prototype.updateTransform;var hrt=function(n){function t(){n.call(this),this.children=[],this.sortableChildren=eit.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},
height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]
);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)
;return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,
t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e)
;this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},
t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);irt(this.children,i,1),this.children.splice(e,0,t),
this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(
1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,irt(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit(
"childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,irt(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit(
"childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(
i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError(
"removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}
t&&1<this.children.length&&this.children.sort(art),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(
var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)
}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0
)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush()
;var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,
this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()
},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},
e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},
e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(t.prototype,e),t}(ort);hrt.prototype.containerUpdateTransform=hrt.prototype.updateTransform,ort.prototype.name=null,
hrt.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null};var urt={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(
t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(
e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,
GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},lrt=(crt.prototype.clone=function(){
return new crt(this.x,this.y)},crt.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},crt.prototype.copyTo=function(t){return t.set(this.x,this.y),t},crt.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},
crt.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e},crt);function crt(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var drt=(prt.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(
e=this.scope),new prt(t,e,this._x,this._y)},prt.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},prt.prototype.copyFrom=function(t){
return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},prt.prototype.copyTo=function(t){return t.set(this._x,this._y),t},prt.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(
prt.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(prt.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(
this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),prt);function prt(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var frt,mrt,_rt=2*Math.PI,yrt=180/Math.PI,vrt=Math.PI/180;(mrt=frt=frt||{}
)[mrt.POLY=0]="POLY",mrt[mrt.RECT=1]="RECT",mrt[mrt.CIRC=2]="CIRC",mrt[mrt.ELIP=3]="ELIP",mrt[mrt.RREC=4]="RREC";var grt=(xrt.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},
xrt.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},xrt.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,
i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},xrt.prototype.apply=function(t,e){e=e||new lrt;var i=t.x,r=t.y
;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},xrt.prototype.applyInverse=function(t,e){e=e||new lrt;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,
e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},xrt.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},xrt.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},
xrt.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},
xrt.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},
xrt.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},xrt.prototype.prepend=function(t){
var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},
xrt.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(_rt-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),
t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},xrt.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,
this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},xrt.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},xrt.prototype.clone=function(){var t=new xrt;return t.a=this.a,t.b=this.b,t.c=this.c,
t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},xrt.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},xrt.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,
this.ty=t.ty,this},Object.defineProperty(xrt,"IDENTITY",{get:function(){return new xrt},enumerable:!0,configurable:!0}),Object.defineProperty(xrt,"TEMP_MATRIX",{get:function(){return new xrt},enumerable:!0,configurable:!0}),xrt);function xrt(t,e,i,r,n,s){
void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var brt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Trt=[0,1,1,1,0,-1,-1,-1,0,1
,1,1,0,-1,-1,-1],Ert=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],wrt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Art=[],Srt=[],Irt=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Art.push(e);for(var i=0;i<16;i++)for(var r=Irt(brt[t]*brt[i]+Ert[t]*Trt[i]),
n=Irt(Trt[t]*brt[i]+wrt[t]*Trt[i]),s=Irt(brt[t]*Ert[i]+Ert[t]*wrt[i]),o=Irt(Trt[t]*Ert[i]+wrt[t]*wrt[i]),a=0;a<16;a++)if(brt[a]===r&&Trt[a]===n&&Ert[a]===s&&wrt[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new grt;h.set(brt[t],Trt[t],Ert[t],wrt[t],0,0
),Srt.push(h)}}();var Crt=(Ort.prototype.onChange=function(){this._localID++},Ort.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),
this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},Ort.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},Ort.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},Ort.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(Ort.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),Ort.IDENTITY=new Ort,Ort);function Ort(){this.worldTransform=new grt,this.localTransform=new grt,this.position=new drt(
this.onChange,this,0,0),this.scale=new drt(this.onChange,this,1,1),this.pivot=new drt(this.onChange,this,0,0),this.skew=new drt(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,
this._worldID=0,this._parentID=0}var Rrt=(Object.defineProperty(Prt.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Prt.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,
configurable:!0}),Object.defineProperty(Prt.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Prt.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),
Object.defineProperty(Prt,"EMPTY",{get:function(){return new Prt(0,0,0,0)},enumerable:!0,configurable:!0}),Prt.prototype.clone=function(){return new Prt(this.x,this.y,this.width,this.height)},Prt.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y
,this.width=t.width,this.height=t.height,this},Prt.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},Prt.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},Prt.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},Prt.prototype.fit=function(t){var e=Math.max(this.x,
t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},Prt.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
Prt.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},Prt);function Prt(t,e,i
,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=frt.RECT}Mrt.prototype.clone=function(){return new Mrt(this.x,this.y,this.radius)},
Mrt.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},Mrt.prototype.getBounds=function(){return new Rrt(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius
)};function Mrt(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=frt.CIRC}Nrt.prototype.clone=function(){return new Nrt(this.x,this.y,this.width,this.height)},Nrt.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},Nrt.prototype.getBounds=function(){return new Rrt(this.x-this.width,this.y-this.height,this.width,this.height)};function Nrt(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=frt.ELIP}Lrt.prototype.clone=function(){var t=new Lrt(this.points.slice());return t.closeStroke=this.closeStroke,t},
Lrt.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function Lrt(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof lrt){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=frt.POLY,this.closeStroke=!0}var Frt,Drt,Urt,Brt,krt,
Xrt,Grt,Vrt,jrt,Hrt,Yrt,zrt,Wrt,qrt,Krt,Zrt,Jrt,Qrt,$rt,tnt,ent,rnt,nnt,snt,ont,ant,hnt,unt;lnt.prototype.clone=function(){return new lnt(this.x,this.y,this.width,this.height,this.radius)},lnt.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(
this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n
)return!0}return!1};function lnt(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=frt.RREC}(Drt=Frt=Frt||{}
)[Drt.WEBGL_LEGACY=0]="WEBGL_LEGACY",Drt[Drt.WEBGL=1]="WEBGL",Drt[Drt.WEBGL2=2]="WEBGL2",(Brt=Urt=Urt||{})[Brt.UNKNOWN=0]="UNKNOWN",Brt[Brt.WEBGL=1]="WEBGL",Brt[Brt.CANVAS=2]="CANVAS",(Xrt=krt=krt||{})[Xrt.NORMAL=0]="NORMAL",Xrt[Xrt.ADD=1]="ADD",
Xrt[Xrt.MULTIPLY=2]="MULTIPLY",Xrt[Xrt.SCREEN=3]="SCREEN",Xrt[Xrt.OVERLAY=4]="OVERLAY",Xrt[Xrt.DARKEN=5]="DARKEN",Xrt[Xrt.LIGHTEN=6]="LIGHTEN",Xrt[Xrt.COLOR_DODGE=7]="COLOR_DODGE",Xrt[Xrt.COLOR_BURN=8]="COLOR_BURN",Xrt[Xrt.HARD_LIGHT=9]="HARD_LIGHT",
Xrt[Xrt.SOFT_LIGHT=10]="SOFT_LIGHT",Xrt[Xrt.DIFFERENCE=11]="DIFFERENCE",Xrt[Xrt.EXCLUSION=12]="EXCLUSION",Xrt[Xrt.HUE=13]="HUE",Xrt[Xrt.SATURATION=14]="SATURATION",Xrt[Xrt.COLOR=15]="COLOR",Xrt[Xrt.LUMINOSITY=16]="LUMINOSITY",
Xrt[Xrt.NORMAL_NPM=17]="NORMAL_NPM",Xrt[Xrt.ADD_NPM=18]="ADD_NPM",Xrt[Xrt.SCREEN_NPM=19]="SCREEN_NPM",Xrt[Xrt.NONE=20]="NONE",Xrt[Xrt.SRC_OVER=0]="SRC_OVER",Xrt[Xrt.SRC_IN=21]="SRC_IN",Xrt[Xrt.SRC_OUT=22]="SRC_OUT",Xrt[Xrt.SRC_ATOP=23]="SRC_ATOP",
Xrt[Xrt.DST_OVER=24]="DST_OVER",Xrt[Xrt.DST_IN=25]="DST_IN",Xrt[Xrt.DST_OUT=26]="DST_OUT",Xrt[Xrt.DST_ATOP=27]="DST_ATOP",Xrt[Xrt.ERASE=26]="ERASE",Xrt[Xrt.SUBTRACT=28]="SUBTRACT",Xrt[Xrt.XOR=29]="XOR",(Vrt=Grt=Grt||{})[Vrt.POINTS=0]="POINTS",
Vrt[Vrt.LINES=1]="LINES",Vrt[Vrt.LINE_LOOP=2]="LINE_LOOP",Vrt[Vrt.LINE_STRIP=3]="LINE_STRIP",Vrt[Vrt.TRIANGLES=4]="TRIANGLES",Vrt[Vrt.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Vrt[Vrt.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Hrt=jrt=jrt||{})[Hrt.RGBA=6408]="RGBA",
Hrt[Hrt.RGB=6407]="RGB",Hrt[Hrt.ALPHA=6406]="ALPHA",Hrt[Hrt.LUMINANCE=6409]="LUMINANCE",Hrt[Hrt.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Hrt[Hrt.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Hrt[Hrt.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(zrt=Yrt=Yrt||{}
)[zrt.TEXTURE_2D=3553]="TEXTURE_2D",zrt[zrt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",zrt[zrt.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",zrt[zrt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",
zrt[zrt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",zrt[zrt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",zrt[zrt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",
zrt[zrt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",zrt[zrt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(qrt=Wrt=Wrt||{})[qrt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",qrt[qrt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",
qrt[qrt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",qrt[qrt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",qrt[qrt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",qrt[qrt.FLOAT=5126]="FLOAT",qrt[qrt.HALF_FLOAT=36193]="HALF_FLOAT",(
Zrt=Krt=Krt||{})[Zrt.NEAREST=0]="NEAREST",Zrt[Zrt.LINEAR=1]="LINEAR",(Qrt=Jrt=Jrt||{})[Qrt.CLAMP=33071]="CLAMP",Qrt[Qrt.REPEAT=10497]="REPEAT",Qrt[Qrt.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(tnt=$rt=$rt||{})[tnt.OFF=0]="OFF",tnt[tnt.POW2=1]="POW2",
tnt[tnt.ON=2]="ON",(rnt=ent=ent||{})[rnt.NPM=0]="NPM",rnt[rnt.UNPACK=1]="UNPACK",rnt[rnt.PMA=2]="PMA",rnt[rnt.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",rnt[rnt.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",
rnt[rnt.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(snt=nnt=nnt||{})[snt.AUTO=0]="AUTO",snt[snt.MANUAL=1]="MANUAL",(ant=ont=ont||{}).LOW="lowp",ant.MEDIUM="mediump",ant.HIGH="highp",(unt=hnt=hnt||{})[unt.NONE=0]="NONE",unt[unt.SCISSOR=1]="SCISSOR",
unt[unt.STENCIL=2]="STENCIL",unt[unt.SPRITE=3]="SPRITE",urt.RETINA_PREFIX=/@([0-9\.]+)x/;urt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;!function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[krt.NORMAL_NPM]=krt.NORMAL,t[krt.ADD_NPM]=krt.ADD,
t[krt.SCREEN_NPM]=krt.SCREEN,e[krt.NORMAL]=krt.NORMAL_NPM,e[krt.ADD]=krt.ADD_NPM,e[krt.SCREEN]=krt.SCREEN_NPM;var r=[];r.push(e),r.push(t)}();function cnt(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i]
;t.length=s}}Object.create(null),Object.create(null);function dnt(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||urt.RESOLUTION,this.resize(t,e)}var pnt={width:{configurable:!0},height:{
configurable:!0}};dnt.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},dnt.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,
this.canvas.height=e*this.resolution},dnt.prototype.destroy=function(){this.context=null,this.canvas=null},pnt.width.get=function(){return this.canvas.width},pnt.width.set=function(t){this.canvas.width=t},pnt.height.get=function(){
return this.canvas.height},pnt.height.set=function(t){this.canvas.height=t},Object.defineProperties(dnt.prototype,pnt);urt.SORTABLE_CHILDREN=!1;function fnt(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}
fnt.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},fnt.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},fnt.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?Rrt.EMPTY:((t=t||new Rrt(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},fnt.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),
this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},fnt.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2]
)<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},fnt.prototype.addFrame=function(t,e,i,r,n){
this.addFrameMatrix(t.worldTransform,e,i,r,n)},fnt.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(
m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},
fnt.prototype.addVertexData=function(t,e,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},
fnt.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},fnt.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,
m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},fnt.prototype.addBounds=function(t){var e=this.minX,i=this.minY,
r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},fnt.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,
n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},fnt.prototype.addBoundsMatrix=function(t,e){
this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},fnt.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){
var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},fnt.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},
fnt.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var mnt=function(t){function n(){t.call(this),
this.tempDisplayObjectParent=null,this.transform=new Crt,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,
this._bounds=new fnt,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{
configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},
zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r
,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){
this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),
this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(
this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Rrt),e=this._boundsRect),
this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Rrt),
t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),
this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(
!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),
void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){
this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,
this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},
e.worldTransform.get=function(){return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){
this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)
},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){
return this.transform.rotation*yrt},e.angle.set=function(t){this.transform.rotation=t*vrt},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){
var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){
var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(n.prototype,e),n}(X.a);function _nt(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}
mnt.prototype.displayObjectUpdateTransform=mnt.prototype.updateTransform;var ynt=function(n){function t(){n.call(this),this.children=[],this.sortableChildren=urt.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},
height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]
);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)
;return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,
t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e)
;this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},
t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);cnt(this.children,i,1),this.children.splice(e,0,t),
this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(
1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,cnt(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit(
"childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,cnt(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit(
"childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(
i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError(
"removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}
t&&1<this.children.length&&this.children.sort(_nt),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(
var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)
}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0
)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush()
;var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,
this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()
},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},
e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},
e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(t.prototype,e),t}(mnt);ynt.prototype.containerUpdateTransform=ynt.prototype.updateTransform,
mnt.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new lrt),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var vnt=(gnt.prototype.emit=function(t,e,i,r,n,s,o,a){if(
8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},
gnt.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},gnt.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t
)),this},gnt.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},gnt.prototype.contains=function(t){return-1!==this.items.indexOf(t)},gnt.prototype.removeAll=function(){
return this.ensureNonAliasedItems(),this.items.length=0,this},gnt.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(gnt.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,
configurable:!0}),Object.defineProperty(gnt.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),gnt);function gnt(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(vnt.prototype,{dispatch:{
value:vnt.prototype.emit},run:{value:vnt.prototype.emit}});var xnt,bnt,Tnt,Ent,wnt,Ant,Snt,Int,Cnt,Ont,Rnt,Pnt,Mnt,Nnt,Lnt,Fnt,Dnt,Unt,Bnt,knt,Xnt,Gnt,Vnt,jnt,Hnt,Ynt,znt,Wnt,qnt={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,
SPRITE_MAX_TEXTURES:function(t){var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/)
;if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},
GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(bnt=xnt=xnt||{}
)[bnt.WEBGL_LEGACY=0]="WEBGL_LEGACY",bnt[bnt.WEBGL=1]="WEBGL",bnt[bnt.WEBGL2=2]="WEBGL2",(Ent=Tnt=Tnt||{})[Ent.UNKNOWN=0]="UNKNOWN",Ent[Ent.WEBGL=1]="WEBGL",Ent[Ent.CANVAS=2]="CANVAS",(Ant=wnt=wnt||{})[Ant.NORMAL=0]="NORMAL",Ant[Ant.ADD=1]="ADD",
Ant[Ant.MULTIPLY=2]="MULTIPLY",Ant[Ant.SCREEN=3]="SCREEN",Ant[Ant.OVERLAY=4]="OVERLAY",Ant[Ant.DARKEN=5]="DARKEN",Ant[Ant.LIGHTEN=6]="LIGHTEN",Ant[Ant.COLOR_DODGE=7]="COLOR_DODGE",Ant[Ant.COLOR_BURN=8]="COLOR_BURN",Ant[Ant.HARD_LIGHT=9]="HARD_LIGHT",
Ant[Ant.SOFT_LIGHT=10]="SOFT_LIGHT",Ant[Ant.DIFFERENCE=11]="DIFFERENCE",Ant[Ant.EXCLUSION=12]="EXCLUSION",Ant[Ant.HUE=13]="HUE",Ant[Ant.SATURATION=14]="SATURATION",Ant[Ant.COLOR=15]="COLOR",Ant[Ant.LUMINOSITY=16]="LUMINOSITY",
Ant[Ant.NORMAL_NPM=17]="NORMAL_NPM",Ant[Ant.ADD_NPM=18]="ADD_NPM",Ant[Ant.SCREEN_NPM=19]="SCREEN_NPM",Ant[Ant.NONE=20]="NONE",Ant[Ant.SRC_OVER=0]="SRC_OVER",Ant[Ant.SRC_IN=21]="SRC_IN",Ant[Ant.SRC_OUT=22]="SRC_OUT",Ant[Ant.SRC_ATOP=23]="SRC_ATOP",
Ant[Ant.DST_OVER=24]="DST_OVER",Ant[Ant.DST_IN=25]="DST_IN",Ant[Ant.DST_OUT=26]="DST_OUT",Ant[Ant.DST_ATOP=27]="DST_ATOP",Ant[Ant.ERASE=26]="ERASE",Ant[Ant.SUBTRACT=28]="SUBTRACT",Ant[Ant.XOR=29]="XOR",(Int=Snt=Snt||{})[Int.POINTS=0]="POINTS",
Int[Int.LINES=1]="LINES",Int[Int.LINE_LOOP=2]="LINE_LOOP",Int[Int.LINE_STRIP=3]="LINE_STRIP",Int[Int.TRIANGLES=4]="TRIANGLES",Int[Int.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Int[Int.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Ont=Cnt=Cnt||{})[Ont.RGBA=6408]="RGBA",
Ont[Ont.RGB=6407]="RGB",Ont[Ont.ALPHA=6406]="ALPHA",Ont[Ont.LUMINANCE=6409]="LUMINANCE",Ont[Ont.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Ont[Ont.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Ont[Ont.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(Pnt=Rnt=Rnt||{}
)[Pnt.TEXTURE_2D=3553]="TEXTURE_2D",Pnt[Pnt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",Pnt[Pnt.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Pnt[Pnt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",
Pnt[Pnt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",Pnt[Pnt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Pnt[Pnt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",
Pnt[Pnt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",Pnt[Pnt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(Nnt=Mnt=Mnt||{})[Nnt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",Nnt[Nnt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",
Nnt[Nnt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",Nnt[Nnt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",Nnt[Nnt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",Nnt[Nnt.FLOAT=5126]="FLOAT",Nnt[Nnt.HALF_FLOAT=36193]="HALF_FLOAT",(
Fnt=Lnt=Lnt||{})[Fnt.NEAREST=0]="NEAREST",Fnt[Fnt.LINEAR=1]="LINEAR",(Unt=Dnt=Dnt||{})[Unt.CLAMP=33071]="CLAMP",Unt[Unt.REPEAT=10497]="REPEAT",Unt[Unt.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(knt=Bnt=Bnt||{})[knt.OFF=0]="OFF",knt[knt.POW2=1]="POW2",
knt[knt.ON=2]="ON",(Gnt=Xnt=Xnt||{})[Gnt.NPM=0]="NPM",Gnt[Gnt.UNPACK=1]="UNPACK",Gnt[Gnt.PMA=2]="PMA",Gnt[Gnt.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Gnt[Gnt.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",
Gnt[Gnt.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(jnt=Vnt=Vnt||{})[jnt.AUTO=0]="AUTO",jnt[jnt.MANUAL=1]="MANUAL",(Ynt=Hnt=Hnt||{}).LOW="lowp",Ynt.MEDIUM="mediump",Ynt.HIGH="highp",(Wnt=znt=znt||{})[Wnt.NONE=0]="NONE",Wnt[Wnt.SCISSOR=1]="SCISSOR",
Wnt[Wnt.STENCIL=2]="STENCIL",Wnt[Wnt.SPRITE=3]="SPRITE",qnt.RETINA_PREFIX=/@([0-9\.]+)x/;var Knt,Znt=!(qnt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),Jnt="5.2.0";var Qnt=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[wnt.NORMAL_NPM]=wnt.NORMAL,
t[wnt.ADD_NPM]=wnt.ADD,t[wnt.SCREEN_NPM]=wnt.SCREEN,e[wnt.NORMAL]=wnt.NORMAL_NPM,e[wnt.ADD]=wnt.ADD_NPM,e[wnt.SCREEN]=wnt.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function $nt(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i)
;for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var tst=0;function est(){return++tst}function ist(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function rst(t){return!(t&t-1||!t)}function nst(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3
;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var sst={},ost=Object.create(null),ast=Object.create(null);function hst(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),
this.resolution=i||qnt.RESOLUTION,this.resize(t,e)}var ust={width:{configurable:!0},height:{configurable:!0}};hst.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},
hst.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},hst.prototype.destroy=function(){this.context=null,this.canvas=null},ust.width.get=function(){return this.canvas.width},ust.width.set=function(t){
this.canvas.width=t},ust.height.get=function(){return this.canvas.height},ust.height.set=function(t){this.canvas.height=t},Object.defineProperties(hst.prototype,ust);var lst;function cst(t,e){var i=qnt.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]
):void 0!==e?e:1}var dst,pst,fst={};qnt.TARGET_FPMS=.06,(pst=dst=dst||{})[pst.INTERACTION=50]="INTERACTION",pst[pst.HIGH=25]="HIGH",pst[pst.NORMAL=0]="NORMAL",pst[pst.LOW=-25]="LOW",pst[pst.UTILITY=-50]="UTILITY";var mst=(_st.prototype.match=function(t,e
){return void 0===e&&(e=null),this.fn===t&&this.context===e},_st.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},
_st.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},_st.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(
this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},_st);function _st(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,
this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var yst=(vst.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},vst.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},vst.prototype._startIfPossible=function(){
this.started?this._requestIfNeeded():this.autoStart&&this.start()},vst.prototype.add=function(t,e,i){return void 0===i&&(i=dst.NORMAL),this._addListener(new mst(t,e,i))},vst.prototype.addOnce=function(t,e,i){return void 0===i&&(i=dst.NORMAL),
this._addListener(new mst(t,e,i,!0))},vst.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i)
;return this._startIfPossible(),this},vst.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},vst.prototype.start=function(){this.started||(this.started=!0,
this._requestIfNeeded())},vst.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},vst.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),
this._head=null}},vst.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(
i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*qnt.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()
}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(vst.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(vst.prototype,"minFPS",{get:function(){
return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,qnt.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(vst.prototype,"maxFPS",{get:function(){
return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(vst,"shared",{
get:function(){if(!vst._shared){var t=vst._shared=new vst;t.autoStart=!0,t._protected=!0}return vst._shared},enumerable:!0,configurable:!0}),Object.defineProperty(vst,"system",{get:function(){if(!vst._system){var t=vst._system=new vst;t.autoStart=!0,
t._protected=!0}return vst._system},enumerable:!0,configurable:!0}),vst);function vst(){var e=this;this._head=new mst(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,
this.deltaMS=1/qnt.TARGET_FPMS,this.elapsedMS=1/qnt.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),
e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}gst.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){
this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,dst.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?yst.shared:new yst,t.autoStart&&this.start()},gst.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function gst(){}var xst=(bst.prototype.clone=function(){return new bst(this.x,this.y)},
bst.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},bst.prototype.copyTo=function(t){return t.set(this.x,this.y),t},bst.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},bst.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},bst);function bst(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var Tst=(Est.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new Est(t,e,this._x,this._y)},
Est.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},Est.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},Est.prototype.copyTo=function(t){return t.set(this._x,this._y),t},Est.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(Est.prototype,"x",{get:function(){return this._x},set:function(t){
this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(Est.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),
Est);function Est(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var wst,Ast,Sst=2*Math.PI,Ist=180/Math.PI,Cst=Math.PI/180;(Ast=wst=wst||{})[Ast.POLY=0]="POLY",Ast[Ast.RECT=1]="RECT",Ast[Ast.CIRC=2]="CIRC",
Ast[Ast.ELIP=3]="ELIP",Ast[Ast.RREC=4]="RREC";var Ost=(Rst.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},Rst.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,
this.tx=n,this.ty=s,this},Rst.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,
i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},Rst.prototype.apply=function(t,e){e=e||new xst;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},Rst.prototype.applyInverse=function(t,e){
e=e||new xst;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},Rst.prototype.translate=function(t,e){return this.tx+=t,
this.ty+=e,this},Rst.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},Rst.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,
this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},Rst.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,
this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},Rst.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(
i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},Rst.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,
this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},Rst.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(
Sst-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},Rst.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,
r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},Rst.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},
Rst.prototype.clone=function(){var t=new Rst;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Rst.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},
Rst.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(Rst,"IDENTITY",{get:function(){return new Rst},enumerable:!0,configurable:!0}),Object.defineProperty(Rst,
"TEMP_MATRIX",{get:function(){return new Rst},enumerable:!0,configurable:!0}),Rst);function Rst(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,
this.c=i,this.d=r,this.tx=n,this.ty=s}var Pst=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Mst=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Nst=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Lst=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Fst=[],Dst=[],Ust=Math.sign
;!function(){for(var t=0;t<16;t++){var e=[];Fst.push(e);for(var i=0;i<16;i++)for(var r=Ust(Pst[t]*Pst[i]+Nst[t]*Mst[i]),n=Ust(Mst[t]*Pst[i]+Lst[t]*Mst[i]),s=Ust(Pst[t]*Nst[i]+Nst[t]*Lst[i]),o=Ust(Mst[t]*Nst[i]+Lst[t]*Lst[i]),a=0;a<16;a++)if(
Pst[a]===r&&Mst[a]===n&&Nst[a]===s&&Lst[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Ost;h.set(Pst[t],Mst[t],Nst[t],Lst[t],0,0),Dst.push(h)}}();var Bst={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,
REVERSE_DIAGONAL:14,uX:function(t){return Pst[t]},uY:function(t){return Mst[t]},vX:function(t){return Nst[t]},vY:function(t){return Lst[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Fst[t][e]},sub:function(t,e){return Fst[t][Bst.inv(e
)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?Bst.S:Bst.N:2*Math.abs(e)<=Math.abs(t)?0<t?Bst.E:Bst.W:0<e?0<t?Bst.SE:Bst.SW:0<t?Bst.NE:Bst.NW},
matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=Dst[Bst.inv(e)];n.tx=i,n.ty=r,t.append(n)}},kst=(Xst.prototype.onChange=function(){this._localID++},Xst.prototype.updateSkew=function(){this._cx=Math.cos(
this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},Xst.prototype.updateLocalTransform=function(){var t=this.localTransform
;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(
this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},Xst.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,
e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){
var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},
Xst.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(Xst.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,
configurable:!0}),Xst.IDENTITY=new Xst,Xst);function Xst(){this.worldTransform=new Ost,this.localTransform=new Ost,this.position=new Tst(this.onChange,this,0,0),this.scale=new Tst(this.onChange,this,1,1),this.pivot=new Tst(this.onChange,this,0,0),
this.skew=new Tst(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}var Gst=(Object.defineProperty(Vst.prototype,"left",{get:function(){
return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Vst.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(Vst.prototype,"top",{get:function(){return this.y},enumerable:!0,
configurable:!0}),Object.defineProperty(Vst.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Vst,"EMPTY",{get:function(){return new Vst(0,0,0,0)},enumerable:!0,configurable:!0}),
Vst.prototype.clone=function(){return new Vst(this.x,this.y,this.width,this.height)},Vst.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},Vst.prototype.copyTo=function(t){return t.x=this.x,
t.y=this.y,t.width=this.width,t.height=this.height,t},Vst.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},Vst.prototype.pad=function(t,e){return void 0===t&&(t=0),
void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},Vst.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height)
;return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},Vst.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t
;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},Vst.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),
n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},Vst);function Vst(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),
this.width=Number(i),this.height=Number(r),this.type=wst.RECT}jst.prototype.clone=function(){return new jst(this.x,this.y,this.radius)},jst.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e
;return(r*=r)+(n*=n)<=i},jst.prototype.getBounds=function(){return new Gst(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)};function jst(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,
this.type=wst.CIRC}Hst.prototype.clone=function(){return new Hst(this.x,this.y,this.width,this.height)},Hst.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r
)<=1},Hst.prototype.getBounds=function(){return new Gst(this.x-this.width,this.y-this.height,this.width,this.height)};function Hst(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,
this.height=r,this.type=wst.ELIP}var Yst=(zst.prototype.clone=function(){var t=new zst(this.points.slice());return t.closeStroke=this.closeStroke,t},zst.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){
var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i},zst);function zst(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),
e[0]instanceof xst){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=wst.POLY,this.closeStroke=!0}Wst.prototype.clone=function(){return new Wst(this.x,this.y,this.width,this.height,this.radius)},
Wst.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function Wst(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=wst.RREC}qnt.SORTABLE_CHILDREN=!1;function qst(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}
qst.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},qst.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},qst.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?Gst.EMPTY:((t=t||new Gst(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},qst.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),
this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},qst.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2]
)<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},qst.prototype.addFrame=function(t,e,i,r,n){
this.addFrameMatrix(t.worldTransform,e,i,r,n)},qst.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(
m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},
qst.prototype.addVertexData=function(t,e,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},
qst.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},qst.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,
m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},qst.prototype.addBounds=function(t){var e=this.minX,i=this.minY,
r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},qst.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,
n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},qst.prototype.addBoundsMatrix=function(t,e){
this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},qst.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){
var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},qst.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},
qst.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var Kst=function(t){function n(){t.call(this),
this.tempDisplayObjectParent=null,this.transform=new kst,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,
this._bounds=new qst,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{
configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},
zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r
,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){
this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),
this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(
this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Gst),e=this._boundsRect),
this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Gst),
t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),
this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(
!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),
void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){
this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,
this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},
e.worldTransform.get=function(){return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){
this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)
},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){
return this.transform.rotation*Ist},e.angle.set=function(t){this.transform.rotation=t*Cst},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){
var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){
var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(n.prototype,e),n}(X.a);function Zst(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}
Kst.prototype.displayObjectUpdateTransform=Kst.prototype.updateTransform;var Jst=function(n){function t(){n.call(this),this.children=[],this.sortableChildren=qnt.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},
height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]
);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)
;return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,
t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e)
;this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},
t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);$nt(this.children,i,1),this.children.splice(e,0,t),
this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(
1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,$nt(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit(
"childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,$nt(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit(
"childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(
i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError(
"removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}
t&&1<this.children.length&&this.children.sort(Zst),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(
var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)
}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0
)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush()
;var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,
this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()
},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},
e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},
e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(t.prototype,e),t}(Kst);Jst.prototype.containerUpdateTransform=Jst.prototype.updateTransform;function Qst(t,e){void 0===t&&(t=0),
void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new vnt("setRealSize",2),this.onUpdate=new vnt("update"),this.onError=new vnt("onError",1)}var $st={valid:{configurable:!0},width:{configurable:!0},height:{
configurable:!0}};Qst.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},Qst.prototype.unbind=function(t){this.onResize.remove(t),
this.onUpdate.remove(t),this.onError.remove(t)},Qst.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},$st.valid.get=function(){return!!this._width&&!!this._height},
Qst.prototype.update=function(){this.destroyed||this.onUpdate.run()},Qst.prototype.load=function(){return Promise.resolve()},$st.width.get=function(){return this._width},$st.height.get=function(){return this._height},Qst.prototype.upload=function(t,e,i){
return!1},Qst.prototype.style=function(t,e,i){return!1},Qst.prototype.dispose=function(){},Qst.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),
this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(Qst.prototype,$st);var tot=function(r){function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),
this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),
0===t.indexOf("data:"))return"";e=e||window.location,(lst=lst||document.createElement("a")).href=t;var i=!(t=H.a.parse(lst.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(
t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Xnt.UNPACK),
this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){
var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(Qst),
eot=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,
this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==e.createBitmap?e.createBitmap:qnt.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(
this.createBitmap=t),this._load||(this._load=new Promise(function(t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e(
):(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(
this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===Xnt.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),
this._process):Promise.resolve(this)},t.prototype.upload=function(t,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1
;if(o.prototype.upload.call(this,t,e,i,this.bitmap),!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},
t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(tot),iot=[];function rot(t,e){if(!t)return null
;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=iot.length-1;0<=n;--n){var s=iot[n];if(s.test&&s.test(t,i))return new s(t,e)}return new eot(t,e)}var not=function(s){function t(t,e){var i=e||{},
r=i.width,n=i.height;if(!r||!n)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl
;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Xnt.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,
i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(Qst),sot={scaleMode:Lnt.NEAREST,
format:Cnt.RGBA,alphaMode:Xnt.NPM},oot=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,
c=e.target,d=e.resolution,p=e.resourceOptions;!t||t instanceof Qst||((t=rot(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||qnt.RESOLUTION,this.mipmap=void 0!==r?r:qnt.MIPMAP_TEXTURES,
this.anisotropicLevel=void 0!==n?n:qnt.ANISOTROPIC_LEVEL,this.wrapMode=h||qnt.WRAP_MODE,this.scaleMode=void 0!==s?s:qnt.SCALE_MODE,this.format=u||Cnt.RGBA,this.type=l||Mnt.UNSIGNED_BYTE,this.target=c||Rnt.TEXTURE_2D,this.alphaMode=void 0!==i?i:Xnt.UNPACK,
void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.uid=est(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,
this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{
configurable:!0}};return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i
;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,
this._refreshPOT(),this.update(),this},o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){
this.isPowerOfTwo=rst(this.realWidth)&&rst(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),
this._refreshPOT()),this},o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(
this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){
this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ast[this.cacheId],delete ost[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),
this.textureCacheIds=null,this.destroyed=!0},o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=qnt.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+est()),t._pixiId)
;var s=ast[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new not(t,{width:e,height:i}),
s=t instanceof Float32Array?Mnt.FLOAT:Mnt.UNSIGNED_BYTE;return new o(n,Object.assign(sot,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),ast[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),ast[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=ast[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete ast[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete ast[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);oot._globalBatch=0;var aot=function(a){function t(t,
e){var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new oot;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(rot(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=Rnt.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(Qst),
hot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(tot),
uot=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=Rnt.TEXTURE_CUBE_MAP_POSITIVE_X+i
;!1!==e.autoLoad&&this.load()}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=Rnt.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(
var r=this.itemDirtyIds,n=0;n<o.SIDES;n++){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(aot);uot.SIDES=6;var lot=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),
this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((
r.prototype=Object.create(i&&i.prototype)).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(
!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,
this.svg,this._crossorigin),o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them."
);var i=t*s.scale,r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+est(),
n.getContext("2d").drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(tot)
;lot.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var cot=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=yst.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(yst.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(yst.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&yst.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(yst.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(yst.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(tot);cot.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var dot=function(t){function e(){t.apply(
this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(tot);iot.push(eot,dot,hot,cot,lot,not,uot,aot);function pot(t){
this.renderer=t}pot.prototype.destroy=function(){this.renderer=null};function fot(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,
this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new vnt("disposeFramebuffer",2)}var mot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e
).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Xnt.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(
i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(not),_ot={colorTexture:{configurable:!0}};_ot.colorTexture.get=function(){return this.colorTextures[0]},
fot.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new oot(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},
fot.prototype.addDepthTexture=function(t){return this.depthTexture=t||new oot(new mot(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:Cnt.DEPTH_COMPONENT,type:Mnt.UNSIGNED_SHORT}),
this.dirtyId++,this.dirtyFormat++,this},fot.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},fot.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},
fot.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution
;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},fot.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(fot.prototype,_ot);function yot(){this.x0=0,
this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}var vot=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]})
;n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new fot(this.width*this.resolution,
this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),
this.framebuffer.resize(t*this.resolution,e*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(oot)
;yot.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=Bst.add(i,Bst.NW),this.x0=a+s*Bst.uX(i),this.y0=h+o*Bst.uY(i),i=Bst.add(i,2),this.x1=a+s*Bst.uX(i),this.y1=h+o*Bst.uY(i),i=Bst.add(i,2
),this.x2=a+s*Bst.uX(i),this.y2=h+o*Bst.uY(i),i=Bst.add(i,2),this.x3=a+s*Bst.uX(i),this.y3=h+o*Bst.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(
t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var got=new yot,
xot=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new Gst(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=got,
this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new xst(s.x,s.y):new xst(0,0),
this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={
resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){
this.baseTexture.resource&&this.baseTexture.resource.update()},a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()
}else this.frame=this._frame;this.emit("update",this)},a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&ost[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",
this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,
this.orig,this.trim,this.rotate,this.defaultAnchor)},a.prototype.updateUvs=function(){this._uvs===got&&(this._uvs=new yot),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(
i=qnt.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+est()),t._pixiId);var s=ost[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(
e.resolution=cst(t)),(s=new a(new oot(t,e))).baseTexture.cacheId=n,oot.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(oot.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new eot(t);r.url=e
;var n=new a(new oot(r,{scaleMode:qnt.SCALE_MODE,resolution:cst(e)}));return i=i||e,oot.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(oot.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(
-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),ost[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),ost[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=ost[t];if(e){
var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete ost[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)ost[t.textureCacheIds[r]]===t&&delete ost[t.textureCacheIds[r]]
;return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,
s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error(
"Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},
t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function bot(t){t.destroy=function(){},
t.on=function(){},t.once=function(){},t.emit=function(){}}xot.EMPTY=new xot(new oot),bot(xot.EMPTY),bot(xot.EMPTY.baseTexture),xot.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d")
;return e.fillStyle="white",e.fillRect(0,0,16,16),new xot(new oot(new hot(t)))}(),bot(xot.WHITE),bot(xot.WHITE.baseTexture);function Tot(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}
var Eot=function(a){function n(t,e){var i=null;if(!(t instanceof vot)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn("Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,
t=new vot({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n
).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},
n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new vot(t))},n
}(xot);Tot.prototype.createTexture=function(t,e){var i=new vot(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Eot(i)},Tot.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=Tot.SCREEN_KEY;t*=i,e*=i,
this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=ist(t)))<<16|65535&(e=ist(e))),this.texturePool[r]||(this.texturePool[r]=[]);var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,
n.setResolution(i),n},Tot.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},Tot.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,
this.texturePool[e].push(t)},Tot.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Tot.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}
this.texturePool={}},Tot.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Tot.SCREEN_KEY,i=this.texturePool[e];if(this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++
)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Tot.SCREEN_KEY="screen";function wot(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,
this.stride=n,this.start=s,this.instance=o}wot.prototype.destroy=function(){this.buffer=null},wot.from=function(t,e,i,r,n){return new wot(t,e,i,r,n)};function Aot(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),
this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=Sot++,this.disposeRunner=new vnt("disposeBuffer",2)}var Sot=0;function Iot(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Aot.prototype.update=function(t){this.data=t||this.data,this._updateID++},Aot.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Aot.prototype.destroy=function(){this.dispose(),this.data=null},Aot.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Aot(t)};var Cot={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Oot(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Pot++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new vnt("disposeGeometry",2),this.refCount=0}var Rot={5126:4,5123:2,5121:1},Pot=0,Mot={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};Oot.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Aot(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new wot(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},Oot.prototype.getAttribute=function(t){return this.attributes[t]},Oot.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},Oot.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Aot(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
Oot.prototype.getIndex=function(){return this.indexBuffer},Oot.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Aot;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Rot[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Iot(c
);n[d]||(n[d]=new Cot[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Oot.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Oot.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},Oot.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Oot.prototype.clone=function(){for(var t=new Oot,e=0;e<this.buffers.length;e++)t.buffers[e]=new Aot(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new wot(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},Oot.merge=function(t){for(var e,i=new Oot,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(Mot[Iot(e.buffers[h].data)])(n[h]),i.buffers[h]=new Aot(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Rot[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function Not(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=Dot++,this.static=!!e}var Lot=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Oot)
,Fot=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Aot(this.vertices),this.uvBuffer=new Aot(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Oot),Dot=0
;Not.prototype.update=function(){this.dirtyId++},Not.prototype.add=function(t,e,i){this.uniforms[t]=new Not(e,i)},Not.from=function(t,e){return new Not(t,e)};function Uot(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new Gst,this.destinationFrame=new Gst,this.filters=[]}Uot.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function Bot(t){this.renderer=t}var kot=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new Tot,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Lot,this.quadUv=new Fot,this.tempRect=new Gst,this.activeState={},this.globalUniforms=new Not({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Uot,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Snt.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(Snt.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
Ost.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(pot);Bot.prototype.flush=function(){},Bot.prototype.destroy=function(){this.renderer=null},Bot.prototype.start=function(){},Bot.prototype.stop=function(){this.flush()},Bot.prototype.render=function(t){};var Xot=function(e){
function t(t){e.call(this,t),this.emptyRenderer=new Bot(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(pot);qnt.PREFER_ENV=u.a.any?xnt.WEBGL:xnt.WEBGL2,
qnt.STRICT_TEXTURE_CACHE=!1;function Got(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function Vot(t){this.type=znt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,
this._scissorCounter=0,this._scissorRect=null,this._target=null}var jot=0,Hot=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),
this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(
t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,
this.renderer.CONTEXT_UID=jot++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,
this.renderer.CONTEXT_UID=jot++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(
qnt.PREFER_ENV>=xnt.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error(
"This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension(
"WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension(
"WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension(
"OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension(
"EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){t.preventDefault()},
t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener(
"webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(pot),Yot=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new fot(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Gst,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;qnt.PREFER_ENV===xnt.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Gst},Object.defineProperties(t.prototype,i),t}(pot),zot={5126:4,5123:2,5121:1},
Wot=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e)
,((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;qnt.PREFER_ENV===xnt.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*zot[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*zot[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*zot[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new Got(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,
e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(pot);function qot(t,e,i,r){var n=Kot(t,t.VERTEX_SHADER,e),s=Kot(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Kot(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function Zot(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Jot(2*e)
;case"bvec3":return Jot(3*e);case"bvec4":return Jot(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Jot(t
){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}Vot.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=znt.NONE,this.autoDetect=!0),this._target=null},Vot.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var Qot,$ot={},tat=$ot;function eat(){if(
tat===$ot||tat&&tat.isContextLost()){var t,e=document.createElement("canvas");qnt.PREFER_ENV>=xnt.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),
tat=t}return tat}function iat(t,e,i){if("precision"===t.substring(0,9))return i!==Hnt.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===Hnt.HIGH&&i!==Hnt.HIGH&&(r=Hnt.MEDIUM),
"precision "+r+" float;\n"+t}var rat={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var nat=null,sat={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",
INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",
SAMPLER_2D_ARRAY:"sampler2DArray"};function oat(t,e){if(!nat){var i=Object.keys(sat);nat={};for(var r=0;r<i.length;++r){var n=i[r];nat[t[n]]=sat[n]}}return nat[e]}var aat={
float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},hat={
float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",
mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",
bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var uat,lat=["precision mediump float;","void main(void){",
"float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function cat(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function dat(t,e,i){void 0===i&&(i="pixi-shader"),this.id=pat++,
this.vertexSrc=t||dat.defaultVertexSrc,this.fragmentSrc=e||dat.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),fat[i]?(fat[i]++,
i+="-"+fat[i]):fat[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=iat(this.vertexSrc,qnt.PRECISION_VERTEX,Hnt.HIGH),this.fragmentSrc=iat(this.fragmentSrc,
qnt.PRECISION_FRAGMENT,function(){if(!Qot){Qot=Hnt.MEDIUM;var t=eat();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Qot=e.precision?Hnt.HIGH:Hnt.MEDIUM}}return Qot}())),this.extractData(this.vertexSrc,
this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}var pat=0,fat={},mat={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};dat.prototype.extractData=function(t,e){var i=eat();if(i){var r=qot(i,t,e)
;this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},dat.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,
e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){var a=e.getActiveAttrib(t,o),h=oat(e,a.type),u={type:h,name:a.name,size:(i=h,rat[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
dat.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=oat(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:Zot(h,s.size)}}return i},mat.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},mat.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},dat.from=function(t,e,i){var r=t+e,n=sst[r];return n||(
sst[r]=n=new dat(t,e,i)),n},Object.defineProperties(dat,mat);function _at(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof Not?e:new Not(e):new Not({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(
this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))}var yat={uniforms:{configurable:!0}};_at.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(
r.group&&this.checkUniformExists(t,r))return!0}return!1},_at.prototype.destroy=function(){this.uniformGroup=null},yat.uniforms.get=function(){return this.uniformGroup.uniforms},_at.from=function(t,e,i){var r=dat.from(t,e);return new _at(r,i)},
Object.defineProperties(_at.prototype,yat);function vat(){this.data=0,this.blendMode=wnt.NORMAL,this.polygonOffset=0,this.blend=!0}var gat={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},
clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};gat.blend.get=function(){return!!(1&this.data)},gat.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},gat.offsets.get=function(){return!!(
2&this.data)},gat.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},gat.culling.get=function(){return!!(4&this.data)},gat.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},gat.depthTest.get=function(){return!!(8&this.data)},
gat.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},gat.clockwiseFrontFace.get=function(){return!!(16&this.data)},gat.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},gat.blendMode.get=function(){
return this._blendMode},gat.blendMode.set=function(t){this.blend=t!==wnt.NONE,this._blendMode=t},gat.polygonOffset.get=function(){return this._polygonOffset},gat.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},vat.for2d=function(){
var t=new vat;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(vat.prototype,gat);var xat=function(n){function s(t,e,i){var r=dat.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,
this.resolution=qnt.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new vat}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},
defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){
this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(_at);xat.SOURCE_KEY_MAP={};function bat(t,e){this._texture=t,this.mapCoord=new Ost,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var Tat=new Ost,Eat={texture:{configurable:!0}};Eat.texture.get=function(){return this._texture},Eat.texture.set=function(t){this._texture=t,this._updateID=-1},bat.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,
r=0;r<t.length;r+=2){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},bat.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID
;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(Tat.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Tat));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(bat.prototype,Eat);function wat(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Aat=function(
i){function t(t){var e=new Ost;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new bat(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(xat),Sat=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new Vot;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case znt.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case znt.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case znt.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case znt.SCISSOR:this.renderer.scissor.pop();break;case znt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case znt.SPRITE:this.popSpriteMask()}e.reset(),
e.pooled&&this.maskDataPool.push(e)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=znt.SPRITE;else if(t.type=znt.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(
i.d,i.c);r=Math.round(r*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=znt.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,
r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(this.alphaMaskPool[this.alphaMaskIndex]=[new Aat(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,
this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(pot),Iat=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(
e&&e.prototype)).constructor=t).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(
this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(pot),Cat=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(Iat),Oat=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),
i.enable(i.STENCIL_TEST)),t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()
},t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Iat),Rat=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ost,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(pot),Pat=new Gst,Mat=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new Gst,this.destinationFrame=new Gst}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(Pat.width=s.realWidth,Pat.height=s.realHeight,i=Pat),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
Pat.width=n.width,Pat.height=n.height,i=Pat),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(pot)
;wat.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Nat=0,Lat=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Nat++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof uat)return uat;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;"
);uat=!0===t({a:"b"},"a","b")}catch(t){uat=!1}return uat}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?aat:hat)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=qot(e,i.vertexSrc,i.fragmentSrc,r)
,o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Zot(h.type,h.size)}}var u=new wat(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,
this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(pot);function Fat(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}
var Dat=function(e){function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=wnt.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,
this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new vat,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i
).prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[wnt.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.ADD]=[t.ONE,t.ONE],e[wnt.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[wnt.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[wnt.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.HUE]=[
t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.NONE]=[0,0],e[wnt.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[wnt.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[wnt.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[wnt.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[wnt.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[wnt.SRC_ATOP]=[
t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[wnt.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[wnt.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[wnt.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[wnt.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[wnt.XOR]=[t.ONE_MINUS_DST_ALPHA,
t.ONE_MINUS_SRC_ALPHA],e[wnt.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,
i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this
,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t);this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){
this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](
this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]
):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){
this.gl.polygonOffset(t,e)},i.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t)
;e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(pot),Uat=function(e){function t(t){e.call(this,t),
this.count=0,this.checkCount=0,this.maxIdle=qnt.GC_MAX_IDLE,this.checkCountMax=qnt.GC_MAX_CHECK_COUNT,this.mode=qnt.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){
this.renderer.renderingToScreen&&(this.count++,this.mode!==Vnt.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,
r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){
var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(pot),Bat=function(e){function t(t){e.call(this,t),this.boundTextures=[],
this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new oot}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null
;this.emptyTextures={};var r=new Fat(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,
this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Fat(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null)
;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0)
;var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(
i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(
this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(
var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++
)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},
t.prototype.initTexture=function(t){var e=new Fat(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(
e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===Mnt.HALF_FLOAT&&(e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(
e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(
e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e
){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){
var r=this.managedTextures.indexOf(t);-1!==r&&$nt(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==Bnt.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,
2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=Dnt.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(
e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,
t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===Lnt.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(pot),kat=new Ost;X.a;function Xat(){this.texArray=null,this.blend=0,this.type=Snt.TRIANGLES,this.start=0,this.size=0,this.data=null}function Gat(){this.elements=[],this.ids=[],this.count=0}Gat.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function Vat(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var jat={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};jat.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},jat.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},jat.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},jat.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},jat.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Vat.prototype.view=function(t){
return this[t+"View"]},Vat.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Vat.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Vat.prototype,jat);var Hat=function(e){function _(t
){e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=vat.for2d(),this.size=4*qnt.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;qnt.PREFER_ENV===xnt.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),qnt.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=lat.replace(/%forloop%/gi,cat(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}
return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},
_.prototype.initFlushBuffers=function(){for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new Xat);for(;e.length<r;)e.push(new Gat);for(var n=0;n<this.MAX_TEXTURES;n++
)this._tempBoundTextures[n]=null},_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,
this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,
i=_._textureArrayPool,r=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++oot._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(
r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null
;oot._globalBatch=o},_.prototype.buildDrawCalls=function(t,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,
c.texArray=t;for(var d=e;d<i;++d){var p=r[d],f=p._texture.baseTexture,m=Qnt[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o
,l+=p.indices.length,c.blend=m}e<i&&(c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null
;t.count=0},_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;qnt.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),qnt.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=ist(Math.ceil(t/8)),i=nst(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Vat(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=ist(Math.ceil(t/12)),i=nst(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(Bot);Hat._drawCallPool=[],Hat._textureArrayPool=[]
;function Yat(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}Yat.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=Not.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new dat(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ost,default:this.defaultGroupCache[t]};return new _at(this.programCache[t],n)}
,Yat.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function zat(){}var Wat=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Aot(null,t,!1),this._indexBuffer=new Aot(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Mnt.FLOAT).addAttribute("aTextureCoord",
this._buffer,2,!1,Mnt.FLOAT).addAttribute("aColor",this._buffer,4,!0,Mnt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Mnt.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t
}(Oot),
qat="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,Kat="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Zat={defaultVertexSrc:{configurable:!0
},defaultFragmentTemplate:{configurable:!0}};zat.create=function(t){var e=Object.assign({vertex:qat,fragment:Kat,geometryClass:Wat,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new Yat(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Hat)},Zat.defaultVertexSrc.get=function(){return qat},Zat.defaultFragmentTemplate.get=function(){
return Kat},Object.defineProperties(zat,Zat);function Jat(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}zat.create();Jat.prototype.update=function(t){if(
t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data
;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}};var Qat=new xst,$at=new Yst,tht=function(n){function i(t,e,i,r){void 0===r&&(r=Snt.TRIANGLES),n.call(this),(
this.geometry=t).refCount++,this.shader=e,this.state=i||vat.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=0,this._transformID=-1,this.tint=16777215,
this.blendMode=wnt.NORMAL,this._roundPixels=qnt.ROUND_PIXELS,this.batchUvs=null}n&&(i.__proto__=n),(i.prototype=Object.create(n&&n.prototype)).constructor=i;var t={uvBuffer:{configurable:!0},verticesBuffer:{configurable:!0},material:{configurable:!0},
blendMode:{configurable:!0},roundPixels:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return t.uvBuffer.get=function(){return this.geometry.buffers[1]},t.verticesBuffer.get=function(){return this.geometry.buffers[0]},
t.material.set=function(t){this.shader=t},t.material.get=function(){return this.shader},t.blendMode.set=function(t){this.state.blendMode=t},t.blendMode.get=function(){return this.state.blendMode},t.roundPixels.set=function(t){this._roundPixels!==t&&(
this._transformID=-1),this._roundPixels=t},t.roundPixels.get=function(){return this._roundPixels},t.tint.get=function(){return this.shader.tint},t.tint.set=function(t){this.shader.tint=t},t.texture.get=function(){return this.shader.texture},
t.texture.set=function(t){this.shader.texture=t},i.prototype._render=function(t){var e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Snt.TRIANGLES&&e.length<2*i.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},
i.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),
t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},i.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),
this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)},
i.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(
this.vertexData=new Float32Array(e.length));for(var i=this.transform.worldTransform,r=i.a,n=i.b,s=i.c,o=i.d,a=i.tx,h=i.ty,u=this.vertexData,l=0;l<u.length/2;l++){var c=e[2*l],d=e[2*l+1];u[2*l]=r*c+s*d+a,u[2*l+1]=n*c+o*d+h}if(this._roundPixels)for(
var p=0;p<u.length;p++)u[p]=Math.round(u[p]);this.vertexDirty=t.vertexDirtyId}},i.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Jat(t,this.shader.uvMatrix)
),this.batchUvs.update(),this.uvs=this.batchUvs.data)},i.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},i.prototype.containsPoint=function(t){if(!this.getBounds(
).contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Qat);for(var e=this.geometry.getBuffer("aVertexPosition").data,i=$at.points,r=this.geometry.getIndex().data,n=r.length,s=4===this.drawMode?3:1,o=0;o+2<n;o+=s){var a=2*r[o],h=2*r[o+1],
u=2*r[o+2];if(i[0]=e[a],i[1]=e[1+a],i[2]=e[h],i[3]=e[1+h],i[4]=e[u],i[5]=e[1+u],$at.contains(Qat.x,Qat.y))return!0}return!1},i.prototype.destroy=function(t){n.prototype.destroy.call(this,t),this.geometry.refCount--,
0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Object.defineProperties(i.prototype,t),i}(Jst);tht.BATCHABLE_SIZE=100;var eht,iht,rht,nht,sht,oht
,aht,hht,uht,lht,cht,dht,pht,fht,mht,_ht,yht,vht,ght,xht,bht,Tht,Eht,wht,Aht,Sht,Iht,Cht,Oht=function(r){function t(t,e){var i={uSampler:t,alpha:1,uTextureMatrix:Ost.IDENTITY,uColor:new Float32Array([1,1,1,1])};(e=Object.assign({tint:16777215,alpha:1,
pluginName:"batch"},e)).uniforms&&Object.assign(i,e.uniforms),r.call(this,e.program||dat.from(
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n"
,"varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),i),this._colorDirty=!1,this.uvMatrix=new bat(t),
this.batchable=void 0===e.program,this.pluginName=e.pluginName,this.tint=e.tint,this.alpha=e.alpha}r&&(t.__proto__=r),(t.prototype=Object.create(r&&r.prototype)).constructor=t;var e={texture:{configurable:!0},alpha:{configurable:!0},tint:{configurable:!0}
};return e.texture.get=function(){return this.uniforms.uSampler},e.texture.set=function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},e.alpha.set=function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},
e.alpha.get=function(){return this._alpha},e.tint.set=function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},e.tint.get=function(){return this._tint},t.prototype.update=function(){if(this._colorDirty
){this._colorDirty=!1;var t=this.texture.baseTexture;!function(t,e,i,r){(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,!r&&void 0!==r||(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e}(this._tint,this._alpha,this.uniforms.uColor,
t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},Object.defineProperties(t.prototype,e),t}(_at),Rht=function(o){function t(t,e,i){o.call(this);var r=new Aot(t),n=new Aot(e,!0),s=new Aot(i,!0,!0)
;this.addAttribute("aVertexPosition",r,2,!1,Mnt.FLOAT).addAttribute("aTextureCoord",n,2,!1,Mnt.FLOAT).addIndex(s),this._updateId=-1}o&&(t.__proto__=o),(t.prototype=Object.create(o&&o.prototype)).constructor=t;var e={vertexDirtyId:{configurable:!0}}
;return e.vertexDirtyId.get=function(){return this.buffers[0]._updateID},Object.defineProperties(t.prototype,e),t}(Oot);(iht=eht=eht||{})[iht.WEBGL_LEGACY=0]="WEBGL_LEGACY",iht[iht.WEBGL=1]="WEBGL",iht[iht.WEBGL2=2]="WEBGL2",(nht=rht=rht||{}
)[nht.UNKNOWN=0]="UNKNOWN",nht[nht.WEBGL=1]="WEBGL",nht[nht.CANVAS=2]="CANVAS",(oht=sht=sht||{})[oht.NORMAL=0]="NORMAL",oht[oht.ADD=1]="ADD",oht[oht.MULTIPLY=2]="MULTIPLY",oht[oht.SCREEN=3]="SCREEN",oht[oht.OVERLAY=4]="OVERLAY",oht[oht.DARKEN=5]="DARKEN",
oht[oht.LIGHTEN=6]="LIGHTEN",oht[oht.COLOR_DODGE=7]="COLOR_DODGE",oht[oht.COLOR_BURN=8]="COLOR_BURN",oht[oht.HARD_LIGHT=9]="HARD_LIGHT",oht[oht.SOFT_LIGHT=10]="SOFT_LIGHT",oht[oht.DIFFERENCE=11]="DIFFERENCE",oht[oht.EXCLUSION=12]="EXCLUSION",
oht[oht.HUE=13]="HUE",oht[oht.SATURATION=14]="SATURATION",oht[oht.COLOR=15]="COLOR",oht[oht.LUMINOSITY=16]="LUMINOSITY",oht[oht.NORMAL_NPM=17]="NORMAL_NPM",oht[oht.ADD_NPM=18]="ADD_NPM",oht[oht.SCREEN_NPM=19]="SCREEN_NPM",oht[oht.NONE=20]="NONE",
oht[oht.SRC_OVER=0]="SRC_OVER",oht[oht.SRC_IN=21]="SRC_IN",oht[oht.SRC_OUT=22]="SRC_OUT",oht[oht.SRC_ATOP=23]="SRC_ATOP",oht[oht.DST_OVER=24]="DST_OVER",oht[oht.DST_IN=25]="DST_IN",oht[oht.DST_OUT=26]="DST_OUT",oht[oht.DST_ATOP=27]="DST_ATOP",
oht[oht.ERASE=26]="ERASE",oht[oht.SUBTRACT=28]="SUBTRACT",oht[oht.XOR=29]="XOR",(hht=aht=aht||{})[hht.POINTS=0]="POINTS",hht[hht.LINES=1]="LINES",hht[hht.LINE_LOOP=2]="LINE_LOOP",hht[hht.LINE_STRIP=3]="LINE_STRIP",hht[hht.TRIANGLES=4]="TRIANGLES",
hht[hht.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",hht[hht.TRIANGLE_FAN=6]="TRIANGLE_FAN",(lht=uht=uht||{})[lht.RGBA=6408]="RGBA",lht[lht.RGB=6407]="RGB",lht[lht.ALPHA=6406]="ALPHA",lht[lht.LUMINANCE=6409]="LUMINANCE",
lht[lht.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",lht[lht.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",lht[lht.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(dht=cht=cht||{})[dht.TEXTURE_2D=3553]="TEXTURE_2D",dht[dht.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",
dht[dht.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",dht[dht.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",dht[dht.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",
dht[dht.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",dht[dht.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",dht[dht.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",
dht[dht.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(fht=pht=pht||{})[fht.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",fht[fht.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",fht[fht.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",
fht[fht.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",fht[fht.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",fht[fht.FLOAT=5126]="FLOAT",fht[fht.HALF_FLOAT=36193]="HALF_FLOAT",(_ht=mht=mht||{})[_ht.NEAREST=0]="NEAREST",
_ht[_ht.LINEAR=1]="LINEAR",(vht=yht=yht||{})[vht.CLAMP=33071]="CLAMP",vht[vht.REPEAT=10497]="REPEAT",vht[vht.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(xht=ght=ght||{})[xht.OFF=0]="OFF",xht[xht.POW2=1]="POW2",xht[xht.ON=2]="ON",(Tht=bht=bht||{}
)[Tht.NPM=0]="NPM",Tht[Tht.UNPACK=1]="UNPACK",Tht[Tht.PMA=2]="PMA",Tht[Tht.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Tht[Tht.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Tht[Tht.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(wht=Eht=Eht||{}
)[wht.AUTO=0]="AUTO",wht[wht.MANUAL=1]="MANUAL",(Sht=Aht=Aht||{}).LOW="lowp",Sht.MEDIUM="mediump",Sht.HIGH="highp",(Cht=Iht=Iht||{})[Cht.NONE=0]="NONE",Cht[Cht.SCISSOR=1]="SCISSOR",Cht[Cht.STENCIL=2]="STENCIL",Cht[Cht.SPRITE=3]="SPRITE";var Pht=(
Mht.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,
this},Mht.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},Mht.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),
this.items.push(t)),this},Mht.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},Mht.prototype.contains=function(t){return-1!==this.items.indexOf(t)},
Mht.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},Mht.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(Mht.prototype,"empty",{get:function(){
return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(Mht.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Mht);function Mht(t){this.items=[],this._name=t,this._aliasCount=0}
Object.defineProperties(Pht.prototype,{dispatch:{value:Pht.prototype.emit},run:{value:Pht.prototype.emit}});var Nht,Lht={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(
u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(e=!0)}}
return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,
GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1,RETINA_PREFIX:/@([0-9\.]+)x/,
FAIL_IF_MAJOR_PERFORMANCE_CAVEAT:!0},Fht=!1,Dht="5.2.0";var Uht=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[sht.NORMAL_NPM]=sht.NORMAL,t[sht.ADD_NPM]=sht.ADD,t[sht.SCREEN_NPM]=sht.SCREEN,e[sht.NORMAL]=sht.NORMAL_NPM,e[sht.ADD]=sht.ADD_NPM,
e[sht.SCREEN]=sht.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function Bht(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var kht=0;function Xht(){return++kht}function Ght(t){
return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Vht(t){return!(t&t-1||!t)}function jht(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var Hht={},
Yht=Object.create(null),zht=Object.create(null);function Wht(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||Lht.RESOLUTION,this.resize(t,e)}var qht={width:{configurable:!0},height:{
configurable:!0}};Wht.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},Wht.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,
this.canvas.height=e*this.resolution},Wht.prototype.destroy=function(){this.context=null,this.canvas=null},qht.width.get=function(){return this.canvas.width},qht.width.set=function(t){this.canvas.width=t},qht.height.get=function(){
return this.canvas.height},qht.height.set=function(t){this.canvas.height=t},Object.defineProperties(Wht.prototype,qht);var Kht;function Zht(t,e){var i=Lht.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var Jht,Qht,$ht={}
;Lht.TARGET_FPMS=.06,(Qht=Jht=Jht||{})[Qht.INTERACTION=50]="INTERACTION",Qht[Qht.HIGH=25]="HIGH",Qht[Qht.NORMAL=0]="NORMAL",Qht[Qht.LOW=-25]="LOW",Qht[Qht.UTILITY=-50]="UTILITY";var tut=(eut.prototype.match=function(t,e){return void 0===e&&(e=null),
this.fn===t&&this.context===e},eut.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},eut.prototype.connect=function(t){(
this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},eut.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(
this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},eut);function eut(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,
this.previous=null,this._destroyed=!1}var iut=(rut.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},
rut.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},rut.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},
rut.prototype.add=function(t,e,i){return void 0===i&&(i=Jht.NORMAL),this._addListener(new tut(t,e,i))},rut.prototype.addOnce=function(t,e,i){return void 0===i&&(i=Jht.NORMAL),this._addListener(new tut(t,e,i,!0))},rut.prototype._addListener=function(t){
var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},rut.prototype.remove=function(t,e){for(var i=this._head.next;i;
)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},rut.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},rut.prototype.stop=function(){this.started&&(this.started=!1,
this._cancelIfNeeded())},rut.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},rut.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),
t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,
this.deltaTime=this.deltaMS*Lht.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(rut.prototype,"FPS",{
get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(rut.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,
Lht.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(rut.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{
var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(rut,"shared",{get:function(){if(!rut._shared){var t=rut._shared=new rut;t.autoStart=!0,t._protected=!0}return rut._shared},enumerable:!0,
configurable:!0}),Object.defineProperty(rut,"system",{get:function(){if(!rut._system){var t=rut._system=new rut;t.autoStart=!0,t._protected=!0}return rut._system},enumerable:!0,configurable:!0}),rut);function rut(){var e=this;this._head=new tut(null,null,
1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Lht.TARGET_FPMS,this.elapsedMS=1/Lht.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,
this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}nut.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),
Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,Jht.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){
e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?iut.shared:new iut,t.autoStart&&this.start()},nut.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function nut(){}var sut=(out.prototype.clone=function(
){return new out(this.x,this.y)},out.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},out.prototype.copyTo=function(t){return t.set(this.x,this.y),t},out.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},
out.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e},out);function out(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var aut=(hut.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(
e=this.scope),new hut(t,e,this._x,this._y)},hut.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},hut.prototype.copyFrom=function(t){
return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},hut.prototype.copyTo=function(t){return t.set(this._x,this._y),t},hut.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(
hut.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(hut.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(
this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),hut);function hut(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var uut,lut,cut=2*Math.PI,dut=180/Math.PI,put=Math.PI/180;(lut=uut=uut||{}
)[lut.POLY=0]="POLY",lut[lut.RECT=1]="RECT",lut[lut.CIRC=2]="CIRC",lut[lut.ELIP=3]="ELIP",lut[lut.RREC=4]="RREC";var fut=(mut.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},
mut.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},mut.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,
i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},mut.prototype.apply=function(t,e){e=e||new sut;var i=t.x,r=t.y
;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},mut.prototype.applyInverse=function(t,e){e=e||new sut;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,
e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},mut.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},mut.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},
mut.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},
mut.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},
mut.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},mut.prototype.prepend=function(t){
var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},
mut.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(cut-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),
t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},mut.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,
this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},mut.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},mut.prototype.clone=function(){var t=new mut;return t.a=this.a,t.b=this.b,t.c=this.c,
t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},mut.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},mut.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,
this.ty=t.ty,this},Object.defineProperty(mut,"IDENTITY",{get:function(){return new mut},enumerable:!0,configurable:!0}),Object.defineProperty(mut,"TEMP_MATRIX",{get:function(){return new mut},enumerable:!0,configurable:!0}),mut);function mut(t,e,i,r,n,s){
void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}var _ut=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],yut=[0,1,1,1,0,-1,-1,-1,0,1
,1,1,0,-1,-1,-1],vut=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],gut=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],xut=[],but=[],Tut=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];xut.push(e);for(var i=0;i<16;i++)for(var r=Tut(_ut[t]*_ut[i]+vut[t]*yut[i]),
n=Tut(yut[t]*_ut[i]+gut[t]*yut[i]),s=Tut(_ut[t]*vut[i]+vut[t]*gut[i]),o=Tut(yut[t]*vut[i]+gut[t]*gut[i]),a=0;a<16;a++)if(_ut[a]===r&&yut[a]===n&&vut[a]===s&&gut[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new fut;h.set(_ut[t],yut[t],vut[t],gut[t],0,0
),but.push(h)}}();var Eut={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return _ut[t]},uY:function(t){return yut[t]},vX:function(t){return vut[t]},vY:function(t){
return gut[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return xut[t][e]},sub:function(t,e){return xut[t][Eut.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t
)<=Math.abs(e)?0<=e?Eut.S:Eut.N:2*Math.abs(e)<=Math.abs(t)?0<t?Eut.E:Eut.W:0<e?0<t?Eut.SE:Eut.SW:0<t?Eut.NE:Eut.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=but[Eut.inv(e)];n.tx=i,n.ty=r,t.append(n)}},wut=(
Aut.prototype.onChange=function(){this._localID++},Aut.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(
this._rotation-this.skew.x),this._localID++},Aut.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,
t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},Aut.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(
this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,
r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},Aut.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(Aut.prototype,"rotation",{get:function(){
return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,configurable:!0}),Aut.IDENTITY=new Aut,Aut);function Aut(){this.worldTransform=new fut,this.localTransform=new fut,this.position=new aut(
this.onChange,this,0,0),this.scale=new aut(this.onChange,this,1,1),this.pivot=new aut(this.onChange,this,0,0),this.skew=new aut(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,
this._worldID=0,this._parentID=0}var Sut=(Object.defineProperty(Iut.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Iut.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,
configurable:!0}),Object.defineProperty(Iut.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Iut.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),
Object.defineProperty(Iut,"EMPTY",{get:function(){return new Iut(0,0,0,0)},enumerable:!0,configurable:!0}),Iut.prototype.clone=function(){return new Iut(this.x,this.y,this.width,this.height)},Iut.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y
,this.width=t.width,this.height=t.height,this},Iut.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},Iut.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0
)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},Iut.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},Iut.prototype.fit=function(t){var e=Math.max(this.x,
t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},Iut.prototype.ceil=function(t,e){void 0===t&&(t=1),
void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},
Iut.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},Iut);function Iut(t,e,i
,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=uut.RECT}Cut.prototype.clone=function(){return new Cut(this.x,this.y,this.radius)},
Cut.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},Cut.prototype.getBounds=function(){return new Sut(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius
)};function Cut(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=uut.CIRC}Out.prototype.clone=function(){return new Out(this.x,this.y,this.width,this.height)},Out.prototype.contains=function(t,e){if(
this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},Out.prototype.getBounds=function(){return new Sut(this.x-this.width,this.y-this.height,this.width,this.height)};function Out(t,e,i,r){
void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=uut.ELIP}Rut.prototype.clone=function(){var t=new Rut(this.points.slice());return t.closeStroke=this.closeStroke,t},
Rut.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function Rut(){for(
var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),e[0]instanceof sut){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=uut.POLY,this.closeStroke=!0}
Put.prototype.clone=function(){return new Put(this.x,this.y,this.width,this.height,this.radius)},Put.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function Put(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=uut.RREC}Lht.SORTABLE_CHILDREN=!1;function Mut(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}
Mut.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Mut.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Mut.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?Sut.EMPTY:((t=t||new Sut(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Mut.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),
this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Mut.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2]
)<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},Mut.prototype.addFrame=function(t,e,i,r,n){
this.addFrameMatrix(t.worldTransform,e,i,r,n)},Mut.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(
m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},
Mut.prototype.addVertexData=function(t,e,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},
Mut.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},Mut.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,
m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},Mut.prototype.addBounds=function(t){var e=this.minX,i=this.minY,
r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},Mut.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,
n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},Mut.prototype.addBoundsMatrix=function(t,e){
this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},Mut.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){
var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},Mut.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},
Mut.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var Nut=function(t){function n(){t.call(this),
this.tempDisplayObjectParent=null,this.transform=new wut,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,
this._bounds=new Mut,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{
configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},
zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r
,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){
this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),
this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(
this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Sut),e=this._boundsRect),
this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new Sut),
t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),
this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(
!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),
void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){
this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,
this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},
e.worldTransform.get=function(){return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){
this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)
},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){
return this.transform.rotation*dut},e.angle.set=function(t){this.transform.rotation=t*put},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){
var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){
var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(n.prototype,e),n}(X.a);function Lut(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}
Nut.prototype.displayObjectUpdateTransform=Nut.prototype.updateTransform;var Fut=function(n){function t(){n.call(this),this.children=[],this.sortableChildren=Lht.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},
height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]
);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)
;return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,
t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e)
;this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},
t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Bht(this.children,i,1),this.children.splice(e,0,t),
this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(
1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,Bht(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit(
"childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Bht(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit(
"childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(
i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError(
"removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}
t&&1<this.children.length&&this.children.sort(Lut),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(
var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)
}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0
)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush()
;var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,
this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()
},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},
e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},
e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(t.prototype,e),t}(Nut);Fut.prototype.containerUpdateTransform=Fut.prototype.updateTransform;function Dut(t,e){void 0===t&&(t=0),
void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Pht("setRealSize",2),this.onUpdate=new Pht("update"),this.onError=new Pht("onError",1)}var Uut={valid:{configurable:!0},width:{configurable:!0},height:{
configurable:!0}};Dut.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},Dut.prototype.unbind=function(t){this.onResize.remove(t),
this.onUpdate.remove(t),this.onError.remove(t)},Dut.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},Uut.valid.get=function(){return!!this._width&&!!this._height},
Dut.prototype.update=function(){this.destroyed||this.onUpdate.run()},Dut.prototype.load=function(){return Promise.resolve()},Uut.width.get=function(){return this._width},Uut.height.get=function(){return this._height},Dut.prototype.upload=function(t,e,i){
return!1},Dut.prototype.style=function(t,e,i){return!1},Dut.prototype.dispose=function(){},Dut.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),
this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(Dut.prototype,Uut);var But=function(r){function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),
this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),
0===t.indexOf("data:"))return"";e=e||window.location,(Kht=Kht||document.createElement("a")).href=t;var i=!(t=H.a.parse(Kht.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(
t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===bht.UNPACK),
this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){
var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(Dut),
kut=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,
this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==e.createBitmap?e.createBitmap:Lht.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(
this.createBitmap=t),this._load||(this._load=new Promise(function(t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e(
):(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(
this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===bht.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),
this._process):Promise.resolve(this)},t.prototype.upload=function(t,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1
;if(o.prototype.upload.call(this,t,e,i,this.bitmap),!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},
t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(But),Xut=[];function Gut(t,e){if(!t)return null
;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=Xut.length-1;0<=n;--n){var s=Xut[n];if(s.test&&s.test(t,i))return new s(t,e)}return new kut(t,e)}var Vut=function(s){function t(t,e){var i=e||{},
r=i.width,n=i.height;if(!r||!n)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl
;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===bht.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,
i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(Dut),jut={scaleMode:mht.NEAREST,
format:uht.RGBA,alphaMode:bht.NPM},Hut=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,
c=e.target,d=e.resolution,p=e.resourceOptions;!t||t instanceof Dut||((t=Gut(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||Lht.RESOLUTION,this.mipmap=void 0!==r?r:Lht.MIPMAP_TEXTURES,
this.anisotropicLevel=void 0!==n?n:Lht.ANISOTROPIC_LEVEL,this.wrapMode=h||Lht.WRAP_MODE,this.scaleMode=void 0!==s?s:Lht.SCALE_MODE,this.format=u||uht.RGBA,this.type=l||pht.UNSIGNED_BYTE,this.target=c||cht.TEXTURE_2D,this.alphaMode=void 0!==i?i:bht.UNPACK,
void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.uid=Xht(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,
this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{
configurable:!0}};return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i
;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,
this._refreshPOT(),this.update(),this},o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){
this.isPowerOfTwo=Vht(this.realWidth)&&Vht(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),
this._refreshPOT()),this},o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(
this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){
this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete zht[this.cacheId],delete Yht[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),
this.textureCacheIds=null,this.destroyed=!0},o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=Lht.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Xht()),t._pixiId)
;var s=zht[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new Vut(t,{width:e,height:i}),
s=t instanceof Float32Array?pht.FLOAT:pht.UNSIGNED_BYTE;return new o(n,Object.assign(jut,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),zht[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),zht[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=zht[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete zht[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete zht[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);Hut._globalBatch=0;var Yut=function(a){function t(t,
e){var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new Hut;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(Gut(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=cht.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(Dut),
zut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(But),
Wut=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=cht.TEXTURE_CUBE_MAP_POSITIVE_X+i
;!1!==e.autoLoad&&this.load()}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=cht.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(
var r=this.itemDirtyIds,n=0;n<o.SIDES;n++){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(Yut);Wut.SIDES=6;var qut=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),
this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((
r.prototype=Object.create(i&&i.prototype)).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(
!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,
this.svg,this._crossorigin),o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them."
);var i=t*s.scale,r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+Xht(),
n.getContext("2d").drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(But)
;qut.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Kut=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=iut.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(iut.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(iut.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&iut.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(iut.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(iut.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(But);Kut.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var Zut=function(t){function e(){t.apply(
this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(But);Xut.push(kut,Zut,zut,Kut,qut,Vut,Wut,Yut);function Jut(t){
this.renderer=t}Jut.prototype.destroy=function(){this.renderer=null};function Qut(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,
this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Pht("disposeFramebuffer",2)}var $ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e
).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===bht.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(
i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(Vut),tlt={colorTexture:{configurable:!0}};tlt.colorTexture.get=function(){return this.colorTextures[0]},
Qut.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Hut(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},
Qut.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Hut(new $ut(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:uht.DEPTH_COMPONENT,type:pht.UNSIGNED_SHORT}),
this.dirtyId++,this.dirtyFormat++,this},Qut.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Qut.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},
Qut.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution
;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},Qut.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(Qut.prototype,tlt);function elt(){this.x0=0,
this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}var ilt=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]})
;n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new Qut(this.width*this.resolution,
this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),
this.framebuffer.resize(t*this.resolution,e*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(Hut)
;elt.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=Eut.add(i,Eut.NW),this.x0=a+s*Eut.uX(i),this.y0=h+o*Eut.uY(i),i=Eut.add(i,2),this.x1=a+s*Eut.uX(i),this.y1=h+o*Eut.uY(i),i=Eut.add(i,2
),this.x2=a+s*Eut.uX(i),this.y2=h+o*Eut.uY(i),i=Eut.add(i,2),this.x3=a+s*Eut.uX(i),this.y3=h+o*Eut.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(
t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var rlt=new elt,
nlt=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new Sut(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=rlt,
this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new sut(s.x,s.y):new sut(0,0),
this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={
resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){
this.baseTexture.resource&&this.baseTexture.resource.update()},a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()
}else this.frame=this._frame;this.emit("update",this)},a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&Yht[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",
this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,
this.orig,this.trim,this.rotate,this.defaultAnchor)},a.prototype.updateUvs=function(){this._uvs===rlt&&(this._uvs=new elt),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(
i=Lht.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+Xht()),t._pixiId);var s=Yht[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(
e.resolution=Zht(t)),(s=new a(new Hut(t,e))).baseTexture.cacheId=n,Hut.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(Hut.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new kut(t);r.url=e
;var n=new a(new Hut(r,{scaleMode:Lht.SCALE_MODE,resolution:Zht(e)}));return i=i||e,Hut.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(Hut.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(
-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Yht[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Yht[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=Yht[t];if(e){
var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Yht[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Yht[t.textureCacheIds[r]]===t&&delete Yht[t.textureCacheIds[r]]
;return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,
s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error(
"Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},
t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function slt(t){t.destroy=function(){},
t.on=function(){},t.once=function(){},t.emit=function(){}}nlt.EMPTY=new nlt(new Hut),slt(nlt.EMPTY),slt(nlt.EMPTY.baseTexture),nlt.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d")
;return e.fillStyle="white",e.fillRect(0,0,16,16),new nlt(new Hut(new zut(t)))}(),slt(nlt.WHITE),slt(nlt.WHITE.baseTexture);function olt(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}
var alt=function(a){function n(t,e){var i=null;if(!(t instanceof ilt)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn("Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,
t=new ilt({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n
).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},
n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new ilt(t))},n
}(nlt);olt.prototype.createTexture=function(t,e){var i=new ilt(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new alt(i)},olt.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=olt.SCREEN_KEY;t*=i,e*=i,
this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=Ght(t)))<<16|65535&(e=Ght(e))),this.texturePool[r]||(this.texturePool[r]=[]);var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,
n.setResolution(i),n},olt.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},olt.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,
this.texturePool[e].push(t)},olt.prototype.returnFilterTexture=function(t){this.returnTexture(t)},olt.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}
this.texturePool={}},olt.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=olt.SCREEN_KEY,i=this.texturePool[e];if(this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++
)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},olt.SCREEN_KEY="screen";function hlt(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,
this.stride=n,this.start=s,this.instance=o}hlt.prototype.destroy=function(){this.buffer=null},hlt.from=function(t,e,i,r,n){return new hlt(t,e,i,r,n)};function ult(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),
this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=llt++,this.disposeRunner=new Pht("disposeBuffer",2)}var llt=0;function clt(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}ult.prototype.update=function(t){this.data=t||this.data,this._updateID++},ult.prototype.dispose=function(){this.disposeRunner.run(this,!1)},ult.prototype.destroy=function(){this.dispose(),this.data=null},ult.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new ult(t)};var dlt={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function plt(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=mlt++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Pht("disposeGeometry",2),this.refCount=0}var flt={5126:4,5123:2,5121:1},mlt=0,_lt={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};plt.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new ult(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new hlt(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},plt.prototype.getAttribute=function(t){return this.attributes[t]},plt.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},plt.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new ult(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
plt.prototype.getIndex=function(){return this.indexBuffer},plt.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new ult;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*flt[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=clt(c
);n[d]||(n[d]=new dlt[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},plt.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},plt.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},plt.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},plt.prototype.clone=function(){for(var t=new plt,e=0;e<this.buffers.length;e++)t.buffers[e]=new ult(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new hlt(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},plt.merge=function(t){for(var e,i=new plt,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(_lt[clt(e.buffers[h].data)])(n[h]),i.buffers[h]=new ult(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*flt[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function ylt(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=xlt++,this.static=!!e}var vlt=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(plt)
,glt=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ult(this.vertices),this.uvBuffer=new ult(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(plt),xlt=0
;ylt.prototype.update=function(){this.dirtyId++},ylt.prototype.add=function(t,e,i){this.uniforms[t]=new ylt(e,i)},ylt.from=function(t,e){return new ylt(t,e)};function blt(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new Sut,this.destinationFrame=new Sut,this.filters=[]}blt.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function Tlt(t){this.renderer=t}var Elt=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new olt,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new vlt,this.quadUv=new glt,this.tempRect=new Sut,this.activeState={},this.globalUniforms=new ylt({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new blt,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(aht.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(aht.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
fut.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(Jut);Tlt.prototype.flush=function(){},Tlt.prototype.destroy=function(){this.renderer=null},Tlt.prototype.start=function(){},Tlt.prototype.stop=function(){this.flush()},Tlt.prototype.render=function(t){};var wlt=function(e){
function t(t){e.call(this,t),this.emptyRenderer=new Tlt(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(Jut);Lht.PREFER_ENV=u.a.any?eht.WEBGL:eht.WEBGL2,
Lht.STRICT_TEXTURE_CACHE=!1;function Alt(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function Slt(t){this.type=Iht.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,
this._scissorCounter=0,this._scissorRect=null,this._target=null}var Ilt=0,Clt=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),
this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(
t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,
this.renderer.CONTEXT_UID=Ilt++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,
this.renderer.CONTEXT_UID=Ilt++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(
Lht.PREFER_ENV>=eht.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error(
"This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension(
"WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension(
"WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension(
"OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension(
"EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){t.preventDefault()},
t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener(
"webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(Jut),Olt=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new Qut(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Sut,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Lht.PREFER_ENV===eht.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Sut},Object.defineProperties(t.prototype,i),t}(Jut),Rlt={5126:4,5123:2,5121:1},
Plt=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e)
,((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;Lht.PREFER_ENV===eht.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*Rlt[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*Rlt[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*Rlt[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new Alt(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,
e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(Jut);function Mlt(t,e,i,r){var n=Nlt(t,t.VERTEX_SHADER,e),s=Nlt(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Nlt(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function Llt(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Flt(2*e)
;case"bvec3":return Flt(3*e);case"bvec4":return Flt(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Flt(t
){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}Slt.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Iht.NONE,this.autoDetect=!0),this._target=null},Slt.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var Dlt,Ult={},Blt=Ult;function klt(){if(
Blt===Ult||Blt&&Blt.isContextLost()){var t,e=document.createElement("canvas");Lht.PREFER_ENV>=eht.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),
Blt=t}return Blt}function Xlt(t,e,i){if("precision"===t.substring(0,9))return i!==Aht.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===Aht.HIGH&&i!==Aht.HIGH&&(r=Aht.MEDIUM),
"precision "+r+" float;\n"+t}var Glt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var Vlt=null,jlt={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",
INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",
SAMPLER_2D_ARRAY:"sampler2DArray"};function Hlt(t,e){if(!Vlt){var i=Object.keys(jlt);Vlt={};for(var r=0;r<i.length;++r){var n=i[r];Vlt[t[n]]=jlt[n]}}return Vlt[e]}var Ylt={
float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},zlt={
float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",
mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",
bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Wlt,qlt=["precision mediump float;","void main(void){",
"float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Klt(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function Zlt(t,e,i){void 0===i&&(i="pixi-shader"),this.id=Jlt++,
this.vertexSrc=t||Zlt.defaultVertexSrc,this.fragmentSrc=e||Zlt.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Qlt[i]?(Qlt[i]++,
i+="-"+Qlt[i]):Qlt[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Xlt(this.vertexSrc,Lht.PRECISION_VERTEX,Aht.HIGH),this.fragmentSrc=Xlt(this.fragmentSrc,
Lht.PRECISION_FRAGMENT,function(){if(!Dlt){Dlt=Aht.MEDIUM;var t=klt();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Dlt=e.precision?Aht.HIGH:Aht.MEDIUM}}return Dlt}())),this.extractData(this.vertexSrc,
this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}var Jlt=0,Qlt={},$lt={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Zlt.prototype.extractData=function(t,e){var i=klt();if(i){var r=Mlt(i,t,e)
;this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},Zlt.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,
e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){var a=e.getActiveAttrib(t,o),h=Hlt(e,a.type),u={type:h,name:a.name,size:(i=h,Glt[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
Zlt.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=Hlt(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:Llt(h,s.size)}}return i},$lt.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},$lt.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},Zlt.from=function(t,e,i){var r=t+e,n=Hht[r];return n||(
Hht[r]=n=new Zlt(t,e,i)),n},Object.defineProperties(Zlt,$lt);function tct(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof ylt?e:new ylt(e):new ylt({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(
this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))}var ect={uniforms:{configurable:!0}};tct.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(
r.group&&this.checkUniformExists(t,r))return!0}return!1},tct.prototype.destroy=function(){this.uniformGroup=null},ect.uniforms.get=function(){return this.uniformGroup.uniforms},tct.from=function(t,e,i){var r=Zlt.from(t,e);return new tct(r,i)},
Object.defineProperties(tct.prototype,ect);function ict(){this.data=0,this.blendMode=sht.NORMAL,this.polygonOffset=0,this.blend=!0}var rct={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},
clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};rct.blend.get=function(){return!!(1&this.data)},rct.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},rct.offsets.get=function(){return!!(
2&this.data)},rct.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},rct.culling.get=function(){return!!(4&this.data)},rct.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},rct.depthTest.get=function(){return!!(8&this.data)},
rct.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},rct.clockwiseFrontFace.get=function(){return!!(16&this.data)},rct.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},rct.blendMode.get=function(){
return this._blendMode},rct.blendMode.set=function(t){this.blend=t!==sht.NONE,this._blendMode=t},rct.polygonOffset.get=function(){return this._polygonOffset},rct.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},ict.for2d=function(){
var t=new ict;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(ict.prototype,rct);var nct=function(n){function s(t,e,i){var r=Zlt.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,
this.resolution=Lht.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new ict}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},
defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){
this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(tct);nct.SOURCE_KEY_MAP={};function sct(t,e){this._texture=t,this.mapCoord=new fut,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var oct=new fut,act={texture:{configurable:!0}};act.texture.get=function(){return this._texture},act.texture.set=function(t){this._texture=t,this._updateID=-1},sct.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,
r=0;r<t.length;r+=2){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},sct.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID
;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(oct.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(oct));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(sct.prototype,act);function hct(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var uct=function(
i){function t(t){var e=new fut;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new sct(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(nct),lct=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new Slt;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case Iht.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case Iht.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case Iht.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Iht.SCISSOR:this.renderer.scissor.pop();break;case Iht.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Iht.SPRITE:this.popSpriteMask()}e.reset(),
e.pooled&&this.maskDataPool.push(e)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Iht.SPRITE;else if(t.type=Iht.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(
i.d,i.c);r=Math.round(r*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=Iht.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,
r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(this.alphaMaskPool[this.alphaMaskIndex]=[new uct(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,
this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(Jut),cct=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(
e&&e.prototype)).constructor=t).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(
this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(Jut),dct=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(cct),pct=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),
i.enable(i.STENCIL_TEST)),t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()
},t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(cct),fct=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new fut,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(Jut),mct=new Sut,_ct=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new Sut,this.destinationFrame=new Sut}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||(mct.width=s.realWidth,mct.height=s.realHeight,i=mct),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
mct.width=n.width,mct.height=n.height,i=mct),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(Jut)
;hct.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var yct=0,vct=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=yct++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Wlt)return Wlt;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;"
);Wlt=!0===t({a:"b"},"a","b")}catch(t){Wlt=!1}return Wlt}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?Ylt:zlt)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=Mlt(e,i.vertexSrc,i.fragmentSrc,r)
,o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Llt(h.type,h.size)}}var u=new hct(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,
this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(Jut);function gct(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}
var xct=function(e){function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=sht.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,
this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new ict,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i
).prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[sht.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.ADD]=[t.ONE,t.ONE],e[sht.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[sht.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[sht.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.HUE]=[
t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.NONE]=[0,0],e[sht.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[sht.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[sht.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[sht.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[sht.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[sht.SRC_ATOP]=[
t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[sht.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[sht.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[sht.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[sht.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[sht.XOR]=[t.ONE_MINUS_DST_ALPHA,
t.ONE_MINUS_SRC_ALPHA],e[sht.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,
i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this
,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t);this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){
this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](
this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]
):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){
this.gl.polygonOffset(t,e)},i.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t)
;e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(Jut),bct=function(e){function t(t){e.call(this,t),
this.count=0,this.checkCount=0,this.maxIdle=Lht.GC_MAX_IDLE,this.checkCountMax=Lht.GC_MAX_CHECK_COUNT,this.mode=Lht.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){
this.renderer.renderingToScreen&&(this.count++,this.mode!==Eht.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,
r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){
var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(Jut),Tct=function(e){function t(t){e.call(this,t),this.boundTextures=[],
this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Hut}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null
;this.emptyTextures={};var r=new gct(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,
this.emptyTextures[t.TEXTURE_CUBE_MAP]=new gct(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null)
;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0)
;var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(
i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(
this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(
var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++
)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},
t.prototype.initTexture=function(t){var e=new gct(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(
e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===pht.HALF_FLOAT&&(e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(
e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(
e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e
){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){
var r=this.managedTextures.indexOf(t);-1!==r&&Bht(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==ght.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,
2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=yht.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(
e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,
t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===mht.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(Jut),Ect=new fut;X.a;function wct(){this.texArray=null,this.blend=0,this.type=aht.TRIANGLES,this.start=0,this.size=0,this.data=null}function Act(){this.elements=[],this.ids=[],this.count=0}Act.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function Sct(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var Ict={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};Ict.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},Ict.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},Ict.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},Ict.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},Ict.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Sct.prototype.view=function(t){
return this[t+"View"]},Sct.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Sct.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Sct.prototype,Ict);var Cct=function(e){function _(t
){e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=ict.for2d(),this.size=4*Lht.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;Lht.PREFER_ENV===eht.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Lht.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=qlt.replace(/%forloop%/gi,Klt(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}
return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},
_.prototype.initFlushBuffers=function(){for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new wct);for(;e.length<r;)e.push(new Act);for(var n=0;n<this.MAX_TEXTURES;n++
)this._tempBoundTextures[n]=null},_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,
this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,
i=_._textureArrayPool,r=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++Hut._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(
r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null
;Hut._globalBatch=o},_.prototype.buildDrawCalls=function(t,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,
c.texArray=t;for(var d=e;d<i;++d){var p=r[d],f=p._texture.baseTexture,m=Uht[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o
,l+=p.indices.length,c.blend=m}e<i&&(c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null
;t.count=0},_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;Lht.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Lht.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=Ght(Math.ceil(t/8)),i=jht(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Sct(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=Ght(Math.ceil(t/12)),i=jht(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(Tlt);Cct._drawCallPool=[],Cct._textureArrayPool=[]
;function Oct(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}Oct.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=ylt.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Zlt(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new fut,default:this.defaultGroupCache[t]};return new tct(this.programCache[t],n)}
,Oct.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function Rct(){}var Pct=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new ult(null,t,!1),this._indexBuffer=new ult(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,pht.FLOAT).addAttribute("aTextureCoord",
this._buffer,2,!1,pht.FLOAT).addAttribute("aColor",this._buffer,4,!0,pht.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,pht.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t
}(plt),
Mct="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,Nct="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Lct={defaultVertexSrc:{configurable:!0
},defaultFragmentTemplate:{configurable:!0}};Rct.create=function(t){var e=Object.assign({vertex:Mct,fragment:Nct,geometryClass:Pct,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new Oct(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Cct)},Lct.defaultVertexSrc.get=function(){return Mct},Lct.defaultFragmentTemplate.get=function(){
return Nct},Object.defineProperties(Rct,Lct);Rct.create();var Fct=function(n){function t(t,e,i,r){void 0===t&&(t=100),void 0===e&&(e=100),void 0===i&&(i=10),void 0===r&&(r=10),n.call(this),this.segWidth=i,this.segHeight=r,this.width=t,this.height=e,
this.build()}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],i=[],r=[],n=this.segWidth-1,s=this.segHeight-1,o=this.width/n,a=this.height/s,
h=0;h<t;h++){var u=h%this.segWidth,l=h/this.segWidth|0;e.push(u*o,l*a),i.push(u/n,l/s)}for(var c=n*s,d=0;d<c;d++){var p=d%n,f=d/n|0,m=f*this.segWidth+p,_=f*this.segWidth+p+1,y=(1+f)*this.segWidth+p,v=(1+f)*this.segWidth+p+1;r.push(m,_,y,_,v,y)}
this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},t}(Rht),Dct=function(r){function t(t,e,i){void 0===t&&(
t=200),void 0===i&&(i=0),r.call(this,new Float32Array(4*e.length),new Float32Array(4*e.length),new Uint16Array(6*(e.length-1))),this.points=e,this.width=t,this.textureScale=i,this.build()}return r&&(t.__proto__=r),((t.prototype=Object.create(
r&&r.prototype)).constructor=t).prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(
4*t.length),i.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var n=i.data,s=r.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;for(var o=0,a=t[0],h=this.width*this.textureScale,u=t.length,l=0;l<u;l++){var c=4*l;if(0<this.textureScale){
var d=a.x-t[l].x,p=a.y-t[l].y,f=Math.sqrt(d*d+p*p);a=t[l],o+=f/h}else o=l/(u-1);n[c]=o,n[1+c]=0,n[2+c]=o,n[3+c]=1}for(var m=0,_=0;_<u-1;_++){var y=2*_;s[m++]=y,s[m++]=1+y,s[m++]=2+y,s[m++]=2+y,s[m++]=1+y,s[m++]=3+y}i.update(),r.update(),
this.updateVertices()}}},t.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,i=t[0],r=0,n=0,s=this.buffers[0].data,o=t.length,a=0;a<o;a++){var h=t[a],u=4*a;n=-((e=a<t.length-1?t[a+1]:h).x-i.x),r=e.y-i.y;var l=Math.sqrt(
r*r+n*n),c=0<this.textureScale?this.textureScale*this.width/2:this.width/2;r/=l,n/=l,r*=c,n*=c,s[u]=h.x+r,s[1+u]=h.y+n,s[2+u]=h.x-r,s[3+u]=h.y-n,i=h}this.buffers[0].update()}},t.prototype.update=function(){0<this.textureScale?this.build(
):this.updateVertices()},t}(Rht),Uct=function(s){function t(t,e,i){void 0===i&&(i=0);var r=new Dct(t.height,e,i),n=new Oht(t);0<i&&(t.baseTexture.wrapMode=yht.REPEAT),s.call(this,r,n),this.autoUpdate=!0}return s&&(t.__proto__=s),((
t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype._render=function(t){!this.autoUpdate&&this.geometry.width===this.shader.texture.height||(this.geometry.width=this.shader.texture.height,this.geometry.update()),s.prototype._render.call(
this,t)},t}(tht),Bct=function(s){function t(t,e,i){var r=new Fct(t.width,t.height,e,i),n=new Oht(nlt.WHITE);s.call(this,r,n),this.texture=t}s&&(t.__proto__=s);var e={texture:{configurable:!0}};return((t.prototype=Object.create(s&&s.prototype)
).constructor=t).prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this.geometry.width=this.shader.texture.width,this.geometry.height=this.shader.texture.height,this.geometry.build()},e.texture.set=function(t){
this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},e.texture.get=function(){return this.shader.texture},t.prototype._render=function(t){
this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),s.prototype._render.call(this,t)},Object.defineProperties(t.prototype,e),t}(tht),kct=function(a){function t(t,e,i,r,n){void 0===t&&(t=nlt.EMPTY);var s=new Rht(e,i,r);s.getBuffer(
"aVertexPosition").static=!1;var o=new Oht(t);a.call(this,s,o,null,n),this.autoUpdate=!0}a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t;var e={vertices:{configurable:!0}};return e.vertices.get=function(){
return this.geometry.getBuffer("aVertexPosition").data},e.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},t.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),
a.prototype._render.call(this,t)},Object.defineProperties(t.prototype,e),t}(tht),Xct=function(s){function t(t,e,i,r,n){s.call(this,nlt.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,
this._height=this._origHeight,this._leftWidth=void 0!==e?e:10,this._rightWidth=void 0!==r?r:10,this._topHeight=void 0!==i?i:10,this._bottomHeight=void 0!==n?n:10,this.texture=t}s&&(t.__proto__=s);var e={vertices:{configurable:!0},width:{configurable:!0},
height:{configurable:!0},leftWidth:{configurable:!0},rightWidth:{configurable:!0},topHeight:{configurable:!0},bottomHeight:{configurable:!0}};return((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.textureUpdated=function(){
this._textureID=this.shader.texture._updateID,this._refresh()},e.vertices.get=function(){return this.geometry.getBuffer("aVertexPosition").data},e.vertices.set=function(t){this.geometry.getBuffer("aVertexPosition").data=t},
t.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._topHeight+this._bottomHeight,i=this._height>e?1:this._height/e;t[9]=t[11]=t[13]=t[15]=this._topHeight*i,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*i,
t[25]=t[27]=t[29]=t[31]=this._height},t.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._leftWidth+this._rightWidth,i=this._width>e?1:this._width/e;t[2]=t[10]=t[18]=t[26]=this._leftWidth*i,
t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*i,t[6]=t[14]=t[22]=t[30]=this._width},e.width.get=function(){return this._width},e.width.set=function(t){this._width=t,this._refresh()},e.height.get=function(){return this._height},e.height.set=function(
t){this._height=t,this._refresh()},e.leftWidth.get=function(){return this._leftWidth},e.leftWidth.set=function(t){this._leftWidth=t,this._refresh()},e.rightWidth.get=function(){return this._rightWidth},e.rightWidth.set=function(t){this._rightWidth=t,
this._refresh()},e.topHeight.get=function(){return this._topHeight},e.topHeight.set=function(t){this._topHeight=t,this._refresh()},e.bottomHeight.get=function(){return this._bottomHeight},e.bottomHeight.set=function(t){this._bottomHeight=t,this._refresh()
},t.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var i=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,
e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices()
,this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},Object.defineProperties(t.prototype,e),t}(Bct),Gct=(Vct.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error(
"max arguments reached");var h=this.name,u=this.items;this._aliasCount++;for(var l=0,c=u.length;l<c;l++)u[l][h](t,e,i,r,n,s,o,a);return u===this.items&&this._aliasCount--,this},Vct.prototype.ensureNonAliasedItems=function(){
0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},Vct.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},Vct.prototype.remove=function(t){
var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},Vct.prototype.contains=function(t){return-1!==this.items.indexOf(t)},Vct.prototype.removeAll=function(){return this.ensureNonAliasedItems(),
this.items.length=0,this},Vct.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(Vct.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(
Vct.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Vct);function Vct(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(Gct.prototype,{dispatch:{value:Gct.prototype.emit},run:{
value:Gct.prototype.emit}});var jct,Hct,Yct,zct,Wct,qct,Kct,Zct,Jct,Qct,$ct,tdt,edt,idt,rdt,ndt,sdt,odt,adt,hdt,udt,ldt,cdt,ddt,pdt,fdt,mdt,_dt,ydt={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){
var e=!0;if(u.a.tablet||u.a.phone){if(e=!1,u.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(u.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)7<=parseInt(r[1],10)&&(
e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,
GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:u.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!u.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};(Hct=jct=jct||{}
)[Hct.WEBGL_LEGACY=0]="WEBGL_LEGACY",Hct[Hct.WEBGL=1]="WEBGL",Hct[Hct.WEBGL2=2]="WEBGL2",(zct=Yct=Yct||{})[zct.UNKNOWN=0]="UNKNOWN",zct[zct.WEBGL=1]="WEBGL",zct[zct.CANVAS=2]="CANVAS",(qct=Wct=Wct||{})[qct.NORMAL=0]="NORMAL",qct[qct.ADD=1]="ADD",
qct[qct.MULTIPLY=2]="MULTIPLY",qct[qct.SCREEN=3]="SCREEN",qct[qct.OVERLAY=4]="OVERLAY",qct[qct.DARKEN=5]="DARKEN",qct[qct.LIGHTEN=6]="LIGHTEN",qct[qct.COLOR_DODGE=7]="COLOR_DODGE",qct[qct.COLOR_BURN=8]="COLOR_BURN",qct[qct.HARD_LIGHT=9]="HARD_LIGHT",
qct[qct.SOFT_LIGHT=10]="SOFT_LIGHT",qct[qct.DIFFERENCE=11]="DIFFERENCE",qct[qct.EXCLUSION=12]="EXCLUSION",qct[qct.HUE=13]="HUE",qct[qct.SATURATION=14]="SATURATION",qct[qct.COLOR=15]="COLOR",qct[qct.LUMINOSITY=16]="LUMINOSITY",
qct[qct.NORMAL_NPM=17]="NORMAL_NPM",qct[qct.ADD_NPM=18]="ADD_NPM",qct[qct.SCREEN_NPM=19]="SCREEN_NPM",qct[qct.NONE=20]="NONE",qct[qct.SRC_OVER=0]="SRC_OVER",qct[qct.SRC_IN=21]="SRC_IN",qct[qct.SRC_OUT=22]="SRC_OUT",qct[qct.SRC_ATOP=23]="SRC_ATOP",
qct[qct.DST_OVER=24]="DST_OVER",qct[qct.DST_IN=25]="DST_IN",qct[qct.DST_OUT=26]="DST_OUT",qct[qct.DST_ATOP=27]="DST_ATOP",qct[qct.ERASE=26]="ERASE",qct[qct.SUBTRACT=28]="SUBTRACT",qct[qct.XOR=29]="XOR",(Zct=Kct=Kct||{})[Zct.POINTS=0]="POINTS",
Zct[Zct.LINES=1]="LINES",Zct[Zct.LINE_LOOP=2]="LINE_LOOP",Zct[Zct.LINE_STRIP=3]="LINE_STRIP",Zct[Zct.TRIANGLES=4]="TRIANGLES",Zct[Zct.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",Zct[Zct.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Qct=Jct=Jct||{})[Qct.RGBA=6408]="RGBA",
Qct[Qct.RGB=6407]="RGB",Qct[Qct.ALPHA=6406]="ALPHA",Qct[Qct.LUMINANCE=6409]="LUMINANCE",Qct[Qct.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Qct[Qct.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Qct[Qct.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(tdt=$ct=$ct||{}
)[tdt.TEXTURE_2D=3553]="TEXTURE_2D",tdt[tdt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",tdt[tdt.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",tdt[tdt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",
tdt[tdt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",tdt[tdt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",tdt[tdt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",
tdt[tdt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",tdt[tdt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(idt=edt=edt||{})[idt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",idt[idt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",
idt[idt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",idt[idt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",idt[idt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",idt[idt.FLOAT=5126]="FLOAT",idt[idt.HALF_FLOAT=36193]="HALF_FLOAT",(
ndt=rdt=rdt||{})[ndt.NEAREST=0]="NEAREST",ndt[ndt.LINEAR=1]="LINEAR",(odt=sdt=sdt||{})[odt.CLAMP=33071]="CLAMP",odt[odt.REPEAT=10497]="REPEAT",odt[odt.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(hdt=adt=adt||{})[hdt.OFF=0]="OFF",hdt[hdt.POW2=1]="POW2",
hdt[hdt.ON=2]="ON",(ldt=udt=udt||{})[ldt.NPM=0]="NPM",ldt[ldt.UNPACK=1]="UNPACK",ldt[ldt.PMA=2]="PMA",ldt[ldt.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ldt[ldt.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",
ldt[ldt.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(ddt=cdt=cdt||{})[ddt.AUTO=0]="AUTO",ddt[ddt.MANUAL=1]="MANUAL",(fdt=pdt=pdt||{}).LOW="lowp",fdt.MEDIUM="mediump",fdt.HIGH="highp",(_dt=mdt=mdt||{})[_dt.NONE=0]="NONE",_dt[_dt.SCISSOR=1]="SCISSOR",
_dt[_dt.STENCIL=2]="STENCIL",_dt[_dt.SPRITE=3]="SPRITE",ydt.RETINA_PREFIX=/@([0-9\.]+)x/;var vdt,gdt=!(ydt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),xdt="5.2.0";var bdt=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[Wct.NORMAL_NPM]=Wct.NORMAL,
t[Wct.ADD_NPM]=Wct.ADD,t[Wct.SCREEN_NPM]=Wct.SCREEN,e[Wct.NORMAL]=Wct.NORMAL_NPM,e[Wct.ADD]=Wct.ADD_NPM,e[Wct.SCREEN]=Wct.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function Tdt(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i)
;for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var Edt=0;function wdt(){return++Edt}function Adt(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Sdt(t){return!(t&t-1||!t)}function Idt(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3
;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var Cdt={},Odt=Object.create(null),Rdt=Object.create(null);function Pdt(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),
this.resolution=i||ydt.RESOLUTION,this.resize(t,e)}var Mdt={width:{configurable:!0},height:{configurable:!0}};Pdt.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},
Pdt.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},Pdt.prototype.destroy=function(){this.context=null,this.canvas=null},Mdt.width.get=function(){return this.canvas.width},Mdt.width.set=function(t){
this.canvas.width=t},Mdt.height.get=function(){return this.canvas.height},Mdt.height.set=function(t){this.canvas.height=t},Object.defineProperties(Pdt.prototype,Mdt);var Ndt;function Ldt(t,e){var i=ydt.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]
):void 0!==e?e:1}var Fdt,Ddt,Udt={};ydt.TARGET_FPMS=.06,(Ddt=Fdt=Fdt||{})[Ddt.INTERACTION=50]="INTERACTION",Ddt[Ddt.HIGH=25]="HIGH",Ddt[Ddt.NORMAL=0]="NORMAL",Ddt[Ddt.LOW=-25]="LOW",Ddt[Ddt.UTILITY=-50]="UTILITY";var Bdt=(kdt.prototype.match=function(t,e
){return void 0===e&&(e=null),this.fn===t&&this.context===e},kdt.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},
kdt.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},kdt.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(
this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},kdt);function kdt(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,
this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var Xdt=(Gdt.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,
this._requestId=requestAnimationFrame(this._tick))},Gdt.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Gdt.prototype._startIfPossible=function(){
this.started?this._requestIfNeeded():this.autoStart&&this.start()},Gdt.prototype.add=function(t,e,i){return void 0===i&&(i=Fdt.NORMAL),this._addListener(new Bdt(t,e,i))},Gdt.prototype.addOnce=function(t,e,i){return void 0===i&&(i=Fdt.NORMAL),
this._addListener(new Bdt(t,e,i,!0))},Gdt.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i)
;return this._startIfPossible(),this},Gdt.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Gdt.prototype.start=function(){this.started||(this.started=!0,
this._requestIfNeeded())},Gdt.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Gdt.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),
this._head=null}},Gdt.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(
i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ydt.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()
}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(Gdt.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(Gdt.prototype,"minFPS",{get:function(){
return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,ydt.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!0,configurable:!0}),Object.defineProperty(Gdt.prototype,"maxFPS",{get:function(){
return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(Gdt,"shared",{
get:function(){if(!Gdt._shared){var t=Gdt._shared=new Gdt;t.autoStart=!0,t._protected=!0}return Gdt._shared},enumerable:!0,configurable:!0}),Object.defineProperty(Gdt,"system",{get:function(){if(!Gdt._system){var t=Gdt._system=new Gdt;t.autoStart=!0,
t._protected=!0}return Gdt._system},enumerable:!0,configurable:!0}),Gdt);function Gdt(){var e=this;this._head=new Bdt(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,
this.deltaMS=1/ydt.TARGET_FPMS,this.elapsedMS=1/ydt.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),
e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}Vdt.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){
this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,Fdt.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,
this.ticker=t.sharedTicker?Xdt.shared:new Xdt,t.autoStart&&this.start()},Vdt.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};function Vdt(){}var jdt=(Hdt.prototype.clone=function(){return new Hdt(this.x,this.y)},
Hdt.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},Hdt.prototype.copyTo=function(t){return t.set(this.x,this.y),t},Hdt.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},Hdt.prototype.set=function(t,e){void 0===t&&(t=0),
void 0===e&&(e=t),this.x=t,this.y=e},Hdt);function Hdt(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}var Ydt=(zdt.prototype.clone=function(t,e){return void 0===t&&(t=this.cb),void 0===e&&(e=this.scope),new zdt(t,e,this._x,this._y)},
zdt.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope))},zdt.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(
this.scope)),this},zdt.prototype.copyTo=function(t){return t.set(this._x,this._y),t},zdt.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(zdt.prototype,"x",{get:function(){return this._x},set:function(t){
this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(zdt.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),
zdt);function zdt(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var Wdt,qdt,Kdt=2*Math.PI,Zdt=180/Math.PI,Jdt=Math.PI/180;(qdt=Wdt=Wdt||{})[qdt.POLY=0]="POLY",qdt[qdt.RECT=1]="RECT",qdt[qdt.CIRC=2]="CIRC",
qdt[qdt.ELIP=3]="ELIP",qdt[qdt.RREC=4]="RREC";var Qdt=($dt.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},$dt.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,
this.tx=n,this.ty=s,this},$dt.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,
i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},$dt.prototype.apply=function(t,e){e=e||new jdt;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},$dt.prototype.applyInverse=function(t,e){
e=e||new jdt;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},$dt.prototype.translate=function(t,e){return this.tx+=t,
this.ty+=e,this},$dt.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},$dt.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,
this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},$dt.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,
this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},$dt.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(
i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},$dt.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,
this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},$dt.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(
Kdt-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},$dt.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,
r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},$dt.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},
$dt.prototype.clone=function(){var t=new $dt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},$dt.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},
$dt.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty($dt,"IDENTITY",{get:function(){return new $dt},enumerable:!0,configurable:!0}),Object.defineProperty($dt,
"TEMP_MATRIX",{get:function(){return new $dt},enumerable:!0,configurable:!0}),$dt);function $dt(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,
this.c=i,this.d=r,this.tx=n,this.ty=s}var tpt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ept=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ipt=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],rpt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],npt=[],spt=[],opt=Math.sign
;!function(){for(var t=0;t<16;t++){var e=[];npt.push(e);for(var i=0;i<16;i++)for(var r=opt(tpt[t]*tpt[i]+ipt[t]*ept[i]),n=opt(ept[t]*tpt[i]+rpt[t]*ept[i]),s=opt(tpt[t]*ipt[i]+ipt[t]*rpt[i]),o=opt(ept[t]*ipt[i]+rpt[t]*rpt[i]),a=0;a<16;a++)if(
tpt[a]===r&&ept[a]===n&&ipt[a]===s&&rpt[a]===o){e.push(a);break}}for(t=0;t<16;t++){var h=new Qdt;h.set(tpt[t],ept[t],ipt[t],rpt[t],0,0),spt.push(h)}}();var apt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,
REVERSE_DIAGONAL:14,uX:function(t){return tpt[t]},uY:function(t){return ept[t]},vX:function(t){return ipt[t]},vY:function(t){return rpt[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return npt[t][e]},sub:function(t,e){return npt[t][apt.inv(e
)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?apt.S:apt.N:2*Math.abs(e)<=Math.abs(t)?0<t?apt.E:apt.W:0<e?0<t?apt.SE:apt.SW:0<t?apt.NE:apt.NW},
matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=spt[apt.inv(e)];n.tx=i,n.ty=r,t.append(n)}},hpt=(upt.prototype.onChange=function(){this._localID++},upt.prototype.updateSkew=function(){this._cx=Math.cos(
this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},upt.prototype.updateLocalTransform=function(){var t=this.localTransform
;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(
this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},upt.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,
e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){
var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},
upt.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(upt.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!0,
configurable:!0}),upt.IDENTITY=new upt,upt);function upt(){this.worldTransform=new Qdt,this.localTransform=new Qdt,this.position=new Ydt(this.onChange,this,0,0),this.scale=new Ydt(this.onChange,this,1,1),this.pivot=new Ydt(this.onChange,this,0,0),
this.skew=new Ydt(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}var lpt=(Object.defineProperty(cpt.prototype,"left",{get:function(){
return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(cpt.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(cpt.prototype,"top",{get:function(){return this.y},enumerable:!0,
configurable:!0}),Object.defineProperty(cpt.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(cpt,"EMPTY",{get:function(){return new cpt(0,0,0,0)},enumerable:!0,configurable:!0}),
cpt.prototype.clone=function(){return new cpt(this.x,this.y,this.width,this.height)},cpt.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},cpt.prototype.copyTo=function(t){return t.x=this.x,
t.y=this.y,t.width=this.width,t.height=this.height,t},cpt.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},cpt.prototype.pad=function(t,e){return void 0===t&&(t=0),
void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},cpt.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height)
;return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this},cpt.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t
;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},cpt.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),
n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this},cpt);function cpt(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),
this.width=Number(i),this.height=Number(r),this.type=Wdt.RECT}dpt.prototype.clone=function(){return new dpt(this.x,this.y,this.radius)},dpt.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e
;return(r*=r)+(n*=n)<=i},dpt.prototype.getBounds=function(){return new lpt(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)};function dpt(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,
this.type=Wdt.CIRC}ppt.prototype.clone=function(){return new ppt(this.x,this.y,this.width,this.height)},ppt.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r
)<=1},ppt.prototype.getBounds=function(){return new lpt(this.x-this.width,this.y-this.height,this.width,this.height)};function ppt(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,
this.height=r,this.type=Wdt.ELIP}fpt.prototype.clone=function(){var t=new fpt(this.points.slice());return t.closeStroke=this.closeStroke,t},fpt.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){
var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function fpt(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(Array.isArray(e[0])&&(e=e[0]),
e[0]instanceof jdt){for(var r=[],n=0,s=(e=e).length;n<s;n++)r.push(e[n].x,e[n].y);e=r}this.points=e,this.type=Wdt.POLY,this.closeStroke=!0}mpt.prototype.clone=function(){return new mpt(this.x,this.y,this.width,this.height,this.radius)},
mpt.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(
e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(
this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1};function mpt(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),
void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=Wdt.RREC}ydt.SORTABLE_CHILDREN=!1;function _pt(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}
_pt.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},_pt.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},_pt.prototype.getRectangle=function(t){
return this.minX>this.maxX||this.minY>this.maxY?lpt.EMPTY:((t=t||new lpt(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},_pt.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),
this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},_pt.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2]
)<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},_pt.prototype.addFrame=function(t,e,i,r,n){
this.addFrameMatrix(t.worldTransform,e,i,r,n)},_pt.prototype.addFrameMatrix=function(t,e,i,r,n){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*i+u,_=o*e+h*i+l;c=m<c?m:c,d=_<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(
m=s*r+a*i+u)<c?m:c,d=(_=o*r+h*i+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*e+a*n+u)<c?m:c,d=(_=o*e+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,c=(m=s*r+a*n+u)<c?m:c,d=(_=o*r+h*n+l)<d?_:d,p=p<m?m:p,f=f<_?_:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},
_pt.prototype.addVertexData=function(t,e,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},
_pt.prototype.addVertices=function(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)},_pt.prototype.addVerticesMatrix=function(t,e,i,r,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty;n=n||0,s=s||0;for(var d=this.minX,p=this.minY,f=this.maxX,
m=this.maxY,_=i;_<r;_+=2){var y=e[_],v=e[_+1],g=o*y+h*v+l,x=u*v+a*y+c;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,x-s),m=Math.max(m,x+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},_pt.prototype.addBounds=function(t){var e=this.minX,i=this.minY,
r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},_pt.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,
n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},_pt.prototype.addBoundsMatrix=function(t,e){
this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},_pt.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){
var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}},_pt.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},
_pt.prototype.addFramePad=function(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r};var ypt=function(t){function n(){t.call(this),
this.tempDisplayObjectParent=null,this.transform=new hpt,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,
this._bounds=new _pt,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{
configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},
zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r
,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){
this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),
this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(
this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new lpt),e=this._boundsRect),
this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new lpt),
t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(
this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),
this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(
!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),
void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){
this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,
this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){return this.position.y},e.y.set=function(t){this.transform.position.y=t},
e.worldTransform.get=function(){return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){return this.transform.position},e.position.set=function(t){
this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)
},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){
return this.transform.rotation*Zdt},e.angle.set=function(t){this.transform.rotation=t*Jdt},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){
var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){return this._mask},e.mask.set=function(t){if(this._mask){var e=this._mask.maskObject||this._mask;e.renderable=!0,e.isMask=!1}if(this._mask=t,this._mask){
var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},Object.defineProperties(n.prototype,e),n}(X.a);function vpt(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}
ypt.prototype.displayObjectUpdateTransform=ypt.prototype.updateTransform;var gpt=function(n){function t(){n.call(this),this.children=[],this.sortableChildren=ydt.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},
height:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]
);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)
;return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,
t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e)
;this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},
t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);Tdt(this.children,i,1),this.children.splice(e,0,t),
this.onChildrenChange(e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(
1<i)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,Tdt(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit(
"childRemoved",t,this,n)}return t},t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Tdt(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit(
"childRemoved",e,this,t),e},t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(
i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError(
"removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}
t&&1<this.children.length&&this.children.sort(vpt),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(
var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)
}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0
)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush()
;var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,
this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()
},t.prototype._render=function(t){},t.prototype.destroy=function(t){n.prototype.destroy.call(this),this.sortDirty=!1;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},
e.width.get=function(){return this.scale.x*this.getLocalBounds().width},e.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},
e.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(t.prototype,e),t}(ypt);gpt.prototype.containerUpdateTransform=gpt.prototype.updateTransform;function xpt(t,e){void 0===t&&(t=0),
void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Gct("setRealSize",2),this.onUpdate=new Gct("update"),this.onError=new Gct("onError",1)}var bpt={valid:{configurable:!0},width:{configurable:!0},height:{
configurable:!0}};xpt.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},xpt.prototype.unbind=function(t){this.onResize.remove(t),
this.onUpdate.remove(t),this.onError.remove(t)},xpt.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},bpt.valid.get=function(){return!!this._width&&!!this._height},
xpt.prototype.update=function(){this.destroyed||this.onUpdate.run()},xpt.prototype.load=function(){return Promise.resolve()},bpt.width.get=function(){return this._width},bpt.height.get=function(){return this._height},xpt.prototype.upload=function(t,e,i){
return!1},xpt.prototype.style=function(t,e,i){return!1},xpt.prototype.dispose=function(){},xpt.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),
this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(xpt.prototype,bpt);var Tpt=function(r){function t(t){var e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),
this.source=t,this.noSubImage=!1}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),
0===t.indexOf("data:"))return"";e=e||window.location,(Ndt=Ndt||document.createElement("a")).href=t;var i=!(t=H.a.parse(Ndt.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(
t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===udt.UNPACK),
this.noSubImage||e.target!==n.TEXTURE_2D||i.width!==s||i.height!==o?(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},t.prototype.update=function(){if(!this.destroyed){
var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(xpt),
Ept=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,
this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==e.createBitmap?e.createBitmap:ydt.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,void 0!==e.premultiplyAlpha&&(
this.premultiplyAlpha=e.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(
this.createBitmap=t),this._load||(this._load=new Promise(function(t){r.url=r.source.src;function e(){r.destroyed||(i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e(
):(i.onload=e,i.onerror=function(t){return r.onError.run(t)})})),this._load},t.prototype.process=function(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(
this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===udt.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),
this._process):Promise.resolve(this)},t.prototype.upload=function(t,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1
;if(o.prototype.upload.call(this,t,e,i,this.bitmap),!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},
t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t}(Tpt),wpt=[];function Apt(t,e){if(!t)return null
;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=wpt.length-1;0<=n;--n){var s=wpt[n];if(s.test&&s.test(t,i))return new s(t,e)}return new Ept(t,e)}var Spt=function(s){function t(t,e){var i=e||{},
r=i.width,n=i.height;if(!r||!n)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.upload=function(t,e,i){var r=t.gl
;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===udt.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,
i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(xpt),Ipt={scaleMode:rdt.NEAREST,
format:Jct.RGBA,alphaMode:udt.NPM},Cpt=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}).alphaMode,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,
c=e.target,d=e.resolution,p=e.resourceOptions;!t||t instanceof xpt||((t=Apt(t,p)).internal=!0),this.width=o||0,this.height=a||0,this.resolution=d||ydt.RESOLUTION,this.mipmap=void 0!==r?r:ydt.MIPMAP_TEXTURES,
this.anisotropicLevel=void 0!==n?n:ydt.ANISOTROPIC_LEVEL,this.wrapMode=h||ydt.WRAP_MODE,this.scaleMode=void 0!==s?s:ydt.SCALE_MODE,this.format=u||Jct.RGBA,this.type=l||edt.UNSIGNED_BYTE,this.target=c||$ct.TEXTURE_2D,this.alphaMode=void 0!==i?i:udt.UNPACK,
void 0!==e.premultiplyAlpha&&(this.premultiplyAlpha=e.premultiplyAlpha),this.uid=wdt(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,
this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{
configurable:!0}};return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},o.prototype.setStyle=function(t,e){var i
;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,
this._refreshPOT(),this.update(),this},o.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){
this.isPowerOfTwo=Sdt(this.realWidth)&&Sdt(this.realHeight)},o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),
this._refreshPOT()),this},o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(
this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.onError=function(t){this.emit("error",this,t)},o.prototype.destroy=function(){
this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Rdt[this.cacheId],delete Odt[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),
this.textureCacheIds=null,this.destroyed=!0},o.prototype.dispose=function(){this.emit("dispose",this)},o.from=function(t,e,i){void 0===i&&(i=ydt.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+wdt()),t._pixiId)
;var s=Rdt[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in BaseTextureCache.');return s||((s=new o(t,e)).cacheId=n,o.addToCache(s,n)),s},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new Spt(t,{width:e,height:i}),
s=t instanceof Float32Array?edt.FLOAT:edt.UNSIGNED_BYTE;return new o(n,Object.assign(Ipt,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Rdt[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Rdt[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=Rdt[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Rdt[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete Rdt[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(X.a);Cpt._globalBatch=0;var Opt=function(a){function t(t,
e){var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new Cpt;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(Apt(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=$ct.TEXTURE_2D_ARRAY;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++
)this.items[e].off("update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){
var t=n[0],e=t.width,i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,
this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(xpt),
Rpt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(Tpt),
Ppt=function(r){function o(t,e){if(e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=$ct.TEXTURE_CUBE_MAP_POSITIVE_X+i
;!1!==e.autoLoad&&this.load()}return r&&(o.__proto__=r),((o.prototype=Object.create(r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=$ct.TEXTURE_CUBE_MAP},o.prototype.upload=function(t,e,i){for(
var r=this.itemDirtyIds,n=0;n<o.SIDES;n++){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,s.valid&&s.resource.upload(t,s,i))}return!0},o}(Opt);Ppt.SIDES=6;var Mpt=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),
this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((
r.prototype=Object.create(i&&i.prototype)).constructor=r).prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(
!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,
this.svg,this._crossorigin),o.src=this.svg,o.onerror=function(t){o.onerror=null,s.onError.run(t)},o.onload=function(){var t=o.width,e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them."
);var i=t*s.scale,r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+wdt(),
n.getContext("2d").drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){
i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(Tpt)
;Mpt.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Npt=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source")
,s=t[r],o=s.src,a=s.mime,h=(o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,
this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l)
;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=Xdt.shared.elapsedMS*this.source.playbackRate
;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(
this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",
this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){
e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._onError=function(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},i.prototype._isSourcePlaying=function(){var t=this.source
;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(Xdt.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(Xdt.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&Xdt.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),
this.source.src="",this.source.load()),l.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(Xdt.shared.remove(
this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(Xdt.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(
this._updateFPS=t)},i.test=function(t,e){return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(Tpt);Npt.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var Lpt=function(t){function e(){t.apply(
this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(Tpt);wpt.push(Ept,Lpt,Rpt,Npt,Mpt,Spt,Ppt,Opt);function Fpt(t){
this.renderer=t}Fpt.prototype.destroy=function(){this.renderer=null};function Dpt(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,
this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Gct("disposeFramebuffer",2)}var Upt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e
).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===udt.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(
i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(Spt),Bpt={colorTexture:{configurable:!0}};Bpt.colorTexture.get=function(){return this.colorTextures[0]},
Dpt.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Cpt(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},
Dpt.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Cpt(new Upt(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:Jct.DEPTH_COMPONENT,type:edt.UNSIGNED_SHORT}),
this.dirtyId++,this.dirtyFormat++,this},Dpt.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Dpt.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},
Dpt.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution
;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},Dpt.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(Dpt.prototype,Bpt);function kpt(){this.x0=0,
this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}var Xpt=function(n){function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]})
;n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new Dpt(this.width*this.resolution,
this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),
this.framebuffer.resize(t*this.resolution,e*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(Cpt)
;kpt.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=apt.add(i,apt.NW),this.x0=a+s*apt.uX(i),this.y0=h+o*apt.uY(i),i=apt.add(i,2),this.x1=a+s*apt.uX(i),this.y1=h+o*apt.uY(i),i=apt.add(i,2
),this.x2=a+s*apt.uX(i),this.y2=h+o*apt.uY(i),i=apt.add(i,2),this.x3=a+s*apt.uX(i),this.y3=h+o*apt.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(
t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Gpt=new kpt,
Vpt=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new lpt(0,0,1,1)),t instanceof a&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=Gpt,
this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new jdt(s.x,s.y):new jdt(0,0),
this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={
resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(o&&o.prototype)).constructor=a).prototype.update=function(){
this.baseTexture.resource&&this.baseTexture.resource.update()},a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()
}else this.frame=this._frame;this.emit("update",this)},a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&Odt[e.url]&&a.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("update",
this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},a.prototype.clone=function(){return new a(this.baseTexture,this.frame,
this.orig,this.trim,this.rotate,this.defaultAnchor)},a.prototype.updateUvs=function(){this._uvs===Gpt&&(this._uvs=new kpt),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},a.from=function(t,e,i){void 0===e&&(e={}),void 0===i&&(
i=ydt.STRICT_TEXTURE_CACHE);var r="string"==typeof t,n=null;n=r?t:(t._pixiId||(t._pixiId="pixiid_"+wdt()),t._pixiId);var s=Odt[n];if(r&&i&&!s)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return s||(e.resolution||(
e.resolution=Ldt(t)),(s=new a(new Cpt(t,e))).baseTexture.cacheId=n,Cpt.addToCache(s.baseTexture,n),a.addToCache(s,n)),s},a.fromBuffer=function(t,e,i,r){return new a(Cpt.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new Ept(t);r.url=e
;var n=new a(new Cpt(r,{scaleMode:ydt.SCALE_MODE,resolution:Ldt(e)}));return i=i||e,Cpt.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(Cpt.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(
-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Odt[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Odt[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=Odt[t];if(e){
var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete Odt[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Odt[t.textureCacheIds[r]]===t&&delete Odt[t.textureCacheIds[r]]
;return t.textureCacheIds.length=0,t}return null},t.resolution.get=function(){return this.baseTexture.resolution},t.frame.get=function(){return this._frame},t.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,
s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error(
"Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},
t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){return this.orig.height},Object.defineProperties(a.prototype,t),a}(X.a);function jpt(t){t.destroy=function(){},
t.on=function(){},t.once=function(){},t.emit=function(){}}Vpt.EMPTY=new Vpt(new Cpt),jpt(Vpt.EMPTY),jpt(Vpt.EMPTY.baseTexture),Vpt.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d")
;return e.fillStyle="white",e.fillRect(0,0,16,16),new Vpt(new Cpt(new Rpt(t)))}(),jpt(Vpt.WHITE),jpt(Vpt.WHITE.baseTexture);function Hpt(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}
var Ypt=function(a){function n(t,e){var i=null;if(!(t instanceof Xpt)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn("Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),i=arguments[0],e=null,
t=new Xpt({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(a&&a.prototype)).constructor=n
).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},
n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new Xpt(t))},n
}(Vpt);Hpt.prototype.createTexture=function(t,e){var i=new Xpt(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new Ypt(i)},Hpt.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=Hpt.SCREEN_KEY;t*=i,e*=i,
this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=Adt(t)))<<16|65535&(e=Adt(e))),this.texturePool[r]||(this.texturePool[r]=[]);var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,
n.setResolution(i),n},Hpt.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},Hpt.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,
this.texturePool[e].push(t)},Hpt.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Hpt.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}
this.texturePool={}},Hpt.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Hpt.SCREEN_KEY,i=this.texturePool[e];if(this.enableFullScreen=0<t.width&&0<t.height,i)for(var r=0;r<i.length;r++
)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Hpt.SCREEN_KEY="screen";function zpt(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,
this.stride=n,this.start=s,this.instance=o}zpt.prototype.destroy=function(){this.buffer=null},zpt.from=function(t,e,i,r,n){return new zpt(t,e,i,r,n)};function Wpt(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),
this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=qpt++,this.disposeRunner=new Gct("disposeBuffer",2)}var qpt=0;function Kpt(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Wpt.prototype.update=function(t){this.data=t||this.data,this._updateID++},Wpt.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Wpt.prototype.destroy=function(){this.dispose(),this.data=null},Wpt.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Wpt(t)};var Zpt={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Jpt(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=$pt++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Gct("disposeGeometry",2),this.refCount=0}var Qpt={5126:4,5123:2,5121:1},$pt=0,tft={Float32Array:Float32Array,
Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};Jpt.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Wpt(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new zpt(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},Jpt.prototype.getAttribute=function(t){return this.attributes[t]},Jpt.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},Jpt.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Wpt(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
Jpt.prototype.getIndex=function(){return this.indexBuffer},Jpt.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Wpt;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Qpt[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Kpt(c
);n[d]||(n[d]=new Zpt[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Jpt.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},Jpt.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},Jpt.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Jpt.prototype.clone=function(){for(var t=new Jpt,e=0;e<this.buffers.length;e++)t.buffers[e]=new Wpt(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new zpt(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},Jpt.merge=function(t){for(var e,i=new Jpt,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(tft[Kpt(e.buffers[h].data)])(n[h]),i.buffers[h]=new Wpt(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Qpt[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function eft(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=nft++,this.static=!!e}var ift=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Jpt)
,rft=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Wpt(this.vertices),this.uvBuffer=new Wpt(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Jpt),nft=0
;eft.prototype.update=function(){this.dirtyId++},eft.prototype.add=function(t,e,i){this.uniforms[t]=new eft(e,i)},eft.from=function(t,e){return new eft(t,e)};function sft(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new lpt,this.destinationFrame=new lpt,this.filters=[]}sft.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function oft(t){this.renderer=t}var aft=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new Hpt,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new ift,this.quadUv=new rft,this.tempRect=new lpt,this.activeState={},this.globalUniforms=new eft({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new sft,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Kct.TRIANGLES)):(
n.geometry.bind(this.quad),n.geometry.draw(Kct.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(
Qdt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),
this.texturePool.getOptimalTexture(t,e,i)},t.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution)
;return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(
this.renderer.view)},t}(Fpt);oft.prototype.flush=function(){},oft.prototype.destroy=function(){this.renderer=null},oft.prototype.start=function(){},oft.prototype.stop=function(){this.flush()},oft.prototype.render=function(t){};var hft=function(e){
function t(t){e.call(this,t),this.emptyRenderer=new oft(t),this.currentRenderer=this.emptyRenderer}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(
this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},
t.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},t.prototype.boundArray=function(t,e,i,r){for(var n=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){
var u=n[h],l=u._batchLocation;if(0<=l&&l<r&&e[l]===u)s[h]=l;else for(;a<r;){var c=e[a];if(!c||c._batchEnabled!==i||c._batchLocation!==a){s[h]=a,e[u._batchLocation=a]=u;break}a++}}},t}(Fpt);ydt.PREFER_ENV=u.a.any?jct.WEBGL:jct.WEBGL2,
ydt.STRICT_TEXTURE_CACHE=!1;function uft(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0}function lft(t){this.type=mdt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,
this._scissorCounter=0,this._scissorRect=null,this._target=null}var cft=0,dft=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),
this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(
t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,
this.renderer.CONTEXT_UID=cft++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,
this.renderer.CONTEXT_UID=cft++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(
ydt.PREFER_ENV>=jct.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error(
"This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension(
"WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension(
"WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension(
"OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension(
"EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){t.preventDefault()},
t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener(
"webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(Fpt),pft=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new Dpt(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new lpt,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;ydt.PREFER_ENV===jct.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.forceStencil=function(){var t=this.current
;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,
n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new lpt},Object.defineProperties(t.prototype,i),t}(Fpt),fft={5126:4,5123:2,5121:1},
mft=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e)
,((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){
var i=this.renderer.context.extensions.vertexArrayObject;ydt.PREFER_ENV===jct.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},
t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays")
;s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}
):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((
this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n
):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],
n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{
var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error(
'shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t
,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h
)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*fft[h[d].type];for(
var p in h){var f=h[p],m=f.size;void 0===f.stride&&(u[f.buffer]===m*fft[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*fft[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){
var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new uft(i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,
e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e
){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--
,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(Fpt);function _ft(t,e,i,r){var n=yft(t,t.VERTEX_SHADER,e),s=yft(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function yft(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function vft(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return gft(2*e)
;case"bvec3":return gft(3*e);case"bvec4":return gft(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function gft(t
){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}lft.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=mdt.NONE,this.autoDetect=!0),this._target=null},lft.prototype.copyCountersOrReset=function(t){t?(
this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var xft,bft={},Tft=bft;function Eft(){if(
Tft===bft||Tft&&Tft.isContextLost()){var t,e=document.createElement("canvas");ydt.PREFER_ENV>=jct.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),
Tft=t}return Tft}function wft(t,e,i){if("precision"===t.substring(0,9))return i!==pdt.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===pdt.HIGH&&i!==pdt.HIGH&&(r=pdt.MEDIUM),
"precision "+r+" float;\n"+t}var Aft={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var Sft=null,Ift={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",
INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",
SAMPLER_2D_ARRAY:"sampler2DArray"};function Cft(t,e){if(!Sft){var i=Object.keys(Ift);Sft={};for(var r=0;r<i.length;++r){var n=i[r];Sft[t[n]]=Ift[n]}}return Sft[e]}var Oft={
float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Rft={
float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",
mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",
bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Pft,Mft=["precision mediump float;","void main(void){",
"float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Nft(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function Lft(t,e,i){void 0===i&&(i="pixi-shader"),this.id=Fft++,
this.vertexSrc=t||Lft.defaultVertexSrc,this.fragmentSrc=e||Lft.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Dft[i]?(Dft[i]++,
i+="-"+Dft[i]):Dft[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=wft(this.vertexSrc,ydt.PRECISION_VERTEX,pdt.HIGH),this.fragmentSrc=wft(this.fragmentSrc,
ydt.PRECISION_FRAGMENT,function(){if(!xft){xft=pdt.MEDIUM;var t=Eft();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);xft=e.precision?pdt.HIGH:pdt.MEDIUM}}return xft}())),this.extractData(this.vertexSrc,
this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}var Fft=0,Dft={},Uft={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Lft.prototype.extractData=function(t,e){var i=Eft();if(i){var r=_ft(i,t,e)
;this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},Lft.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,
e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){var a=e.getActiveAttrib(t,o),h=Cft(e,a.type),u={type:h,name:a.name,size:(i=h,Aft[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},
Lft.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=Cft(e,s.type);i[o]={type:h,size:s.size,isArray:a,
value:vft(h,s.size)}}return i},Uft.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},Uft.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},Lft.from=function(t,e,i){var r=t+e,n=Cdt[r];return n||(
Cdt[r]=n=new Lft(t,e,i)),n},Object.defineProperties(Lft,Uft);function Bft(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof eft?e:new eft(e):new eft({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(
this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))}var kft={uniforms:{configurable:!0}};Bft.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(
r.group&&this.checkUniformExists(t,r))return!0}return!1},Bft.prototype.destroy=function(){this.uniformGroup=null},kft.uniforms.get=function(){return this.uniformGroup.uniforms},Bft.from=function(t,e,i){var r=Lft.from(t,e);return new Bft(r,i)},
Object.defineProperties(Bft.prototype,kft);function Xft(){this.data=0,this.blendMode=Wct.NORMAL,this.polygonOffset=0,this.blend=!0}var Gft={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},
clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};Gft.blend.get=function(){return!!(1&this.data)},Gft.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Gft.offsets.get=function(){return!!(
2&this.data)},Gft.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},Gft.culling.get=function(){return!!(4&this.data)},Gft.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Gft.depthTest.get=function(){return!!(8&this.data)},
Gft.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},Gft.clockwiseFrontFace.get=function(){return!!(16&this.data)},Gft.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Gft.blendMode.get=function(){
return this._blendMode},Gft.blendMode.set=function(t){this.blend=t!==Wct.NONE,this._blendMode=t},Gft.polygonOffset.get=function(){return this._polygonOffset},Gft.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Xft.for2d=function(){
var t=new Xft;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(Xft.prototype,Gft);var Vft=function(n){function s(t,e,i){var r=Lft.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,
this.resolution=ydt.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Xft}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},
defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)).constructor=s).prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){
this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(Bft);Vft.SOURCE_KEY_MAP={};function jft(t,e){this._texture=t,this.mapCoord=new Qdt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var Hft=new Qdt,Yft={texture:{configurable:!0}};Yft.texture.get=function(){return this._texture},Yft.texture.set=function(t){this._texture=t,this._updateID=-1},jft.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,
r=0;r<t.length;r+=2){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},jft.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID
;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(Hft.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Hft));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(jft.prototype,Yft);function zft(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Wft=function(
i){function t(t){var e=new Qdt;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new jft(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,
this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(Vft),qft=function(e){function t(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],
this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},
t.prototype.push=function(t,e){if(!e.isMaskData){var i=this.maskDataPool.pop()||new lft;i.pooled=!0,i.maskObject=e,e=i}switch(e.autoDetect&&this.detect(e),e.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),e._target=t,e.type){case mdt.SCISSOR:
this.maskStack.push(e),this.renderer.scissor.push(e);break;case mdt.STENCIL:this.maskStack.push(e),this.renderer.stencil.push(e);break;case mdt.SPRITE:e.copyCountersOrReset(null),this.pushSpriteMask(e),this.maskStack.push(e)}},t.prototype.pop=function(t){
var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case mdt.SCISSOR:this.renderer.scissor.pop();break;case mdt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case mdt.SPRITE:this.popSpriteMask()}e.reset(),
e.pooled&&this.maskDataPool.push(e)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=mdt.SPRITE;else if(t.type=mdt.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),n=Math.atan2(
i.d,i.c);r=Math.round(r*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===n&&(t.type=mdt.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,
r=this.alphaMaskPool[this.alphaMaskIndex];(r=r||(this.alphaMaskPool[this.alphaMaskIndex]=[new Wft(e)]))[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=n,
this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(Fpt),Kft=function(e){function t(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(t.__proto__=e),((t.prototype=Object.create(
e&&e.prototype)).constructor=t).prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(
this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.maskStack=null},t}(Fpt),Zft=function(e){function t(t){e.call(this,t),
this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},
t.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),n=this.renderer.gl;e.renderable=!1,i?r.fit(i):n.enable(n.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},
t.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},t.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,
i=this.renderer.projection,r=i.transform,n=i.sourceFrame,s=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,a=(t.x-n.x)*o+s.x,h=(t.y-n.y)*o+s.y,u=t.width*o,l=t.height*o;r&&(a+=r.tx*o,h+=r.ty*o),e||(h=this.renderer.height-l-h),
this.renderer.gl.scissor(a,h,u,l)},t}(Kft),Jft=function(e){function t(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t
).prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},t.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),
i.enable(i.STENCIL_TEST)),t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()
},t.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),
this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},
t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Kft),Qft=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Qdt,this.transform=null}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(
this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),
n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,
n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(Fpt),$ft=new lpt,tmt=function(e){function t(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,
this.sourceFrame=new lpt,this.destinationFrame=new lpt}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture
;r=s.resolution,i||($ft.width=s.realWidth,$ft.height=s.realHeight,i=$ft),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.mask.setMaskStack(s.maskStack)}else r=this.renderer.resolution,i||(
$ft.width=n.width,$ft.height=n.height,i=$ft),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,
this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},t.prototype.clear=function(t){
t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(Fpt)
;zft.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var emt=0,imt=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=emt++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Pft)return Pft;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;"
);Pft=!0===t({a:"b"},"a","b")}catch(t){Pft=!1}return Pft}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?Oft:Rft)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=_ft(e,i.vertexSrc,i.fragmentSrc,r)
,o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:vft(h.type,h.size)}}var u=new zft(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,
this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(Fpt);function rmt(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}
var nmt=function(e){function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Wct.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,
this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Xft,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i
).prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[Wct.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.ADD]=[t.ONE,t.ONE],e[Wct.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[Wct.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],
e[Wct.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.HUE]=[
t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.NONE]=[0,0],e[Wct.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[Wct.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Wct.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Wct.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Wct.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Wct.SRC_ATOP]=[
t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Wct.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Wct.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Wct.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Wct.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Wct.XOR]=[t.ONE_MINUS_DST_ALPHA,
t.ONE_MINUS_SRC_ALPHA],e[Wct.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,
i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this
,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t);this.stateId=t.data},i.prototype.setBlend=function(t){this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){
this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](
this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]
):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){
this.gl.polygonOffset(t,e)},i.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t)
;e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},i}(Fpt),smt=function(e){function t(t){e.call(this,t),
this.count=0,this.checkCount=0,this.maxIdle=ydt.GC_MAX_IDLE,this.checkCountMax=ydt.GC_MAX_CHECK_COUNT,this.mode=ydt.GC_MODE}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){
this.renderer.renderingToScreen&&(this.count++,this.mode!==cdt.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,
r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},t.prototype.unload=function(t){
var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(Fpt),omt=function(e){function t(t){e.call(this,t),this.boundTextures=[],
this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Cpt}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null
;this.emptyTextures={};var r=new rmt(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,
this.emptyTextures[t.TEXTURE_CUBE_MAP]=new rmt(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null)
;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0)
;var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(
i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(
this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(
var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++
)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},
t.prototype.initTexture=function(t){var e=new rmt(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(
e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===edt.HALF_FLOAT&&(e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(
e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(
e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e
){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){
var r=this.managedTextures.indexOf(t);-1!==r&&Tdt(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==adt.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=0,
2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=sdt.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(
e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,
t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===rdt.LINEAR){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(Fpt),amt=new Qdt;X.a;function hmt(){this.texArray=null,this.blend=0,this.type=Kct.TRIANGLES,this.start=0,this.size=0,this.data=null}function umt(){this.elements=[],this.ids=[],this.count=0}umt.prototype.clear=function(){for(var t=0;t<this.count;t++
)this.elements[t]=null;this.count=0};function lmt(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var cmt={int8View:{configurable:!0},uint8View:{
configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};cmt.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},cmt.uint8View.get=function(){
return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},cmt.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},cmt.uint16View.get=function(){
return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},cmt.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},lmt.prototype.view=function(t){
return this[t+"View"]},lmt.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},lmt.sizeOf=function(t){
switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},Object.defineProperties(lmt.prototype,cmt);var dmt=function(e){function _(t
){e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Xft.for2d(),this.size=4*ydt.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,
this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,
this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(_.__proto__=e),((_.prototype=Object.create(e&&e.prototype)).constructor=_).prototype.contextChange=function(){var t=this.renderer.gl
;ydt.PREFER_ENV===jct.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),ydt.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error(
"Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Mft.replace(/%forloop%/gi,Nft(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}
return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},
_.prototype.initFlushBuffers=function(){for(var t=_._drawCallPool,e=_._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new hmt);for(;e.length<r;)e.push(new umt);for(var n=0;n<this.MAX_TEXTURES;n++
)this._tempBoundTextures[n]=null},_.prototype.onPrerender=function(){this._flushId=0},_.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,
this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},_.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,
i=_._textureArrayPool,r=this.renderer.batch,n=this._tempBoundTextures,s=this.renderer.textureGC.count,o=++Cpt._globalBatch,a=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(var l=0;l<this._bufferSize;++l){var c=t[l];t[l]=null,c._batchEnabled!==o&&(h.count>=e&&(
r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,l),u=l,h=i[++a],++o),c._batchEnabled=o,c.touched=s,h.elements[h.count++]=c)}0<h.count&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++a,++o);for(var d=0;d<n.length;d++)n[d]=null
;Cpt._globalBatch=o},_.prototype.buildDrawCalls=function(t,e,i){var r=this._bufferedElements,n=this._attributeBuffer,s=this._indexBuffer,o=this.vertexSize,a=_._drawCallPool,h=this._dcIndex,u=this._aIndex,l=this._iIndex,c=a[h];c.start=this._iIndex,
c.texArray=t;for(var d=e;d<i;++d){var p=r[d],f=p._texture.baseTexture,m=bdt[f.alphaMode?1:0][p.blendMode];r[d]=null,e<d&&c.blend!==m&&(c.size=l-c.start,e=d,(c=a[++h]).texArray=t,c.start=l),this.packInterleavedGeometry(p,n,s,u,l),u+=p.vertexData.length/2*o
,l+=p.indices.length,c.blend=m}e<i&&(c.size=l-c.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=l},_.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null
;t.count=0},_.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;ydt.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),
this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},_.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,i=e.gl,r=e.state,n=_._drawCallPool,s=null,o=0;o<t;o++){var a=n[o],
h=a.texArray,u=a.type,l=a.size,c=a.start,d=a.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),r.setBlendMode(d),i.drawElements(u,l,i.UNSIGNED_SHORT,2*c)}},_.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(
this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},
_.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),ydt.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},_.prototype.stop=function(){this.flush()},
_.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,
this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},_.prototype.getAttributeBuffer=function(t){var e=Adt(Math.ceil(t/8)),i=Idt(e),r=8*e
;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new lmt(r*this.vertexSize*4)),n},_.prototype.getIndexBuffer=function(t){var e=Adt(Math.ceil(t/12)),i=Idt(e),r=12*e;this._iBuffers.length<=i&&(
this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},_.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,
c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0
)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},_}(oft);dmt._drawCallPool=[],dmt._textureArrayPool=[]
;function pmt(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error(
'Fragment template must contain "%forloop%".')}pmt.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=eft.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(
/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Lft(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Qdt,default:this.defaultGroupCache[t]};return new Bft(this.programCache[t],n)}
,pmt.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}
;function fmt(){}var mmt=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Wpt(null,t,!1),this._indexBuffer=new Wpt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,edt.FLOAT).addAttribute("aTextureCoord",
this._buffer,2,!1,edt.FLOAT).addAttribute("aColor",this._buffer,4,!0,edt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,edt.FLOAT).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t
}(Jpt),
_mt="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,ymt="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",vmt={defaultVertexSrc:{configurable:!0
},defaultFragmentTemplate:{configurable:!0}};fmt.create=function(t){var e=Object.assign({vertex:_mt,fragment:ymt,geometryClass:mmt,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new pmt(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(dmt)},vmt.defaultVertexSrc.get=function(){return _mt},vmt.defaultFragmentTemplate.get=function(){
return ymt},Object.defineProperties(fmt,vmt);fmt.create();var gmt=function(i){function r(t,e){i.call(this,t[0]instanceof Vpt?t[0]:t[0].texture),this._textures=null,this._durations=null,this.textures=t,this._autoUpdate=!1!==e,this.animationSpeed=1,
this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this.playing=!1}i&&(r.__proto__=i);var t={totalFrames:{configurable:!0},textures:{configurable:!0},currentFrame:{configurable:!0}};return((
r.prototype=Object.create(i&&i.prototype)).constructor=r).prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&Xdt.shared.remove(this.update,this))},r.prototype.play=function(){this.playing||(this.playing=!0,
this._autoUpdate&&Xdt.shared.add(this.update,this,Fdt.HIGH))},r.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},r.prototype.gotoAndPlay=function(t){
var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},r.prototype.update=function(t){var e=this.animationSpeed*t,i=this.currentFrame;if(null!==this._durations){
var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime
);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),
this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(
0<this.animationSpeed&&this.currentFrame<i?this.onLoop():this.animationSpeed<0&&this.currentFrame>i&&this.onLoop()),this.updateTexture())},r.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,
this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame)},r.prototype.destroy=function(t){
this.stop(),i.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},r.fromFrames=function(t){for(var e=[],i=0;i<t.length;++i)e.push(Vpt.from(t[i]));return new r(e)},r.fromImages=function(t){for(var e=[],
i=0;i<t.length;++i)e.push(Vpt.from(t[i]));return new r(e)},t.totalFrames.get=function(){return this._textures.length},t.textures.get=function(){return this._textures},t.textures.set=function(t){if(t[0]instanceof Vpt)this._textures=t,
this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this.gotoAndStop(0),this.updateTexture()},t.currentFrame.get=function(){var t=Math.floor(
this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},Object.defineProperties(r.prototype,t),r}(ry);i.d(e,"VERSION",function(){return Tmt}),i.d(e,"filters",function(){return Emt}),i.d(e,"useDeprecated",function(){return bmt}),
i.d(e,"accessibility",function(){return r}),i.d(e,"extract",function(){return n}),i.d(e,"interaction",function(){return s}),i.d(e,"prepare",function(){return o}),i.d(e,"utils",function(){return a}),i.d(e,"Application",function(){return rS}),i.d(e,
"AbstractBatchRenderer",function(){return JC}),i.d(e,"AbstractRenderer",function(){return VC}),i.d(e,"Attribute",function(){return wI}),i.d(e,"BaseRenderTexture",function(){return vI}),i.d(e,"BaseTexture",function(){return sI}),i.d(e,"BatchDrawCall",
function(){return YC}),i.d(e,"BatchGeometry",function(){return tO}),i.d(e,"BatchPluginFactory",function(){return $C}),i.d(e,"BatchRenderer",function(){return nO}),i.d(e,"BatchShaderGenerator",function(){return QC}),i.d(e,"BatchTextureArray",function(){
return zC}),i.d(e,"Buffer",function(){return AI}),i.d(e,"CubeTexture",function(){return qC}),i.d(e,"Filter",function(){return bC}),i.d(e,"Framebuffer",function(){return fI}),i.d(e,"GLProgram",function(){return AC}),i.d(e,"GLTexture",function(){return DC})
,i.d(e,"Geometry",function(){return OI}),i.d(e,"MaskData",function(){return VI}),i.d(e,"ObjectRenderer",function(){return BI}),i.d(e,"Program",function(){return pC}),i.d(e,"Quad",function(){return LI}),i.d(e,"QuadUv",function(){return FI}),i.d(e,
"RenderTexture",function(){return EI}),i.d(e,"RenderTexturePool",function(){return TI}),i.d(e,"Renderer",function(){return jC}),i.d(e,"Shader",function(){return yC}),i.d(e,"SpriteMaskFilter",function(){return SC}),i.d(e,"State",function(){return gC}),i.d(
e,"System",function(){return dI}),i.d(e,"Texture",function(){return xI}),i.d(e,"TextureMatrix",function(){return TC}),i.d(e,"TextureUvs",function(){return yI}),i.d(e,"UniformGroup",function(){return NI}),i.d(e,"ViewableBuffer",function(){return KC}),i.d(e
,"autoDetectRenderer",function(){return HC}),i.d(e,"checkMaxIfStatementsInShader",function(){return cC}),i.d(e,"defaultFilterVertex",function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
}),i.d(e,"defaultVertex",function(){return WC}),i.d(e,"resources",function(){return pI}),i.d(e,"systems",function(){return XC}),i.d(e,"AppLoaderPlugin",function(){return aN}),i.d(e,"Loader",function(){return oN}),i.d(e,"LoaderResource",function(){
return DN}),i.d(e,"TextureLoader",function(){return sN}),i.d(e,"ParticleContainer",function(){return HD}),i.d(e,"ParticleRenderer",function(){return YD}),i.d(e,"Spritesheet",function(){return wX}),i.d(e,"SpritesheetLoader",function(){return SX}),i.d(e,
"TilingSprite",function(){return oH}),i.d(e,"TilingSpriteRenderer",function(){return uH}),i.d(e,"BitmapFontLoader",function(){return jW}),i.d(e,"BitmapText",function(){return VW}),i.d(e,"Ticker",function(){return dS}),i.d(e,"TickerPlugin",function(){
return fS}),i.d(e,"UPDATE_PRIORITY",function(){return oS}),i.d(e,"ALPHA_MODES",function(){return Pb}),i.d(e,"BLEND_MODES",function(){return mb}),i.d(e,"DRAW_MODES",function(){return yb}),i.d(e,"ENV",function(){return cb}),i.d(e,"FORMATS",function(){
return gb}),i.d(e,"GC_MODES",function(){return Nb}),i.d(e,"MASK_TYPES",function(){return Ub}),i.d(e,"MIPMAP_MODES",function(){return Ob}),i.d(e,"PRECISION",function(){return Fb}),i.d(e,"RENDERER_TYPE",function(){return pb}),i.d(e,"SCALE_MODES",function(){
return Ab}),i.d(e,"TARGETS",function(){return bb}),i.d(e,"TYPES",function(){return Eb}),i.d(e,"WRAP_MODES",function(){return Ib}),i.d(e,"Bounds",function(){return WS}),i.d(e,"Container",function(){return ZS}),i.d(e,"DisplayObject",function(){return qS}),
i.d(e,"FillStyle",function(){return Kd}),i.d(e,"GRAPHICS_CURVES",function(){return Zd}),i.d(e,"Graphics",function(){return xp}),i.d(e,"GraphicsData",function(){return lp}),i.d(e,"GraphicsGeometry",function(){return _p}),i.d(e,"LineStyle",function(){
return yp}),i.d(e,"graphicsUtils",function(){return pp}),i.d(e,"Circle",function(){return kS}),i.d(e,"DEG_TO_RAD",function(){return wS}),i.d(e,"Ellipse",function(){return GS}),i.d(e,"Matrix",function(){return AS}),i.d(e,"ObservablePoint",function(){
return vS}),i.d(e,"PI_2",function(){return TS}),i.d(e,"Point",function(){return _S}),i.d(e,"Polygon",function(){return jS}),i.d(e,"RAD_TO_DEG",function(){return ES}),i.d(e,"Rectangle",function(){return US}),i.d(e,"RoundedRectangle",function(){return YS}),
i.d(e,"SHAPES",function(){return xS}),i.d(e,"Transform",function(){return FS}),i.d(e,"groupD8",function(){return LS}),i.d(e,"Mesh",function(){return tht}),i.d(e,"MeshBatchUvs",function(){return Jat}),i.d(e,"MeshGeometry",function(){return Rht}),i.d(e,
"MeshMaterial",function(){return Oht}),i.d(e,"NineSlicePlane",function(){return Xct}),i.d(e,"PlaneGeometry",function(){return Fct}),i.d(e,"RopeGeometry",function(){return Dct}),i.d(e,"SimpleMesh",function(){return kct}),i.d(e,"SimplePlane",function(){
return Bct}),i.d(e,"SimpleRope",function(){return Uct}),i.d(e,"Runner",function(){return hS}),i.d(e,"Sprite",function(){return ry}),i.d(e,"AnimatedSprite",function(){return gmt}),i.d(e,"TEXT_GRADIENT",function(){return Xx}),i.d(e,"Text",function(){
return Zx}),i.d(e,"TextMetrics",function(){return Wx}),i.d(e,"TextStyle",function(){return kx}),i.d(e,"isMobile",function(){return u.a}),i.d(e,"settings",function(){return kb});var xmt="5.0.0";function bmt(){var i=this;Object.defineProperties(i,{
SVG_SIZE:{get:function(){return ET(xmt,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE"),i.SVGResource.SVG_SIZE}},TransformStatic:{get:function(){return ET(xmt,
"PIXI.TransformStatic class has been removed, use PIXI.Transform"),i.Transform}},TransformBase:{get:function(){return ET(xmt,"PIXI.TransformBase class has been removed, use PIXI.Transform"),i.Transform}},TRANSFORM_MODE:{get:function(){return ET(xmt,
"PIXI.TRANSFORM_MODE property has been removed"),{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function(){return ET(xmt,"PIXI.WebGLRenderer class has moved to PIXI.Renderer"),i.Renderer}},CanvasRenderTarget:{get:function(){return ET(xmt,
"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget"),i.utils.CanvasRenderTarget}},loader:{get:function(){return ET(xmt,"PIXI.loader instance has moved to PIXI.Loader.shared"),i.Loader.shared}},FilterManager:{get:function(){
return ET(xmt,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem"),i.systems.FilterSystem}},CanvasTinter:{get:function(){return ET("5.2.0","PIXI.CanvasTinter namespace has moved to PIXI.canvasUtils"),i.canvasUtils}},GroupD8:{get:function(){
return ET("5.2.0","PIXI.GroupD8 namespace has moved to PIXI.groupD8"),i.groupD8}}}),i.extras={},Object.defineProperties(i.extras,{TilingSprite:{get:function(){return ET(xmt,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite"),i.TilingSprite}},
TilingSpriteRenderer:{get:function(){return ET(xmt,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer"),i.TilingSpriteRenderer}},AnimatedSprite:{get:function(){return ET(xmt,
"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite"),i.AnimatedSprite}},BitmapText:{get:function(){return ET(xmt,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText"),i.BitmapText}}}),Object.defineProperties(i.utils,{getSvgSize:{
get:function(){return ET(xmt,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize"),i.SVGResource.getSize}}}),i.mesh={},Object.defineProperties(i.mesh,{Mesh:{get:function(){return ET(xmt,
"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh"),i.SimpleMesh}},NineSlicePlane:{get:function(){return ET(xmt,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane"),i.NineSlicePlane}},Plane:{get:function(){return ET(xmt,
"PIXI.mesh.Plane class has moved to PIXI.SimplePlane"),i.SimplePlane}},Rope:{get:function(){return ET(xmt,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope"),i.SimpleRope}},RawMesh:{get:function(){return ET(xmt,
"PIXI.mesh.RawMesh class has moved to PIXI.Mesh"),i.Mesh}},CanvasMeshRenderer:{get:function(){return ET(xmt,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer"),i.CanvasMeshRenderer}},MeshRenderer:{get:function(){return ET(xmt,
"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer"),i.MeshRenderer}}}),i.particles={},Object.defineProperties(i.particles,{ParticleContainer:{get:function(){return ET(xmt,
"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer"),i.ParticleContainer}},ParticleRenderer:{get:function(){return ET(xmt,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer"),i.ParticleRenderer}}}),
i.ticker={},Object.defineProperties(i.ticker,{Ticker:{get:function(){return ET(xmt,"PIXI.ticker.Ticker class has moved to PIXI.Ticker"),i.Ticker}},shared:{get:function(){return ET(xmt,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared"),
i.Ticker.shared}}}),i.loaders={},Object.defineProperties(i.loaders,{Loader:{get:function(){return ET(xmt,"PIXI.loaders.Loader class has moved to PIXI.Loader"),i.Loader}},Resource:{get:function(){return ET(xmt,
"PIXI.loaders.Resource class has moved to PIXI.LoaderResource"),i.LoaderResource}},bitmapFontParser:{get:function(){return ET(xmt,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use"),i.BitmapFontLoader.use}},
parseBitmapFontData:{get:function(){return ET(xmt,"PIXI.loaders.parseBitmapFontData function has moved to PIXI.BitmapFontLoader.parse"),i.BitmapFontLoader.parse}},spritesheetParser:{get:function(){return ET(xmt,
"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use"),i.SpritesheetLoader.use}},getResourcePath:{get:function(){return ET(xmt,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath"),
i.SpritesheetLoader.getResourcePath}}}),i.Loader.addPixiMiddleware=function(t){return ET(xmt,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin"),i.loaders.Loader.registerPlugin({use:t()})},
Object.defineProperty(i.extract,"WebGLExtract",{get:function(){return ET(xmt,"PIXI.extract.WebGLExtract method has moved to PIXI.extract.Extract"),i.extract.Extract}}),Object.defineProperty(i.prepare,"WebGLPrepare",{get:function(){return ET(xmt,
"PIXI.prepare.WebGLPrepare class has moved to PIXI.prepare.Prepare"),i.prepare.Prepare}}),i.Container.prototype._renderWebGL=function(t){ET(xmt,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render"),this._render(t)},
i.Container.prototype.renderWebGL=function(t){ET(xmt,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render"),this.render(t)},i.DisplayObject.prototype.renderWebGL=function(t){ET(xmt,
"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render"),this.render(t)},i.Container.prototype.renderAdvancedWebGL=function(t){ET(xmt,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced"),
this.renderAdvanced(t)},Object.defineProperties(i.settings,{TRANSFORM_MODE:{get:function(){return ET(xmt,"PIXI.settings.TRANSFORM_MODE property has been removed"),0},set:function(){ET(xmt,"PIXI.settings.TRANSFORM_MODE property has been removed")}}})
;var s=i.BaseTexture,t=!(s.prototype.loadSource=function(t){ET(xmt,"PIXI.BaseTexture.loadSource method has been deprecated");var e=i.resources.autoDetectResource(t);e.internal=!0,this.setResource(e),this.update()});Object.defineProperties(s.prototype,{
hasLoaded:{get:function(){return ET(xmt,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid"),this.valid}},imageUrl:{get:function(){return ET(xmt,
"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&this.resource.url},set:function(t){ET(xmt,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&(
this.resource.url=t)}},source:{get:function(){return ET(xmt,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source`"),this.resource&&this.resource.source},set:function(t){ET(xmt,
"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source` if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture."),this.resource&&(this.resource.source=t)}},premultiplyAlpha:{get:function(){return ET(
"5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){ET("5.2.0",
"PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}},_id:{get:function(){return t||(ET("5.2.0","PIXI.BaseTexture._id batch local field has been changed to `_batchLocation`"),t=!0)
,this._batchLocation},set:function(t){this._batchLocation=t}}}),s.fromImage=function(t,e,i,r){ET(xmt,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var n={scale:r,crossorigin:e};return s.from(t,{scaleMode:i,
resourceOptions:n})},s.fromCanvas=function(t,e){return ET(xmt,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from"),s.from(t,{scaleMode:e})},s.fromSVG=function(t,e,i,r){ET(xmt,
"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var n={scale:r,crossorigin:e};return s.from(t,{scaleMode:i,resourceOptions:n})},Object.defineProperties(i.resources.ImageResource.prototype,{premultiplyAlpha:{get:function(){
return ET("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(t){ET("5.2.0",
"PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(t)}}}),i.Point.prototype.copy=function(t){return ET(xmt,
"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom"),this.copyFrom(t)},i.ObservablePoint.prototype.copy=function(t){return ET(xmt,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom"),this.copyFrom(t)},
i.Rectangle.prototype.copy=function(t){return ET(xmt,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom"),this.copyFrom(t)},i.Matrix.prototype.copy=function(t){return ET(xmt,
"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo"),this.copyTo(t)},i.systems.StateSystem.prototype.setState=function(t){return ET("v5.1.0","StateSystem.setState has been renamed to StateSystem.set"),this.set(t)},Object.assign(
i.systems.FilterSystem.prototype,{getRenderTarget:function(t,e){return ET(xmt,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture"),this.getFilterTexture(e)},returnRenderTarget:function(t){ET(xmt,
"PIXI.FilterManager.returnRenderTarget method has been replaced with PIXI.systems.FilterSystem.returnFilterTexture"),this.returnFilterTexture(t)},calculateScreenSpaceMatrix:function(t){ET(xmt,
"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var e=t.identity(),i=this.activeState,r=i.sourceFrame,n=i.destinationFrame;return e.translate(r.x/n.width,r.y/n.height
),e.scale(n.width,n.height),e},calculateNormalizedScreenSpaceMatrix:function(t){ET(xmt,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.")
;var e=this.activeState,i=e.sourceFrame,r=e.destinationFrame,n=t.identity();n.translate(i.x/r.width,i.y/r.height);var s=r.width/i.width,o=r.height/i.height;return n.scale(s,o),n}}),Object.defineProperties(i.RenderTexture.prototype,{sourceFrame:{
get:function(){return ET(xmt,"PIXI.RenderTexture.sourceFrame property has been removed"),this.filterFrame}},size:{get:function(){return ET(xmt,"PIXI.RenderTexture.size property has been removed"),this._frame}}});var e=function(n){function t(t,e,i,r){ET(
xmt,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass"),n.call(this,!0,t,e,i,r)}return n&&(t.__proto__=n),(t.prototype=Object.create(n&&n.prototype)).constructor=t}(i.filters.BlurFilterPass),r=function(n){function t(t,e,i,r){
ET(xmt,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass"),n.call(this,!1,t,e,i,r)}return n&&(t.__proto__=n),(t.prototype=Object.create(n&&n.prototype)).constructor=t}(i.filters.BlurFilterPass);Object.assign(i.filters,{
BlurXFilter:e,BlurYFilter:r});var n=i.Sprite,o=i.Texture,a=i.Graphics;function h(t,e,i,r){return ET(xmt,"PIXI.Sprite."+t+" method is deprecated, use PIXI.Sprite.from"),n.from(e,{resourceOptions:{scale:r,crossorigin:i}})}function u(t,e,i,r){return ET(xmt,
"PIXI.Texture."+t+" method is deprecated, use PIXI.Texture.from"),o.from(e,{resourceOptions:{scale:r,crossorigin:i}})}a.prototype.generateCanvasTexture||(a.prototype.generateCanvasTexture=function(){ET(xmt,
'PIXI.Graphics.generateCanvasTexture method is only available in "pixi.js-legacy"')}),Object.defineProperty(i.Graphics.prototype,"graphicsData",{get:function(){return ET(xmt,
"PIXI.Graphics.graphicsData property is deprecated, use PIXI.Graphics.geometry.graphicsData"),this.geometry.graphicsData}}),n.fromImage=h.bind(null,"fromImage"),n.fromSVG=h.bind(null,"fromSVG"),n.fromCanvas=h.bind(null,"fromCanvas"),n.fromVideo=h.bind(
null,"fromVideo"),n.fromFrame=h.bind(null,"fromFrame"),o.fromImage=u.bind(null,"fromImage"),o.fromSVG=u.bind(null,"fromSVG"),o.fromCanvas=u.bind(null,"fromCanvas"),o.fromVideo=u.bind(null,"fromVideo"),o.fromFrame=u.bind(null,"fromFrame"),
Object.defineProperty(i.AbstractRenderer.prototype,"autoResize",{get:function(){return ET(xmt,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity},set:function(t){ET(xmt,
"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity=t}}),Object.defineProperty(i.Renderer.prototype,"textureManager",{get:function(){return ET(xmt,
"PIXI.Renderer.textureManager property is deprecated, use PIXI.Renderer.texture"),this.texture}}),i.utils.mixins={mixin:function(){ET(xmt,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function(){ET(xmt,
"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function(){ET(xmt,"PIXI.utils.mixins.performMixins function is no longer available")}}}jC.registerPlugin("accessibility",At),jC.registerPlugin("extract",on),jC.registerPlugin(
"interaction",Rs),jC.registerPlugin("particle",YD),jC.registerPlugin("prepare",ob),jC.registerPlugin("batch",nO),jC.registerPlugin("tilingSprite",uH),oN.registerPlugin(jW),oN.registerPlugin(SX),rS.registerPlugin(fS),rS.registerPlugin(aN);var Tmt="5.2.0",
Emt={AlphaFilter:HW,BlurFilter:KW,BlurFilterPass:qW,ColorMatrixFilter:CJ,DisplacementFilter:a1,FXAAFilter:X4,NoiseFilter:g7}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e,i){return e&&n(t.prototype,e),
i&&n(t,i),t};function n(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){if(!(t instanceof e))throw new TypeError(
"Cannot call a class as a function")}var o=(r(a,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),a);function a(t,e,i){void 0===e&&(e=!1),s(this,a),this._fn=t,this._once=e,this._thisArg=i,
this._next=this._prev=this._owner=null}function h(t,e){return t._head?(t._tail._next=e)._prev=t._tail:t._head=e,(t._tail=e)._owner=t,e}var u=(r(l,[{key:"handlers",value:function(t){var e=!(arguments.length<=0||void 0===t)&&t,i=this._head;if(e)return!!i
;for(var r=[];i;)r.push(i),i=i._next;return r}},{key:"has",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head
;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t,e){var i=arguments.length<=1||void 0===e?null:e;if("function"!=typeof t)throw new Error(
"MiniSignal#add(): First arg must be a Function.");return h(this,new o(t,!1,i))}},{key:"once",value:function(t,e){var i=arguments.length<=1||void 0===e?null:e;if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.")
;return h(this,new o(t,!0,i))}},{key:"detach",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(
t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(
this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),l);function l(){s(this,l),this._head=this._tail=void 0}u.MiniSignalBinding=o,e.default=u,t.exports=e.default},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0
});var r=(n.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.level<=n.LEVEL_ERROR&&console.error.apply(console,t)},n.WARN=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.level<=n.LEVEL_WARN&&(
window.console.warn?console.warn.apply(console,t):console.log.apply(console,t))},n.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.level<=n.LEVEL_INFO&&console.log.apply(console,t)},n.debug=function(){for(var t=[],
e=0;e<arguments.length;e++)t[e]=arguments[e];n.level<=n.LEVEL_DEBUG&&console.log.apply(console,t)},n.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.level<=n.LEVEL_TRACE&&console.log.apply(console,t)},n.LEVEL_ERROR=4,
n.LEVEL_WARN=3,n.LEVEL_INFO=2,n.LEVEL_DEBUG=1,n.LEVEL_TRACE=0,n.level=n.LEVEL_INFO,n);function n(){}e.Logger=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n.prototype.fire=function(){this.callback()},n)
;function n(t,e,i){this.eventName=t,this.callback=e,this.info=i}e.PonEventHandler=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toRgb=function(t){var e=0,i=0,r=0;switch(typeof t){case"string":e=+("0x"+t.substr(1,2)),
i=+("0x"+t.substr(3,2)),r=+("0x"+t.substr(5,2));break;case"number":e=Math.floor((16711680&t)/65536),i=Math.floor((65280&t)/256),r=Math.floor(255&t)}return"rgb("+e+","+i+","+r+")"},e.objExtend=function(e,i){return Object.keys(i).forEach(function(t){
e[t]=i[t]}),e},e.objClone=function(e){var i={};return Object.keys(e).forEach(function(t){i[t]=e[t]}),i},e.escapeHtml=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},
e.Ease={in:function(t){return t*t},out:function(t){return t*(2-t)},inOut:function(t){return t*t*(3-2*t)}}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},
function(t,e,i){"use strict";var o=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t
){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},a=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},
"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return
)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue
;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}
o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(
var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var n=r(i(5)),s=i(14),h=i(59),u=i(60),l=i(7),c=i(61),d=(Object.defineProperty(p.prototype,"container",{get:function(){
return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"debugInfoVisible",{get:function(){return this.debugContainer.visible},set:function(t){this.debugContainer.visible=t},enumerable:!0,configurable:!0}),
Object.defineProperty(p.prototype,"imageWidth",{get:function(){return null!==this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"imageHeight",{get:function(){return null!==this.image?this.image.height:0},
enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"canvasWidth",{get:function(){return null!==this.canvas?this.canvas.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"canvasHeight",{get:function(){
return null!==this.canvas?this.canvas.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"videoWidth",{get:function(){return null!=this.video?this.video.width:0},set:function(t){null!=this.video&&(this.video.width=t)},
enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"videoHeight",{get:function(){return null!=this.video?this.video.height:0},set:function(t){null!=this.video&&(this.video.height=t)},enumerable:!0,configurable:!0}),Object.defineProperty(
p.prototype,"videoLoop",{get:function(){return null!=this.video&&this.video.loop},set:function(t){null!=this.video&&(this.video.loop=t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"videoVolume",{get:function(){
return null!=this.video?this.video.volume:0},set:function(t){null!=this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),
Object.defineProperty(p.prototype,"x",{get:function(){return this.container.x},set:function(t){this.container.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"y",{get:function(){return this.container.y},set:function(t){
this.container.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"width",{get:function(){return this.maskSprite.width},set:function(t){this.maskSprite.width=this.backgroundSprite.width=t,this.textCanvas.width!=t&&(this.clearText(),
this.textCanvas.width=t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"height",{get:function(){return this.maskSprite.height},set:function(t){this.maskSprite.height=this.backgroundSprite.height=t,this.textCanvas.height!=t&&(
this.clearText(),this.textCanvas.height=t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"visible",{get:function(){return this.container.visible},set:function(t){this.container.visible=t},enumerable:!0,configurable:!0}),
Object.defineProperty(p.prototype,"alpha",{get:function(){return this.container.alpha},set:function(t){this.container.alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"backgroundColor",{get:function(){return this._backgroundColor
},set:function(t){this.setBackgroundColor(t,this._backgroundAlpha)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"backgroundAlpha",{get:function(){return this._backgroundAlpha},set:function(t){this.setBackgroundColor(
this._backgroundColor,t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"imageX",{get:function(){return null===this.imageSprite?0:this.imageSprite.x},set:function(t){null!==this.imageSprite&&(this.imageSprite.x=t)},enumerable:!0,
configurable:!0}),Object.defineProperty(p.prototype,"imageY",{get:function(){return null===this.imageSprite?0:this.imageSprite.y},set:function(t){null!==this.imageSprite&&(this.imageSprite.y=t)},enumerable:!0,configurable:!0}),Object.defineProperty(
p.prototype,"canvasX",{get:function(){return null===this.canvasSprite?0:this.canvasSprite.x},set:function(t){null!==this.canvasSprite&&(this.canvasSprite.x=t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"canvasY",{get:function(){
return null===this.canvasSprite?0:this.canvasSprite.y},set:function(t){null!==this.canvasSprite&&(this.canvasSprite.y=t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"scaleX",{get:function(){return this.container.scale.x},
set:function(t){this.container.scale.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"scaleY",{get:function(){return this.container.scale.y},set:function(t){this.container.scale.y=t},enumerable:!0,configurable:!0}),
p.prototype.destroy=function(){this.clearText(),this.freeImage(),this.freeCanvas(),this.freeVideo(),this.maskSprite.destroy(),this.backgroundSprite.destroy(),null!=this.imageSprite&&this.imageSprite.destroy(),
null!=this.canvasSprite&&this.canvasSprite.destroy(),null!=this.video&&this.video.destroy(),this.textContainer.destroy(),this.imageContainer.destroy(),this.childContainer.destroy(),this.debugContainer.destroy(),this.container.destroy(),
this.children.forEach(function(t){t.destroy()}),this._children=[]},p.prototype.addChild=function(t){return this.children.push(t),this.container.addChild(t.container),t},p.prototype.deleteChildLayer=function(e){var i=[];this.children.forEach(function(t){
t!==e&&i.push(t)}),this._children=i},p.prototype.deleteAllChildren=function(){this._children=[]},p.prototype.child=function(t){return this.children[t]},p.prototype.update=function(e){this.children.forEach(function(t){t.update(e)})},
p.prototype.beforeDraw=function(e){this.visible&&this.debugContainer.visible&&(this.debugBorder.width=this.width,this.debugBorder.height=this.height,this.debugBorder.x=0,this.debugBorder.y=0,this.debugBorder.lineStyle(2,16711680),
this.debugBorder.drawRect(0,0,this.debugBorder.width,this.debugBorder.height),this.debugText.text=this.name+": x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height),this.textCanvas.beforeDraw(e),this.textCanvas.draw(e),
this.visible&&null!==this.canvas&&null!==this.canvasSprite&&this.canvasSprite.beforeDraw(e),this.children.forEach(function(t){t.beforeDraw(e)})},p.isInsideOfLayer=function(t,e,i){var r=t.y,n=t.x+t.width,s=t.y+t.height;return t.x<=e&&e<=n&&r<=i&&i<=s},
p.prototype.isInsideEvent=function(t){var e=t.x,i=t.y;return 0<=e&&e<=this.width&&0<=i&&i<=this.height},p.prototype.isBlockedEvent=function(t,e){if(t instanceof s.PonMouseEvent){if("down"===e||"up"===e){if(this.blockLeftClickFlag&&t.isLeft)return!0;if(
this.blockRightClickFlag&&t.isRight)return!0;if(this.blockCenterClickFlag&&t.isCenter)return!0}if("move"===e&&this.blockMouseMove)return!0}else if(this.blockWheelFlag)return!0;return!1},p.prototype.onMouseEnter=function(t){},
p.prototype._onMouseEnter=function(t){this.onMouseEnter(t)},p.prototype.onMouseLeave=function(t){},p.prototype._onMouseLeave=function(t){this.onMouseLeave(t)},p.prototype.onMouseMove=function(t){},p.prototype._onMouseMove=function(t){for(
var e=this.children.length-1;0<=e;e--){var i=this.children[e];if(i.visible){i.isInsideBuffer=p.isInsideOfLayer(i,t.x,t.y);var r=new s.PonMouseEvent(t.x-i.x,t.y-i.y,t.button);if(i._onMouseMove(r),r.stopPropagationFlag&&t.stopPropagation(),r.forceStopFlag
)return void t.forceStop()}}t.stopPropagationFlag||t.forceStopFlag||this.onMouseMove(t)},p.prototype._preCallMouseEnterLeave=function(t){for(var e=this.children.length-1;0<=e;e--){var i=this.children[e],r=new s.PonMouseEvent(t.x-i.x,t.y-i.y,t.button)
;i._preCallMouseEnterLeave(r)}for(this.callMouseEnterTargetChild=[],this.callMouseLeaveTargetChild=[],e=this.children.length-1;0<=e;e--)if((i=this.children[e]).visible){var n=p.isInsideOfLayer(i,t.x,t.y);n!==i.isInsideBuffer&&(
n?this.callMouseEnterTargetChild.push(i):this.callMouseLeaveTargetChild.push(i)),i.isInsideBuffer=n}},p.prototype._callOnMouseEnter=function(t){for(var e=this.children.length-1;0<=e;e--){var i=this.children[e],r=new s.PonMouseEvent(t.x-i.x,t.y-i.y,
t.button);if(i._callOnMouseEnter(r),r.stopPropagationFlag&&t.stopPropagation(),r.forceStopFlag)return void t.forceStop()}if(!t.stopPropagationFlag&&!t.forceStopFlag)for(e=this.callMouseEnterTargetChild.length-1;0<=e;e--)if(
i=this.callMouseEnterTargetChild[e],r=new s.PonMouseEvent(t.x-i.x,t.y-i.y,t.button),i._onMouseEnter(r),r.stopPropagationFlag&&t.stopPropagation(),r.forceStopFlag)return void t.forceStop()},p.prototype._callOnMouseLeave=function(t){for(
var e=this.children.length-1;0<=e;e--){var i=this.children[e],r=new s.PonMouseEvent(t.x-i.x,t.y-i.y,t.button);if(i._callOnMouseLeave(r),r.stopPropagationFlag&&t.stopPropagation(),r.forceStopFlag)return void t.forceStop()}if(
!t.stopPropagationFlag&&!t.forceStopFlag)for(e=this.callMouseLeaveTargetChild.length-1;0<=e;e--)if(i=this.callMouseLeaveTargetChild[e],r=new s.PonMouseEvent(t.x-i.x,t.y-i.y,t.button),i._onMouseLeave(r),r.stopPropagationFlag&&t.stopPropagation(),
r.forceStopFlag)return void t.forceStop()},p.prototype.onMouseDown=function(t){},p.prototype._onMouseDown=function(t){for(var e=this.children.length-1;0<=e;e--){var i=this.children[e];if(i.visible){var r=new s.PonMouseEvent(t.x-i.x,t.y-i.y,t.button);if(
i._onMouseDown(r),r.stopPropagationFlag&&t.stopPropagation(),r.forceStopFlag)return void t.forceStop()}}t.stopPropagationFlag||t.forceStopFlag||this.onMouseDown(t)},p.prototype.onMouseUp=function(t){},p.prototype._onMouseUp=function(t){for(
var e=this.children.length-1;0<=e;e--){var i=this.children[e];if(i.visible){var r=new s.PonMouseEvent(t.x-i.x,t.y-i.y,t.button);if(i._onMouseUp(r),r.stopPropagationFlag&&t.stopPropagation(),r.forceStopFlag)return void t.forceStop()}}
t.stopPropagationFlag||t.forceStopFlag||this.onMouseUp(t)},p.prototype.onMouseWheel=function(t){for(var e=this.children.length-1;0<=e;e--){var i=this.children[e];i.visible&&i.onMouseWheel(t)}return!this.isBlockedEvent(t,"wheel")},
p.prototype.onChangeStable=function(t){for(var e=this.children.length-1;0<=e;e--)this.children[e].onChangeStable(t)},p.prototype.setBackgroundColor=function(t,e){void 0===e&&(e=1),this.freeImage(),this.freeCanvas(),this.freeVideo(),
this.backgroundSprite.fillColor(t,e),this._backgroundColor=t,this._backgroundAlpha=e,this.hasBackgroundColor=!0},p.prototype.clearBackgroundColor=function(){this.backgroundSprite.clearColor(),this.hasBackgroundColor=!1},Object.defineProperty(p.prototype,
"text",{get:function(){return this.textCanvas.text},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"messageText",{get:function(){return this.text},enumerable:!0,configurable:!0}),p.prototype.addText=function(t){this.textCanvas.addText(t
)},p.prototype.addChar=function(t){this.textCanvas.addChar(t)},p.prototype.getNextTextPos=function(t){return this.textCanvas.getNextTextPos(t)},p.prototype.addTextReturn=function(){this.textCanvas.addTextReturn()},p.prototype.setCharLocate=function(t,e){
this.textCanvas.setCharLocate(t,e)},p.prototype.setIndentPoint=function(){this.textCanvas.setIndentPoint()},p.prototype.clearIndentPoint=function(){this.textCanvas.clearIndentPoint()},p.prototype.reserveRubyText=function(t){
this.textCanvas.reserveRubyText(t)},p.prototype.clearText=function(){this.textCanvas.clear()},p.prototype.loadImage=function(r){return o(this,void 0,void 0,function(){var e,i;return a(this,function(t){switch(t.label){case 0:this.clearBackgroundColor(),
this.freeImage(),this.freeCanvas(),this.freeVideo(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this).resource.loadImage(r)];case 2:return e.image=t.sent(),this.imageFilePath=r,this.imageSprite=new h.PonSprite(this.imageSpriteCallbacks),
this.imageSprite.setImage(this.image),this.width=this.imageSprite.width,this.height=this.imageSprite.height,this.imageX=0,this.imageY=0,[3,4];case 3:throw i=t.sent(),l.Logger.error(i),i;case 4:return[2]}})})},p.prototype.freeImage=function(){
null!=this.imageSprite&&this.imageSprite.destroy(),this.imageSprite=null,this.image=null,this.imageFilePath=null},p.prototype.loadCanvas=function(t){this.clearBackgroundColor(),this.freeImage(),this.freeCanvas(),this.freeVideo();try{this.canvas=t,
this.canvasSprite=new h.PonSprite(this.canvasSpriteCallbacks),this.canvasSprite.setCanvas(t),this.width=this.canvasSprite.width,this.height=this.canvasSprite.height,this.canvasX=0,this.canvasY=0}catch(t){throw l.Logger.error(t),t}},
p.prototype.freeCanvas=function(){null!=this.canvasSprite&&this.canvasSprite.destroy(),this.canvasSprite=null,this.canvas=null},p.prototype.loadVideo=function(n,t,e,i,r,s){var o=this;this.clearBackgroundColor(),this.freeImage(),this.freeCanvas(),
this.freeVideo();var a=this.resource.loadVideoTexture(n,i),h=new u.PonVideo(a,this.videoCallbacks);return h.width=t,h.height=e,h.loop=r,h.volume=s,h.source.autoplay=i,new Promise(function(t,e){var i=-1,r=function(){-1!=i&&window.clearTimeout(i),
h.source.removeEventListener("canplaythrough",r),o.video=h,o.videoFilePath=n,o.width=o.video.width,o.height=o.video.height,t(o)};h.source.addEventListener("canplaythrough",r),i=window.setTimeout(function(){h.source.removeEventListener("canplaythrough",r),
e(o)},3e4),h.source.addEventListener("ended",function(){o.owner.conductor.trigger("video")})})},p.prototype.playVideo=function(){null!=this.video&&this.video.play()},p.prototype.pauseVideo=function(){null!=this.video&&this.video.pause()},
p.prototype.stopVideo=function(){null!=this.video&&this.video.stop()},p.prototype.freeVideo=function(){null!=this.video&&(this.video.stop(),this.video.destroy()),this.video=null,this.videoFilePath=null},Object.defineProperty(p.prototype,"isPlayingVideo",{
get:function(){return null!=this.video&&this.video.playing},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"isLoopPlayingVideo",{get:function(){return null!=this.video&&this.video.loop},enumerable:!0,configurable:!0}),
p.prototype.store=function(t){var e={},i=this;return p.baseLayerStoreParams.forEach(function(t){return e[t]=i[t]}),e.textCanvas=this.textCanvas.store(t),e},p.prototype.restore=function(r,n,s){return o(this,void 0,void 0,function(){var e,i=this;return a(
this,function(t){switch(t.label){case 0:return e=function(){var e=i;p.baseLayerStoreParams.filter(function(t){return-1===p.baseLayerIgnoreParams.indexOf(t)}).forEach(function(t){return e[t]=r[t]})},this.textCanvas.restore(r.textCanvas,n,s),
this.clearBackgroundColor(),r.hasBackgroundColor&&this.setBackgroundColor(r.backgroundColor,r.backgroundAlpha),this.freeImage(),this.freeCanvas(),this.freeVideo(),null==r.imageFilePath||""===r.imageFilePath||r.imageFilePath===this.imageFilePath?[3,2]:[4,
this.loadImage(r.imageFilePath)];case 1:return t.sent(),e(),this.restoreAfterLoadImage(r,n),[3,5];case 2:return null!=r.videoFilePath&&""!=r.videoFilePath&&r.videoFilePath!=this.videoFilePath&&r.videoLoop?(this.freeVideo(),[4,this.loadVideo(
r.videoFilePath,r.videoWidth,r.videoHeight,r.isPlayingVideo,r.videoLoop,r.videoVolume)]):[3,4];case 3:return t.sent(),e(),this.restoreAfterLoadImage(r,n),[3,5];case 4:e(),this.restoreAfterLoadImage(r,n),t.label=5;case 5:return[2]}})})},
p.prototype.restoreAfterLoadImage=function(t,e){},p.prototype.copyTo=function(t){if(t.clearBackgroundColor(),this.hasBackgroundColor&&t.setBackgroundColor(this.backgroundColor,this.backgroundAlpha),t.freeImage(),null!==this.image&&(
t.imageSprite=new h.PonSprite(t.imageSpriteCallbacks),t.imageSprite.setImage(this.image),t.image=this.image),t.freeCanvas(),null!==this.canvas&&(t.canvasSprite=new h.PonSprite(t.canvasSpriteCallbacks),t.canvasSprite.setCanvas(this.canvas),
t.canvas=this.canvas),t.freeVideo(),null!==this.video&&null!=this.videoFilePath&&this.videoFilePath!==t.videoFilePath){var e=this.resource.cloneVideoTexture(this.video.texture);t.video=new u.PonVideo(e,t.videoCallbacks)}var i=this,r=t
;p.baseLayerStoreParams.filter(function(t){return-1===p.baseLayerIgnoreParams.indexOf(t)}).forEach(function(t){return r[t]=i[t]}),t.clearText(),this.textCanvas.copyTo(t.textCanvas)},p.prototype.applyConfig=function(e){if(null!=e){var i=this;Object.keys(e
).forEach(function(t){i[t]=e[t]})}},p.baseLayerStoreParams=["name","x","y","scaleX","scaleY","width","height","visible","alpha","backgroundColor","backgroundAlpha","hasBackgroundColor","imageFilePath","imageX","imageY","canvasX","canvasY","videoFilePath",
"videoWidth","videoHeight","videoLoop","videoVolume","isPlayingVideo"],p.baseLayerIgnoreParams=["backgroundColor","backgroundAlpha","hasBackgroundColor","isPlayingVideo"],p);function p(t,e,i){var r=this;this.debugTextStyle=new n.TextStyle({fontFamily:[
"GenShinGothic","monospace"],fontSize:12,fontWeight:"normal",fontStyle:"normal",fill:16777215,stroke:0,strokeThickness:3,trim:!0}),this.hasBackgroundColor=!1,this._backgroundColor=0,this._backgroundAlpha=1,this.image=null,this.imageFilePath=null,
this.imageSprite=null,this.canvas=null,this.canvasSprite=null,this.videoFilePath=null,this.video=null,this._children=[],this.blockLeftClickFlag=!1,this.blockRightClickFlag=!1,this.blockCenterClickFlag=!1,this.blockMouseMove=!1,this.blockWheelFlag=!1,
this.textCanvas=new c.LayerTextCanvas,this.isInsideBuffer=!1,this.callMouseEnterTargetChild=[],this.callMouseLeaveTargetChild=[],this.name=t,this.resource=e,this.owner=i,this._container=new n.Container,this.maskSprite=new n.Sprite(n.Texture.WHITE),
this.maskSprite.width=32,this.maskSprite.height=32,this.container.addChild(this.maskSprite),this.container.mask=this.maskSprite,this.imageContainer=new n.Container,this.container.addChild(this.imageContainer),this.imageSpriteCallbacks={
pixiContainerAddChild:function(t){r.imageContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.imageContainer.removeChild(t)}},this.textSpriteCallbacks={pixiContainerAddChild:function(t){r.textContainer.addChild(t)},
pixiContainerRemoveChild:function(t){r.textContainer.removeChild(t)}},this.canvasSpriteCallbacks={pixiContainerAddChild:function(t){r.imageContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.imageContainer.removeChild(t)}},this.videoCallbacks={
pixiContainerAddChild:function(t){r.imageContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.imageContainer.removeChild(t)}},this.backgroundSprite=new h.PonSprite(this.imageSpriteCallbacks),this.textContainer=new n.Container,
this.container.addChild(this.textContainer),this.textCanvas.width=this.width,this.textCanvas.height=this.height,this.textContainer.addChild(this.textCanvas.sprite),this.clearText(),this.childContainer=new n.Container,this.container.addChild(
this.childContainer),this.childSpriteCallbacks={pixiContainerAddChild:function(t){r.childContainer.addChild(t)},pixiContainerRemoveChild:function(t){r.childContainer.removeChild(t)}},this.debugContainer=new n.Container,this.debugContainer.visible=!1,
this.container.addChild(this.debugContainer),this.debugBorder=new n.Graphics,this.debugContainer.addChild(this.debugBorder),this.debugText=new n.Text(this.name,this.debugTextStyle),this.debugContainer.addChild(this.debugText),this.visible=!1}e.BaseLayer=d
},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e
){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){
try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},a=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},
trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;
)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],
e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}
if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{
value:!0});var s,h=i(11),u=(s=h.BaseLayer,n(l,s),l.prototype.initButton=function(){this.clearButton()},l.prototype.clearButton=function(){this.setButtonStatus("disabled"),this.insideFlag=!1,this.down=!1},l.prototype.setButtonStatus=function(t){
this.buttonStatus=t,"disabled"===this.buttonStatus&&(this.down=!1),this.resource.getForeCanvasElm().style.cursor=this.resource.cursor[t]},l.prototype.onMouseEnter=function(t){s.prototype.onMouseEnter.call(this,t),
"disabled"!==this.buttonStatus&&this.setButtonStatus("over"),this.insideFlag=!0},l.prototype.onMouseLeave=function(t){s.prototype.onMouseLeave.call(this,t),"disabled"!==this.buttonStatus&&this.setButtonStatus("normal"),this.insideFlag=!1},
l.prototype.onMouseDown=function(t){s.prototype.onMouseDown.call(this,t),this.isInsideEvent(t)&&"disabled"!==this.buttonStatus&&(this.setButtonStatus("on"),this.down=!0)},l.prototype.onMouseUp=function(t){s.prototype.onMouseUp.call(this,t),this.down=!1},
l.prototype.store=function(t){var e=s.prototype.store.call(this,t),i=this;return l.buttonStoreParams.forEach(function(t){e[t]=i[t]}),e},l.prototype.restore=function(i,r,n){return o(this,void 0,void 0,function(){var e;return a(this,function(t){switch(
t.label){case 0:return this.clearButton(),[4,s.prototype.restore.call(this,i,r,n)];case 1:return t.sent(),e=this,l.buttonStoreParams.forEach(function(t){e[t]=i[t]}),this.insideFlag=!1,this.setButtonStatus(i.buttonStatus),[2]}})})},
l.prototype.copyTo=function(t){s.prototype.copyTo.call(this,t);var e=this,i=t;l.buttonStoreParams.forEach(function(t){i[t]=e[t]})},l.buttonStoreParams=["insideFlag","buttonStatus"],l);function l(){var t=null!==s&&s.apply(this,arguments)||this
;return t.insideFlag=!1,t.buttonStatus="disabled",t.down=!1,t}e.Button=u;var c,d=(n(p,c=u),p.prototype.initCommandButton=function(t,e,i,r,n,s,o,a,h,u,l,c){void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===i&&(i=null),void 0===r&&(r=null),void 0===n&&(n=!0),
void 0===s&&(s=!1),void 0===o&&(o=null),void 0===a&&(a=null),void 0===h&&(h=null),void 0===u&&(u=null),void 0===l&&(l=null),void 0===c&&(c=null),this.initButton(),this.jump=t,this.call=e,this.filePath=i,this.label=r,this.countPage=n,this.isSystemButton=s,
this.onEnterExp=o,this.onLeaveExp=a,this.onClickExp=h,this.visible=!0,this.onEnterSoundBuf=u,this.onLeaveSoundBuf=l,this.onClickSoundBuf=c},p.prototype.clearCommandButton=function(){this.clearButton(),this.jump=!0,this.call=!1,this.filePath=null,
this.label=null,this.onClickExp=null,this.onEnterSoundBuf="",this.onLeaveSoundBuf="",this.onClickSoundBuf=""},p.prototype.lockSystemButton=function(){this.isSystemButton&&(this.systemButtonLocked=!0,this.setButtonStatus("disabled"))},
p.prototype.unlockSystemButton=function(){this.isSystemButton&&(this.systemButtonLocked=!1,this.setButtonStatus("normal"))},p.prototype.onChangeStable=function(t){c.prototype.onChangeStable.call(this,t),this.isSystemButton&&(this.systemButtonLocked||(
t?this.insideFlag?this.setButtonStatus("over"):this.setButtonStatus("normal"):this.setButtonStatus("disabled")))},p.prototype.onMouseEnter=function(t){c.prototype.onMouseEnter.call(this,t),"disabled"!==this.buttonStatus&&(
null!=this.onEnterExp&&""!==this.onEnterExp&&this.resource.evalJs(this.onEnterExp),null!=this.onEnterSoundBuf&&""!==this.onEnterSoundBuf&&this.owner.getSoundBuffer(this.onEnterSoundBuf).play())},p.prototype.onMouseLeave=function(t){
c.prototype.onMouseLeave.call(this,t),"disabled"!==this.buttonStatus&&(null!=this.onLeaveExp&&""!==this.onLeaveExp&&this.resource.evalJs(this.onLeaveExp),null!=this.onLeaveSoundBuf&&""!==this.onLeaveSoundBuf&&this.owner.getSoundBuffer(this.onLeaveSoundBuf
).play())},p.prototype.onMouseUp=function(s){return o(this,void 0,void 0,function(){var e,i,r,n;return a(this,function(t){switch(t.label){case 0:if(e=this.down,c.prototype.onMouseUp.call(this,s),!s.isLeft)return[2];if(!e||!this.isInsideEvent(s
)||"disabled"===this.buttonStatus)return[3,11];if(s.stopPropagation(),s.forceStop(),i=this.owner,null!==this.onClickExp&&""!==this.onClickExp&&this.resource.evalJs(this.onClickExp),null!=this.onClickSoundBuf&&""!==this.onClickSoundBuf&&i.getSoundBuffer(
this.onClickSoundBuf).play(),null==this.filePath&&null==this.label)return[3,10];if(!this.call)return[3,5];i.conductor.stop(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.callSubroutine(this.filePath,this.label,this.countPage)];case 2:return t.sent()
,[3,4];case 3:return r=t.sent(),i.error(r),[3,4];case 4:return i.conductor.start(),[3,10];case 5:if(!this.jump)return[3,10];i.conductor.stop(),t.label=6;case 6:return t.trys.push([6,8,,9]),[4,i.conductor.jump(this.filePath,this.label,this.countPage)]
;case 7:return t.sent(),[3,9];case 8:return n=t.sent(),i.error(n),[3,9];case 9:i.conductor.start(),t.label=10;case 10:this.isSystemButton?this.setButtonStatus("normal"):this.setButtonStatus("disabled"),t.label=11;case 11:return[2]}})})},
p.prototype.store=function(t){var e=c.prototype.store.call(this,t),i=this;return p.commandButtonStoreParams.forEach(function(t){e[t]=i[t]}),e},p.prototype.restore=function(e,i,r){return o(this,void 0,void 0,function(){return a(this,function(t){switch(
t.label){case 0:return this.clearCommandButton(),[4,c.prototype.restore.call(this,e,i,r)];case 1:return t.sent(),[2]}})})},p.prototype.restoreAfterLoadImage=function(e,t){c.prototype.restoreAfterLoadImage.call(this,e,t);var i=this
;p.commandButtonStoreParams.forEach(function(t){i[t]=e[t]}),this.insideFlag=!1,this.setButtonStatus(e.buttonStatus)},p.prototype.copyTo=function(t){c.prototype.copyTo.call(this,t);var e=this,i=t;p.commandButtonStoreParams.forEach(function(t){i[t]=e[t]})},
p.commandButtonStoreParams=["jump","call","filePath","label","countPage","isSystemButton","onC","onEnterExp","onLeaveExp","onClickExp","onEnterSoundBuf","onLeaveSoundBuf","onClickSoundBuf","systemButtonLocked"],p);function p(){var t=null!==c&&c.apply(this
,arguments)||this;return t.jump=!0,t.call=!1,t.filePath=null,t.label=null,t.countPage=!0,t.isSystemButton=!1,t.onEnterExp=null,t.onLeaveExp=null,t.onClickExp=null,t.onEnterSoundBuf=null,t.onLeaveSoundBuf=null,t.onClickSoundBuf=null,t.systemButtonLocked=!1
,t}e.CommandButton=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7),n=(s.prototype.debugPrint=function(){r.Logger.debug("TAG: ",this.name,this.values)},s.prototype.clone=function(){var t={};for(
var e in this.values)Object.prototype.hasOwnProperty.call(this.values,e)&&(t[e]=this.values[e]);return new s(this.name,t,this.line)},s);function s(t,e,i){this.name=t,this.values=e,this.line=i}e.Tag=n},function(t,e,i){"use strict";Object.defineProperty(e,
"__esModule",{value:!0});var r=(Object.defineProperty(n.prototype,"isLeft",{get:function(){return 0===this.button},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCenter",{get:function(){return 1===this.button},enumerable:!0,
configurable:!0}),Object.defineProperty(n.prototype,"isRight",{get:function(){return 2===this.button},enumerable:!0,configurable:!0}),n.prototype.stopPropagation=function(){this._stopPropagationFlag=!0},Object.defineProperty(n.prototype,
"stopPropagationFlag",{get:function(){return this._stopPropagationFlag},enumerable:!0,configurable:!0}),n.prototype.forceStop=function(){this._forceStopFlag=!0},Object.defineProperty(n.prototype,"forceStopFlag",{get:function(){return this._forceStopFlag},
enumerable:!0,configurable:!0}),n);function n(t,e,i){this._stopPropagationFlag=!1,this._forceStopFlag=!1,t instanceof MouseEvent?(this.x=t.offsetX,this.y=t.offsetY,this.button=t.button):null!=t&&null!=e&&null!=i?(this.x=t,this.y=e,this.button=i):(this.x=0
,this.y=0,this.button=0)}e.PonMouseEvent=r},function(t,r,e){"use strict";(function(i){Object.defineProperty(r,"__esModule",{value:!0});var t=(Object.defineProperty(e.prototype,"filterName",{get:function(){return e.filterName},enumerable:!0,configurable:!0
}),Object.defineProperty(e.prototype,"pixiFilter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),e.prototype.permitParams=function(e,t){var i={};return t.forEach(function(t){null!=e[t]&&(i[t]=e[t])}),i},e.prototype.store=function(){
return this.params},e.filterName="LayerFilter(base class)",e);function e(t,e){void 0===e&&(e=[]),this.params={},this._filter=new i.filters.AlphaFilter(1),0<e.length&&(t=this.permitParams(t,e)),this.params=t}r.LayerFilter=t}).call(this,e(5))},function(t,e,
i){"use strict";t.exports=function(t,e){e=e||{};for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},
parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=r.parser[e.strictMode?"strict":"loose"].exec(t),
n={},s=14;s--;)n[r.key[s]]=i[s]||"";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,function(t,e,i){e&&(n[r.q.name][e]=i)}),n}},function(t,e,i){"use strict";var n=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){
function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},s=this&&this.__generator||function(i,r){var n,s,o,t,a={
label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n
)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:
return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){
a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{
value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var r,o,a=i(33),h=i(18);(o=r=e.ConductorState||(e.ConductorState={}))[o.Stop=0]="Stop",o[o.Run=1]="Run",o[o.Sleep=2]="Sleep";var u=(Object.defineProperty(
l.prototype,"script",{get:function(){return this._script},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),l.prototype.loadScript=function(r){return n(this,
void 0,void 0,function(){var e,i;return s(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.latestScriptFilePath=r,[4,(e=this).resource.loadScript(r)];case 1:return e._script=t.sent(),[3,3];case 2:throw i=t.sent(),
this.eventCallbacks.onError(i),i;case 3:return[2]}})})},l.prototype.jump=function(e,i,r){return void 0===i&&(i=null),void 0===r&&(r=!0),n(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return r&&(this.passLatestSaveMark(),
this.latestSaveMarkName=""),null==e||""===e?[3,2]:[4,this.loadScript(e)];case 1:return t.sent(),null!=i&&this.script.goToLabel(i),[3,3];case 2:null!=i&&this.script.goToLabel(i),t.label=3;case 3:return[2]}})})},l.prototype.isPassed=function(t){
return this.readUnread.isPassed(this.script,t)},l.prototype.isPassedLatestSaveMark=function(){return this.isPassed(this.latestSaveMarkName)},l.prototype.passSaveMark=function(t){this.readUnread.pass(this.script,t)},l.prototype.passLatestSaveMark=function(
){this.passSaveMark(this.latestSaveMarkName)},l.prototype.conduct=function(t){if(this.status!==r.Stop){if(this.status===r.Sleep){if(t-this.sleepStartTick<this.sleepTime)return;this.start()}for(this.callOnChangeStable();;){var e=this.script.getNextTag()
;if(null==e)return void this.stop();var i=void 0;switch((e=e.clone()).name){case"__label__":i=this.eventCallbacks.onLabel(e.values.__body__,e.line,t);break;case"__save_mark__":this.passLatestSaveMark(),this.latestSaveMarkName=e.values.name,
i=this.eventCallbacks.onSaveMark(e.values.name,e.values.comment,e.line,t);break;case"__js__":i=this.eventCallbacks.onJs(e.values.__body__,e.values.print,e.line,t);break;case"__line_break__":i=null!=this.resource.commandShortcut["\n"]?(
e=this.script.callCommandShortcut(e,this.resource.commandShortcut["\n"]),this.eventCallbacks.onTag(e,e.line,t)):"continue";break;case"ch":null!=this.resource.commandShortcut[e.values.text]&&(e=this.script.callCommandShortcut(e,
this.resource.commandShortcut[e.values.text])),i=this.eventCallbacks.onTag(e,e.line,t);break;default:i=this.eventCallbacks.onTag(e,e.line,t)}if("break"===i)break;if(this.status!==r.Run)break}this.callOnChangeStable()}},l.prototype.applyJsEntity=function(t
){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=t[e];if("string"!=typeof i)continue;var r=""+i;if(2<=r.length&&"&"===t.charAt(0)){var n=r.substring(1);t[e]=this.resource.evalJs(n)}}},l.prototype.callOnChangeStable=function(){
this.stableBuffer!==this.isStable&&this.eventCallbacks.onChangeStable(this.isStable),this.stableBuffer=this.isStable},l.prototype.start=function(){return this._status=r.Run,this.sleepTime=-1,this.sleepStartTick=-1,this.sleepSender="","continue"},
l.prototype.stop=function(){return this._status=r.Stop,"break"},l.prototype.sleep=function(t,e,i){return this._status=r.Sleep,this.sleepStartTick=t,this.sleepTime=e,this.sleepSender=i,"break"},Object.defineProperty(l.prototype,"isStable",{get:function(){
return!(this._status!==r.Stop||this.hasEventHandler("move")||this.hasEventHandler("trans")||this.hasEventHandler("frameanim")||this.hasEventHandler("soundstop")||this.hasEventHandler("soundfade"))},enumerable:!0,configurable:!0}),
l.prototype.addEventHandler=function(t){var e=t.eventName;null==this.eventHandlers[e]&&(this.eventHandlers[e]=[]),this.eventHandlers[e].push(t)},l.prototype.hasEventHandler=function(t){return null!=this.eventHandlers[t]},l.prototype.trigger=function(t){
var e=this.eventHandlers[t];return null!=e&&(this.clearEventHandlerByName(t),e.forEach(function(t){t.fire()}),!0)},l.prototype.clearAllEventHandler=function(){this.eventHandlers={}},l.prototype.clearEventHandler=function(r){var n=this;Object.keys(
this.eventHandlers).forEach(function(i){n.eventHandlers[i].forEach(function(t,e){t!==r||n.eventHandlers[i].splice(e,1)})})},l.prototype.clearEventHandlerByName=function(t){delete this.eventHandlers[t]},l.prototype.store=function(t,e){var i={},r=this;if(
l.conductorStoreParams.forEach(function(t){i[t]=r[t]}),i.scriptFilePath=this.script.filePath,i.saveMarkName=t,this.script.isInsideOfMacro())throw new Error("マクロの中でセーブすることはできません");if(this.script.isInsideOfForLoop())throw new Error(
"for〜endforの中でセーブすることはできません");if(this.script.isInsideOfIf())throw new Error("if〜endifの中でセーブすることはできません");return i},l.prototype.restore=function(i,t){return n(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return e=this
,l.conductorStoreParams.forEach(function(t){e[t]=i[t]}),this.stop(),[4,this.loadScript(i.scriptFilePath)];case 1:return t.sent(),this.script.goToSaveMark(i.saveMarkName),[2]}})})},l.conductorStoreParams=["_status","sleepStartTick","sleepTime",
"sleepSender"],l);function l(t,e,i){this.latestScriptFilePath="",this._status=r.Stop,this.sleepStartTick=-1,this.sleepTime=-1,this.sleepSender="",this.stableBuffer=!1,this.eventHandlers={},this.eventHandlersStack=[],this.latestSaveMarkName="",
this.resource=t,this.name=e,this.eventCallbacks=i,this._script=new h.Script(this.resource,"__dummy__",";s"),this.readUnread=new a.ReadUnread(this.resource)}e.Conductor=u},function(t,e,i){"use strict";var r=this&&this.__importStar||function(t){if(
t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var n=i(4),s=i(7),o=i(47),a=i(48),h=i(13),u=r(i(9)),l=(Object.defineProperty(
c.prototype,"filePath",{get:function(){return this._filePath},enumerable:!0,configurable:!0}),c.prototype.debugPrint=function(){s.Logger.debug("============================================"),this.parser.debugPrint(),s.Logger.debug("Script current point: "
,this.tagPoint),s.Logger.debug("============================================")},c.prototype.clone=function(){var t=new c(this.resource,this.filePath,null);return t.parser=this.parser,t},c.prototype.goToStart=function(){this.goTo(0)},
c.prototype.goTo=function(t){t<0&&(t=0),t>=this.parser.tags.length&&(t=this.parser.tags.length-1),this.tagPoint=t},c.prototype.getPoint=function(){return this.tagPoint},c.prototype.goToLabel=function(t){var e=this.parser.getLabelPos(t);if(-1===e
)throw new Error(this.filePath+"内に、ラベル "+t+" が見つかりませんでした");this.goTo(e+1)},c.prototype.goToSaveMark=function(t){var e=this.parser.getSaveMarkPos(t);if(-1===e)throw new Error(this.filePath+"内に、セーブマーク "+t+" が見つかりませんでした");this.goTo(e+1)},
c.prototype.getCurrentTag=function(){if(0!==this.macroStack.length)return this.macroStack[this.macroStack.length-1].getCurrentTag();var t=this.parser.tags;return t.length<=this.tagPoint?null:t[this.tagPoint]},c.prototype.getNextTag=function(){if(
0===this.macroStack.length){var t=this.parser.tags;if(t.length<=this.tagPoint)return null;var e=this.latestTagBuffer=t[this.tagPoint++];return this.resource.hasMacro(e.name)?(this.callMacro(e),this.getNextTag()):e}
var i=this.macroStack[this.macroStack.length-1];return e=this.latestTagBuffer=i.getNextTag(),this.resource.setMacroParams(i.params),null!=e?this.resource.hasMacro(e.name)?(this.callMacro(e),this.getNextTag()):e:(this.macroStack.pop(),
this.resource.clearMacroParams(),this.getNextTag())},c.prototype.callMacro=function(t){var e=this.resource.getMacro(t.name).clone();e.clearTagPoint(),e.params=u.objClone(t.values),n.applyJsEntity(this.resource,e.params),this.macroStack.push(e)},
c.prototype.isInsideOfMacro=function(){return 0!==this.macroStack.length},c.prototype.callCommandShortcut=function(t,e){var i=new h.Tag(e,{},t.line);if(this.resource.hasMacro(i.name)){this.callMacro(i);var r=this.getNextTag();if(null==r)throw new Error(
"コマンドショートカットの呼び出しに失敗しました");return r}return i},c.prototype.getLatestTag=function(){return this.latestTagBuffer},c.prototype.defineMacro=function(t){for(var e=[];;){var i=this.getNextTagWithoutMacro();if(null===i)throw new Error(
"マクロ定義エラー。macroとendmacroの対応が取れていません");if("__label__"===i.name)throw new Error("マクロ定義エラー。マクロの中でラベルは使用できません");if("__save_mark__"===i.name)throw new Error("マクロ定義エラー。マクロの中でセーブマークは使用できません");if("endmacro"===i.name)break;e.push(i.clone())}if(0===e.length
)throw new Error("マクロ定義の中身が空です");return new o.Macro(t,e)},c.prototype.getNextTagWithoutMacro=function(){var t=this.parser.tags;return t.length<=this.tagPoint?null:t[this.tagPoint++]},c.prototype.getNextTagForIf=function(){if(0!==this.macroStack.length
)return this.macroStack[this.macroStack.length-1].getNextTag();var t=this.parser.tags;return t.length<=this.tagPoint?null:t[this.tagPoint++]},c.prototype.ifJump=function(t,e){this.ifDepth++,this.resource.evalJs(t)||this.goToElseFromIf(e)},
c.prototype.goToElseFromIf=function(t){for(var e=0;;){var i=this.getNextTagForIf();if(null===i)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません");if("if"===i.name)e++;else if("else"===i.name){if(0===e)break}else if("endif"===i.name){if(0===e){if(
this.ifDepth--,this.ifDepth<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません");break}e--}else if("elsif"===i.name&&0===e){var r=i.clone();if(n.applyJsEntity(this.resource,r.values),n.castTagValues(r,t.elsif),this.resource.evalJs(r.values.exp)
)break}if(e<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません")}},c.prototype.elsifJump=function(){this.goToEndifFromElse()},c.prototype.elseJump=function(){this.goToEndifFromElse()},c.prototype.endif=function(){if(this.ifDepth--,this.ifDepth<0
)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません")},c.prototype.goToEndifFromElse=function(){for(var t=0;;){var e=this.getNextTagForIf();if(null===e)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません");if("if"===e.name)t++;else if(
"endif"===e.name){if(0===t){if(this.ifDepth--,this.ifDepth<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません");break}t--}if(t<0)throw new Error("条件分岐エラー。if/else/elsif/endifの対応が取れていません")}},c.prototype.isInsideOfIf=function(){return 0!==this.ifDepth
},c.prototype.startForLoop=function(t,e){void 0===e&&(e="__index__");var i={startTagPoint:this.tagPoint,indexVarName:e,loops:t,count:0};this.forLoopStack.push(i),this.resource.evalJs('tv["'+i.indexVarName+'"] = '+i.count+";")},
c.prototype.endForLoop=function(){var t=this.forLoopStack[this.forLoopStack.length-1];if(null==t)throw new Error("予期しないendforです。forとendforの対応が取れていません");++t.count<t.loops?(this.resource.tmpVar[t.indexVarName]=t.count,this.goTo(t.startTagPoint)
):this.forLoopStack.pop()},c.prototype.breakForLoop=function(){for(var t=0;;){var e=this.getNextTagForIf();if(null===e)throw new Error("breakforの動作エラー。forとendforの対応が取れていません");if("for"===e.name)t++;else if("endfor"===e.name){if(0===t)break;t--}if(t<0
)throw new Error("breakforの動作エラー。forとendforの対応が取れていません")}},c.prototype.isInsideOfForLoop=function(){return 0!==this.forLoopStack.length},c);function c(t,e,i){this.tagPoint=0,this.latestTagBuffer=null,this.forLoopStack=[],this.ifDepth=0,this.macroStack=[],
this.resource=t,this._filePath=e,this.parser=null!=i?new a.ScriptParser(this.resource,i):new a.ScriptParser(this.resource,"")}e.Script=l},function(t,e,i){"use strict";var r=Object.prototype.hasOwnProperty,p="~";function n(){}function a(t,e,i){this.fn=t,
this.context=e,this.once=i||!1}function s(t,e,i,r,n){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new a(i,r||t,n),o=p?p+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(
t._events[o]=s,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(p=!1)),
o.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)r.call(t,e)&&i.push(p?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},o.prototype.listeners=function(t
){var e=p?p+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,n=i.length,s=new Array(n);r<n;r++)s[r]=i[r].fn;return s},o.prototype.listenerCount=function(t){var e=p?p+t:t,i=this._events[e];return i?i.fn?1:i.length:0},
o.prototype.emit=function(t,e,i,r,n,s){var o=p?p+t:t;if(!this._events[o])return!1;var a,h,u=this._events[o],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(
u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,n),!0;case 6:return u.fn.call(u.context,e,i,r,n,s),!0}for(h=1,a=new Array(l-1);h<l;h++)a[h-1]=arguments[h]
;u.fn.apply(u.context,a)}else{var c,d=u.length;for(h=0;h<d;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),l){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,i);break
;case 4:u[h].fn.call(u[h].context,e,i,r);break;default:if(!a)for(c=1,a=new Array(l-1);c<l;c++)a[c-1]=arguments[c];u[h].fn.apply(u[h].context,a)}}return!0},o.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return s(
this,t,e,i,!0)},o.prototype.removeListener=function(t,e,i,r){var n=p?p+t:t;if(!this._events[n])return this;if(!e)return u(this,n),this;var s=this._events[n];if(s.fn)s.fn!==e||r&&!s.once||i&&s.context!==i||u(this,n);else{for(var o=0,a=[],h=s.length;o<h;o++
)(s[o].fn!==e||r&&!s[o].once||i&&s[o].context!==i)&&a.push(s[o]);a.length?this._events[n]=1===a.length?a[0]:a:u(this,n)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=p?p+t:t,this._events[e]&&u(this,e)):(this._events=new n,
this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=p,o.EventEmitter=o,t.exports=o},function(S,I,C){(function(t,w){var A;!function(t){var e,i=t.Promise,
r=i&&"resolve"in i&&"reject"in i&&"all"in i&&"race"in i&&(new i(function(t){e=t}),"function"==typeof e);I?(I.Promise=r?i:E,I.Polyfill=E):void 0===(A=function(){return r?i:E}.call(I,C,I,S))||(S.exports=A);function n(){}var s="pending",o="sealed",
a="fulfilled",h="rejected";function u(t){return"[object Array]"===Object.prototype.toString.call(t)}var l,c=void 0!==w?w:setTimeout,d=[];function p(){for(var t=0;t<d.length;t++)d[t][0](d[t][1]);l=!(d=[])}function f(t,e){d.push([t,e]),l||(l=!0,c(p,0))}
function m(t){var e=t.owner,i=e.state_,r=e.data_,n=t[i],s=t.then;if("function"==typeof n){i=a;try{r=n(r)}catch(t){g(s,t)}}_(s,r)||(i===a&&y(s,r),i===h&&g(s,r))}function _(e,i){var r;try{if(e===i)throw new TypeError(
"A promises callback cannot return that same promise.");if(i&&("function"==typeof i||"object"==typeof i)){var t=i.then;if("function"==typeof t)return t.call(i,function(t){r||(r=!0,i!==t?y(e,t):v(e,t))},function(t){r||(r=!0,g(e,t))}),!0}}catch(t){
return r||g(e,t),!0}return!1}function y(t,e){t!==e&&_(t,e)||v(t,e)}function v(t,e){t.state_===s&&(t.state_=o,t.data_=e,f(b,t))}function g(t,e){t.state_===s&&(t.state_=o,t.data_=e,f(T,t))}function x(t){var e=t.then_;t.then_=void 0;for(
var i=0;i<e.length;i++)m(e[i])}function b(t){t.state_=a,x(t)}function T(t){t.state_=h,x(t)}function E(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof E==!1)throw new TypeError(
"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function i(t){g(e,t)}try{t(function(t){y(e,t)},i)}catch(t){i(t)}}(t,this)}E.prototype={constructor:E,
state_:s,then_:null,data_:void 0,then:function(t,e){var i={owner:this,then:new this.constructor(n),fulfilled:t,rejected:e};return this.state_===a||this.state_===h?f(m,i):this.then_.push(i),i.then},catch:function(t){return this.then(null,t)}},
E.all=function(a){if(!u(a))throw new TypeError("You must pass an array to Promise.all().");return new this(function(i,t){var r=[],n=0;function e(e){return n++,function(t){r[e]=t,--n||i(r)}}for(var s,o=0;o<a.length;o++)(s=a[o]
)&&"function"==typeof s.then?s.then(e(o),t):r[o]=s;n||i(r)})},E.race=function(n){if(!u(n))throw new TypeError("You must pass an array to Promise.race().");return new this(function(t,e){for(var i,r=0;r<n.length;r++)(i=n[r]
)&&"function"==typeof i.then?i.then(t,e):t(i)})},E.resolve=function(e){return e&&"object"==typeof e&&e.constructor===this?e:new this(function(t){t(e)})},E.reject=function(i){return new this(function(t,e){e(i)})}}(
"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this)}).call(this,C(10),C(24).setImmediate)},function(t,e,i){"use strict";var h=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,
l=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if(
"0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}
}()?Object.assign:function(t,e){for(var i,r,n=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),s=1;s<arguments.length;s++){for(var o in i=Object(arguments[s]))u.call(i,o)&&(n[o]=i[o])
;if(h){r=h(i);for(var a=0;a<r.length;a++)l.call(i,r[a])&&(n[r[a]]=i[r[a]])}}return n}},function(t,x,b){"use strict";(function(t){var r,e=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){
t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),u=this&&this.__awaiter||function(s,o,a,h){
return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},
l=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t
;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(
e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0
;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0
}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}
;Object.defineProperty(x,"__esModule",{value:!0});var n,s,o=b(17),c=b(7),a=b(49),h=b(57),d=b(13),p=i(b(9)),f=b(58),m=b(62),_=b(4);(s=n=x.SkipType||(x.SkipType={}))[s.INVALID=0]="INVALID",s[s.UNTIL_CLICK_WAIT=1]="UNTIL_CLICK_WAIT",s[s.UNTIL_S=2]="UNTIL_S",
s[s.WHILE_PRESSING_CTRL=3]="WHILE_PRESSING_CTRL";var y,v=(y=a.PonGame,e(g,y),Object.defineProperty(g.prototype,"foreLayers",{get:function(){return this.forePrimaryLayer.children},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,
"backLayers",{get:function(){return this.backPrimaryLayer.children},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"messageLayerNum",{get:function(){return this._messageLayerNum},set:function(t){this._messageLayerNum=t},enumerable:!0,
configurable:!0}),Object.defineProperty(g.prototype,"lineBreakGlyphLayerNum",{get:function(){return this._lineBreakGlyphLayerNum},set:function(t){this._lineBreakGlyphLayerNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,
"pageBreakGlyphLayerNum",{get:function(){return this._pageBreakGlyphLayerNum},set:function(t){this._pageBreakGlyphLayerNum=t},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"tmpVar",{get:function(){return this.resource.tmpVar},
enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"gameVar",{get:function(){return this.resource.gameVar},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"systemVar",{get:function(){return this.resource.systemVar},
enumerable:!0,configurable:!0}),g.prototype.destroy=function(){this.stop(),this.forePrimaryLayer.destroy(),this.backPrimaryLayer.destroy(),this.plugins.forEach(function(t){null!=t.destroy&&t.destroy()}),this.pluginMap={},y.prototype.destroy.call(this)},
g.prototype.start=function(){return u(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return y.prototype.start.call(this),this.resource.existSystemData(this.saveDataPrefix)&&this.loadSystemData(this.saveDataPrefix),[4,
this.historyLayer.init(this.config)];case 1:return t.sent(),[4,this.conductor.loadScript("start.pon")];case 2:return t.sent(),this.conductor.start(),[2]}})})},g.prototype.stop=function(){y.prototype.stop.call(this)},g.prototype.pause=function(t,e){
void 0===t&&(t=!1),void 0===e&&(e=!0),t&&this.conductor.passLatestSaveMark(),this.conductor.stop(),e&&this.stopSkip(),this.lock()},g.prototype.resume=function(){this.conductor.start(),this.unlock()},g.prototype.addPlugin=function(t,e){if(
null!=this.pluginMap[t])throw new Error("プラグイン"+t+"はすでに登録済みです。");this.pluginMap[t]=e,this.plugins.push(e),console.log(t,e,this.pluginMap,this.plugins)},g.prototype.removePlugin=function(t){var e=this.pluginMap[t];this.plugins=this.plugins.filter(function(
t){return t!=e}),delete this.pluginMap[t]},g.prototype.getPlugin=function(t){if(null==this.pluginMap[t])throw new Error("プラグイン"+t+"は登録されていません。");return this.pluginMap[t]},g.prototype.update=function(e){var t=this;if(
this.autoModeFlag&&0<=this.autoModeStartTick&&e-this.autoModeStartTick>=this.autoModeInterval&&(this.autoModeStartTick=-1,this.onPrimaryClick(),this.startAutoMode()),this.conductor.conduct(e),
this.conductor.isStable&&0<this.onSoundStopParamsList.length&&null==this.currentOnSoundStopParams){var i=this.currentOnSoundStopParams=this.onSoundStopParamsList.pop();null!=i&&(this.conductor.stop(),(i.call?this.callSubroutine(i.file,i.label
):this.conductor.jump(i.file,i.label)).then(function(){t.conductor.start(),t.currentOnSoundStopParams=null}))}this.forePrimaryLayer.update(e),this.backPrimaryLayer.update(e),this.historyLayer.update(e),this.autoModeLayer.visible=this.autoModeFlag,
this.resetLineBreakGlyphPos(),this.resetPageBreakGlyphPos(),this.plugins.forEach(function(t){null!=t.onUpdate&&t.onUpdate(e)})},g.prototype.beforeDraw=function(e){this.forePrimaryLayer.beforeDraw(e),this.backPrimaryLayer.beforeDraw(e),this.quake(e),
this.plugins.forEach(function(t){null!=t.beforeDraw&&t.beforeDraw(e)})},g.prototype.error=function(t){this.conductor.stop();var e=t.message,i=this.conductor.latestScriptFilePath,r=this.conductor.script.getLatestTag()
;e=null!==r?"("+i+":"+r.line+") "+e:"("+i+":1) "+e,y.prototype.error.call(this,new Error(e))},g.prototype.showLayerDebugInfo=function(){this.foreLayers.forEach(function(t){return t.debugInfoVisible=!0}),this.backLayers.forEach(function(t){
return t.debugInfoVisible=!0})},g.prototype.hideLayerDebugInfo=function(){this.foreLayers.forEach(function(t){return t.debugInfoVisible=!1}),this.backLayers.forEach(function(t){return t.debugInfoVisible=!1})},g.prototype.getDebugInfo=function(){
var t=Date.now();return{latestSaveData:this.latestSaveData,systemVar:this.systemVar,foreLayers:this.foreLayers,backLayers:this.backLayers,foreLayerStoredData:this.forePrimaryLayer.store(t),backLayerStoredData:this.backPrimaryLayer.store(t)}},
g.prototype.dumpDebugInfo=function(){var t=this.getDebugInfo();console.info("========================================="),console.info("latestSaveData",t.latestSaveData),console.info("systemVar",t.systemVar),console.info("foreLayers(current object)",
t.foreLayers),console.info("backLayers(current object)",t.backLayers),console.info("foreLayers(stored data)",t.foreLayerStoredData),console.info("backLayers(stored data)",t.backLayerStoredData),console.info("=========================================")},
Object.defineProperty(g.prototype,"eventReceivesLayer",{get:function(){return this.historyLayer.visible?this.historyLayer:this.forePrimaryLayer},enumerable:!0,configurable:!0}),g.prototype.onMouseEnter=function(t){this.eventReceivesLayer._onMouseEnter(t)}
,g.prototype.onMouseLeave=function(t){this.eventReceivesLayer._onMouseLeave(t)},g.prototype.onMouseMove=function(t){var e=this.eventReceivesLayer;e._preCallMouseEnterLeave(t),e._callOnMouseLeave(t),e._callOnMouseEnter(t),e._onMouseMove(t)},
g.prototype.onMouseDown=function(t){this.eventReceivesLayer._onMouseDown(t)},g.prototype.onMouseUp=function(t){this.eventReceivesLayer._onMouseUp(t),t.stopPropagationFlag||t.forceStopFlag||(t.isRight?this.onPrimaryRightClick():this.onPrimaryClick())},
g.prototype.onMouseWheel=function(t){var e=this;return this.historyLayer.visible?this.historyLayer.onMouseWheel(t):!!this.forePrimaryLayer.onMouseWheel(t)&&(this.conductor.isStable&&this.enabledHistory&&t.isUp?(this.showHistoryLayer(),!1):!(
!this.onMouseWheelLocked&&t.isDown)||(this.onMouseWheelLocked=!0,window.setTimeout(function(){e.onMouseWheelLocked=!1},500),this.onPrimaryClick()))},g.prototype.onPrimaryClick=function(){return this.hideMessageByRClickFlag?(this.showMessages(),!(
this.hideMessageByRClickFlag=!1)):(this.conductor.trigger("click")||(this.skipMode=n.INVALID,this.stopAutoMode(),this.clickSkipEnabled&&this.conductor.status===o.ConductorState.Sleep&&"ch"===this.conductor.sleepSender&&(this.conductor.start(),
this.skipMode=n.UNTIL_CLICK_WAIT)),!0)},g.prototype.onPrimaryRightClick=function(){return u(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return this.rightClickEnabled&&this.conductor.isStable?(
this.autoModeFlag&&this.stopAutoMode(),this.isSkipping&&this.stopSkip(),this.rightClickJump?[4,this.conductor.jump(this.rightClickFilePath,this.rightClickLabel,!1)]:[3,2]):[2,!1];case 1:return t.sent(),this.conductor.start(),[3,3];case 2:
this.rightClickCall?this.callSubroutine(this.rightClickFilePath,this.rightClickLabel,!1):this.hideMessageFlag?this.hideMessageByRClickFlag?this.showMessagesByRightClick():this.conductor.trigger("click"):this.hideMessagesByRightClick(),t.label=3;case 3:
return[2,!1]}})})},g.prototype.onKeyDown=function(t){if(this.historyLayer.visible);else switch(t.key){case"Ctrl":case"ctrl":case"Control":this.onPrimaryClick(),this.startSkipByCtrl()}return!0},g.prototype.onKeyUp=function(t){if(this.historyLayer.visible
)switch(t.key.toLowerCase()){case"esc":case"escape":this.hideHistoryLayer();break;case"arrowup":this.conductor.isStable&&this.historyLayer.scrollUpPage();break;case"arrowdown":this.conductor.isStable&&this.historyLayer.scrollDownPage()}else switch(
t.key.toLowerCase()){case"ctrl":case"control":this.stopWhilePressingCtrlSkip();break;case"esc":case"escape":this.onPrimaryRightClick();break;case"enter":this.onPrimaryClick();break;case"arrowup":
this.conductor.isStable&&this.enabledHistory&&this.showHistoryLayer()}return!0},g.prototype.initTagAction=function(){var i=this;_.generateTagActions(this).forEach(function(e){e.names.forEach(function(t){i.addTagAction(t,e)})})},
g.prototype.addTagAction=function(t,e){null==this.tagActions[t]?this.tagActions[t]=e:this.error(new Error(t+"はすでに存在しています。"))},g.prototype.addCommandShortcut=function(t,e){if(1!==t.length)throw new Error("コマンドショートカットには1文字しか指定できません")
;this.resource.commandShortcut[t]=e},g.prototype.delCommandShortcut=function(t){delete this.resource.commandShortcut[t]},g.prototype.execCommand=function(t,e){void 0===e&&(e={});var i=this.conductor.script.getCurrentTag(),r=null!=i?i.line:0;this.onTag(
new d.Tag(t,e,r),r,Date.now())},g.prototype.onTag=function(i,t,e){c.Logger.debug("onTag: ",i.name,i.values,i);var r=this.tagActions[i.name];if(null!=r)return null==i.values.if||""==i.values.if||this.resource.evalJs(i.values.if)?(_.applyJsEntity(
this.resource,i.values),_.castTagValues(i,r),r.values.forEach(function(t){var e=i.values[t.name];if(null==e){if(t.required)throw new Error(i.name+"タグの"+t.name+"は必須です。");null!=t.defaultValue&&(i.values[t.name]=t.defaultValue)}}),r.action(i.values,e)
):"continue";if(this.raiseError.unknowncommand)throw new Error(i.name+"というタグは存在しません");return"continue"},g.prototype.onLabel=function(t,e,i){return"continue"},g.prototype.onSaveMark=function(t,e,i,r){return this.conductor.isPassed(t)||(
this.skipMode===n.WHILE_PRESSING_CTRL?this.canSkipUnreadPartByCtrl||this.stopSkip():this.isSkipping&&(this.canSkipUnreadPart||this.stopSkip())),null!=e&&""!==e&&(this.latestSaveComment=e),this.latestSaveData=this.generateSaveData(t,this.latestSaveComment,
r),"continue"},g.prototype.onJs=function(t,e,i,r){var n=this.resource.evalJs(t);if(e){var s=new d.Tag("ch",{text:""+n},i);return this.onTag(s,i,r)}return"continue"},g.prototype.onChangeStable=function(e){this.forePrimaryLayer.onChangeStable(e),
this.backPrimaryLayer.onChangeStable(e),this.plugins.forEach(function(t){null!=t.onChangeStable&&t.onChangeStable(e)})},g.prototype.onReturnSubroutin=function(t){void 0===t&&(t=!1),this.conductor.trigger("return_subroutin"),t&&this.hideBreakGlyph()},
Object.defineProperty(g.prototype,"isSkipping",{get:function(){return this.skipMode!==n.INVALID},enumerable:!0,configurable:!0}),g.prototype.startSkipByTag=function(){(this.conductor.isPassedLatestSaveMark()||this.canSkipUnreadPart)&&(
this.skipMode=n.UNTIL_S)},g.prototype.startSkipByCtrl=function(){(this.conductor.isPassedLatestSaveMark()||this.canSkipUnreadPartByCtrl)&&(this.skipMode=n.WHILE_PRESSING_CTRL)},g.prototype.stopWhilePressingCtrlSkip=function(){
this.skipMode===n.WHILE_PRESSING_CTRL&&this.stopSkip()},g.prototype.stopUntilClickSkip=function(){this.skipMode===n.UNTIL_CLICK_WAIT&&this.stopSkip()},g.prototype.stopSkip=function(){this.skipMode=n.INVALID},Object.defineProperty(g.prototype,
"autoModeLayer",{get:function(){return this.foreLayers[this.autoModeLayerNum]},enumerable:!0,configurable:!0}),g.prototype.startAutoMode=function(){this.autoModeFlag=!0,this.autoModeStartTick=-1,this.autoModeLayer.visible=!0},
g.prototype.stopAutoMode=function(){this.autoModeFlag=!1,this.autoModeStartTick=-1,this.autoModeLayer.visible=!1},g.prototype.reserveAutoClick=function(t){this.autoModeFlag&&(this.autoModeStartTick=t)},g.prototype.initSoundBuffers=function(t){var e=this
;null!=t.soundBufferCount&&(this.soundBufferCount=+t.soundBufferCount);for(var i={onStop:function(t){e.onSoundStop(t)},onFadeComplete:function(t){e.onSoundFadeComplete(t)}},r=0;r<this.soundBufferCount;r++)this.soundBuffers.push(new h.SoundBuffer(
this.resource,r,i))},g.prototype.getSoundBuffer=function(t){if(null!=this.soundBufferAlias[t])return this.getSoundBuffer(this.soundBufferAlias[t]);var e=this.soundBuffers[+t];if(null==e)throw new Error("音声バッファ"+t+"は範囲外です");return e},
g.prototype.onSoundStop=function(e){return u(this,void 0,void 0,function(){return l(this,function(t){return this.conductor.trigger("soundstop"),"onEndEvent"!==e.stopBy||null==e.file&&null==e.label||this.onSoundStopParamsList.push(e),[2]})})},
g.prototype.onSoundFadeComplete=function(t){this.conductor.trigger("soundfade")},g.prototype.waitSoundCompleteCallback=function(t){this.conductor.clearEventHandlerByName("click"),this.conductor.start()},g.prototype.waitSoundStopClickCallback=function(t){
this.conductor.clearEventHandlerByName("soundstop"),t.stop(),this.conductor.start()},g.prototype.waitSoundFadeCompleteCallback=function(t){this.conductor.clearEventHandlerByName("click"),this.conductor.start()},
g.prototype.waitSoundFadeClickCallback=function(t){this.conductor.clearEventHandlerByName("soundfade"),t.endFade(),this.conductor.start()},g.prototype.initLayers=function(e){var i=this;[this.forePrimaryLayer,this.backPrimaryLayer].forEach(function(t){
t.x=0,t.y=0,t.width=i.width,t.height=i.height,t.visible=!0,t.setBackgroundColor(0,1)});for(var t=0;t<this.layerCount;t++)this.forePrimaryLayer.addChild(this.createLayer("fore layer "+t)),this.backPrimaryLayer.addChild(this.createLayer("back layer "+t))
;null!=e.layersDefault&&(this.foreLayers.forEach(function(t){return t.applyConfig(e.layersDefault)}),this.backLayers.forEach(function(t){return t.applyConfig(e.layersDefault)}))},Object.defineProperty(g.prototype,"layerCount",{get:function(){
return this._layerCount},set:function(r){if(r<this._layerCount)[this.forePrimaryLayer,this.backPrimaryLayer].forEach(function(t){for(var e=t.children,i=0;i<e.length;i++)i<r?t.addChild(e[i]):e[i].destroy()});else for(var t=this.foreLayers.length;t<r;t++
)this.forePrimaryLayer.addChild(this.createLayer("fore layer "+t)),this.backPrimaryLayer.addChild(this.createLayer("back layer "+t));this._layerCount=r},enumerable:!0,configurable:!0}),g.prototype.createLayer=function(t){var e=new m.PonLayer(t,
this.resource,this);return e.visible=!1,e},g.prototype.getTargetLayers=function(e,t){var i=this,r=[];if(null==t||""===t||"all"===t)return e;if(-1!==t.indexOf(","))t.split(",").forEach(function(t){i.getTargetLayers(e,t.trim()).forEach(function(t){r.push(t)
})});else if(-1!==t.indexOf("-")){var n=t.split("-"),s=parseInt(n[0],10),o=parseInt(n[1],10);if(s<0)throw new Error("レイヤ指定が範囲外です");if(o>=this.layerCount)throw new Error("レイヤ指定が範囲外です");for(var a=s;a<=o;a++)r.push(e[a])}else if("mes"===t||"message"===t
)r.push(e[this.messageLayerNum]);else if("linebreak"===t)r.push(e[this.lineBreakGlyphLayerNum]);else if("pagebreak"===t)r.push(e[this.pageBreakGlyphLayerNum]);else if("auto"===t||"automode"===t)r.push(e[this.autoModeLayerNum]);else{if(
null!=this.layerAlias[t])return this.getTargetLayers(e,this.layerAlias[t]);var h=parseInt(t,10);if(isNaN(h)||h<0||this.layerCount<=h)throw new Error("レイヤー指定が存在しないエイリアスか、または範囲外です("+t+")");r.push(e[h])}return r},g.prototype.getLayers=function(t){var e,
i=""+t.lay,r=""+t.page;return null!=t.page&&"current"!==t.page||(r=this.currentPage),e="back"===r?this.backLayers:this.foreLayers,this.getTargetLayers(e,i)},Object.defineProperty(g.prototype,"hasMovingLayer",{get:function(){
return 0<this.foreLayers.filter(function(t){return t.isMoving&&!t.isLoopMoving}).length||0<this.backLayers.filter(function(t){return t.isMoving&&!t.isLoopMoving}).length},enumerable:!0,configurable:!0}),g.prototype.waitMoveClickCallback=function(){
this.conductor.clearEventHandlerByName("move"),this.foreLayers.forEach(function(t){return t.stopMove()}),this.backLayers.forEach(function(t){return t.stopMove()}),this.conductor.start()},g.prototype.waitMoveCompleteCallback=function(){
this.conductor.clearEventHandlerByName("click"),this.conductor.start()},g.prototype.waitFrameAnimClickCallback=function(t){this.conductor.clearEventHandlerByName("frameanim"),t.forEach(function(t){t.stopFrameAnim()}),this.conductor.start()},
g.prototype.waitFrameAnimCompleteCallback=function(t){0===t.filter(function(t){return t.frameAnimRunning}).length&&(this.conductor.clearEventHandlerByName("click"),this.conductor.start())},Object.defineProperty(g.prototype,"hasPlayingVideoLayer",{
get:function(){return 0<this.foreLayers.filter(function(t){return t.isPlayingVideo&&!t.isLoopPlayingVideo}).length||0<this.backLayers.filter(function(t){return t.isPlayingVideo&&!t.isLoopPlayingVideo}).length},enumerable:!0,configurable:!0}),
g.prototype.waitVideoClickCallback=function(){this.conductor.clearEventHandlerByName("move"),this.foreLayers.forEach(function(t){return t.stopVideo()}),this.backLayers.forEach(function(t){return t.stopVideo()}),this.conductor.start()},
g.prototype.waitVideoCompleteCallback=function(){this.conductor.clearEventHandlerByName("click"),this.conductor.start()},g.prototype.startQuake=function(t,e,i,r){this.isQuaking=!0,this.quakeStartTick=t,this.quakeTime=e,this.quakeMaxX=i,this.quakeMaxY=r,
this.isQuakePhase=!0,this.quakeFrameCount=0},g.prototype.stopQuake=function(){this.isQuaking=!1,this.quakeStartTick=-1,this.quakeTime=0,this.quakeMaxX=20,this.quakeMaxY=20,this.isQuakePhase=!0,this.quakeFrameCount=0,this.forePrimaryLayer.x=0,
this.forePrimaryLayer.y=0,this.backPrimaryLayer.x=0,this.backPrimaryLayer.y=0,this.conductor.trigger("quake")},g.prototype.quake=function(t){var e,i;this.quakeFrameCount++%this.quakeIntervalFrame==0&&(t-this.quakeStartTick>this.quakeTime?this.stopQuake(
):(i=this.quakeMaxY===this.quakeMaxX?(e=Math.floor(Math.random()*this.quakeMaxX*2-this.quakeMaxX),Math.floor(Math.random()*this.quakeMaxY*2-this.quakeMaxY)):this.quakeMaxX<this.quakeMaxY?(e=Math.floor(Math.random()*this.quakeMaxX*2-this.quakeMaxX),
Math.floor((this.isQuakePhase?Math.random():-Math.random())*this.quakeMaxY)):(e=Math.floor((this.isQuakePhase?Math.random():-Math.random())*this.quakeMaxX),Math.floor(Math.random()*this.quakeMaxY*2-this.quakeMaxY)),this.forePrimaryLayer.x=e,
this.forePrimaryLayer.y=i,this.backPrimaryLayer.x=e,this.backPrimaryLayer.y=i,this.isQuakePhase=!this.isQuakePhase))},Object.defineProperty(g.prototype,"textSpeed",{get:function(){return this.nowaitModeFlag?0:this.conductor.isPassedLatestSaveMark(
)?"user"===this.textSpeedMode?this.userReadTextSpeed:this.readTextSpeed:"user"===this.textSpeedMode?this.userUnreadTextSpeed:this.unreadTextSpeed},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"messageLayer",{get:function(){
return this.foreLayers[this.messageLayerNum]},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"backMessageLayer",{get:function(){return this.backLayers[this.messageLayerNum]},enumerable:!0,configurable:!0}),Object.defineProperty(
g.prototype,"lineBreakGlyphLayer",{get:function(){return this.foreLayers[this.lineBreakGlyphLayerNum]},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"pageBreakGlyphLayer",{get:function(){
return this.foreLayers[this.pageBreakGlyphLayerNum]},enumerable:!0,configurable:!0}),g.prototype.showLineBreakGlyph=function(t){this.showBreakGlyph(t,this.lineBreakGlyphLayer,this.lineBreakGlyphPos,this.lineBreakGlyphVerticalAlign,this.lineBreakGlyphX,
this.lineBreakGlyphY,this.lineBreakGlyphMarginX,this.lineBreakGlyphMarginY)},g.prototype.showPageBreakGlyph=function(t){this.showBreakGlyph(t,this.pageBreakGlyphLayer,this.pageBreakGlyphPos,this.pageBreakGlyphVerticalAlign,this.pageBreakGlyphX,
this.pageBreakGlyphY,this.pageBreakGlyphMarginX,this.pageBreakGlyphMarginY)},g.prototype.showBreakGlyph=function(t,e,i,r,n,s,o,a){this.resetBreakGlyphPos(e,i,r,n,s,o,a),e.hasFrameAnim&&(e.stopFrameAnim(),e.startFrameAnim(t)),e.visible=!0},
g.prototype.resetLineBreakGlyphPos=function(){this.resetBreakGlyphPos(this.lineBreakGlyphLayer,this.lineBreakGlyphPos,this.lineBreakGlyphVerticalAlign,this.lineBreakGlyphX,this.lineBreakGlyphY,this.lineBreakGlyphMarginX,this.lineBreakGlyphMarginY)},
g.prototype.resetPageBreakGlyphPos=function(){this.resetBreakGlyphPos(this.pageBreakGlyphLayer,this.pageBreakGlyphPos,this.pageBreakGlyphVerticalAlign,this.pageBreakGlyphX,this.pageBreakGlyphY,this.pageBreakGlyphMarginX,this.pageBreakGlyphMarginY)},
g.prototype.resetBreakGlyphPos=function(t,e,i,r,n,s,o){var a=this.messageLayer;if("eol"===e){var h=a.getNextTextPos(t.width);t.x=a.x+h.x;var u=a.textCanvas.lineHeight;switch(i){case"bottom":t.y=a.y+(h.y+u)-t.height;break;case"top":t.y=a.y+h.y;break
;default:case"middle":t.y=a.y+h.y+(u-t.height)/2;break;case"text-top":t.y=a.y+h.y+u-a.textCanvas.style.fontSize;break;case"text-middle":var l=h.y+u-a.textCanvas.style.fontSize;t.y=a.y+l+(a.textCanvas.style.fontSize-t.height)/2}t.x+=s,t.y+=o
}else"relative"===e?(t.x=a.x+r,t.y=a.y+n):"absolute"===e&&(t.x=r,t.y=n)},g.prototype.hideBreakGlyph=function(){this.pageBreakGlyphLayer.visible=!1,this.lineBreakGlyphLayer.visible=!1},g.prototype.hideMessages=function(){this.foreLayers.forEach(function(t
){return t.storeVisible()}),this.foreLayers.forEach(function(t){t.autoHideWithMessage&&(t.visible=!1)}),this.messageLayer.visible=!1,this.lineBreakGlyphLayer.visible=!1,this.pageBreakGlyphLayer.visible=!1,this.plugins.forEach(function(t){
null!=t.onChangeMessageVisible&&t.onChangeMessageVisible(!1)}),this.hideMessageFlag=!0},g.prototype.showMessages=function(){this.foreLayers.forEach(function(t){t.restoreVisible()}),this.plugins.forEach(function(t){
null!=t.onChangeMessageVisible&&t.onChangeMessageVisible(!0)}),this.hideMessageFlag=!1},g.prototype.hideMessagesByRightClick=function(){this.conductor.isStable&&(this.hideMessages(),this.hideMessageByRClickFlag=!0)},
g.prototype.showMessagesByRightClick=function(){this.hideMessageByRClickFlag&&(this.showMessages(),this.hideMessageByRClickFlag=!1)},g.prototype.onAddChar=function(t,e){t===this.messageLayer&&this.historyLayer.addHistoryChar(e)},
g.prototype.onTextReturn=function(t){t===this.messageLayer&&this.historyLayer.addHistoryTextReturn()},g.prototype.showHistoryLayer=function(){this.historyLayer.goToEnd(),this.historyLayer.show()},g.prototype.hideHistoryLayer=function(){
this.historyLayer.hide()},g.prototype.historyTextReturn=function(){this.historyLayer.addHistoryTextReturn()},g.prototype.addTextToHistory=function(t){for(var e=0;e<t.length;e++)this.historyLayer.addHistoryChar(t[e])},g.prototype.backlay=function(t){for(
var e=this.getLayers({lay:t,page:"fore"}),i=this.getLayers({lay:t,page:"back"}),r=0;r<e.length;r++)e[r].copyTo(i[r]);this.plugins.forEach(function(t){null!=t.onBacklay&&t.onBacklay()})},g.prototype.copylay=function(t,e,i,r){var n=this.getLayers({lay:t,
page:i}),s=this.getLayers({lay:e,page:r});if(n.length!==s.length)throw new Error("コピー元と先のレイヤ数が異なります(copylay)");for(var o=0;o<n.length;o++)n[o]!==s[o]&&n[o].copyTo(s[o]);this.plugins.forEach(function(t){null!=t.onCopylay&&t.onCopylay(n,s,i,r)})},
g.prototype.flipPrimaryLayers=function(){y.prototype.flipPrimaryLayers.call(this);var t=this.forePrimaryLayer;this.forePrimaryLayer=this.backPrimaryLayer,this.backPrimaryLayer=t,this.plugins.forEach(function(t){null!=t.onFlipLayers&&t.onFlipLayers()}),
this.removeForePrimaryLayer(this.historyLayer),this.removeBackPrimaryLayer(this.historyLayer),this.addForePrimaryLayer(this.historyLayer)},g.prototype.onCompleteTrans=function(){return this.currentPage="fore",y.prototype.onCompleteTrans.call(this)},
g.prototype.waitTransClickCallback=function(){this.conductor.clearEventHandlerByName("trans"),this.transManager.stop(),this.conductor.start()},g.prototype.waitTransCompleteCallback=function(){this.conductor.clearEventHandlerByName("click"),
this.conductor.start()},g.prototype.onWindowClose=function(){return this.saveSystemData(),!0},g.prototype.saveSystemData=function(){var e=this.systemVar,i=this;e.system={},g.ponkanSystemStoreParams.forEach(function(t){e.system[t]=i[t]}),e.soundBuffers=[],
this.soundBuffers.forEach(function(t){e.soundBuffers.push(t.storeSystem())}),this.resource.saveSystemData(this.saveDataPrefix)},g.prototype.loadSystemData=function(t){this.resource.loadSystemData(t);var i=this.systemVar,e=this;if(null!=i.system&&(
g.ponkanSystemStoreParams.filter(function(t){return-1===g.ponkanSystemStoreIgnoreParams.indexOf(t)}).forEach(function(t){null!=i.system[t]&&(e[t]=i.system[t])}),null!=i.system.scaleMode))switch(i.system.scaleMode){case g.ScaleMode.FULLSCREEN:
case g.ScaleMode.FIT:this.scaleMode=g.ScaleMode.FIT;break;case g.ScaleMode.FIXED:null!=i.system._fixedScaleWidth&&null!=i.system._fixedScaleHeight?(this.scaleMode=g.ScaleMode.FIXED,this.setFixedScaleSize(i.system._fixedScaleWidth,
i.system._fixedScaleHeight)):this.scaleMode=g.ScaleMode.FIT}null!=i.soundBuffers&&this.soundBuffers.forEach(function(t,e){null!=i.soundBuffers[e]&&t.restoreSystem(i.soundBuffers[e])})},g.prototype.getSaveDataName=function(t){
return this.saveDataPrefix+"_"+t},g.prototype.save=function(t,e){var i;c.Logger.debug("==SAVE============================================="),c.Logger.debug(e,this.latestSaveData);try{i=JSON.stringify(this.latestSaveData)}catch(t){throw c.Logger.error(t),
new Error("セーブデータの保存に失敗しました。JSON文字列に変換できません")}this.resource.storeToLocalStorage(this.getSaveDataName(e),i),c.Logger.debug("SAVE! ",this.latestSaveData),null==this.systemVar.saveDataInfo&&(this.systemVar.saveDataInfo=[]),this.systemVar.saveDataInfo[e]={
isEmpty:!1,date:this.getNowDateStr(),name:this.latestSaveData.name,comment:this.latestSaveData.comment,text:this.latestSaveData.text,screenShot:this.screenShot.getDataUrl()},c.Logger.debug(this.systemVar.saveDataInfo[e]),this.saveSystemData(),
c.Logger.debug("===================================================")},g.prototype.getNowDateStr=function(){var t=new Date;return t.getFullYear()+"/"+("0"+(t.getMonth()+1)).substring(0,2)+"/"+("0"+t.getDate()).substring(0,2)+" "+("0"+t.getHours()
).substring(0,2)+":"+("0"+t.getMinutes()).substring(0,2)+":"+("0"+t.getSeconds()).substring(0,2)},g.prototype.generateSaveData=function(t,e,i){var r={},n=this;return r.tick=i,r.saveMarkName=t,r.comment=e,r.text=this.messageLayer.text,
g.ponkanStoreParams.forEach(function(t){r[t]=n[t]}),r.gameVar=p.objClone(this.gameVar),r.conductor=this.conductor.store(t,i),r.forePrimaryLayer=this.forePrimaryLayer.store(i),r.foreLayers=[],this.foreLayers.forEach(function(t){r.foreLayers.push(t.store(i)
)}),r.backPrimaryLayer=this.backPrimaryLayer.store(i),r.backLayers=[],this.backLayers.forEach(function(t){r.backLayers.push(t.store(i))}),r.historyLayer=this.historyLayer.store(i),r.soundBuffers=[],this.soundBuffers.forEach(function(t){
r.soundBuffers.push(t.store(i))}),this.plugins.forEach(function(t){null!=t.onStore&&t.onStore(r,i)}),r},g.prototype.tempSave=function(t,e){var i=""+e;this.tempSaveData[i]=this.generateSaveData("tempsave","tempsave",t),this.tempSaveData[i].gameVar=null},
g.prototype.load=function(o,a){return u(this,void 0,void 0,function(){var e,i,r,n,s=this;return l(this,function(t){switch(t.label){case 0:return i=(e=this).resource.restoreFromLocalStorage(this.getSaveDataName(a)),r=JSON.parse(i),c.Logger.debug("LOAD! ",r
),this.goToMainConductor(),this.mainConductor.stop(),g.ponkanStoreParams.forEach(function(t){e[t]=r[t]}),this.waitUntilStartTick=-1,[4,this.forePrimaryLayer.restore(r.forePrimaryLayer,o,!0)];case 1:return t.sent(),[4,this.backPrimaryLayer.restore(
r.backPrimaryLayer,o,!0)];case 2:t.sent(),n=0,t.label=3;case 3:return n<r.foreLayers.length?[4,this.foreLayers[n].restore(r.foreLayers[n],o,!0)]:[3,7];case 4:return t.sent(),[4,this.backLayers[n].restore(r.backLayers[n],o,!0)];case 5:t.sent(),t.label=6
;case 6:return n++,[3,3];case 7:return[4,this.historyLayer.restore(r.historyLayer,o,!1)];case 8:t.sent(),this.soundBuffers.forEach(function(t){t.stop()}),n=0,t.label=9;case 9:return n<r.soundBuffers.length?null==this.soundBuffers[n]?[3,11]:[4,
this.soundBuffers[n].restore(r.soundBuffers[n],o)]:[3,12];case 10:t.sent(),t.label=11;case 11:return n++,[3,9];case 12:return[4,this.mainConductor.restore(r.conductor,o)];case 13:return t.sent(),null!=r.gameVar&&(this.resource.gameVar=p.objClone(r.gameVar
)),this.stopSkip(),this.stopAutoMode(),this.plugins.forEach(function(e){return u(s,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return null==e.onRestore?[3,2]:[4,e.onRestore(r,o,!1,!0,!1)];case 1:t.sent(),t.label=2;case 2:
return[2]}})})}),this.conductor.stop(),[2]}})})},g.prototype.tempLoad=function(s,o,a,h){return void 0===a&&(a=!1),void 0===h&&(h=!1),u(this,void 0,void 0,function(){var e,i,r,n=this;return l(this,function(t){switch(t.label){case 0:return i=(e=this
).tempSaveData[""+o],c.Logger.debug(i),g.ponkanStoreParams.forEach(function(t){e[t]=i[t]}),h?[4,this.backPrimaryLayer.restore(i.forePrimaryLayer,s,!1)]:[3,6];case 1:t.sent(),r=0,t.label=2;case 2:return r<i.foreLayers.length?[4,this.backLayers[r].restore(
i.foreLayers[r],s,!1)]:[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[3,13];case 6:return[4,this.forePrimaryLayer.restore(i.forePrimaryLayer,s,!1)];case 7:return t.sent(),[4,this.backPrimaryLayer.restore(i.backPrimaryLayer,s,!1)]
;case 8:t.sent(),r=0,t.label=9;case 9:return r<i.foreLayers.length?[4,this.foreLayers[r].restore(i.foreLayers[r],s,!1)]:[3,13];case 10:return t.sent(),[4,this.backLayers[r].restore(i.backLayers[r],s,!1)];case 11:t.sent(),t.label=12;case 12:return r++,[3,9
];case 13:return[4,this.historyLayer.restore(i.historyLayer,s,!1)];case 14:if(t.sent(),!a)return[3,18];this.soundBuffers.forEach(function(t){t.stop()}),r=0,t.label=15;case 15:return r<i.soundBuffers.length?null==this.soundBuffers[r]?[3,17]:[4,
this.soundBuffers[r].restore(i.soundBuffers[r],s)]:[3,18];case 16:t.sent(),t.label=17;case 17:return r++,[3,15];case 18:return this.plugins.forEach(function(e){return u(n,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:
return e.onRestore?[4,e.onRestore(i,s,!0,a,h)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}),[2]}})})},g.prototype.copySaveData=function(t,e){this.resource.copyLocalStorage(this.getSaveDataName(t),this.getSaveDataName(e))},Object.defineProperty(
g.prototype,"emptySaveData",{get:function(){return{isEmpty:!0,date:"----/--/-- --:--:--",name:"",comment:"NO DATA",message:"",text:"",screenShot:this.screenShot.nodata}},enumerable:!0,configurable:!0}),g.prototype.deleteSaveData=function(t){
delete this.systemVar.saveDataInfo[t],this.resource.storeToLocalStorage(this.getSaveDataName(t),""),this.saveSystemData()},g.prototype.getSaveDataInfo=function(t){if(this.existSaveData(t)){var e=this.systemVar.saveDataInfo[t]
;null!=e.screenShot&&""!==e.screenShot||(e.screenShot=this.screenShot.nodata);var i=this.emptySaveData;return null==e.date&&(e.date=i.date),null==e.name&&(e.name=i.name),null==e.comment&&(e.comment=i.comment),null==e.message&&(e.message=i.message),
null==e.text&&(e.text=i.text),null==e.screenShot&&(e.screenShot=i.screenShot),e}return this.emptySaveData},g.prototype.existSaveData=function(t){return null!=this.systemVar&&null!=this.systemVar.saveDataInfo&&null!=this.systemVar.saveDataInfo[t]},
g.prototype.getSaveDataScreenShot=function(t){return this.getSaveDataInfo(t).screenShot},g.prototype.splitStrByLength=function(t,e){var i=[];if(null==t||null==e||e<1)return i;for(var r=0,n=r,s=n+e;n<t.length;)i[r]=t.substring(n,s),r++,s=(n=s)+e;return i},
g.ponkanSystemStoreParams=["scaleMode","_fixedScaleWidth","_fixedScaleHeight","autoModeInterval","userReadTextSpeed","userUnreadTextSpeed","canSkipUnreadPart","canSkipUnreadPartByCtrl"],g.ponkanSystemStoreIgnoreParams=["scaleMode","_fixedScaleWidth",
"_fixedScaleHeight"],g.ponkanStoreParams=["layerCount","currentPage","textSpeedMode","unreadTextSpeed","readTextSpeed","nowaitModeFlag","addCharWithBackFlag","messageLayerNum","lineBreakGlyphLayerNum","lineBreakGlyphPos","lineBreakGlyphVerticalAlign",
"lineBreakGlyphX","lineBreakGlyphY","lineBreakGlyphMarginX","lineBreakGlyphMarginY","pageBreakGlyphLayerNum","pageBreakGlyphVerticalAlign","pageBreakGlyphPos","pageBreakGlyphX","pageBreakGlyphY","pageBreakGlyphMarginX","pageBreakGlyphMarginY",
"rightClickJump","rightClickCall","rightClickFilePath","rightClickLabel","rightClickEnabled","enabledHistory"],g);function g(t,e){void 0===e&&(e={});var i=y.call(this,t,e)||this;return i.raiseError={unknowncommand:!0},i.skipMode=n.INVALID,
i.canSkipUnreadPart=!1,i.canSkipUnreadPartByCtrl=!0,i.autoModeFlag=!1,i.autoModeInterval=1e3,i.autoModeStartTick=-1,i.autoModeLayerNum=23,i.waitUntilStartTick=-1,i.waitUntilTime=0,i.tagActions={},i._layerCount=40,i.layerAlias={},i.currentPage="fore",
i.isQuaking=!1,i.quakeStartTick=-1,i.quakeTime=0,i.quakeMaxX=20,i.quakeMaxY=20,i.isQuakePhase=!0,i.quakeFrameCount=0,i.quakeIntervalFrame=4,i.textSpeedMode="user",i.unreadTextSpeed=20,i.readTextSpeed=20,i.userUnreadTextSpeed=20,i.userReadTextSpeed=20,
i.clickSkipEnabled=!0,i.nowaitModeFlag=!1,i.addCharWithBackFlag=!1,i.hideMessageFlag=!1,i.hideMessageByRClickFlag=!1,i._messageLayerNum=20,i._lineBreakGlyphLayerNum=21,i.lineBreakGlyphPos="eol",i.lineBreakGlyphVerticalAlign="bottom",i.lineBreakGlyphX=0,
i.lineBreakGlyphY=0,i.lineBreakGlyphMarginX=10,i.lineBreakGlyphMarginY=0,i._pageBreakGlyphLayerNum=22,i.pageBreakGlyphPos="eol",i.pageBreakGlyphVerticalAlign="bottom",i.pageBreakGlyphX=0,i.pageBreakGlyphY=0,i.pageBreakGlyphMarginX=10,
i.pageBreakGlyphMarginY=0,i.rightClickJump=!1,i.rightClickCall=!1,i.rightClickFilePath=null,i.rightClickLabel=null,i.rightClickEnabled=!0,i.enabledHistory=!0,i.soundBufferAlias={},i.soundBufferCount=5,i.soundBuffers=[],i.onSoundStopParamsList=[],
i.currentOnSoundStopParams=null,i.saveDataPrefix="ponkan-game",i.latestSaveComment="",i.latestSaveData={},i.tempSaveData={},i.pluginMap={},i.plugins=[],i.onMouseWheelLocked=!1,null!=e.saveDataPrefix&&(i.saveDataPrefix=e.saveDataPrefix),null!=e.text&&(
null!=e.text.unread&&(i.userUnreadTextSpeed=e.text.unread),null!=e.text.read&&(i.userReadTextSpeed=e.text.read)),i.initTagAction(),i.forePrimaryLayer=i.addForePrimaryLayer(new m.PonLayer("Fore primary layer",i.resource,i)),
i.backPrimaryLayer=i.addBackPrimaryLayer(new m.PonLayer("Back primary layer",i.resource,i)),i.initLayers(e),i.historyLayer=new f.HistoryLayer("HistoryLayer",i.resource,i),i.addForePrimaryLayer(i.historyLayer),i.historyLayer.visible=!1,i.initSoundBuffers(e
),i}x.Ponkan3=v,t.utils.skipHello(),window.Ponkan3=v}).call(this,b(5))},function(t,e,l){"use strict";(function(t){var e=l(20),i=l(21),r=l.n(i);window.Promise||(window.Promise=e.Polyfill),Object.assign||(Object.assign=r.a)
;var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!n.performance||!n.performance.now){
var s=Date.now();n.performance||(n.performance={}),n.performance.now=function(){return Date.now()-s}}for(var o=Date.now(),a=["ms","moz","webkit","o"],h=0;h<a.length&&!n.requestAnimationFrame;++h){var u=a[h]
;n.requestAnimationFrame=n[u+"RequestAnimationFrame"],n.cancelAnimationFrame=n[u+"CancelAnimationFrame"]||n[u+"CancelRequestAnimationFrame"]}n.requestAnimationFrame||(n.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(
t+"is not a function");var e=Date.now(),i=16+o-e;return i<0&&(i=0),o=e,setTimeout(function(){o=Date.now(),t(performance.now())},i)}),n.cancelAnimationFrame||(n.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){
return 0===(t=Number(t))||isNaN(t)?t:0<t?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),
window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array)}).call(this,l(10))},function(t,n,s){(function(t){
var e=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new r(i.call(setTimeout,e,arguments),clearTimeout)},n.setInterval=function(){return new r(
i.call(setInterval,e,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(e,this._id)},n.enroll=function(t,e){clearTimeout(
t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){
t._onTimeout&&t._onTimeout()},e))},s(25),n.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,
n.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,s(10))},function(t,e,i){(function(t,f){!function(i,r){"use strict";if(!i.setImmediate){var n,s,e,o,a=1,h={},u=!1,
l=i.document,t=Object.getPrototypeOf&&Object.getPrototypeOf(i);t=t&&t.setTimeout?t:i,n="[object process]"==={}.toString.call(i.process)?function(t){f.nextTick(function(){d(t)})}:function(){if(i.postMessage&&!i.importScripts){var t=!0,e=i.onmessage
;return i.onmessage=function(){t=!1},i.postMessage("","*"),i.onmessage=e,t}}()?(o="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",p,!1):i.attachEvent("onmessage",p),function(t){i.postMessage(o+t,"*")}):i.MessageChannel?((
e=new MessageChannel).port1.onmessage=function(t){d(t.data)},function(t){e.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(s=l.documentElement,function(t){var e=l.createElement("script");e.onreadystatechange=function(){d(t),
e.onreadystatechange=null,s.removeChild(e),e=null},s.appendChild(e)}):function(t){setTimeout(d,0,t)},t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1]
;var r={callback:t,args:e};return h[a]=r,n(a),a++},t.clearImmediate=c}function c(t){delete h[t]}function d(t){if(u)setTimeout(d,0,t);else{var e=h[t];if(e){u=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0])
;break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(r,i)}}(e)}finally{c(t),u=!1}}}}function p(t){t.source===i&&"string"==typeof t.data&&0===t.data.indexOf(o)&&d(+t.data.slice(o.length))}}(
"undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(10),i(26))},function(t,e){var i,r,n=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e
){if(i===setTimeout)return setTimeout(e,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{
i="function"==typeof setTimeout?setTimeout:s}catch(t){i=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var h,u=[],l=!1,c=-1;function d(){l&&h&&(l=!1,h.length?u=h.concat(u):c=-1,u.length&&p())}function p(){if(!l){var t=a(d);l=!0
;for(var e=u.length;e;){for(h=u,u=[];++c<e;)h&&h[c].run();c=-1,e=u.length}h=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)
}catch(t){return r.call(this,e)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new f(t,e)),
1!==u.length||l||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,
n.prependListener=m,n.prependOnceListener=m,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},
n.umask=function(){return 0}},function(t,_,P){(function(p,f){var m;!function(){_&&_.nodeType,p&&p.nodeType;var t="object"==typeof f&&f;t.global!==t&&t.window!==t&&t.self;var e,y=2147483647,v=36,g=1,x=26,n=38,s=700,b=72,T=128,E="-",i=/^xn--/,
r=/[^\x20-\x7E]/,o=/[\x2E\u3002\uFF0E\uFF61]/g,a={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=v-g,w=Math.floor,A=String.fromCharCode;function S(
t){throw new RangeError(a[t])}function u(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function l(t,e){var i=t.split("@"),r="";return 1<i.length&&(r=i[0]+"@",t=i[1]),r+u((t=t.replace(o,".")).split("."),e).join(".")}function I(t){for(var e,i,r=[]
,n=0,s=t.length;n<s;)55296<=(e=t.charCodeAt(n++))&&e<=56319&&n<s?56320==(64512&(i=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--):r.push(e);return r}function C(t){return u(t,function(t){var e="";return 65535<t&&(e+=A((t-=65536
)>>>10&1023|55296),t=56320|1023&t),e+=A(t)}).join("")}function O(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function R(t,e,i){var r=0;for(t=i?w(t/s):t>>1,t+=w(t/e);h*x>>1<t;r+=v)t=w(t/h);return w(r+(h+1)*t/(t+n))}function c(t){var e,i,r,n,s,o,a,h,u,l,c,d=[],
p=t.length,f=0,m=T,_=b;for((i=t.lastIndexOf(E))<0&&(i=0),r=0;r<i;++r)128<=t.charCodeAt(r)&&S("not-basic"),d.push(t.charCodeAt(r));for(n=0<i?i+1:0;n<p;){for(s=f,o=1,a=v;p<=n&&S("invalid-input"),c=t.charCodeAt(n++),(v<=(
h=c-48<10?c-22:c-65<26?c-65:c-97<26?c-97:v)||h>w((y-f)/o))&&S("overflow"),f+=h*o,!(h<(u=a<=_?g:_+x<=a?x:a-_));a+=v)o>w(y/(l=v-u))&&S("overflow"),o*=l;_=R(f-s,e=d.length+1,0==s),w(f/e)>y-m&&S("overflow"),m+=w(f/e),f%=e,d.splice(f++,0,m)}return C(d)}
function d(t){var e,i,r,n,s,o,a,h,u,l,c,d,p,f,m,_=[];for(d=(t=I(t)).length,e=T,s=b,o=i=0;o<d;++o)(c=t[o])<128&&_.push(A(c));for(r=n=_.length,n&&_.push(E);r<d;){for(a=y,o=0;o<d;++o)e<=(c=t[o])&&c<a&&(a=c);for(a-e>w((y-i)/(p=r+1))&&S("overflow"),i+=(a-e)*p,
e=a,o=0;o<d;++o)if((c=t[o])<e&&++i>y&&S("overflow"),c==e){for(h=i,u=v;!(h<(l=u<=s?g:s+x<=u?x:u-s));u+=v)m=h-l,f=v-l,_.push(A(O(l+m%f,0))),h=w(m/f);_.push(A(O(h,0))),s=R(i,p,r==n),i=0,++r}++i,++e}return _.join("")}e={version:"1.4.1",ucs2:{decode:I,encode:C
},decode:c,encode:d,toASCII:function(t){return l(t,function(t){return r.test(t)?"xn--"+d(t):t})},toUnicode:function(t){return l(t,function(t){return i.test(t)?c(t.slice(4).toLowerCase()):t})}},void 0===(m=function(){return e}.call(_,P,_,p))||(p.exports=m)
}()}).call(this,P(28)(t),P(10))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),
Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},
isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,i){"use strict";e.decode=e.parse=i(31),e.encode=e.stringify=i(32)},function(t,e,i){"use strict";t.exports=function(t,e,i,r){e=e||"&",i=i||"=";var n={};if(
"string"!=typeof t||0===t.length)return n;var s=/\+/g;t=t.split(e);var o=1e3;r&&"number"==typeof r.maxKeys&&(o=r.maxKeys);var a,h,u=t.length;0<o&&o<u&&(u=o);for(var l=0;l<u;++l){var c,d,p,f,m=t[l].replace(s,"%20"),_=m.indexOf(i);d=0<=_?(c=m.substr(0,_),
m.substr(_+1)):(c=m,""),p=decodeURIComponent(c),f=decodeURIComponent(d),a=n,h=p,Object.prototype.hasOwnProperty.call(a,h)?y(n[p])?n[p].push(f):n[p]=[n[p],f]:n[p]=f}return n};var y=Array.isArray||function(t){
return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,i){"use strict";function s(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}t.exports=function(
i,r,n,t){return r=r||"&",n=n||"=",null===i&&(i=void 0),"object"==typeof i?a(h(i),function(t){var e=encodeURIComponent(s(t))+n;return o(i[t])?a(i[t],function(t){return e+encodeURIComponent(s(t))}).join(r):e+encodeURIComponent(s(i[t]))}).join(r
):t?encodeURIComponent(s(t))+n+encodeURIComponent(s(i)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function a(t,e){if(t.map)return t.map(e);for(var i=[],r=0;r<t.length;r++)i.push(e(t[r],r));return i}
var h=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(Object.defineProperty(n.prototype,"systemVar",{
get:function(){return this.resource.systemVar},enumerable:!0,configurable:!0}),n.prototype.pass=function(t,e){var i=this.systemVar;null==i.trail&&(i.trail={}),null==i.trail[t.filePath]&&(i.trail[t.filePath]={}),
null==i.trail[t.filePath][e]?i.trail[t.filePath][e]=1:i.trail[t.filePath][e]++},n.prototype.isPassed=function(t,e){var i=this.systemVar;return null!=i.trail&&null!=i.trail[t.filePath]&&null!=i.trail[t.filePath][e]&&0<i.trail[t.filePath][e]},n);function n(
t){this.resource=t}e.ReadUnread=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4),s=i(8);e.default=function(r){return[new n.TagAction(["frameanim","fanim"],[new n.TagValue("lay","string",!0,null),new n.TagValue(
"page","string",!1,"current"),new n.TagValue("loop","boolean",!1,!1),new n.TagValue("time","number",!0,null),new n.TagValue("width","number",!0,null),new n.TagValue("height","number",!0,null),new n.TagValue("frames","array",!0,null)],function(e,t){
return r.getLayers(e).forEach(function(t){t.initFrameAnim(e.loop,e.time,e.width,e.height,e.frames)}),"continue"}),new n.TagAction(["startframeanim","startfanim"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current")],
function(t,e){return r.getLayers(t).forEach(function(t){t.startFrameAnim(e)}),"continue"}),new n.TagAction(["stopframeanim","stopfanim"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current")],function(t,e){
return r.getLayers(t).forEach(function(t){t.deleteFrameAnim()}),"continue"}),new n.TagAction(["waitframeanim","waitfanim"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current"),new n.TagValue("canskip","boolean",!1,!0)],
function(t,e){var i=r.getLayers(t).filter(function(t){return t.frameAnimRunning&&!t.frameAnimLoop});return 0===i.length?"continue":r.isSkipping&&t.canskip?(r.waitFrameAnimClickCallback(i),"break"):(t.canskip&&r.conductor.addEventHandler(
new s.PonEventHandler("click",function(){r.waitFrameAnimClickCallback(i)},"waitframeanim")),r.conductor.addEventHandler(new s.PonEventHandler("frameanim",function(){r.waitFrameAnimCompleteCallback(i)},"waitframeanim")),r.conductor.stop())}),
new n.TagAction(["startmove","move"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current"),new n.TagValue("time","number",!0,null),new n.TagValue("delay","number",!1,0),new n.TagValue("path","array",!0,null),new n.TagValue(
"type","string",!1,"linear"),new n.TagValue("ease","string",!1,"none"),new n.TagValue("loop","boolean",!1,null)],function(e,i){return r.getLayers(e).forEach(function(t){t.startMove(i,e.time,e.delay,e.path,e.type,e.ease,e.loop)}),"continue"}),
new n.TagAction(["stopmove"],[new n.TagValue("lay","string",!1,"all"),new n.TagValue("page","string",!1,"current")],function(t,e){return r.getLayers(t).forEach(function(t){t.stopMove()}),"continue"}),new n.TagAction(["waitmove","wm"],[new n.TagValue(
"canskip","boolean",!1,!0)],function(t,e){return r.hasMovingLayer?r.isSkipping&&t.canskip?(r.waitMoveClickCallback(),"break"):(t.canskip&&r.conductor.addEventHandler(new s.PonEventHandler("click",function(){r.waitMoveClickCallback()},"waitmove")),
r.conductor.addEventHandler(new s.PonEventHandler("move",function(){r.waitMoveCompleteCallback()},"waitmove")),r.conductor.stop()):"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4);e.default=function(
i){return[new r.TagAction(["textbutton","txtbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("btnname","string",!1,null),new r.TagValue("jump","boolean",!1,!0),new r.TagValue("call","boolean",!1,
null),new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("onclick","string",!1,null),new r.TagValue("onleave","string",!1,null),new r.TagValue("onclick","string",!1,null),new r.TagValue("text","string",!1,""),
new r.TagValue("x","number",!1,0),new r.TagValue("y","number",!1,0),new r.TagValue("width","number",!0,null),new r.TagValue("height","number",!0,null),new r.TagValue("bgcolors","array",!0,null),new r.TagValue("bgalphas","array",!1,[1,1,1]),new r.TagValue(
"system","boolean",!1,!1),new r.TagValue("margint","number",!1,0),new r.TagValue("marginr","number",!1,0),new r.TagValue("marginb","number",!1,0),new r.TagValue("marginl","number",!1,0),new r.TagValue("align","string",!1,"center"),new r.TagValue(
"countpage","boolean",!1,!0),new r.TagValue("enterbuf","string",!1,""),new r.TagValue("leavebuf","string",!1,""),new r.TagValue("clickbuf","string",!1,"")],function(e,t){return i.getLayers(e).forEach(function(t){t.addTextButton(e.btnname,e.jump,e.call,
e.file,e.label,e.countpage,e.onenter,e.onleave,e.onclick,e.text,e.x,e.y,e.width,e.height,e.bgcolors,e.bgalphas,e.system,e.margint,e.marginr,e.marginb,e.marginl,e.align,e.enterbuf,e.leavebuf,e.clickbuf)}),"continue"}),new r.TagAction(["textbuttonopt",
"txtbtnopt"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("btnname","string",!0,null),new r.TagValue("bgcolors","array",!1,null),new r.TagValue("bgalphas","array",!1,null)],function(e,t){
return i.getLayers(e).forEach(function(t){e.bgcolors&&t.changeTextButtonColors(e.btnname,e.bgcolors),e.bgalphas&&t.changeTextButtonAlphas(e.btnname,e.bgalphas)}),"continue"}),new r.TagAction(["clearbuttons","clearbutton","clearbtn"],[new r.TagValue("lay",
"string",!0,null),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.clearTextButtons(),t.clearImageButtons(),t.clearToggleButtons()}),"continue"}),new r.TagAction(["cleartextbuttons","cleartextbutton",
"cleartxtbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.clearTextButtons()}),"continue"}),new r.TagAction(["imagebutton","imgbtn"],[new r.TagValue("lay"
,"string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("jump","boolean",!1,!0),new r.TagValue("call","boolean",!1,null),new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("onclick",
"string",!1,null),new r.TagValue("onleave","string",!1,null),new r.TagValue("onclick","string",!1,null),new r.TagValue("imagefile","string",!0,null),new r.TagValue("x","number",!1,0),new r.TagValue("y","number",!1,0),new r.TagValue("direction","string",!1
,"horizontal"),new r.TagValue("system","boolean",!1,!1),new r.TagValue("countpage","boolean",!1,!0),new r.TagValue("enterbuf","string",!1,""),new r.TagValue("leavebuf","string",!1,""),new r.TagValue("clickbuf","string",!1,"")],function(e,t){
return i.getLayers(e).forEach(function(t){t.addImageButton(e.jump,e.call,e.file,e.label,e.countpage,e.onenter,e.onleave,e.onclick,e.imagefile,e.x,e.y,e.direction,e.system,e.enterbuf,e.leavebuf,e.clickbuf).then(function(){i.conductor.start()}).catch(
function(){i.error(new Error("画像読み込みに失敗しました。("+e.imagefile+")"))})}),i.conductor.stop()}),new r.TagAction(["clearimagebuttons","clearimagebutton","clearimgbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current")],
function(t,e){return i.getLayers(t).forEach(function(t){t.clearImageButtons()}),"continue"}),new r.TagAction(["togglebutton","tglbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("exp","string",!1,
null),new r.TagValue("imagefile","string",!0,null),new r.TagValue("x","number",!1,0),new r.TagValue("y","number",!1,0),new r.TagValue("statevar","string",!0,null),new r.TagValue("direction","string",!1,"horizontal"),new r.TagValue("system","boolean",!1,!1
)],function(e,t){return i.getLayers(e).forEach(function(t){t.addToggleButton(e.imagefile,e.x,e.y,e.statevar,e.system,e.exp,e.direction).then(function(){i.conductor.start()}).catch(function(){i.error(new Error("画像読み込みに失敗しました。("+e.imagefile+")"))})}),
i.conductor.stop()}),new r.TagAction(["cleartogglebuttons","cleartogglebutton","cleartglbtn"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){
t.clearToggleButtons()}),"continue"}),new r.TagAction(["lockbuttons","lockbutton","lock"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.lockButtons()}),
"continue"}),new r.TagAction(["unlockbuttons","unlockbutton","unlock"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.unlockButtons()}),"continue"}),
new r.TagAction(["locksystembuttons","locksystembutton","locksystem"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.lockSystemButtons()}),"continue"}),
new r.TagAction(["unlocksystembuttons","unlocksystembutton","unlocksystem"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.unlockSystemButtons()}),"continue"
}),new r.TagAction(["slider"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("onchange","string",!1,null),new r.TagValue("x","number",!1,0),new r.TagValue("y","number",!1,0),new r.TagValue("exp",
"string|function",!1,""),new r.TagValue("value","number",!1,0),new r.TagValue("back","string",!0,null),new r.TagValue("fore","string",!0,null),new r.TagValue("button","string",!0,null)],function(e,t){return i.getLayers(e).forEach(function(t){t.addSlider(
e.x,e.y,e.value,e.exp,e.back,e.fore,e.button).then(function(){i.conductor.start()}).catch(function(){i.error(new Error("画像読み込みに失敗しました。("+e.back+")("+e.fore+")("+e.button+")"))})}),i.conductor.stop()}),new r.TagAction(["locksliders","lockslider"],[
new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.lockSliders()}),"continue"}),new r.TagAction(["unlocksliders","unlockslider"],[new r.TagValue("lay","string",!1
,"all"),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.unlockSliders()}),"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4);e.default=function(i
){return[new r.TagAction(["historyopt"],[new r.TagValue("output","boolean",!1,null),new r.TagValue("enabled","boolean",!1,null)],function(t,e){return null!=t.output&&(i.historyLayer.enableOutput=t.output),null!=t.enabled&&(i.enabledHistory=t.enabled),
"continue"}),new r.TagAction(["showhistory","history"],[],function(t,e){return i.showHistoryLayer(),"continue"}),new r.TagAction(["historych","hch"],[new r.TagValue("text","string",!0,null)],function(t,e){return i.addTextToHistory(t.text),"continue"}),
new r.TagAction(["hbr"],[],function(t,e){return i.historyTextReturn(),"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4);e.default=function(i){return[new r.TagAction(["clearfilters","clearfilter"],[
new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.clearFilters()}),"continue"}),new r.TagAction(["blur"],[new r.TagValue("lay","string",!0,null),new r.TagValue(
"page","string",!1,"current"),new r.TagValue("blurx","number",!1,4),new r.TagValue("blury","number",!1,4),new r.TagValue("quality","number",!1,4)],function(e,t){return i.getLayers(e).forEach(function(t){t.addFilter("blur",{blurX:e.blurx,blurY:e.blury,
quality:e.quality})}),"continue"}),new r.TagAction(["colorfilter"],[new r.TagValue("lay","string",!0,null),new r.TagValue("page","string",!1,"current"),new r.TagValue("gamma","number",!1,null),new r.TagValue("saturation","number",!1,null),new r.TagValue(
"contrast","number",!1,null),new r.TagValue("brightness","number",!1,null),new r.TagValue("red","number",!1,null),new r.TagValue("green","number",!1,null),new r.TagValue("blue","number",!1,null)],function(e,t){return i.getLayers(e).forEach(function(t){
t.addFilter("color",e)}),"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4);e.default=function(r){return[new n.TagAction(["layalias"],[new n.TagValue("name","string",!0,null),new n.TagValue("lay",
"string",!0,null)],function(t,e){return r.layerAlias[t.name]=t.lay,"continue"}),new n.TagAction(["dellayalias"],[new n.TagValue("name","string",!0,null)],function(t,e){return delete r.layerAlias[t.name],"continue"}),new n.TagAction(["messagelayer",
"messagelay","meslay"],[new n.TagValue("lay","number",!0,null)],function(t,e){var i=+t.lay;if(i<0||r.layerCount<=i)throw new Error("メッセージレイヤーの指定が範囲外です");return r.messageLayerNum=i,"continue"}),new n.TagAction(["linebreakglyph","lbglyph"],[new n.TagValue(
"lay","number",!1,null),new n.TagValue("pos","string",!1,null),new n.TagValue("verticalalign","string",!1,null),new n.TagValue("x","number",!1,null),new n.TagValue("y","number",!1,null),new n.TagValue("marginx","number",!1,null),new n.TagValue("marginy",
"number",!1,null)],function(t,e){return null!=t.lay&&(r.lineBreakGlyphLayerNum=t.lay),null!=t.pos&&(r.lineBreakGlyphPos=t.pos),null!=t.verticalalign&&(r.lineBreakGlyphVerticalAlign=t.verticalalign),null!=t.x&&(r.lineBreakGlyphX=t.x),null!=t.y&&(
r.lineBreakGlyphY=t.y),null!=t.marginx&&(r.lineBreakGlyphMarginX=t.marginx),null!=t.marginy&&(r.lineBreakGlyphMarginY=t.marginy),"continue"}),new n.TagAction(["pagebreakglyph","pbglyph"],[new n.TagValue("lay","number",!1,null),new n.TagValue("pos",
"string",!1,null),new n.TagValue("verticalalign","string",!1,null),new n.TagValue("x","number",!1,null),new n.TagValue("y","number",!1,null),new n.TagValue("marginx","number",!1,null),new n.TagValue("marginy","number",!1,null)],function(t,e){
return null!=t.lay&&(r.pageBreakGlyphLayerNum=t.lay),null!=t.pos&&(r.pageBreakGlyphPos=t.pos),null!=t.verticalalign&&(r.pageBreakGlyphVerticalAlign=t.verticalalign),null!=t.x&&(r.pageBreakGlyphX=t.x),null!=t.y&&(r.pageBreakGlyphY=t.y),null!=t.marginx&&(
r.pageBreakGlyphMarginX=t.marginx),null!=t.marginy&&(r.pageBreakGlyphMarginY=t.marginy),"continue"}),new n.TagAction(["fillcolor","fill"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current"),new n.TagValue("color","number",
!0,null),new n.TagValue("alpha","number",!1,1)],function(e,t){return r.getLayers(e).forEach(function(t){t.setBackgroundColor(e.color,e.alpha)}),"continue"}),new n.TagAction(["clearcolor"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page",
"string",!1,"current")],function(t,e){return r.getLayers(t).forEach(function(t){t.clearBackgroundColor()}),"continue"}),new n.TagAction(["layopt"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current"),new n.TagValue(
"visible","boolean",!1,null),new n.TagValue("x","number",!1,null),new n.TagValue("y","number",!1,null),new n.TagValue("width","number",!1,null),new n.TagValue("height","number",!1,null),new n.TagValue("alpha","number",!1,1),new n.TagValue("autohide",
"boolean",!1,null),new n.TagValue("scalex","number",!1,null),new n.TagValue("scaley","number",!1,null),new n.TagValue("blocklclick","boolean",!1,null),new n.TagValue("blockrclick","boolean",!1,null),new n.TagValue("blockcclick","boolean",!1,null),
new n.TagValue("blockmove","boolean",!1,null),new n.TagValue("blockwheel","boolean",!1,null)],function(e,t){return r.getLayers(e).forEach(function(t){null!=e.visible&&(t.visible=e.visible),null!=e.x&&(t.x=e.x),null!=e.y&&(t.y=e.y),null!=e.scalex&&(
t.scaleX=e.scalex),null!=e.scaley&&(t.scaleY=e.scaley),null!=e.width&&(t.width=e.width),null!=e.height&&(t.height=e.height),null!=e.alpha&&(t.alpha=e.alpha),null!=e.autohide&&(t.autoHideWithMessage=e.autohide),null!=e.blocklclick&&(
t.blockLeftClickFlag=e.blocklclick),null!=e.blockrclick&&(t.blockRightClickFlag=e.blockrclick),null!=e.blockcclick&&(t.blockCenterClickFlag=e.blockcclick),null!=e.blockmove&&(t.blockMouseMove=e.blockmove),null!=e.blockwheel&&(t.blockWheelFlag=e.blockwheel
)}),"continue"}),new n.TagAction(["loadimage","image"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current"),new n.TagValue("file","string",!0,null),new n.TagValue("visible","boolean",!1,null),new n.TagValue("x","number",!1,
null),new n.TagValue("y","number",!1,null),new n.TagValue("alpha","number",!1,1)],function(e,t){var i=[];return r.getLayers(e).forEach(function(t){i.push((null!=e.x&&(t.x=e.x),null!=e.y&&(t.y=e.y),null!=e.visible&&(t.visible=e.visible),null!=e.alpha&&(
t.alpha=e.alpha),t.loadImage(e.file)))}),Promise.all(i).then(function(){r.conductor.start()}).catch(function(){r.config&&r.config.developMode?r.error(new Error("画像読み込みに失敗しました。("+e.file+")")):r.error(new Error("画像読み込みに失敗しました。"))}),r.conductor.stop()}),
new n.TagAction(["loadchildimage","childimage",""],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current"),new n.TagValue("file","string",!0,null),new n.TagValue("x","number",!0,null),new n.TagValue("y","number",!0,null),
new n.TagValue("alpha","number",!1,1)],function(e,t){var i=[];return r.getLayers(e).forEach(function(t){i.push(t.loadChildImage(e.file,e.x,e.y,e.alpha))}),Promise.all(i).then(function(){r.conductor.start()}).catch(function(){r.error(new Error(
"追加の画像読み込みに失敗しました。"))}),r.conductor.stop()}),new n.TagAction(["freeimage","free","unloadimage"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current")],function(t,e){return r.getLayers(t).forEach(function(t){t.freeImage(),
t.freeChildImages()}),"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4);e.default=function(r){return[new n.TagAction(["macro"],[new n.TagValue("name","string",!0,null)],function(t,e){if(
r.resource.hasMacro(t.name))throw new Error(t.name+"マクロはすでに登録されています");var i=r.conductor.script.defineMacro(t.name);return r.resource.macroInfo[t.name]=i,"continue"}),new n.TagAction(["endmacro"],[],function(t,e){throw new Error(
"マクロ定義エラー。macroとendmacroの対応が取れていません")})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4),n=i(8);e.default=function(i){return[new r.TagAction(["messageopt","mesopt"],[new r.TagValue("lay","string",!1,"message"),
new r.TagValue("page","string",!1,"current"),new r.TagValue("fontfamily","array",!1,null),new r.TagValue("fontsize","number",!1,null),new r.TagValue("fontweight","string",!1,null),new r.TagValue("fontstyle","string",!1,null),new r.TagValue("color",
"number|array",!1,null),new r.TagValue("gradientstops","array",!1,null),new r.TagValue("gradienttype","string",!1,null),new r.TagValue("margint","number",!1,null),new r.TagValue("marginr","number",!1,null),new r.TagValue("marginb","number",!1,null),
new r.TagValue("marginl","number",!1,null),new r.TagValue("pitch","number",!1,null),new r.TagValue("lineheight","number",!1,null),new r.TagValue("linepitch","number",!1,null),new r.TagValue("align","string",!1,null),new r.TagValue("shadow","boolean",!1,
null),new r.TagValue("shadowalpha","number",!1,null),new r.TagValue("shadowangle","number",!1,null),new r.TagValue("shadowblur","number",!1,null),new r.TagValue("shadowcolor ","number",!1,null),new r.TagValue("shadowdistance","number",!1,null),
new r.TagValue("edgewidth","number",!1,null),new r.TagValue("edgecolor","number",!1,null),new r.TagValue("rubysize","number",!1,null),new r.TagValue("rubypitch","number",!1,null),new r.TagValue("rubyoffset","number",!1,null)],function(e,t){
return i.getLayers(e).forEach(function(t){null!=e.fontfamily&&(t.textCanvas.style.fontFamily=e.fontfamily),null!=e.fontsize&&(t.textCanvas.style.fontSize=e.fontsize),null!=e.fontweight&&(t.textCanvas.style.fontWeight=e.fontweight),null!=e.fontstyle&&(
t.textCanvas.style.fontStyle=e.fontstyle),null!=e.color&&t.textCanvas.style.setColor(e.color),null!=e.gradientstops&&(t.textCanvas.style.fillGradientStops=e.gradientstops),null!=e.gradienttype&&(t.textCanvas.style.fillGradientType=e.gradienttype),
null!=e.margint&&(t.textCanvas.marginTop=e.margint),null!=e.marginr&&(t.textCanvas.marginRight=e.marginr),null!=e.marginb&&(t.textCanvas.marginBottom=e.marginb),null!=e.marginl&&(t.textCanvas.marginLeft=e.marginl),null!=e.pitch&&(
t.textCanvas.style.pitch=e.pitch),null!=e.lineheight&&(t.textCanvas.lineHeight=e.lineheight),null!=e.linepitch&&(t.textCanvas.linePitch=e.linepitch),null!=e.align&&(t.textCanvas.align=e.align),null!=e.shadow&&(t.textCanvas.style.shadow=e.shadow),
null!=e.shadowalpha&&(t.textCanvas.style.shadowAlpha=e.shadowalpha),null!=e.shadowangle&&(t.textCanvas.style.shadowAngle=e.shadowangle),null!=e.shadowblur&&(t.textCanvas.style.shadowBlur=e.shadowblur),
null!=e.shadowcolor&&t.textCanvas.style.setShadowColor(e.shadowcolor),null!=e.shadowdistance&&(t.textCanvas.style.shadowDistance=e.shadowdistance),null!=e.edgewidth&&(t.textCanvas.style.edgeWidth=e.edgewidth),
null!=e.edgecolor&&t.textCanvas.style.setEdgeColor(e.edgecolor),null!=e.rubysize&&(t.textCanvas.rubyFontSize=e.rubysize),null!=e.rubypitch&&(t.textCanvas.rubyPitch=e.rubypitch),null!=e.rubyoffset&&(t.textCanvas.rubyOffset=e.rubyoffset)}),"continue"}),
new r.TagAction(["chineffect"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("type","string|array",!1,null),new r.TagValue("time","number",!1,null),new r.TagValue("ease","string",!1,"none"),
new r.TagValue("offsetx","number",!1,null),new r.TagValue("offsety","number",!1,null)],function(e,t){return i.getLayers(e).forEach(function(t){null!=e.type&&(t.textCanvas.style.inEffectTypes=e.type),null!=e.time&&(t.textCanvas.style.inEffectTime=e.time),
null!=e.ease&&(t.textCanvas.style.inEffectEase=e.ease),t.textCanvas.style.inEffectOptions={offsetx:e.offsetx,offsety:e.offsety}}),"continue"}),new r.TagAction(["ch"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current")
,new r.TagValue("text","string",!0,null)],function(e,t){return i.hideBreakGlyph(),i.getLayers(e).forEach(function(t){t.addChar(e.text)}),"fore"===e.page&&i.addCharWithBackFlag&&(e.page="back",i.getLayers(e).forEach(function(t){t.addChar(e.text)})),
i.isSkipping||0===i.textSpeed?"continue":i.conductor.sleep(t,i.textSpeed,"ch")}),new r.TagAction(["ruby"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("text","string",!1,null)],function(e,t){
return null!=e.text&&i.getLayers(e).forEach(function(t){t.reserveRubyText(e.text)}),"continue"}),new r.TagAction(["br"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(
function(t){t.addTextReturn()}),"continue"}),new r.TagAction(["clear","c"],[new r.TagValue("lay","string",!1,"all"),new r.TagValue("page","string",!1,"current")],function(t,e){return i.getLayers(t).forEach(function(t){t.clearText()}),i.hideBreakGlyph(),
"continue"}),new r.TagAction(["textspeed"],[new r.TagValue("mode","string",!1,null),new r.TagValue("unread","number",!1,null),new r.TagValue("read","number",!1,null),new r.TagValue("sysunread","number",!1,null),new r.TagValue("sysread","number",!1,null)],
function(t,e){return null!=t.move&&(i.textSpeedMode=t.mode),null!=t.unread&&(i.userUnreadTextSpeed=t.unread),null!=t.read&&(i.userReadTextSpeed=t.read),null!=t.sysunread&&(i.unreadTextSpeed=t.sysunread),null!=t.sysread&&(i.readTextSpeed=t.sysread),
"continue"}),new r.TagAction(["nowait"],[],function(t,e){return i.nowaitModeFlag=!0,"continue"}),new r.TagAction(["endnowait"],[],function(t,e){return i.nowaitModeFlag=!1,"continue"}),new r.TagAction(["textlocate","locate"],[new r.TagValue("lay","string",
!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("x","number",!1,null),new r.TagValue("y","number",!1,null)],function(e,t){return i.getLayers(e).forEach(function(t){t.setCharLocate(e.x,e.y)}),"continue"}),new r.TagAction(["indent"
],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("history","boolean",!1,!0)],function(t,e){return i.getLayers(t).forEach(function(t){t.setIndentPoint()}),
t.history&&i.historyLayer.setHistoryIndentPoint(),"continue"}),new r.TagAction(["endindent"],[new r.TagValue("lay","string",!1,"message"),new r.TagValue("page","string",!1,"current"),new r.TagValue("history","boolean",!1,!0)],function(t,e){
return i.getLayers(t).forEach(function(t){t.clearIndentPoint()}),t.history&&i.historyLayer.clearHistoryIndentPoint(),"continue"}),new r.TagAction(["linebreak","lb","l"],[],function(t,e){return i.stopUntilClickSkip(),i.isSkipping?(i.showLineBreakGlyph(e),
i.hideBreakGlyph(),"break"):(i.showLineBreakGlyph(e),i.conductor.addEventHandler(new n.PonEventHandler("click",function(){i.conductor.start(),i.hideBreakGlyph()},"lb")),i.reserveAutoClick(e),i.conductor.stop())}),new r.TagAction(["pagebreak","pb","p"],[],
function(t,e){return i.stopUntilClickSkip(),i.historyTextReturn(),i.isSkipping?(i.showPageBreakGlyph(e),i.hideBreakGlyph(),"break"):(i.showPageBreakGlyph(e),i.conductor.addEventHandler(new n.PonEventHandler("click",function(){i.conductor.start(),
i.hideBreakGlyph()},"pb")),i.reserveAutoClick(e),i.conductor.stop())}),new r.TagAction(["hidemessages"],[],function(t,e){return i.hideMessages(),i.conductor.addEventHandler(new n.PonEventHandler("click",function(){i.conductor.start(),i.showMessages()},
"hidemessages")),i.conductor.stop()})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4);e.default=function(i){return[new r.TagAction(["save"],[new r.TagValue("num","number",!0,null)],function(t,e){return i.save(e,
t.num),"continue"}),new r.TagAction(["load"],[new r.TagValue("num","number",!0,null)],function(e,t){return i.load(t,e.num).then(function(){i.conductor.start()}).catch(function(t){throw console.error(t),new Error("セーブデータのロードに失敗しました("+e.num+")")}),
i.conductor.stop()}),new r.TagAction(["tempsave"],[new r.TagValue("num","number",!0,null)],function(t,e){return i.tempSave(e,t.num),"continue"}),new r.TagAction(["tempload"],[new r.TagValue("num","number",!0,null),new r.TagValue("sound","boolean",!1,!1),
new r.TagValue("toback","boolean",!1,!1)],function(e,t){return i.tempLoad(t,e.num,e.sound,e.toback).then(function(){i.conductor.start()}).catch(function(t){console.error(t),i.error(new Error("セーブデータのロードに失敗しました("+e.num+")"))}),i.conductor.stop()}),
new r.TagAction(["lockscreenshot"],[],function(t,e){return i.lockScreenShot(),"continue"}),new r.TagAction(["unlockscreenshot"],[],function(t,e){return i.unlockScreenShot(),"continue"}),new r.TagAction(["copysavedata","copysave"],[new r.TagValue("srcnum",
"number",!0,null),new r.TagValue("destnum","number",!0,null)],function(t,e){return i.copySaveData(t.srcnum,t.destnum),"continue"}),new r.TagAction(["deletesavedata","delsavedata","delsave"],[new r.TagValue("num","number",!0,null)],function(t,e){
return i.deleteSaveData(t.num),"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4),s=i(8);e.default=function(n){return[new r.TagAction(["s"],[],function(t,e){return n.conductor.passLatestSaveMark(),
n.conductor.stop(),n.stopSkip(),"break"}),new r.TagAction(["jump"],[new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("countpage","boolean",!1,!0)],function(t,e){return null==t.file&&null==t.label?"continue":(
n.conductor.jump(t.file,t.label,t.countpage).then(function(){n.conductor.start()}),n.conductor.stop())}),new r.TagAction(["call"],[new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("countpage","boolean",!1,!1)
],function(t,e){return null==t.file&&null==t.label?"continue":(n.callSubroutine(t.file,t.label,t.countpage).then(function(){n.conductor.start()}),n.conductor.stop())}),new r.TagAction(["return"],[new r.TagValue("forcestart","boolean",!1,!1),
new r.TagValue("countpage","boolean",!1,!0)],function(t,e){return n.returnSubroutine(t.forcestart,t.countpage)}),new r.TagAction(["if"],[new r.TagValue("exp","string",!0,null)],function(t,e){return n.conductor.script.ifJump(t.exp,n.tagActions),"continue"}
),new r.TagAction(["elseif","elsif"],[],function(t,e){return n.conductor.script.elsifJump(),"continue"}),new r.TagAction(["else"],[],function(t,e){return n.conductor.script.elseJump(),"continue"}),new r.TagAction(["endif"],[],function(t,e){
return n.conductor.script.endif(),"continue"}),new r.TagAction(["for"],[new r.TagValue("loops","number",!0,null),new r.TagValue("indexvar","string",!1,"__index__")],function(t,e){return n.conductor.script.startForLoop(t.loops,t.indexvar),"continue"}),
new r.TagAction(["endfor"],[],function(t,e){return n.conductor.script.endForLoop(),"continue"}),new r.TagAction(["breakfor"],[],function(t,e){return n.conductor.script.breakForLoop(),"continue"}),new r.TagAction(["startskip","skip"],[],function(t,e){
return n.startSkipByTag(),"continue"}),new r.TagAction(["stopskip"],[],function(t,e){return n.stopSkip(),"continue"}),new r.TagAction(["startautomode","startauto","auto"],[],function(t,e){return n.startAutoMode(),"continue"}),new r.TagAction([
"stopautomode","stopauto"],[],function(t,e){return n.stopAutoMode(),"continue"}),new r.TagAction(["automodeopt","autoopt"],[new r.TagValue("lay","number",!1,null),new r.TagValue("time","number",!1,null)],function(t,e){return t.lay&&(
n.autoModeLayerNum=t.lay),t.time&&(n.autoModeInterval=t.time),"continue"}),new r.TagAction(["wait"],[new r.TagValue("time","number",!0,null),new r.TagValue("canskip","boolean",!1,!0)],function(t,e){return n.isSkipping&&t.canskip?"continue":(
t.canskip&&n.conductor.addEventHandler(new s.PonEventHandler("click",function(){n.conductor.start(),n.stopUntilClickSkip()},"wait")),n.conductor.sleep(e,t.time,"wait"))}),new r.TagAction(["waituntil"],[new r.TagValue("time","number",!0,null),
new r.TagValue("canskip","boolean",!1,!0)],function(t,e){if(n.waitUntilTime=0,n.isSkipping&&t.canskip)return"continue";if(-1==n.waitUntilStartTick)return"continue";var i=Date.now(),r=i-n.waitUntilStartTick;return r>=t.time?"continue":(
t.canskip&&n.conductor.addEventHandler(new s.PonEventHandler("click",function(){n.conductor.start(),n.stopUntilClickSkip()},"waituntil")),n.waitUntilTime=t.time-r,n.conductor.sleep(i,n.waitUntilTime,"wait"))}),new r.TagAction(["resetwait"],[],function(t,e
){return n.waitUntilStartTick=Date.now(),"continue"}),new r.TagAction(["waitclick"],[new r.TagValue("canskip","boolean",!1,!0)],function(t,e){return n.stopUntilClickSkip(),n.isSkipping&&t.canskip?"continue":(n.conductor.addEventHandler(
new s.PonEventHandler("click",function(){n.conductor.start()},"waitclick")),n.autoModeFlag&&t.canskip&&n.reserveAutoClick(e),n.conductor.stop())})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4),s=i(8)
;e.default=function(r){return[new n.TagAction(["bufalias"],[new n.TagValue("name","string",!0,null),new n.TagValue("buf","string",!0,null)],function(t,e){return r.soundBufferAlias[t.name]=t.buf,"continue"}),new n.TagAction(["delbufalias"],[new n.TagValue(
"name","string",!0,null)],function(t,e){return delete r.soundBufferAlias[t.name],"continue"}),new n.TagAction(["loadsound","sound"],[new n.TagValue("buf","string",!0,null),new n.TagValue("file","string",!0,null)],function(t,e){return r.getSoundBuffer(
t.buf).loadSound(t.file).then(function(t){r.conductor.start()}).catch(function(){r.error(new Error("音声のロードに失敗しました("+t.file+")"))}),r.conductor.stop()}),new n.TagAction(["freesound","unloadsound"],[new n.TagValue("buf","string",!0,null)],function(t,e){
return r.getSoundBuffer(t.buf).freeSound(),"continue"}),new n.TagAction(["soundopt"],[new n.TagValue("buf","string",!0,null),new n.TagValue("volume","number",!1,null),new n.TagValue("gvolume","number",!1,null),new n.TagValue("seek","number",!1,null),
new n.TagValue("loop","boolean",!1,null)],function(t,e){var i=r.getSoundBuffer(t.buf);return null!=t.volume&&(i.volume=t.volume),null!=t.gvolume&&(i.gvolume=t.gvolume),null!=t.seek&&(i.seek=t.seek),null!=t.loop&&(i.loop=t.loop),"continue"}),
new n.TagAction(["setsoundstop"],[new n.TagValue("buf","string",!0,null),new n.TagValue("jump","boolean",!1,!0),new n.TagValue("call","boolean",!1,!1),new n.TagValue("file","string",!1,null),new n.TagValue("label","string",!1,null)],function(t,e){
var i=r.getSoundBuffer(t.buf);return null!=t.jump&&(i.onStopJump=t.jump),null!=t.call&&(i.onStopCall=t.call),null!=t.file&&(i.onStopFile=t.file),null!=t.label&&(i.onStopLabel=t.label),"continue"}),new n.TagAction(["playsound"],[new n.TagValue("buf",
"string",!0,null)],function(t,e){return r.getSoundBuffer(t.buf).play(),"continue"}),new n.TagAction(["stopsound"],[new n.TagValue("buf","string",!0,null)],function(t,e){return r.getSoundBuffer(t.buf).stop("tag"),"continue"}),new n.TagAction(["fadesound"],
[new n.TagValue("buf","string",!0,null),new n.TagValue("volume","number",!0,null),new n.TagValue("time","number",!0,null),new n.TagValue("autostop","boolean",!1,!1)],function(t,e){return r.getSoundBuffer(t.buf).fade(t.volume,t.time,t.autostop),"continue"}
),new n.TagAction(["fadeoutsound","fadeout"],[new n.TagValue("buf","string",!0,null),new n.TagValue("time","number",!0,null),new n.TagValue("autostop","boolean",!1,!0)],function(t,e){return r.getSoundBuffer(t.buf).fadeout(t.time,t.autostop),"continue"}),
new n.TagAction(["fadeinsound","fadein"],[new n.TagValue("buf","string",!0,null),new n.TagValue("volume","number",!0,null),new n.TagValue("time","number",!0,null)],function(t,e){return r.getSoundBuffer(t.buf).fadein(t.volume,t.time),"continue"}),
new n.TagAction(["waitsoundstop","waitsound"],[new n.TagValue("buf","string",!0,null),new n.TagValue("canskip","boolean",!1,!0)],function(t,e){var i=r.getSoundBuffer(t.buf);return!i.playing||i.loop?"continue":r.isSkipping&&t.canskip?(
r.waitSoundStopClickCallback(i),"continue"):(t.canskip&&r.conductor.addEventHandler(new s.PonEventHandler("click",function(){r.waitSoundStopClickCallback(i)},"waitsoundstop")),r.conductor.addEventHandler(new s.PonEventHandler("soundstop",function(){
r.waitSoundCompleteCallback(i)},"waitsoundstop")),r.conductor.stop())}),new n.TagAction(["waitsoundfade","waitfade"],[new n.TagValue("buf","string",!0,null),new n.TagValue("canskip","boolean",!1,!0)],function(t,e){var i=r.getSoundBuffer(t.buf)
;return i.fading?r.isSkipping&&t.canskip?(r.waitSoundFadeClickCallback(i),"continue"):(t.canskip&&r.conductor.addEventHandler(new s.PonEventHandler("click",function(){r.waitSoundFadeClickCallback(i)},"waitsoundfade")),r.conductor.addEventHandler(
new s.PonEventHandler("soundfade",function(){r.waitSoundFadeCompleteCallback(i)},"waitsoundfade")),r.conductor.stop()):"continue"}),new n.TagAction(["endfadesound","endfade"],[new n.TagValue("buf","string",!0,null)],function(t,e){return r.getSoundBuffer(
t.buf).endFade(),"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4),n=i(8);e.default=function(i){return[new r.TagAction(["laycount"],[new r.TagValue("count","number",!0,null)],function(t,e){
return i.layerCount=t.count,"continue"}),new r.TagAction(["raiseerror"],[new r.TagValue("unknowncommand","boolean",!1,null)],function(t,e){return null!=t.unknowncommand&&(i.raiseError.unknowncommand=t.unknowncommand),"continue"}),new r.TagAction([
"dumpdebuginfo"],[],function(t,e){return i.dumpDebugInfo(),"continue"}),new r.TagAction(["lockgame"],[],function(t,e){return i.lock(),"break"}),new r.TagAction(["unlockgame"],[],function(t,e){return i.unlock(),"break"}),new r.TagAction(["clearsysvar"],[],
function(t,e){return i.resource.systemVar={},"continue"}),new r.TagAction(["cleargamevar"],[],function(t,e){return i.resource.gameVar={},"continue"}),new r.TagAction(["cleartmpvar"],[],function(t,e){return i.resource.tmpVar={},"continue"}),
new r.TagAction(["savesysvar"],[],function(t,e){return i.saveSystemData(),"continue"}),new r.TagAction(["clickskipopt","clickskip"],[new r.TagValue("enabled","boolean",!0,null)],function(t,e){return i.clickSkipEnabled=t.enabled,"continue"}),
new r.TagAction(["quake"],[new r.TagValue("time","number",!0,null),new r.TagValue("x","number",!1,20),new r.TagValue("y","number",!1,20)],function(t,e){return i.startQuake(e,t.time,t.x,t.y),"continue"}),new r.TagAction(["stopquake"],[],function(t,e){
return i.stopQuake(),"continue"}),new r.TagAction(["waitquake"],[new r.TagValue("canskip","boolean",!1,!0)],function(t,e){return i.isQuaking?i.isSkipping&&t.canskip?(i.stopQuake(),"break"):(t.canskip&&i.conductor.addEventHandler(new n.PonEventHandler(
"click",function(){i.stopQuake(),i.conductor.start()},"waitquake")),i.conductor.addEventHandler(new n.PonEventHandler("quake",function(){i.conductor.start()},"waitquake")),i.conductor.stop()):"continue"}),new r.TagAction(["rightclick","rclick"],[
new r.TagValue("jump","boolean",!1,null),new r.TagValue("call","boolean",!1,null),new r.TagValue("file","string",!1,null),new r.TagValue("label","string",!1,null),new r.TagValue("enabled","boolean",!1,null)],function(t,e){return null!=t.jump&&(
i.rightClickJump=t.jump),null!=t.call&&(i.rightClickCall=t.call),null!=t.file&&(i.rightClickFilePath=t.file),null!=t.label&&(i.rightClickLabel=t.label),null!=t.enabled&&(i.rightClickEnabled=t.enabled),"continue"}),new r.TagAction(["commandshortcut",
"cmdsc"],[new r.TagValue("ch","string",!0,null),new r.TagValue("command","string",!0,null)],function(t,e){return i.addCommandShortcut(t.ch,t.command),"continue"}),new r.TagAction(["delcommandshortcut","delcmdsc"],[new r.TagValue("ch","string",!0,null)],
function(t,e){return i.delCommandShortcut(t.ch),"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4),n=i(8);e.default=function(i){return[new r.TagAction(["backlay"],[new r.TagValue("lay","string",!1,
"all")],function(t,e){return i.backlay(t.lay),"continue"}),new r.TagAction(["copylay"],[new r.TagValue("srclay","number",!0,null),new r.TagValue("destlay","number",!0,null),new r.TagValue("srcpage","string",!1,"fore"),new r.TagValue("destpage","string",!1
,"fore")],function(t,e){return i.copylay(t.srclay,t.destlay,t.srcpage,t.destpage),"continue"}),new r.TagAction(["currentpage"],[new r.TagValue("page","string",!0,null)],function(t,e){return i.currentPage=t.page,"continue"}),new r.TagAction(["preparetrans"
,"pretrans"],[],function(t,e){return i.backlay("all"),i.currentPage="back","continue"}),new r.TagAction(["trans"],[new r.TagValue("time","number",!0,null),new r.TagValue("method","string",!1,"crossfade"),new r.TagValue("rule","string",!1,""),
new r.TagValue("vague","number",!1,.25)],function(e,t){return e.time<=0?(i.flip(),i.onCompleteTrans(),"continue"):("univ"===e.method?i.transManager.initUnivTrans(e.time,e.rule,e.vague).then(function(){i.transManager.start(),i.conductor.start()}).catch(
function(t){console.error(t),i.error(new Error("トランジションの処理に失敗しました。("+e.method+", "+e.rule+")"))}):i.transManager.initTrans(e.time,e.method).then(function(){i.transManager.start(),i.conductor.start()}).catch(function(t){console.error(t),i.error(new Error(
"トランジションの処理に失敗しました。("+e.method+")"))}),i.conductor.stop())}),new r.TagAction(["stoptrans"],[],function(t,e){return i.transManager.isRunning&&i.transManager.stop(),"continue"}),new r.TagAction(["waittrans","wt"],[new r.TagValue("canskip","boolean",!1,!0)],
function(t,e){return i.transManager.isRunning?i.isSkipping&&t.canskip?(i.waitTransClickCallback(),"break"):(t.canskip&&i.conductor.addEventHandler(new n.PonEventHandler("click",function(){i.waitTransClickCallback()},"waittrans")),
i.conductor.addEventHandler(new n.PonEventHandler("trans",function(){i.waitTransCompleteCallback()},"waittrans")),i.conductor.stop()):"continue"}),new r.TagAction(["flip"],[],function(t,e){return i.flip(),i.onCompleteTrans(),"continue"})]}},function(t,e,i
){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4),s=i(8);e.default=function(r){return[new n.TagAction(["loadvideo","video"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current"),new n.TagValue("file"
,"string",!0,null),new n.TagValue("width","number",!0,null),new n.TagValue("height","number",!0,null),new n.TagValue("autoplay","boolean",!1,!0),new n.TagValue("loop","boolean",!1,!1),new n.TagValue("volume","number",!1,1),new n.TagValue("visible",
"boolean",!1,null),new n.TagValue("x","number",!1,null),new n.TagValue("y","number",!1,null),new n.TagValue("alpha","number",!1,1)],function(e,t){var i=[];return r.getLayers(e).forEach(function(t){i.push((null!=e.x&&(t.x=e.x),null!=e.y&&(t.y=e.y),
null!=e.visible&&(t.visible=e.visible),null!=e.alpha&&(t.alpha=e.alpha),t.loadVideo(e.file,e.width,e.height,e.autoplay,e.loop,e.volume)))}),Promise.all(i).then(function(){r.conductor.start()}).catch(function(t){console.error(t),r.error(new Error(
"動画読み込みに失敗しました。("+e.file+")"))}),r.conductor.stop()}),new n.TagAction(["freevideo"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current")],function(t,e){return r.getLayers(t).forEach(function(t){t.freeVideo()}),"continue"}),
new n.TagAction(["videoopt"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current"),new n.TagValue("volume","number",!1,null),new n.TagValue("loop","boolean",!1,null)],function(e,t){return r.getLayers(e).forEach(function(t){
null!=e.volume&&(t.videoVolume=e.volume),null!=e.loop&&(t.videoLoop=e.loop)}),"continue"}),new n.TagAction(["playvideo"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current")],function(t,e){return r.getLayers(t).forEach(
function(t){t.playVideo()}),"continue"}),new n.TagAction(["pausevideo"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current")],function(t,e){return r.getLayers(t).forEach(function(t){t.pauseVideo()}),"continue"}),
new n.TagAction(["stopvideo"],[new n.TagValue("lay","string",!0,null),new n.TagValue("page","string",!1,"current")],function(t,e){return r.getLayers(t).forEach(function(t){t.stopVideo()}),"continue"}),new n.TagAction(["waitvideo"],[new n.TagValue(
"canskip","boolean",!1,!0)],function(t,e){return r.hasPlayingVideoLayer?r.isSkipping&&t.canskip?(r.waitVideoClickCallback(),"break"):(t.canskip&&r.conductor.addEventHandler(new s.PonEventHandler("click",function(){r.waitVideoClickCallback()},"waitvideo"))
,r.conductor.addEventHandler(new s.PonEventHandler("video",function(){r.waitVideoCompleteCallback()},"waitvideo")),r.conductor.stop()):"continue"})]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(
n.prototype.clone=function(){var e=[];return this.tags.forEach(function(t){e.push(t.clone())}),new n(this.name,e)},n.prototype.getCurrentTag=function(){return this.tags.length<=this.tagPoint?null:this.tags[this.tagPoint]},n.prototype.getNextTag=function(
){return this.tags.length<=this.tagPoint?null:this.tags[this.tagPoint++]},n.prototype.clearTagPoint=function(){this.tagPoint=0},n);function n(t,e){this.tagPoint=0,this.params={},this.name=t,this.tags=e}e.Macro=r},function(t,e,i){"use strict"
;Object.defineProperty(e,"__esModule",{value:!0});var o=i(7),r=i(13),n=(Object.defineProperty(s.prototype,"tags",{get:function(){return this._tags},enumerable:!0,configurable:!0}),s.prototype.debugPrint=function(){this.tags.forEach(function(t){
t.debugPrint()})},s.prototype.getLine=function(){return this.currentLineNum<this.lines.length?this.lines[this.currentLineNum++].replace(/^[ \t]+|[ \t]+$/g,""):null},s.prototype.getLineWithoutTrim=function(){
return this.currentLineNum<this.lines.length?this.lines[this.currentLineNum++]:null},s.prototype.getLabelPos=function(t){return Object.prototype.hasOwnProperty.call(this.labelMap,t)?this.labelMap[t]:-1},s.prototype.getSaveMarkPos=function(t){
return Object.prototype.hasOwnProperty.call(this.saveMarkMap,t)?this.saveMarkMap[t]:-1},s.prototype.parse=function(){for(;;){var t=this.getLine();if(null===t)break;if(""!==t){var e=t.charAt(0),i=t.substring(1).trim();if("---"===t){for(var r="";;){
var n=this.getLineWithoutTrim();if(null===n||"---"===n.trim())break;r+=n+"\n"}this.addTag("__js__",{__body__:r,print:!1})}else switch(e){case"#":break;case";":this.parseCommand(i);break;case"*":this.parseLabel(i);break;case"~":this.parseSaveMark(i);break
;case"-":this.parseJs(i);break;case"=":this.parseJsPrint(i);break;default:this.parseText(t)}}else this.currentLineNum<this.lines.length&&this.addLinebreak()}this.addTag("s",{__body__:"s"})},s.prototype.parseCommand=function(e){try{var t=void 0,i=void 0,
r=void 0,n=/[{ ]/.exec(e);if(null==n)t=e.substring(0).trim(),r={};else{if(t=e.substring(0,n.index).trim(),0!==(i=e.substring(n.index).trim()).indexOf("{"))i="{"+i+"}";else for(;"}"!==i.charAt(i.length-1);){var s=this.getLine();if(null===s)break
;i+=" "+s.trim()}r=this.resource.evalJs("("+i+")")}r.__body__=e,this.addTag(t,r)}catch(t){throw o.Logger.error(t),console.error(e),new Error("コマンド行の文法エラーです(行:"+this.currentLineNum+")")}},s.prototype.parseLabel=function(t){
Object.prototype.hasOwnProperty.call(this.labelMap,t)||(this.labelMap[t]=this._tags.length),this.addTag("__label__",{__body__:t})},s.prototype.parseSaveMark=function(t){var e=t.indexOf("|");if(-1!==e){var i=t.substring(0,e),r=t.substring(e+1)
;null!=i&&0!=i.length||(i="__save_mark_"+this.saveMarkCount+"__"),Object.prototype.hasOwnProperty.call(this.saveMarkMap,i)||(this.saveMarkMap[i]=this._tags.length),this.addTag("__save_mark__",{__body__:t,name:i,comment:r})}else if(0<t.length){
var n="__save_mark_"+this.saveMarkCount+"__";Object.prototype.hasOwnProperty.call(this.saveMarkMap,n)||(this.saveMarkMap[n]=this._tags.length),this.addTag("__save_mark__",{__body__:t,name:n,comment:t})}else{var s="__save_mark_"+this.saveMarkCount+"__"
;Object.prototype.hasOwnProperty.call(this.saveMarkMap,s)||(this.saveMarkMap[s]=this._tags.length),this.addTag("__save_mark__",{__body__:t,name:s,comment:""})}this.saveMarkCount++},s.prototype.parseJs=function(t){this.addTag("__js__",{__body__:t,print:!1}
)},s.prototype.parseJsPrint=function(t){this.addTag("__js__",{__body__:t,print:!0})},s.prototype.parseText=function(t){for(var e=0;e<t.length;e++){var i=t.charAt(e);""!==i&&this.addTag("ch",{__body__:i,text:i})}this.addLinebreak()},
s.prototype.addLinebreak=function(){this.addTag("__line_break__",{__body__:"\n"})},s.prototype.addTag=function(t,e){this._tags.push(new r.Tag(t,e,this.currentLineNum-1))},s);function s(t,e){this.lines=[],this.currentLineNum=0,this.saveMarkCount=0,
this._tags=[],this.labelMap={},this.saveMarkMap={},this.resource=t,this.scriptText=e,this.currentLineNum=0,this.saveMarkCount=0,this.lines=this.scriptText.split(/\r\n|\n|\r/g),this.parse()}e.ScriptParser=n},function(t,e,i){"use strict"
;var s=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((
h=h.apply(s,o||[])).next())})},o=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(
t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(
o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys
).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop()
;continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var n,r,a=i(17),h=i(7),u=i(50),l=i(14),c=i(51),d=i(52),p=i(53),f=i(55),m=i(
56);(r=n=e.ScaleMode||(e.ScaleMode={}))[r.FIXED=0]="FIXED",r[r.FIT=1]="FIT",r[r.FULLSCREEN=2]="FULLSCREEN";var _=(Object.defineProperty(y.prototype,"width",{get:function(){return this.foreRenderer.width},enumerable:!0,configurable:!0}),
Object.defineProperty(y.prototype,"height",{get:function(){return this.foreRenderer.height},enumerable:!0,configurable:!0}),y.prototype.destroy=function(){this.stop(),this.foreRenderer.destroy(),this.backRenderer.destroy()},y.prototype.start=function(){
var t=this;this.stop(),this.loopFlag=!0,this.fpsPreTick=Date.now(),window.setTimeout(function(){t.updateLoop()},0),window.setTimeout(function(){t.drawLoop()},60)},y.prototype.stop=function(){this.loopFlag=!1,this.fpsPreTick=0,this.fpsCount=0,this.fps=0},
y.prototype.lock=function(t){void 0===t&&(t=!0),this.isLocked=!0,t&&this.conductor.stop()},y.prototype.unlock=function(t){void 0===t&&(t=!0),this.isLocked=!1,t&&this.conductor.start()},y.prototype.initWindowScale=function(){var t=this
;this._fixedScaleWidth=this.config.width,this._fixedScaleHeight=this.config.height,window.addEventListener("resize",function(){t.onWindowResize()}),this.onWindowResize(),window.addEventListener("fullscreenchange",function(){t.onFullscreenChange()}),
window.addEventListener("fullscreenerror",function(){t.onFullscreenChange()})},Object.defineProperty(y.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleModeBuffer=this._scaleMode,this._scaleMode=t,
this._scaleMode===n.FULLSCREEN?this.isFullscreen||this.requestFullscreen():this.isFullscreen&&this.cancelFullscreen(),this.onWindowResize()},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"isFullscreen",{get:function(){
var t=window.document;return null!=(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)},enumerable:!0,configurable:!0}),y.prototype.requestFullscreen=function(){var t=window.document.documentElement,
e=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen;e&&e.call(t)},y.prototype.cancelFullscreen=function(){var t=window.document,
e=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;e&&e.call(t)},y.prototype.onFullscreenChange=function(){
this.isFullscreen&&this.scaleMode!==n.FULLSCREEN?this.scaleMode=n.FULLSCREEN:this.isFullscreen||this.scaleMode!==n.FULLSCREEN||(this.scaleMode=this._scaleModeBuffer)},Object.defineProperty(y.prototype,"fixedScaleWidth",{get:function(){
return this._fixedScaleWidth},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"fixedScaleHeight",{get:function(){return this._fixedScaleHeight},enumerable:!0,configurable:!0}),y.prototype.setFixedScaleSize=function(t,e){
this._fixedScaleWidth=t,this._fixedScaleHeight=e,this.scaleMode=n.FIXED},y.prototype.onWindowResize=function(){var t=1,e=1,i=document.body.clientWidth,r=document.body.clientHeight;switch(this.scaleMode){case n.FIXED:
i>=this.fixedScaleWidth&&r>=this.fixedScaleHeight?(t=this.fixedScaleWidth/this.config.width,e=this.fixedScaleHeight/this.config.height):t=e=this.getFitScale();break;case n.FIT:case n.FULLSCREEN:t=e=this.getFitScale()}this.setCanvasScale(t,e)},
y.prototype.getFitScale=function(){return Math.min(this.parentElm.clientWidth/this.config.width,this.parentElm.clientHeight/this.config.height)},y.prototype.setCanvasScale=function(t,e){var i=this.config.width*t,r=this.config.height*e,n=(
this.parentElm.clientWidth-i)/2+"px",s=(this.parentElm.clientHeight-r)/2+"px",o="scale("+t+","+e+")";document.querySelectorAll(".ponkan-scale-target").forEach(function(t){null!=t.style&&(t.style.position="absolute",t.style.transform=o,
t.style["transform-origin"]="0 0",t.style.left=n,t.style.top=s)})},y.prototype.updateLoop=function(){var t=this;try{if(!this.loopFlag)return;var e=Date.now();this.update(e),window.setTimeout(function(){return t.updateLoop()},1)}catch(t){console.error(t),
this.error(t)}},y.prototype.drawLoop=function(){var t=this;try{if(!this.loopFlag)return;var e=Date.now();1e3<=e-this.fpsPreTick&&(this.fps=this.fpsCount,this.fpsPreTick=e,this.fpsCount=0),this.beforeDraw(e),
this.transManager.isRunning?this.transManager.draw(e):this.foreRenderer.draw(e),this.updateScreenShotFlag&&this.screenShot.draw(this.foreRenderer.canvasElm),this.fpsCount++,window.requestAnimationFrame(function(){return t.drawLoop()})}catch(t){
console.error(t),this.error(t)}},y.prototype.update=function(t){},y.prototype.beforeDraw=function(t){},y.prototype.error=function(t){h.Logger.error(t),alert(t.message)},Object.defineProperty(y.prototype,"conductor",{get:function(){
return this.conductorStack[this.conductorStack.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"mainConductor",{get:function(){return this.conductorStack[0]},enumerable:!0,configurable:!0}),y.prototype.callSubroutine=function(
i,r,n){return void 0===r&&(r=null),void 0===n&&(n=!1),s(this,void 0,void 0,function(){var e;return o(this,function(t){return null==i&&(i=this.conductor.script.filePath),e=new a.Conductor(this.resource,"Sub Conductor "+this.conductorStack.length,this),
this.conductorStack.push(e),[2,this.conductor.jump(i,r,n)]})})},y.prototype.returnSubroutine=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!0),1===this.conductorStack.length)throw new Error("returnで戻れませんでした。callとreturnの対応が取れていません");if(
e&&this.conductor.passLatestSaveMark(),this.conductorStack.pop(),this.onReturnSubroutin(t),t){var i=this.conductor.script.getLatestTag();null!=i&&"s"!==i.name&&(this.conductor.clearAllEventHandler(),this.conductor.start())}return this.conductor.trigger(
"return_subroutin"),this.onChangeStable(this.conductor.isStable),"break"},y.prototype.goToMainConductor=function(){for(;1<this.conductorStack.length;){var t=this.conductorStack.pop();null!=t&&t.stop()}},y.prototype.onTag=function(t,e,i){return"continue"},
y.prototype.onLabel=function(t,e,i){return"continue"},y.prototype.onSaveMark=function(t,e,i,r){return"continue"},y.prototype.onJs=function(t,e,i,r){return"continue"},y.prototype.onChangeStable=function(t){},y.prototype.onReturnSubroutin=function(t){
void 0===t&&(t=!1)},y.prototype.onError=function(t){this.error(t)},y.prototype.clearLayer=function(){var e=this;this.forePrimaryLayers.forEach(function(t){t.destroy(),e.foreRenderer.removeContainer(t.container)}),this.forePrimaryLayers=[],
this.backPrimaryLayers.forEach(function(t){t.destroy(),e.backRenderer.removeContainer(t.container)}),this.backPrimaryLayers=[]},y.prototype.addForePrimaryLayer=function(t){return this.forePrimaryLayers.push(t),this.foreRenderer.addContainer(t.container),t
},y.prototype.addBackPrimaryLayer=function(t){return this.backPrimaryLayers.push(t),this.backRenderer.addContainer(t.container),t},y.prototype.removeForePrimaryLayer=function(e){this.forePrimaryLayers=this.forePrimaryLayers.filter(function(t){return t!==e
}),this.foreRenderer.removeContainer(e.container)},y.prototype.removeBackPrimaryLayer=function(e){this.backPrimaryLayers=this.backPrimaryLayers.filter(function(t){return t!==e}),this.backRenderer.removeContainer(e.container)},y.prototype.flip=function(){
this.flipPrimaryLayers(),this.resetPrimaryLayersRenderer()},y.prototype.flipPrimaryLayers=function(){var t=this.forePrimaryLayers;this.forePrimaryLayers=this.backPrimaryLayers,this.backPrimaryLayers=t},y.prototype.resetPrimaryLayersRenderer=function(){
var e=this;this.forePrimaryLayers.forEach(function(t){e.foreRenderer.removeContainer(t.container),e.backRenderer.removeContainer(t.container)}),this.backPrimaryLayers.forEach(function(t){e.backRenderer.removeContainer(t.container),
e.foreRenderer.removeContainer(t.container)}),this.forePrimaryLayers.forEach(function(t){e.foreRenderer.addContainer(t.container)}),this.backPrimaryLayers.forEach(function(t){e.backRenderer.addContainer(t.container)})},y.prototype.lockScreenShot=function(
){this.updateScreenShotFlag=!1},y.prototype.unlockScreenShot=function(){this.updateScreenShotFlag=!0},y.prototype.onCompleteTrans=function(){return this.conductor.trigger("trans"),!0},y.prototype.initWindowEvent=function(){var t=this
;window.addEventListener("unload",function(){t.onWindowClose()}),window.addEventListener("beforeunload",function(){t.onWindowClose()})},y.prototype.onWindowClose=function(){return!0},y.prototype.initMouseEventOnCanvas=function(t){var e=this
;t.addEventListener("mouseenter",function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseEnter(new l.PonMouseEvent(t))}catch(t){e.error(t)}return!0}),t.addEventListener("mouseleave",function(t){try{return t.preventDefault(),
e.isLocked||e.onMouseLeave(new l.PonMouseEvent(t)),!0}catch(t){return e.error(t),!0}}),t.addEventListener("mousewheel",function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseWheel(new d.PonWheelEvent(t))}catch(t){e.error(t)}return!0}),
t.addEventListener("click",function(t){return t.preventDefault(),!0}),t.addEventListener("contextmenu",function(t){return t.preventDefault(),!0}),"ontouchmove"in t?t.addEventListener("touchmove",function(t){try{if(t.preventDefault(),e.isLocked)return!0
;e.onMouseMove(e.convertTouchEventToMouseEvent(t))}catch(t){e.error(t)}return!0}):t.addEventListener("mousemove",function(t){try{if(t.preventDefault(),e.isLocked)return!0;e.onMouseMove(new l.PonMouseEvent(t))}catch(t){e.error(t)}return!0}),
"ontouchstart"in t?t.addEventListener("touchstart",function(t){try{return t.preventDefault(),!!e.isLocked||e.onMouseDown(e.convertTouchEventToMouseEvent(t))}catch(t){e.error(t)}}):t.addEventListener("mousedown",function(t){try{return t.preventDefault(),
!!e.isLocked||e.onMouseDown(new l.PonMouseEvent(t))}catch(t){e.error(t)}}),"ontouchend"in t?t.addEventListener("touchend",function(t){t.preventDefault();try{if(e.isLocked)return!0;e.onMouseUp(e.convertTouchEventToMouseEvent(t))}catch(t){e.error(t)}
return!0}):t.addEventListener("mouseup",function(t){t.preventDefault();try{if(e.isLocked)return!0;e.onMouseUp(new l.PonMouseEvent(t))}catch(t){e.error(t)}return!0})},y.prototype.convertTouchEventToMouseEvent=function(t){
var e=t.changedTouches[t.changedTouches.length-1],i=e.pageX-e.target.offsetLeft,r=e.pageY-e.target.offsetTop,n=this.getFitScale();i/=n,r/=n;try{return new l.PonMouseEvent(Math.floor(i),Math.floor(r),0)}catch(t){return this.error(t),new l.PonMouseEvent(-1,
-1,0)}},y.prototype.onMouseEnter=function(t){},y.prototype.onMouseLeave=function(t){},y.prototype.onMouseMove=function(t){},y.prototype.onMouseDown=function(t){},y.prototype.onMouseUp=function(t){},y.prototype.onMouseWheel=function(t){return!0},
y.prototype.initKeyboardEvent=function(){var e=this;window.addEventListener("keydown",function(t){try{if(e.isLocked)return;e.onKeyDown(new u.PonKeyEvent(t))}catch(t){e.error(t)}}),window.addEventListener("keyup",function(t){try{if(e.isLocked)return
;e.onKeyUp(new u.PonKeyEvent(t))}catch(t){e.error(t)}})},y.prototype.onKeyDown=function(t){return!0},y.prototype.onKeyUp=function(t){return!0},y.ScaleMode=n,y.Logger=h.Logger,y);function y(t,e){void 0===e&&(e={}),this.config={},this.isLocked=!1,
this.loopFlag=!1,this.fpsPreTick=0,this.fpsCount=0,this.fps=0,this._scaleModeBuffer=n.FIT,this._scaleMode=n.FIT,this._fixedScaleWidth=800,this._fixedScaleHeight=450,this.conductorStack=[],this.forePrimaryLayers=[],this.backPrimaryLayers=[],
this.updateScreenShotFlag=!0;var i=document.getElementById(t);if(null==i)throw new Error("Not found HTMLElement: "+t);this.parentElm=i,null!=(this.config=e).width&&null!=e.height||(e.width=800,e.height=450),this.foreRenderer=new c.PonRenderer(i,e.width,
e.height),this.backRenderer=new c.PonRenderer(i,e.width,e.height),i.style.position="relative",i.style.display="block",i.style.padding="0",this.foreRenderer.canvasElm.style.display="block",this.backRenderer.canvasElm.style.display="none",
this.foreRenderer.canvasElm.className="ponkan-scale-target",this.backRenderer.canvasElm.className="ponkan-scale-target",this.resource=new p.Resource(this,e.gameDataDir,e.gameVersion),this.resource.enableResourceCache=!e.developMode,
this.transManager=new m.TransManager(this,this.resource),this.screenShot=new f.ScreenShot(e),this.initWindowScale(),this.initWindowEvent(),this.initMouseEventOnCanvas(this.foreRenderer.canvasElm),this.initKeyboardEvent(),this.conductorStack.push(
new a.Conductor(this.resource,"Main Conductor",this))}e.PonGame=_},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(Object.defineProperty(n.prototype,"key",{get:function(){return this.e.key},enumerable:!0,
configurable:!0}),Object.defineProperty(n.prototype,"ctrl",{get:function(){return this.e.ctrlKey},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shift",{get:function(){return this.e.shiftKey},enumerable:!0,configurable:!0}),
Object.defineProperty(n.prototype,"alt",{get:function(){return this.e.altKey},enumerable:!0,configurable:!0}),n);function n(t){this.e=t}e.PonKeyEvent=r},function(t,e,i){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t
;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var s=r(i(5)),n=(Object.defineProperty(o.prototype,"width",{get:function(){return this._width},
enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"canvasElm",{get:function(){return this._canvasElm},enumerable:!0,
configurable:!0}),Object.defineProperty(o.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"sprite",{get:function(){return this._sprite},enumerable:!0,configurable:!0}),
Object.defineProperty(o.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),o.prototype.destroy=function(){this.container.destroy(),this.parentElm.removeChild(this.renderer.view),this.renderer.destroy()},
o.prototype.draw=function(t){null!=this.renderer&&null!=this._container&&(null!==this.otherRenderer&&this.otherRenderer.texture.update(),this.renderer.render(this._container))},o.prototype.addContainer=function(t){this._container.addChild(t)},
o.prototype.removeContainer=function(t){this._container.removeChild(t)},o.prototype.setOtherRenderer=function(t){this.delOtherRenderer(),this.otherRenderer=t,this._container.addChild(t.sprite)},o.prototype.delOtherRenderer=function(){
null!==this.otherRenderer&&this._container.removeChild(this.otherRenderer.sprite)},o);function o(t,e,i){this.otherRenderer=null,this._width=e,this._height=i,this.parentElm=t;var r=new s.Renderer({width:this._width,height:this._height,
backgroundColor:4278190080});this.renderer=r,t.appendChild(this.renderer.view),this._sprite=s.Sprite.from(this.renderer.view),this._texture=this._sprite.texture,this._sprite.width=e,this._sprite.height=i,this._canvasElm=this.renderer.view,
this._container=new s.Container;var n=new s.Sprite(s.Texture.WHITE);n.width=e,n.height=i,this._container.addChild(n),this._container.mask=n}e.PonRenderer=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(
Object.defineProperty(n.prototype,"isUp",{get:function(){return this.deltaY<=0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDown",{get:function(){return 0<this.deltaY},enumerable:!0,configurable:!0}),n);function n(t){
this.deltaX=t.deltaX,this.deltaY=t.deltaY}e.PonWheelEvent=r},function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t
)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},__generator=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0]
)throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError(
"Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{
value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(
6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t]
)}}},__importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(exports,"__esModule",{value:!0})
;var howler_1=__webpack_require__(54),logger_1=__webpack_require__(7),script_1=__webpack_require__(18),PIXI=__importStar(__webpack_require__(5)),Util=__importStar(__webpack_require__(9)),Resource=function(){function Resource(t,e,i){void 0===e&&(
e="./gamedata"),void 0===i&&(i="0.0.0"),this.gameVersion="",this.enableResourceCache=!0,this.tmpVar={},this.gameVar={},this.systemVar={saveDataInfo:[]},this.enabledScriptCache=!0,this.scriptCache={},this.cursor={disabled:"auto",normal:"auto",
over:"pointer",on:"pointer"},this.macroInfo={},this.macroParams=null,this.commandShortcut={},this.ponGame=t,this.basePath=this.fixPath(e),this.gameVersion=i,howler_1.Howler.usingWebAudio=!0,this.bufferCanvas=document.createElement("canvas"),
this.bufferCanvas.width=t.width,this.bufferCanvas.height=t.height;var r=this.bufferCanvas.getContext("2d");if(null===r)throw new Error("Canvasの初期化に失敗しました。");this.bufferCanvasContext=r}return Resource.prototype.getForeCanvasElm=function(){
return this.ponGame.foreRenderer.canvasElm},Resource.prototype.getBackCanvasElm=function(){return this.ponGame.backRenderer.canvasElm},Resource.prototype.saveSystemData=function(t){try{logger_1.Logger.debug(
"==SYSTEM SAVE======================================"),logger_1.Logger.debug(this.systemVar),logger_1.Logger.debug("==================================================="),this.storeToLocalStorage(t+"_sys",JSON.stringify(this.systemVar))}catch(t){
throw logger_1.Logger.error(t),new Error("セーブデータの保存に失敗しました。JSON文字列に変換できません")}},Resource.prototype.loadSystemData=function(t){try{var e=this.restoreFromLocalStorage(t+"_sys");null!=e&&Util.objExtend(this.systemVar,JSON.parse(e)),logger_1.Logger.debug(
"==SYSTEM LOAD======================================"),logger_1.Logger.debug(this.systemVar),logger_1.Logger.debug("===================================================")}catch(t){throw logger_1.Logger.error(t),new Error("システムデータのロードに失敗しました")}},
Resource.prototype.existSystemData=function(t){try{return null!=this.restoreFromLocalStorage(t+"_sys")}catch(t){return!1}},Resource.prototype.debugClearSystemData=function(){var e=this;Object.keys(this.systemVar).forEach(function(t){delete e.systemVar[t]}
)},Resource.prototype.evalJs=function(js){var ponkan=this.ponGame,tv=this.tmpVar,gv=this.gameVar,sv=this.systemVar,mp=this.macroParams;return function(){return eval(js)}()},Resource.prototype.setMacroParams=function(t){this.macroParams=t},
Resource.prototype.clearMacroParams=function(){this.macroParams=null},Resource.prototype.fixPath=function(t){return"/"===t[t.length-1]?t.substring(0,t.length-1):t},Resource.prototype.getPath=function(t){if(t.match(/^http:\/\/|^https:\/\//))return t
;var e=this.basePath+"/"+t;return this.enableResourceCache?e+="?v="+this.gameVersion:e+="?x="+Math.random().toString(36).slice(-8),e},Resource.prototype.hasMacro=function(t){return null!=this.macroInfo[t]},Resource.prototype.getMacro=function(t){
return this.macroInfo[t]},Resource.prototype.loadText=function(n){return __awaiter(this,void 0,void 0,function(){var r=this;return __generator(this,function(t){return[2,new Promise(function(t,e){var i=new XMLHttpRequest;i.onload=function(){
200<=i.status&&i.status<300?(logger_1.Logger.debug("AJAX SUCCESS: ",i),t(i.responseText)):(logger_1.Logger.debug("AJAX FAILED: ",i),e(i.statusText))},i.open("GET",r.getPath(n),!0),i.send()})]})})},Resource.prototype.loadScript=function(n){
return __awaiter(this,void 0,void 0,function(){var e,i,r;return __generator(this,function(t){switch(t.label){case 0:return this.enableResourceCache&&this.enabledScriptCache&&null!=this.scriptCache[n]?[2,this.scriptCache[n].clone()]:[3,1];case 1:
return t.trys.push([1,3,,4]),[4,this.loadText(n)];case 2:return e=t.sent(),i=new script_1.Script(this,n,e),this.enabledScriptCache?[2,(this.scriptCache[n]=i).clone()]:[2,i];case 3:throw r=t.sent(),logger_1.Logger.error(r),"string"==typeof r?new Error(r):r
;case 4:return[2]}})})},Resource.prototype.loadImage=function(o){return __awaiter(this,void 0,void 0,function(){var s=this;return __generator(this,function(t){return[2,new Promise(function(t,e){var i=s.getPath(o),r=new Image,n=!1;r.onload=function(){n=!0,
t(r)},r.onerror=function(){n||e(r)},0===o.indexOf("data:image/")?r.src=o:r.src=i})]})})},Resource.prototype.loadSoundHowler=function(r){var n=this;return new Promise(function(t,e){var i=new howler_1.Howl({src:[n.getPath(r)],loop:!0,volume:1,autoplay:!1,
onload:function(){t(i)},onloaderror:function(){e(i)}})})},Resource.prototype.loadVideoTexture=function(t,e){var i=this.getPath(t),r=PIXI.Texture.from(i,{scaleMode:PIXI.SCALE_MODES.NEAREST});return r.baseTexture.resource.autoPlay=e,r},
Resource.prototype.cloneVideoTexture=function(t){var e=t.baseTexture.resource.source;return PIXI.Texture.from(e)},Resource.prototype.isEnabledLocalStorage=function(){return null!=window.localStorage},Resource.prototype.storeToLocalStorage=function(t,e){
try{window.localStorage.setItem(t,e)}catch(t){throw new Error("ストレージが満杯のため保存できませんでした")}},Resource.prototype.restoreFromLocalStorage=function(t){var e=window.localStorage.getItem(t);if(null!=e)return e;throw new Error("ストレージ"+t+"にはデータがありません")},
Resource.prototype.copyLocalStorage=function(t,e){try{var i=this.restoreFromLocalStorage(t);return this.storeToLocalStorage(e,i),!0}catch(t){return!1}},Resource}();exports.Resource=Resource},function(n,d,t){(function(i){var r;!function(){"use strict"
;function t(){this.init()}t.prototype={init:function(){var t=this||x;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",
t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||x;if(t=parseFloat(t),e.ctx||c(),
void 0!==t&&0<=t&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,x.ctx.currentTime);for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var r=e._howls[i]._getSoundIds(),n=0;n<r.length;n++){
var s=e._howls[i]._soundById(r[n]);s&&s._node&&(s._node.volume=s._volume*t)}return e}return e._volume},mute:function(t){var e=this||x;e.ctx||c(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,x.ctx.currentTime);for(
var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var r=e._howls[i]._getSoundIds(),n=0;n<r.length;n++){var s=e._howls[i]._soundById(r[n]);s&&s._node&&(s._node.muted=!!t||s._muted)}return e},unload:function(){for(var t=this||x,
e=t._howls.length-1;0<=e;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,c()),t},codecs:function(t){return(this||x)._codecs[t.replace(/^x-/,"")]},_setup:function(){var e=this||x;if(
e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)
}catch(t){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||x,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(
/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),n=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(n||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"'
).replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;"
).replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;"
)||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(
/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var a=this||x,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi|Chrome|Safari/i.test(a._navigator&&a._navigator.userAgent)
;if(!a._audioUnlocked&&a.ctx&&t){a._audioUnlocked=!1,a.autoUnlock=!1,a._mobileUnloaded||44100===a.ctx.sampleRate||(a._mobileUnloaded=!0,a.unload()),a._scratchBuffer=a.ctx.createBuffer(1,1,22050);var h=function(t){for(var e=0;e<a.html5PoolSize;e++){
var i=new Audio;i._unlocked=!0,a._releaseHtml5Audio(i)}for(e=0;e<a._howls.length;e++)if(!a._howls[e]._webAudio)for(var r=a._howls[e]._getSoundIds(),n=0;n<r.length;n++){var s=a._howls[e]._soundById(r[n]);s&&s._node&&!s._node._unlocked&&(
s._node._unlocked=!0,s._node.load())}a._autoResume();var o=a.ctx.createBufferSource();o.buffer=a._scratchBuffer,o.connect(a.ctx.destination),void 0===o.start?o.noteOn(0):o.start(0),"function"==typeof a.ctx.resume&&a.ctx.resume(),o.onended=function(){
o.disconnect(0),a._audioUnlocked=!0,document.removeEventListener("touchstart",h,!0),document.removeEventListener("touchend",h,!0),document.removeEventListener("click",h,!0);for(var t=0;t<a._howls.length;t++)a._howls[t]._emit("unlock")}}
;return document.addEventListener("touchstart",h,!0),document.addEventListener("touchend",h,!0),document.addEventListener("click",h,!0),a}},_obtainHtml5Audio:function(){var t=this||x;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(
new Audio).play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(
t){var e=this||x;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&x.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(
var i=0;i<t._howls[e]._sounds.length;i++)if(!t._howls[e]._sounds[i]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend(
).then(function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())}))},3e4),t}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&x.usingWebAudio)return"running"===e.state&&e._suspendTimer?(
clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),
e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};function e(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")}var x=new t;e.prototype={init:function(t){
var e=this;return x.ctx||c(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload||t.preload,
e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhrWithCredentials=t.xhrWithCredentials||!1,e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],
e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{
fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],
e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=x.usingWebAudio&&!e._html5,void 0!==x.ctx&&x.ctx&&x.autoUnlock&&x._unlockAudio(),x._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),
e._preload&&e.load(),e},load:function(){var t=this,e=null;if(x.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var i=0;i<t._src.length;i++){var r,n;if(t._format&&t._format[i])r=t._format[i];else{
if("string"!=typeof(n=t._src[i])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}r=(r=(r=/^data:audio\/([^;,]+);/i.exec(n))||/\.([^.]+)$/.exec(n.split("?",1)[0]))&&r[1].toLowerCase()}if(r||console.warn(
'No file extension was found. Consider using the "format" property or specify an extension.'),r&&x.codecs(r)){e=t._src[i];break}}if(e)return t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,
t._webAudio=!1),new s(t),t._webAudio&&a(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,i){var r=this,t=null;if("number"==typeof e)t=e,e=null;else{if("string"==typeof e&&"loaded"===r._state&&!r._sprite[e]
)return null;if(void 0===e&&(e="__default",!r._playLock)){for(var n=0,s=0;s<r._sounds.length;s++)r._sounds[s]._paused&&!r._sounds[s]._ended&&(n++,t=r._sounds[s]._id);1===n?e=null:t=null}}var o=t?r._soundById(t):r._inactiveSound();if(!o)return null;if(
t&&!e&&(e=o._sprite||"__default"),"loaded"!==r._state){o._sprite=e,o._ended=!1;var a=o._id;return r._queue.push({event:"play",action:function(){r.play(a)}}),a}if(t&&!o._paused)return i||r._loadQueue("play"),o._id;r._webAudio&&x._autoResume()
;var h=Math.max(0,0<o._seek?o._seek:r._sprite[e][0]/1e3),u=Math.max(0,(r._sprite[e][0]+r._sprite[e][1])/1e3-h),l=1e3*u/Math.abs(o._rate),c=r._sprite[e][0]/1e3,d=(r._sprite[e][0]+r._sprite[e][1])/1e3,p=!(!o._loop&&!r._sprite[e][2]);o._sprite=e,o._ended=!1
;function f(){o._paused=!1,o._seek=h,o._start=c,o._stop=d,o._loop=p}if(!(d<=h)){var m=o._node;if(r._webAudio){var _=function(){r._playLock=!1,f(),r._refreshBuffer(o);var t=o._muted||r._muted?0:o._volume;m.gain.setValueAtTime(t,x.ctx.currentTime),
o._playStart=x.ctx.currentTime,void 0===m.bufferSource.start?o._loop?m.bufferSource.noteGrainOn(0,h,86400):m.bufferSource.noteGrainOn(0,h,u):o._loop?m.bufferSource.start(0,h,86400):m.bufferSource.start(0,h,u),l!=1/0&&(r._endTimers[o._id]=setTimeout(
r._ended.bind(r,o),l)),i||setTimeout(function(){r._emit("play",o._id),r._loadQueue()},0)};"running"===x.state?_():(r._playLock=!0,r.once("resume",_),r._clearTimer(o._id))}else{var y=function(){m.currentTime=h,m.muted=o._muted||r._muted||x._muted||m.muted,
m.volume=o._volume*x.volume(),m.playbackRate=o._rate;try{var t=m.play();if(t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)?(r._playLock=!0,f(),t.then(function(){r._playLock=!1,m._unlocked=!0,i||(r._emit("play",o._id),
r._loadQueue())}).catch(function(){r._playLock=!1,r._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),o._ended=!0,o._paused=!0})):i||(
r._playLock=!1,f(),r._emit("play",o._id),r._loadQueue()),m.playbackRate=o._rate,m.paused)return void r._emit("playerror",o._id,
"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||o._loop?r._endTimers[o._id]=setTimeout(r._ended.bind(r,o),l):(r._endTimers[o._id]=function(){
r._ended(o),m.removeEventListener("ended",r._endTimers[o._id],!1)},m.addEventListener("ended",r._endTimers[o._id],!1))}catch(t){r._emit("playerror",o._id,t)}},v=window&&window.ejecta||!m.readyState&&x._navigator.isCocoonJS;if(3<=m.readyState||v)y();else{
r._playLock=!0;var g=function(){y(),m.removeEventListener(x._canPlayEvent,g,!1)};m.addEventListener(x._canPlayEvent,g,!1),r._clearTimer(o._id)}}return o._id}r._ended(o)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock
)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var i=e._getSoundIds(t),r=0;r<i.length;r++){e._clearTimer(i[r]);var n=e._soundById(i[r]);if(n&&!n._paused&&(n._seek=e.seek(i[r]),n._rateSeek=0,n._paused=!0,e._stopFade(i[r]),
n._node))if(e._webAudio){if(!n._node.bufferSource)continue;void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),e._cleanBuffer(n._node)}else isNaN(n._node.duration)&&n._node.duration!==1/0||n._node.pause()
;arguments[1]||e._emit("pause",n?n._id:null)}return e},stop:function(t,e){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(t)}}),i;for(var r=i._getSoundIds(t),n=0;n<r.length;n++){i._clearTimer(r[n]
);var s=i._soundById(r[n]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,i._stopFade(r[n]),s._node&&(i._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),
i._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause())),e||i._emit("stop",s._id))}return i},mute:function(t,e){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({
event:"mute",action:function(){i.mute(t,e)}}),i;if(void 0===e){if("boolean"!=typeof t)return i._muted;i._muted=t}for(var r=i._getSoundIds(e),n=0;n<r.length;n++){var s=i._soundById(r[n]);s&&(s._muted=t,s._interval&&i._stopFade(s._id),
i._webAudio&&s._node?s._node.gain.setValueAtTime(t?0:s._volume,x.ctx.currentTime):s._node&&(s._node.muted=!!x._muted||t),i._emit("mute",s._id))}return i},volume:function(){var t,e,i,r=this,n=arguments;if(0===n.length)return r._volume;if(
1===n.length||2===n.length&&void 0===n[1]?0<=r._getSoundIds().indexOf(n[0])?e=parseInt(n[0],10):t=parseFloat(n[0]):2<=n.length&&(t=parseFloat(n[0]),e=parseInt(n[1],10)),!(void 0!==t&&0<=t&&t<=1))return(i=e?r._soundById(e):r._sounds[0])?i._volume:0;if(
"loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,n)}}),r;void 0===e&&(r._volume=t),e=r._getSoundIds(e);for(var s=0;s<e.length;s++)(i=r._soundById(e[s]))&&(i._volume=t,n[2]||r._stopFade(e[s]),
r._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(t,x.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=t*x.volume()),r._emit("volume",i._id));return r},fade:function(t,e,i,r){var n=this;if("loaded"!==n._state||n._playLock
)return n._queue.push({event:"fade",action:function(){n.fade(t,e,i,r)}}),n;t=parseFloat(t),e=parseFloat(e),i=parseFloat(i),n.volume(t,r);for(var s=n._getSoundIds(r),o=0;o<s.length;o++){var a=n._soundById(s[o]);if(a){if(r||n._stopFade(s[o]),
n._webAudio&&!a._muted){var h=x.ctx.currentTime,u=h+i/1e3;a._volume=t,a._node.gain.setValueAtTime(t,h),a._node.gain.linearRampToValueAtTime(e,u)}n._startFadeInterval(a,t,e,i,s[o],void 0===r)}}return n},_startFadeInterval:function(e,i,r,n,t,s){var o=this,
a=i,h=r-i,u=Math.abs(h/.01),l=Math.max(4,0<u?n/u:n),c=Date.now();e._fadeTo=r,e._interval=setInterval(function(){var t=(Date.now()-c)/n;c=Date.now(),a+=h*t,a=Math.max(0,a),a=Math.min(1,a),a=Math.round(100*a)/100,o._webAudio?e._volume=a:o.volume(a,e._id,!0)
,s&&(o._volume=a),(r<i&&a<=r||i<r&&r<=a)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,o.volume(r,e._id),o._emit("fade",e._id))},l)},_stopFade:function(t){var e=this._soundById(t);return e&&e._interval&&(
this._webAudio&&e._node.gain.cancelScheduledValues(x.ctx.currentTime),clearInterval(e._interval),e._interval=null,this.volume(e._fadeTo,t),e._fadeTo=null,this._emit("fade",t)),this},loop:function(){var t,e,i,r=arguments;if(0===r.length)return this._loop
;if(1===r.length){if("boolean"!=typeof r[0])return!!(i=this._soundById(parseInt(r[0],10)))&&i._loop;t=r[0],this._loop=t}else 2===r.length&&(t=r[0],e=parseInt(r[1],10));for(var n=this._getSoundIds(e),s=0;s<n.length;s++)(i=this._soundById(n[s]))&&(i._loop=t
,this._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=t)&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop));return this},rate:function(){var t,e,i,r=this,n=arguments;if(0===n.length
)e=r._sounds[0]._id;else if(1===n.length){0<=r._getSoundIds().indexOf(n[0])?e=parseInt(n[0],10):t=parseFloat(n[0])}else 2===n.length&&(t=parseFloat(n[0]),e=parseInt(n[1],10));if("number"!=typeof t)return(i=r._soundById(e))?i._rate:r._rate;if(
"loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,n)}}),r;void 0===e&&(r._rate=t),e=r._getSoundIds(e);for(var s=0;s<e.length;s++)if(i=r._soundById(e[s])){r.playing(e[s])&&(i._rateSeek=r.seek(e[s]),
i._playStart=r._webAudio?x.ctx.currentTime:i._playStart),i._rate=t,r._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(t,x.ctx.currentTime):i._node&&(i._node.playbackRate=t);var o=r.seek(e[s]),a=1e3*((
r._sprite[i._sprite][0]+r._sprite[i._sprite][1])/1e3-o)/Math.abs(i._rate);!r._endTimers[e[s]]&&i._paused||(r._clearTimer(e[s]),r._endTimers[e[s]]=setTimeout(r._ended.bind(r,i),a)),r._emit("rate",i._id)}return r},seek:function(){var t,e,i=this,r=arguments
;if(0===r.length)e=i._sounds[0]._id;else if(1===r.length){0<=i._getSoundIds().indexOf(r[0])?e=parseInt(r[0],10):i._sounds.length&&(e=i._sounds[0]._id,t=parseFloat(r[0]))}else 2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if(void 0===e)return i
;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"seek",action:function(){i.seek.apply(i,r)}}),i;var n=i._soundById(e);if(n){if(!("number"==typeof t&&0<=t)){if(i._webAudio){var s=i.playing(e)?x.ctx.currentTime-n._playStart:0,
o=n._rateSeek?n._rateSeek-n._seek:0;return n._seek+(o+s*Math.abs(n._rate))}return n._node.currentTime}var a=i.playing(e);a&&i.pause(e,!0),n._seek=t,n._ended=!1,i._clearTimer(e),i._webAudio||!n._node||isNaN(n._node.duration)||(n._node.currentTime=t)
;var h=function(){i._emit("seek",e),a&&i.play(e,!0)};if(a&&!i._webAudio){var u=function(){i._playLock?setTimeout(u,0):h()};setTimeout(u,0)}else h()}return i},playing:function(t){if("number"==typeof t){var e=this._soundById(t);return!!e&&!e._paused}for(
var i=0;i<this._sounds.length;i++)if(!this._sounds[i]._paused)return!0;return!1},duration:function(t){var e=this._duration,i=this._soundById(t);return i&&(e=this._sprite[i._sprite][1]/1e3),e},state:function(){return this._state},unload:function(){for(
var t=this,e=t._sounds,i=0;i<e.length;i++){if(e[i]._paused||t.stop(e[i]._id),!t._webAudio)/MSIE |Trident\//.test(x._navigator&&x._navigator.userAgent)||(
e[i]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),e[i]._node.removeEventListener("error",e[i]._errorFn,!1),e[i]._node.removeEventListener(x._canPlayEvent,e[i]._loadFn,!1),x._releaseHtml5Audio(
e[i]._node);delete e[i]._node,t._clearTimer(e[i]._id)}var r=x._howls.indexOf(t);0<=r&&x._howls.splice(r,1);var n=!0;for(i=0;i<x._howls.length;i++)if(x._howls[i]._src===t._src||0<=t._src.indexOf(x._howls[i]._src)){n=!1;break}return o&&n&&delete o[t._src],
x.noAudio=!1,t._state="unloaded",t._sounds=[],t=null},on:function(t,e,i,r){var n=this["_on"+t];return"function"==typeof e&&n.push(r?{id:i,fn:e,once:r}:{id:i,fn:e}),this},off:function(t,e,i){var r=this["_on"+t],n=0;if("number"==typeof e&&(i=e,e=null),e||i
)for(n=0;n<r.length;n++){var s=i===r[n].id;if(e===r[n].fn&&s||!e&&s){r.splice(n,1);break}}else if(t)this["_on"+t]=[];else{var o=Object.keys(this);for(n=0;n<o.length;n++)0===o[n].indexOf("_on")&&Array.isArray(this[o[n]])&&(this[o[n]]=[])}return this},
once:function(t,e,i){return this.on(t,e,i,1),this},_emit:function(t,e,i){for(var r=this["_on"+t],n=r.length-1;0<=n;n--)r[n].id&&r[n].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,i)}.bind(this,r[n].fn),0),r[n].once&&this.off(t,r[n].fn,r[n].id)
);return this._loadQueue(t),this},_loadQueue:function(t){if(0<this._queue.length){var e=this._queue[0];e.event===t&&(this._queue.shift(),this._loadQueue()),t||e.action()}return this},_ended:function(t){var e=this,i=t._sprite;if(
!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var r=!(!t._loop&&!e._sprite[i][2]);if(e._emit("end",t._id),!e._webAudio&&r&&e.stop(t._id,!0).play(t._id),e._webAudio&&r){
e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=x.ctx.currentTime;var n=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),n)}return e._webAudio&&!r&&(t._paused=!0,t._ended=!0,
t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),x._autoSuspend()),e._webAudio||r||e.stop(t._id,!0),e},_clearTimer:function(t){if(this._endTimers[t]){if("function"!=typeof this._endTimers[t])clearTimeout(this._endTimers[t]
);else{var e=this._soundById(t);e&&e._node&&e._node.removeEventListener("ended",this._endTimers[t],!1)}delete this._endTimers[t]}return this},_soundById:function(t){for(var e=0;e<this._sounds.length;e++)if(t===this._sounds[e]._id)return this._sounds[e]
;return null},_inactiveSound:function(){this._drain();for(var t=0;t<this._sounds.length;t++)if(this._sounds[t]._ended)return this._sounds[t].reset();return new s(this)},_drain:function(){var t=this,e=t._pool,i=0,r=0;if(!(t._sounds.length<e)){for(
r=0;r<t._sounds.length;r++)t._sounds[r]._ended&&i++;for(r=t._sounds.length-1;0<=r;r--){if(i<=e)return;t._sounds[r]._ended&&(t._webAudio&&t._sounds[r]._node&&t._sounds[r]._node.disconnect(0),t._sounds.splice(r,1),i--)}}},_getSoundIds:function(t){if(
void 0!==t)return[t];for(var e=[],i=0;i<this._sounds.length;i++)e.push(this._sounds[i]._id);return e},_refreshBuffer:function(t){return t._node.bufferSource=x.ctx.createBufferSource(),t._node.bufferSource.buffer=o[this._src],
t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),
t._node.bufferSource.playbackRate.setValueAtTime(t._rate,x.ctx.currentTime),this},_cleanBuffer:function(t){var e=x._navigator&&0<=x._navigator.vendor.indexOf("Apple");if(x._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,
t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=x._scratchBuffer}catch(t){}return t.bufferSource=null,this}};var s=function(t){this._parent=t,this.init()};s.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,
t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++x._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,i=x._muted||t._muted||t._parent._muted?0:t._volume
;return e._webAudio?(t._node=void 0===x.ctx.createGain?x.ctx.createGainNode():x.ctx.createGain(),t._node.gain.setValueAtTime(i,x.ctx.currentTime),t._node.paused=!0,t._node.connect(x.masterGain)):(t._node=x._obtainHtml5Audio(),
t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(x._canPlayEvent,t._loadFn,!1),t._node.src=e._src,t._node.preload="auto",t._node.volume=i*x.volume(),
t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++x._counter,t},_errorListener:function(){
this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var t=this._parent;t._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(
t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),this._node.removeEventListener(x._canPlayEvent,this._loadFn,!1)}};var o={},a=function(e){var t=e._src;if(o[t]
)return e._duration=o[t].duration,void l(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),r=new Uint8Array(i.length),n=0;n<i.length;++n)r[n]=i.charCodeAt(n);u(r.buffer,e)}else{var s=new XMLHttpRequest;s.open("GET",t,!0),
s.withCredentials=e._xhrWithCredentials,s.responseType="arraybuffer",s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?u(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(
){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete o[t],e.load())},h(s)}},h=function(e){try{e.send()}catch(t){e.onerror()}},u=function(t,e){function i(){e._emit("loaderror",null,"Decoding audio data failed.")}function r(t){
t&&0<e._sounds.length?(o[e._src]=t,l(e,t)):i()}"undefined"!=typeof Promise&&1===x.ctx.decodeAudioData.length?x.ctx.decodeAudioData(t).then(r).catch(i):x.ctx.decodeAudioData(t,r,i)},l=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(
t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},c=function(){if(x.usingWebAudio){try{
"undefined"!=typeof AudioContext?x.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?x.ctx=new webkitAudioContext:x.usingWebAudio=!1}catch(t){x.usingWebAudio=!1}x.ctx||(x.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(
x._navigator&&x._navigator.platform),e=x._navigator&&x._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=e?parseInt(e[1],10):null;if(t&&i&&i<9){var r=/safari/.test(x._navigator&&x._navigator.userAgent.toLowerCase());(
x._navigator&&x._navigator.standalone&&!r||x._navigator&&!x._navigator.standalone&&!r)&&(x.usingWebAudio=!1)}x.usingWebAudio&&(x.masterGain=void 0===x.ctx.createGain?x.ctx.createGainNode():x.ctx.createGain(),x.masterGain.gain.setValueAtTime(x._muted?0:1,
x.ctx.currentTime),x.masterGain.connect(x.ctx.destination)),x._setup()}};void 0===(r=function(){return{Howler:x,Howl:e}}.apply(d,[]))||(n.exports=r),d.Howler=x,d.Howl=e,"undefined"!=typeof window?(window.HowlerGlobal=t,window.Howler=x,window.Howl=e,
window.Sound=s):void 0!==i&&(i.HowlerGlobal=t,i.Howler=x,i.Howl=e,i.Sound=s)}(),function(){"use strict";var e,i,r;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){if(
!this.ctx||!this.ctx.listener)return this;for(var e=this._howls.length-1;0<=e;e--)this._howls[e].stereo(t);return this},HowlerGlobal.prototype.pos=function(t,e,i){var r=this;return r.ctx&&r.ctx.listener?(e="number"!=typeof e?r._pos[1]:e,
i="number"!=typeof i?r._pos[2]:i,"number"!=typeof t?r._pos:(r._pos=[t,e,i],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],
Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(t,e,i,r,n,s){var o=this;if(
!o.ctx||!o.ctx.listener)return o;var a=o._orientation;return e="number"!=typeof e?a[1]:e,i="number"!=typeof i?a[2]:i,r="number"!=typeof r?a[3]:r,n="number"!=typeof n?a[4]:n,s="number"!=typeof s?a[5]:s,"number"!=typeof t?a:(o._orientation=[t,e,i,r,n,s],
void 0!==o.ctx.listener.forwardX?(o.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),
o.ctx.listener.upX.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(i,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(t,e,i,r,n,s),o)},
Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,
coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,
panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],
this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(t,e){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,e)}}),i
;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===e){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var n=i._getSoundIds(e),s=0;s<n.length;s++){var o=i._soundById(n[s]);if(o){if("number"!=typeof t
)return o._stereo;o._stereo=t,o._pos=[t,0,0],o._node&&(o._pannerAttr.panningModel="equalpower",o._panner&&o._panner.pan||u(o,r),"spatial"==r?void 0!==o._panner.positionX?(o._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),
o._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),o._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):o._panner.setPosition(t,0,0):o._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",o._id)}}return i},
Howl.prototype.pos=function(t,e,i,r){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"pos",action:function(){n.pos(t,e,i,r)}}),n;if(e="number"!=typeof e?0:e,i="number"!=typeof i?-.5:i,void 0===r){if(
"number"!=typeof t)return n._pos;n._pos=[t,e,i]}for(var s=n._getSoundIds(r),o=0;o<s.length;o++){var a=n._soundById(s[o]);if(a){if("number"!=typeof t)return a._pos;a._pos=[t,e,i],a._node&&(a._panner&&!a._panner.pan||u(a,"spatial"),
void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):a._panner.setPosition(t,e,i)),n._emit(
"pos",a._id)}}return n},Howl.prototype.orientation=function(t,e,i,r){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"orientation",action:function(){n.orientation(t,e,i,r)}}),n;if(
e="number"!=typeof e?n._orientation[1]:e,i="number"!=typeof i?n._orientation[2]:i,void 0===r){if("number"!=typeof t)return n._orientation;n._orientation=[t,e,i]}for(var s=n._getSoundIds(r),o=0;o<s.length;o++){var a=n._soundById(s[o]);if(a){if(
"number"!=typeof t)return a._orientation;a._orientation=[t,e,i],a._node&&(a._panner||(a._pos||(a._pos=n._pos||[0,0,-.5]),u(a,"spatial")),void 0!==a._panner.orientationX?(a._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),
a._panner.orientationY.setValueAtTime(e,Howler.ctx.currentTime),a._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):a._panner.setOrientation(t,e,i)),n._emit("orientation",a._id)}}return n},Howl.prototype.pannerAttr=function(){var t,e,i,r=this
,n=arguments;if(!r._webAudio)return r;if(0===n.length)return r._pannerAttr;if(1===n.length){if("object"!=typeof n[0])return(i=r._soundById(parseInt(n[0],10)))?i._pannerAttr:r._pannerAttr;t=n[0],void 0===e&&(t.pannerAttr||(t.pannerAttr={
coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),r._pannerAttr={
coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:r._coneOuterAngle,
coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:r._distanceModel,
maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:r._refDistance,
rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:r._panningModel})}else 2===n.length&&(t=n[0],e=parseInt(n[1],10));for(
var s=r._getSoundIds(e),o=0;o<s.length;o++)if(i=r._soundById(s[o])){var a=i._pannerAttr;a={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:a.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:a.coneOuterAngle,
coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:a.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:a.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:a.maxDistance,
refDistance:void 0!==t.refDistance?t.refDistance:a.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:a.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:a.panningModel};var h=i._panner;h?(h.coneInnerAngle=a.coneInnerAngle,
h.coneOuterAngle=a.coneOuterAngle,h.coneOuterGain=a.coneOuterGain,h.distanceModel=a.distanceModel,h.maxDistance=a.maxDistance,h.refDistance=a.refDistance,h.rolloffFactor=a.rolloffFactor,h.panningModel=a.panningModel):(i._pos||(i._pos=r._pos||[0,0,-.5]),u(
i,"spatial"))}return r},Sound.prototype.init=(i=Sound.prototype.init,function(){var t=this,e=t._parent;t._orientation=e._orientation,t._stereo=e._stereo,t._pos=e._pos,t._pannerAttr=e._pannerAttr,i.call(this),t._stereo?e.stereo(t._stereo):t._pos&&e.pos(
t._pos[0],t._pos[1],t._pos[2],t._id)}),Sound.prototype.reset=(r=Sound.prototype.reset,function(){var t=this,e=t._parent;return t._orientation=e._orientation,t._stereo=e._stereo,t._pos=e._pos,t._pannerAttr=e._pannerAttr,t._stereo?e.stereo(t._stereo
):t._pos?e.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,e._refreshBuffer(t)),r.call(this)});var u=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),
t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,
t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(
t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],
t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(
t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(
t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()}).call(this,t(10))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n.prototype.draw=function(t){this.context.drawImage(t,0,0,this.canvas.width,
this.canvas.height)},n.prototype.getDataUrl=function(){return null!=this.quality?this.canvas.toDataURL(this.dataType,this.quality):this.canvas.toDataURL(this.dataType)},n);function n(t){this.dataType="image/jpeg",this.quality=.85,
this.nodata="image/nodata.png",this.canvas=document.createElement("canvas"),null==t&&(t={}),null==t.screenShot&&(t.screenShot={});var e=t.screenShot;null!=e.width?this.canvas.width=e.width:this.canvas.width=320,
null!=e.height?this.canvas.height=e.height:this.canvas.height=180,null!=e.dataType&&(this.dataType=e.dataType),null!=e.quality&&(this.quality=e.quality),null!=e.nodata&&(this.nodata=e.nodata);var i=this.canvas.getContext("2d");if(null==i)throw new Error(
"Canvasの初期化に失敗しました");this.context=i,this.context.fillStyle="#000000",this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}e.ScreenShot=r},function(t,p,e){"use strict";(function(h){var r,t=this&&this.__extends||(r=function(t,e){return(
r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(
i.prototype=e.prototype,new i)}),n=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t
){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},u=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},
"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return
)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue
;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}
o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(p,"__esModule",{value:!0});var e,i=(e=h.Filter,t(s,e),s);function s(){
return e.call(this,void 0,
"\n      varying vec2 vTextureCoord;\n      uniform sampler2D uSampler;\n      uniform sampler2D subSampler;\n      uniform float foreAlpha;\n      uniform float backAlpha;\n\n      void main(void) {\n        vec4 color = texture2D(uSampler, vTextureCoord);\n        vec4 scolor = texture2D(subSampler, vTextureCoord);\n        gl_FragColor = color * backAlpha + scolor * foreAlpha;\n      }\n    "
,{subSampler:{type:"sampler2D",value:1},foreAlpha:{type:"float",value:1},backAlpha:{type:"float",value:1}})||this}var o,a=(o=h.Filter,t(l,o),l);function l(){return o.call(this,void 0,
"\n      varying vec2 vTextureCoord;\n      uniform sampler2D uSampler;\n      uniform sampler2D subSampler;\n      uniform sampler2D ruleSampler;\n      uniform float time;\n      uniform float elapsedTime;\n      uniform float vague;\n      uniform float phaseMax;\n      uniform float phase;\n\n      void main(void) {\n        vec4 color = texture2D(uSampler, vTextureCoord);\n        vec4 scolor = texture2D(subSampler, vTextureCoord);\n        vec4 rcolor = texture2D(ruleSampler, vTextureCoord);\n\n        float a = (rcolor.r + rcolor.g + rcolor.b) / 3.0;\n        if (a < phase) {\n          gl_FragColor = scolor;\n        } else if (a >= phaseMax) {\n          gl_FragColor = color;\n        } else {\n          float tmp = 1.0 - ((a - phase) * 1.0 / vague);\n          if (tmp < 0.0) { tmp = 0.0; }\n          if (tmp > 1.0) { tmp = 1.0; }\n          gl_FragColor = scolor * tmp + color * (1.0 - tmp);\n        }\n      }\n    "
,{subSampler:{type:"sampler2D",value:1},ruleSampler:{type:"sampler2D",value:1},time:{type:"float",value:1},elapsedTime:{type:"float",value:1},vague:{type:"float",value:1},phase:{type:"float",value:1},phaseMax:{type:"float",value:1}})||this}var c=(
d.prototype.initTrans=function(e,i){return n(this,void 0,void 0,function(){return u(this,function(t){if(this.isRunning&&this.stop(),this.startTick=-1,this.time=e,this.method=i,this.ruleFilePath=null,void 0===this.filters[this.method])throw new Error(
"存在しないmethodです("+this.method+")");return[2,new Promise(function(t){setTimeout(function(){t()},0)})]})})},d.prototype.initUnivTrans=function(s,o,a){return void 0===a&&(a=.25),n(this,void 0,void 0,function(){var e,i,r,n;return u(this,function(t){switch(
t.label){case 0:return this.initTrans(s,"univ"),this.ruleFilePath=o,a<0&&(a=0),1<a&&(a=1),this.vague=a,e=this.game.width,i=this.game.height,[4,(r=this).resource.loadImage(o)];case 1:return r.ruleImage=t.sent(),this.ruleSprite=new h.Sprite(h.Texture.from(
this.ruleImage)),this.ruleSprite.width=e,this.ruleSprite.height=i,(n=new h.Sprite(h.Texture.WHITE)).width=e,n.height=i,this.ruleSprite.mask=n,[2]}})})},Object.defineProperty(d.prototype,"isRunning",{get:function(){return"run"===this.status},enumerable:!0,
configurable:!0}),d.prototype.stop=function(){"run"===this.status&&(this.status="stop",this.ruleFilePath=null,this.game.foreRenderer.delOtherRenderer(),this.game.backRenderer.delOtherRenderer(),this.game.resetPrimaryLayersRenderer(),
this.game.foreRenderer.container.filters=[],this.game.backRenderer.container.filters=[],this.game.onCompleteTrans())},d.prototype.start=function(){this.status="run",this.game.flipPrimaryLayers(),this.filter=this.filters[this.method],
null===this.filter?this.game.foreRenderer.setOtherRenderer(this.game.backRenderer):this.game.foreRenderer.container.filters=[this.filter]},d.prototype.draw=function(t){-1===this.startTick&&(this.startTick=t);var e=t-this.startTick;if(e>this.time
)return this.stop(),void this.game.foreRenderer.draw(t);switch(this.game.backRenderer.draw(t),this.game.backRenderer.texture.update(),this.method){case"scroll-to-right":this.drawScrollHorizontal(t,e,"right");break;case"scroll-to-left":
this.drawScrollHorizontal(t,e,"left");break;case"scroll-to-top":this.drawScrollVertical(t,e,"top");break;case"scroll-to-bottom":this.drawScrollVertical(t,e,"bottom");break;case"univ":this.drawUniv(t,e);break;case"crossfade":default:this.drawCrossFade(t,e)
}this.game.foreRenderer.draw(t)},d.prototype.drawScrollHorizontal=function(t,e,i){var r=this.game.width,n=r*(e/this.time);n<0&&(n=0),r<n&&(n=r),this.game.backRenderer.sprite.x="right"===i?n-r:r-n},d.prototype.drawScrollVertical=function(t,e,i){
var r=this.game.height,n=r*(e/this.time);n<0&&(n=0),r<n&&(n=r),this.game.backRenderer.sprite.y="bottom"===i?n-r:r-n},d.prototype.drawCrossFade=function(t,e){var i=e/this.time*1;i<0&&(i=0),1<i&&(i=1);var r=this.filter.uniforms;r.backAlpha=1-i,r.foreAlpha=i
,r.subSampler=this.game.backRenderer.texture},d.prototype.drawUniv=function(t,e){var i=this.filter.uniforms;i.subSampler=this.game.backRenderer.texture,i.ruleSampler=this.ruleSprite.texture,i.table=this.table,i.time=this.time,i.elapsedTime=e,
i.vague=this.vague,i.phaseMax=1+this.vague,i.phase=e*i.phaseMax/this.time-this.vague},d);function d(t,e){this.startTick=-1,this.time=1e3,this.method="crossfade",this.ruleFilePath=null,this.ruleImage=null,this.ruleSprite=null,this.vague=.25,this.table=[],
this.status="stop",this.game=t,this.resource=e,this.filters={"scroll-to-right":null,"scroll-to-left":null,"scroll-to-top":null,"scroll-to-bottom":null,univ:new a,crossfade:new i},this.filter=this.filters.crossfade}p.TransManager=c}).call(this,e(5))},
function(t,e,i){"use strict";var s=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t
){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},o=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},
"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return
)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue
;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}
o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var r,n,a=i(7);(n=r=e.SoundState||(
e.SoundState={}))[n.Stop=0]="Stop",n[n.Play=1]="Play",n[n.Pause=2]="Pause",n[n.Fade=3]="Fade",n[n.Fadein=4]="Fadein",n[n.Fadeout=5]="Fadeout";var h=(u.prototype.loadSound=function(i){return s(this,void 0,void 0,function(){var e;return o(this,function(t){
switch(t.label){case 0:a.Logger.debug("SoundBuffer.loadSound call: ",i),this.filePath=i,t.label=1;case 1:return t.trys.push([1,3,,4]),this.stop("loadSound"),[4,(e=this).resource.loadSoundHowler(i)];case 2:return e.howl=t.sent(),a.Logger.debug(
"SoundBuffer.loadSound success: ",this.howl),this.setHowlerEvent(),this.setHowlerOptions(),[3,4];case 3:return t.sent(),a.Logger.debug("SoundBuffer.loadSound fail: ",i),[3,4];case 4:return[2]}})})},Object.defineProperty(u.prototype,"hasSound",{
get:function(){return null!=this.howl},enumerable:!0,configurable:!0}),u.prototype.freeSound=function(){this.stop("freeSound"),(this.filePath=null)!=this.howl&&(this.howl.unload(),this.howl=null)},u.prototype.clearOnStop=function(){this.onStopJump=!1,
this.onStopCall=!1,this.onStopExp=null,this.onStopFile=null,this.onStopLabel=null},u.prototype.setHowlerEvent=function(){var t=this;null!=this.howl&&(this.howl.off("playerror").on("playerror",function(){throw new Error("音声の再生に失敗しました("+t.filePath+")")}),
this.howl.off("end").on("end",function(){t.loop||t.stop("onEndEvent")}),this.howl.off("fade").on("fade",function(){t.onFade()}))},u.prototype.setHowlerOptions=function(){null!=this.howl&&(this.volume=this.volume,this.gvolume=this.gvolume,
this.seek=this.seek,this.loop=this.loop)},Object.defineProperty(u.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"volume",{get:function(){return this._volume},set:function(t){
this._volume=t,null!=this.howl&&this.howl.volume(this.volume*this.gvolume)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"gvolume",{get:function(){return this._gvolume},set:function(t){this._gvolume=t,
null!=this.howl&&this.howl.volume(this.volume*this.gvolume)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"seek",{get:function(){return this._seek},set:function(t){null!=this.howl&&this.howl.seek(t)},enumerable:!0,configurable:!0}),
Object.defineProperty(u.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,null!=this.howl&&this.howl.loop(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"playing",{get:function(){
return this._state===r.Play||this._state===r.Fade||this._state===r.Fadein||this._state===r.Fadeout},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"fading",{get:function(){
return this._state===r.Fade||this._state===r.Fadein||this._state===r.Fadeout},enumerable:!0,configurable:!0}),u.prototype.play=function(){if(null==this.howl)throw new Error("音声が読み込まれていません");this.playing&&this.stop("play"),this.fading&&this.endFade(),
this.setHowlerEvent(),this.setHowlerOptions(),this.howl.play(),this._state=r.Play},u.prototype.stop=function(t){void 0===t&&(t="unknown"),null!=this.howl&&(this.howl.stop(),this.howl.off("fade"),this.howl.off("play"),this.howl.off("end")),
this._state===r.Fade&&(this.volume=this.fadeTargetVolume),this._state=r.Stop,null!==this.onStopExp&&this.resource.evalJs(this.onStopExp),this.callback.onStop({bufferNum:this.bufferNum,stopBy:t,jump:this.onStopJump,call:this.onStopCall,
file:this.onStopFile,label:this.onStopLabel}),this.clearOnStop()},u.prototype.pause=function(){if(null==this.howl)throw new Error("音声が読み込まれていません");this.setHowlerEvent(),this.howl.pause(),this._state=r.Pause},u.prototype.fade=function(t,e,i){if(
null==this.howl)throw new Error("音声が読み込まれていません");this.fadeStartVolume=this.volume,this.fadeTargetVolume=t,this.fadeTime=e,this.stopAfterFade=i,this.setHowlerEvent(),this.setHowlerOptions(),this.howl.fade(this.fadeStartVolume*this.gvolume,
this.fadeTargetVolume*this.gvolume,e),this._state=r.Fade},u.prototype.fadein=function(t,e){var i=this;if(null==this.howl)throw new Error("音声が読み込まれていません");this.stop("fadein"),this.fadeStartVolume=0,this.fadeTargetVolume=t,this.fadeTime=e,
this.stopAfterFade=!1,this.howl.once("play",function(){i.setHowlerEvent(),null!=i.howl&&i.howl.fade(i.fadeStartVolume*i.gvolume,i.fadeTargetVolume*i.gvolume,e)}),this.volume=this.fadeStartVolume,this.play(),this._state=r.Fadein},
u.prototype.fadeout=function(t,e){if(null==this.howl)throw new Error("音声が読み込まれていません");this.fadeStartVolume=this.volume,this.fadeTargetVolume=0,this.fadeTime=t,this.stopAfterFade=e,this.setHowlerEvent(),this.howl.fade(this.fadeStartVolume*this.gvolume,
this.fadeTargetVolume*this.gvolume,t),this._state=r.Fadein},u.prototype.endFade=function(){this.fading&&(this._volume=this.fadeTargetVolume,this.stopAfterFade?this.stop("endFade"):this._state=r.Play)},u.prototype.onFade=function(){this.fading&&(
this.endFade(),this.callback.onFadeComplete(this.bufferNum))},u.prototype.store=function(t){var e={},i=this;return u.soundBufferStoreParams.forEach(function(t){e[t]=i[t]}),e},u.prototype.restore=function(r,n){return s(this,void 0,void 0,function(){var e,i
;return o(this,function(t){switch(t.label){case 0:return e=this,i=["hasSound","state"],u.soundBufferStoreParams.filter(function(t){return-1===i.indexOf(t)}).forEach(function(t){e[t]=r[t]}),this.stop("restore"),r.hasSound?[4,this.loadSound(r.filePath)]:[3,
2];case 1:return t.sent(),this.restoreAfterLoad(r,n),[3,3];case 2:this.restoreAfterLoad(r,n),t.label=3;case 3:return[2]}})})},u.prototype.restoreAfterLoad=function(t,e){t.state===r.Play&&t.loop&&this.play(),t.state===r.Fade&&!t.stopAfterFade&&t.loop&&(
this.volume=t.fadeTargetVolume,this.play()),t.state===r.Fadein&&t.loop&&this.fadein(t.fadeTargetVolume,t.fadeTime)},u.prototype.storeSystem=function(){return{gvolume:this.gvolume}},u.prototype.restoreSystem=function(t){null!=t&&null!=t.gvolume&&(
this.gvolume=t.gvolume)},u.soundBufferStoreParams=["hasSound","filePath","bufferNum","state","seek","loop","volume","fadeStartVolume","fadeTargetVolume","fadeTime","stopAfterFade","jump","call","onStopExp","onStopFile","onStopLabel"],u);function u(t,e,i){
this.howl=null,this.filePath=null,this._state=r.Stop,this._volume=1,this._gvolume=1,this._seek=0,this._loop=!1,this.fadeStartVolume=0,this.fadeTargetVolume=0,this.fadeTime=0,this.stopAfterFade=!1,this.onStopJump=!1,this.onStopCall=!1,this.onStopExp=null,
this.onStopFile=null,this.onStopLabel=null,this.resource=t,this.bufferNum=e,this.callback=i}e.SoundBuffer=h},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]
}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),
s=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((
h=h.apply(s,o||[])).next())})},o=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(
t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(
o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys
).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop()
;continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t
)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var h,u=i(11),l=i(14),c=a(i(9)),d=i(12),p=(h=d.Button,n(f,h),f.prototype.initHistoryButton=function(e){return s(this,void 0,void 0,
function(){return o(this,function(t){switch(t.label){case 0:return[4,this.loadImage(e)];case 1:return t.sent(),this.initButton(),this.width=Math.floor(this.imageWidth/3),this.setButtonStatus("normal"),[2]}})})},f.prototype.clearHistoryButton=function(){
this.clearButton(),this.freeImage()},f.prototype.setButtonStatus=function(t){switch(h.prototype.setButtonStatus.call(this,t),t){case"normal":case"disabled":this.imageX=0;break;case"over":this.imageX=-Math.floor(this.imageWidth/3);break;case"on":
this.imageX=-Math.floor(this.imageWidth/3*2)}},f.prototype.setCallbacks=function(t){this.callbacks=t},f.prototype.onMouseDown=function(t){h.prototype.onMouseDown.call(this,t),this.isInsideEvent(t)&&this.callbacks.onMouseDown&&this.callbacks.onMouseDown(t)
},f.prototype.onMouseUp=function(t){h.prototype.onMouseUp.call(this,t),this.isInsideEvent(t)&&this.callbacks.onMouseUp&&this.callbacks.onMouseUp(t)},f);function f(){return null!==h&&h.apply(this,arguments)||this}e.HistoryButton=p;var m,_=(m=u.BaseLayer,n(
y,m),y.prototype.initButton=function(t,e){this.bgColors=t,this.bgAlphas=e,this.setStatus("normal"),this.visible=!0},y.prototype.setStatus=function(t){var e={normal:0,over:1,on:2}[this.status=t];this.setBackgroundColor(this.bgColors[e],this.bgAlphas[e]),
this.resource.getForeCanvasElm().style.cursor=this.resource.cursor[t]},y.prototype.onMouseEnter=function(t){m.prototype.onMouseEnter.call(this,t),this.setStatus("over"),this.mouseEnter(this)},y.prototype.onMouseLeave=function(t){
m.prototype.onMouseLeave.call(this,t),this.setStatus("normal"),this.mouseLeave(this)},y.prototype.onMouseMove=function(t){m.prototype.onMouseMove.call(this,t),this.isInsideEvent(t)&&this.mouseMove(this)},y.prototype.onMouseDown=function(t){
m.prototype.onMouseDown.call(this,t),this.isInsideEvent(t)&&(this.setStatus("on"),this.mouseDown(this))},y.prototype.onMouseUp=function(t){if(m.prototype.onMouseUp.call(this,t),this.isInsideEvent(t)){if("on"!==this.status)return;if(!t.isLeft)return
;this.mouseUp(this),this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.normal}},y);function y(){var t=null!==m&&m.apply(this,arguments)||this;return t.bgColors=[16711680,65280,255],t.bgAlphas=[1,1,1],t.status="normal",
t.mouseEnter=function(){},t.mouseLeave=function(){},t.mouseMove=function(){},t.mouseDown=function(){},t.mouseUp=function(){},t}var v,g=(n(x,v=_),x.prototype.onMouseDown=function(t){v.prototype.onMouseDown.call(this,t),this.isInsideEvent(t)&&(this.down=!0,
this.downX=t.y,this.downY=t.y)},x.prototype.onMouseMove=function(t){v.prototype.onMouseMove.call(this,t)},x.prototype.onMouseUp=function(t){v.prototype.onMouseUp.call(this,t),t.isLeft&&(this.down=!1)},x);function x(){var t=null!==v&&v.apply(this,arguments
)||this;return t.down=!1,t.downX=0,t.downY=0,t}var b,T=(b=u.BaseLayer,n(E,b),E.prototype.initScrollBar=function(t,e,i,r){this.minHeight=r,this.visible=!0,this.applyConfig(t),this.bar.initButton(e,i),this.bar.x=0,this.bar.y=0,this.bar.width=this.width,
this.bar.height=this.width,this.addChild(this.bar)},E.prototype.setValues=function(t,e,i,r){if(i<=r)this.bar.visible=!1;else{var n,s=Math.floor(this.height*r/i);s<this.minHeight&&(s=this.minHeight),s>this.height&&(s=this.height),
n=0===t?0:t===e?this.height-s:Math.floor((this.height-s)*(t/e)),this.bar.height=s,this.bar.y=n,this.bar.visible=!0}},E.prototype.onMouseEnter=function(t){b.prototype.onMouseEnter.call(this,t),this.resource.getForeCanvasElm(
).style.cursor=this.resource.cursor.over,t.stopPropagation()},E.prototype.onMouseLeave=function(t){b.prototype.onMouseLeave.call(this,t),this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.normal,t.stopPropagation()},
E.prototype.onMouseDown=function(t){b.prototype.onMouseDown.call(this,t),t.stopPropagation()},E.prototype.onMouseMove=function(t){b.prototype.onMouseMove.call(this,t),(this.bar.down||this.isInsideEvent(t))&&(this.resource.getForeCanvasElm(
).style.cursor=this.resource.cursor.over),this.bar.down&&(this.setBarY(t.y-this.bar.downY),this.onChangeCallback(this)),t.stopPropagation()},E.prototype.onMouseUp=function(t){b.prototype.onMouseUp.call(this,t),t.isLeft&&((
this.bar.down||this.isInsideEvent(t))&&(this.setBarY(t.y-this.bar.height/2),this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.normal,this.onChangeCallback(this),this.bar.onMouseUp(new l.PonMouseEvent(0,0,0))),t.stopPropagation())},
E.prototype.setBarY=function(t){var e=this.height-this.bar.height;t<0&&(t=0),e<t&&(t=e),this.bar.y=t},E.prototype.getBarPoint=function(){var t=this.bar.y,e=this.height-this.bar.height;return 0===t?0:t===e?1:t/e},Object.defineProperty(E.prototype,
"dragging",{get:function(){return this.bar.down},enumerable:!0,configurable:!0}),E);function E(t,e,i){var r=b.call(this,t,e,i)||this;return r.minHeight=30,r.onChangeCallback=function(){},r.bar=new g("ScrollBarButton",e,i),r}var w,A=(w=u.BaseLayer,n(S,w),
Object.defineProperty(S.prototype,"currentLine",{get:function(){return this.lines[this.lines.length-1]},enumerable:!0,configurable:!0}),S.prototype.init=function(t){this.width=t.width,this.height=t.height,this.textCanvas.autoReturn=!1,
null!=t.history&&t.history.text&&this.applyConfig(t.history.text),this.point=0,this.clear()},S.prototype.clear=function(){this.lines=[[]],this.indentPoints=[-1],this.clearIndentPoints=[-1]},Object.defineProperty(S.prototype,"historyText",{get:function(){
var e="";return this.lines.forEach(function(t){e+=t.join("")+"\n"}),e},enumerable:!0,configurable:!0}),S.prototype.add=function(t){this.currentLine.push(t)},S.prototype.textReturn=function(){this.lines.push([]),this.indentPoints.push(-1),
this.clearIndentPoints.push(-1),this.lines.length>this.maxLinesCount&&this.lines.shift()},S.prototype.setHistoryIndentPoint=function(){this.indentPoints[this.indentPoints.length-1]=this.currentLine.length-1},S.prototype.clearHistoryIndentPoint=function(){
this.clearIndentPoints[this.clearIndentPoints.length-1]=this.currentLine.length-1},S.prototype.scrollUp=function(t){void 0===t&&(t=1),this.point-=t,this.fixPoint()},S.prototype.scrollDown=function(t){void 0===t&&(t=1),this.point+=t,this.fixPoint()},
S.prototype.scrollUpPage=function(){this.scrollUp(this.screenLineCount-this.scrollOffLines)},S.prototype.scrollDownPage=function(){this.scrollDown(this.screenLineCount-this.scrollOffLines)},S.prototype.goTo=function(t){this.point=t,this.fixPoint()},
S.prototype.goToEnd=function(){this.point=this.maxPoint},S.prototype.fixPoint=function(){this.point<0&&(this.point=0),this.point>this.maxPoint&&(this.point=this.maxPoint)},S.prototype.redraw=function(){var n=this;this.clearText();for(
var t=this.point+this.screenLineCount,e=function(t){var i=s.indentPoints[t],r=s.clearIndentPoints[t];s.lines[t].forEach(function(t,e){n.addChar(t),e===i&&n.setIndentPoint(),e===r&&n.clearIndentPoint()}),s.addTextReturn()},s=this,
i=this.point;i<t&&i<this.lines.length;i++)e(i)},S.prototype.redrawLazy=function(){this.lazyRedrawFlag=!0},S.prototype.update=function(t){w.prototype.update.call(this,t),this.lazyRedrawFlag&&(this.redraw(),this.lazyRedrawFlag=!1)},Object.defineProperty(
S.prototype,"screenLineCount",{get:function(){var t=this.textCanvas.lineHeight+this.textCanvas.linePitch,e=this.height-this.textCanvas.marginTop-this.textCanvas.marginBottom+this.textCanvas.linePitch;return Math.floor(e/t)},enumerable:!0,configurable:!0})
,Object.defineProperty(S.prototype,"maxPoint",{get:function(){var t=this.lines.length-1-this.screenLineCount;return t<0?0:t},enumerable:!0,configurable:!0}),Object.defineProperty(S.prototype,"currentPoint",{get:function(){return this.point},enumerable:!0,
configurable:!0}),Object.defineProperty(S.prototype,"linesCount",{get:function(){return this.lines.length},enumerable:!0,configurable:!0}),S);function S(t,e,i){var r=w.call(this,t,e,i)||this;return r.lines=[[]],r.maxLinesCount=1e4,r.indentPoints=[-1],
r.clearIndentPoints=[-1],r.scrollOffLines=3,r.point=0,r.lazyRedrawFlag=!1,r.visible=!0,r}var I,C=(I=u.BaseLayer,n(O,I),O.prototype.init=function(e){return void 0===e&&(e={}),s(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:
return null==e.history&&(e.history={}),null==e.history.text&&(e.history.text={}),null==e.history.upButton&&(e.history.upButton={}),null==e.history.downButton&&(e.history.downButton={}),null==e.history.scrollBar&&(e.history.scrollBar={}),
null==e.history.closeButton&&(e.history.closeButton={}),this.x=0,this.y=0,this.width=e.width,this.height=e.height,this.wheelScrollCount=e.history.wheelScrollCount||3,null==e.history.backgroundImage?[3,2]:[4,this.loadImage(e.history.backgroundImage)]
;case 1:t.sent(),t.label=2;case 2:return this.textLayer.init(e),this.textLayer.visible=!0,this.addChild(this.textLayer),this.initScrollButtons(e),this.initScrollBar(e),this.initCloseButton(e),[2]}})})},O.prototype.initScrollButtons=function(t){function e(
t,e){null==e.bgColors&&(e.bgColors=[4359924,4359924,4359924]),null==e.bgAlphas&&(e.bgAlphas=[.7,.8,.9]),t.applyConfig(e),t.visible=!0,t.initHistoryButton(e.imageFile),i.addChild(t)}var i=this;e(this.upButton,t.history.upButton),e(this.downButton,
t.history.downButton),this.upButton.setCallbacks({onMouseUp:function(){i.scrollUpPage()}}),this.downButton.setCallbacks({onMouseUp:function(){i.scrollDownPage()}})},O.prototype.initScrollBar=function(t){var e=this,i=c.objClone(t.history.scrollBar)
;i=c.objExtend({x:t.width-32-20,y:52,width:32,height:t.height-104,backgroundColor:4359924,backgroundAlpha:.1,bgColors:[4359924,4359924,4359924],bgAlphas:[.4,.5,.6],minHeight:16},i);var r=this.scrollBar;r.initScrollBar(i,i.bgColors,i.bgAlphas,i.minHeight),
r.onChangeCallback=function(){var t=Math.floor(e.textLayer.maxPoint*r.getBarPoint());e.textLayer.currentPoint!==t&&(e.textLayer.goTo(t),e.textLayer.redrawLazy())},this.addChild(r)},O.prototype.initCloseButton=function(t){var e=this,i=c.objClone(
t.history.closeButton);i=c.objExtend({x:t.width-40-30,y:15},i),this.closeButton.applyConfig(i),this.closeButton.initHistoryButton(i.imageFile),this.closeButton.setCallbacks({onMouseUp:function(){e.hide(),e.resource.getForeCanvasElm(
).style.cursor=e.resource.cursor.normal}}),this.closeButton.visible=!0,this.addChild(this.closeButton)},O.prototype.addHistoryChar=function(t){this.enableOutput&&(this.textLayer.add(t),this.visible&&(this.textLayer.redraw(),this.resetScrollBar()))},
O.prototype.addHistoryTextReturn=function(){this.enableOutput&&(this.textLayer.textReturn(),this.visible&&(this.textLayer.redraw(),this.resetScrollBar()))},O.prototype.clearHistory=function(){this.textLayer.clear()},O.prototype.show=function(){
this.textLayer.redraw(),this.resetScrollBar(),this.visible=!0},O.prototype.hide=function(){this.visible=!1},O.prototype.scrollUp=function(t){void 0===t&&(t=1),this.textLayer.scrollUp(t),this.textLayer.redraw(),this.resetScrollBar()},
O.prototype.scrollUpPage=function(){this.textLayer.scrollUpPage(),this.textLayer.redraw(),this.resetScrollBar()},O.prototype.scrollDown=function(t){void 0===t&&(t=1),this.textLayer.scrollDown(t),this.textLayer.redraw(),this.resetScrollBar()},
O.prototype.scrollDownPage=function(){this.textLayer.scrollDownPage(),this.textLayer.redraw(),this.resetScrollBar()},O.prototype.resetScrollBar=function(){this.scrollBar.setValues(this.textLayer.currentPoint,this.textLayer.maxPoint,
this.textLayer.linesCount,this.textLayer.screenLineCount)},O.prototype.setHistoryIndentPoint=function(){this.textLayer.setHistoryIndentPoint()},O.prototype.clearHistoryIndentPoint=function(){this.textLayer.clearHistoryIndentPoint()},
O.prototype.goToEnd=function(){this.textLayer.goToEnd()},O.prototype.onMouseEnter=function(t){I.prototype.onMouseEnter.call(this,t),t.stopPropagation()},O.prototype.onMouseLeave=function(t){I.prototype.onMouseLeave.call(this,t),t.stopPropagation()},
O.prototype.onMouseMove=function(t){I.prototype.onMouseMove.call(this,t),t.stopPropagation();var e=this.scrollBar;if(e.dragging){var i=new l.PonMouseEvent(t.x-e.x,t.y-e.y,t.button);this.scrollBar.onMouseMove(i)}},O.prototype.onMouseDown=function(t){
I.prototype.onMouseDown.call(this,t),t.stopPropagation()},O.prototype.onMouseUp=function(t){if(I.prototype.onMouseUp.call(this,t),t.stopPropagation(),t.isLeft){var e=this.scrollBar;if(e.dragging){var i=new l.PonMouseEvent(t.x-e.x,t.y-e.y,t.button)
;this.scrollBar.onMouseUp(i),this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.normal}}t.isRight&&this.hide()},O.prototype.onMouseWheel=function(t){return t.isUp?this.scrollUp(this.wheelScrollCount):this.scrollDown(this.wheelScrollCount),
!1},O.prototype.store=function(t){return{enableOutput:this.enableOutput}},O.prototype.restore=function(e,t,i){return s(this,void 0,void 0,function(){return o(this,function(t){return null!=e.enableOutput&&(this.enableOutput=e.enableOutput),[2]})})},O)
;function O(t,e,i){var r=I.call(this,t,e,i)||this;return r.wheelScrollCount=3,r.enableOutput=!0,r.textLayer=new A("HistoryText",e,i),r.upButton=new p("ScrollUpButton",e,i),r.downButton=new p("ScrollDownButton",e,i),r.scrollBar=new T("ScrollBar",e,i),
r.closeButton=new p("CloseButton",e,i),r}e.HistoryLayer=C},function(t,e,i){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i])
;return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var n,s,o,a,h=r(i(5)),u=i(9);h.TextMetrics.BASELINE_SYMBOL+="ぽン甘｜",(s=n=e.SpriteType||(e.SpriteType={}))[s.Unknown=0]="Unknown",s[s.Image=1]="Image",s[s.Color=2]="Color",
s[s.Text=3]="Text",s[s.Canvas=4]="Canvas",(a=o=o||{})[a.Stop=0]="Stop",a[a.Run=1]="Run";var l=(Object.defineProperty(c.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,null!=this.pixiSprite&&(this.pixiSprite.x=t+this._offsetX)},
enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,null!=this.pixiSprite&&(this.pixiSprite.y=t+this._offsetY)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,
"width",{get:function(){return this._width},set:function(t){this._width=t,null!=this.pixiSprite&&(this.pixiSprite.width=t)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"height",{get:function(){return this._height},set:function(t){
this._height=t,null!=this.pixiSprite&&(this.pixiSprite.height=t)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){this._scaleX=t,null!=this.pixiSprite&&(
this.pixiSprite.scale.x=t,this._width=this.pixiSprite.width)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){this._scaleY=t,null!=this.pixiSprite&&(this.pixiSprite.scale.y=t,
this._height=this.pixiSprite.height)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,null!=this.pixiSprite&&(this.pixiSprite.visible=t)},enumerable:!0,
configurable:!0}),Object.defineProperty(c.prototype,"text",{get:function(){return null!==this.pixiSprite&&null!==this.textStyle?this.pixiSprite.text:null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"textStyle",{get:function(){
return this._textStyle},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"textPitch",{get:function(){return this._textPitch},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"textWidth",{get:function(){
return this._width+this._textPitch},enumerable:!0,configurable:!0}),c.prototype.destroy=function(){this.clear()},c.prototype.clear=function(){try{null!=this.pixiSprite&&(this.callbacks.pixiContainerRemoveChild(this.pixiSprite),this.pixiSprite.destroy()),
this.pixiSprite=null,this.type=n.Unknown,this.inEffectTypes=[],this.inEffectTime=100,this.inEffectStartTick=-1}catch(t){throw console.error(t),t}},c.prototype.createText=function(t,e,i){this.clear(),this._textStyle=e.clone(),this._textPitch=i,
this.pixiSprite=new h.Text(t,this._textStyle),this.pixiSprite.x=this.x,this.pixiSprite.y=this.y,this.pixiSprite.anchor.set(0),this.pixiSprite.scale.x=this.scaleX,this.pixiSprite.scale.y=this.scaleY,this._width=this.pixiSprite.width,
this._height=this.pixiSprite.height,this.callbacks.pixiContainerAddChild(this.pixiSprite),this.type=n.Text},c.prototype.fillColor=function(t,e){this.clear(),this.pixiSprite=new h.Graphics,this.pixiSprite.x=this.x,this.pixiSprite.y=this.y,
this.pixiSprite.width=this.width,this.pixiSprite.height=this.height,this.pixiSprite.lineStyle(0),this.pixiSprite.beginFill(t,e),this.pixiSprite.drawRect(0,0,this.width,this.height),this.pixiSprite.scale.x=this.scaleX,this.pixiSprite.scale.y=this.scaleY,
this.callbacks.pixiContainerAddChild(this.pixiSprite),this.type=n.Color},c.prototype.clearColor=function(){null!=this.pixiSprite&&this.pixiSprite instanceof h.Graphics&&(this.pixiSprite.clear(),this.type=n.Unknown)},c.prototype.setImage=function(t){
this.clear();var e=h.Texture.from(t);this.pixiSprite=new h.Sprite(e),this.pixiSprite.x=this.x,this.pixiSprite.y=this.y,this.pixiSprite.anchor.set(0),this.pixiSprite.scale.x=this.scaleX,this.pixiSprite.scale.y=this.scaleY,this._width=this.pixiSprite.width,
this._height=this.pixiSprite.height,this.callbacks.pixiContainerAddChild(this.pixiSprite),this.type=n.Image},c.prototype.setCanvas=function(t){this.clear();var e=h.Texture.from(t);this.pixiSprite=new h.Sprite(e),this.pixiSprite.x=this.x,
this.pixiSprite.y=this.y,this.pixiSprite.anchor.set(0),this.pixiSprite.scale.x=this.scaleX,this.pixiSprite.scale.y=this.scaleY,this._width=this.pixiSprite.width,this._height=this.pixiSprite.height,this.callbacks.pixiContainerAddChild(this.pixiSprite),
this.type=n.Canvas},c.prototype.copyTextFrom=function(t){if(t.type===n.Text){var e=t.pixiSprite;this.createText(e.text,t.textStyle,t.textPitch),this.x=t.x,this.y=t.y,this.copyEffectStateFrom(t)}},c.prototype.copyEffectStateFrom=function(t){
this.inEffectTypes=t.inEffectTypes,this.inEffectOptions=t.inEffectOptions,this.inEffectEase=t.inEffectEase,this.inEffectState=t.inEffectState,this.inEffectStartTick=t.inEffectStartTick,this.inEffectTime=t.inEffectTime},c.prototype.initInEffect=function(t,
e,i,r){this.inEffectTypes=t,this.inEffectEase=i,this.inEffectOptions=r,this.inEffectState=o.Run,this.inEffectStartTick=-1,this.inEffectTime=e,t.includes("move")&&(null==r&&(r={}),null==r.offsetx&&(r.offsetx=0),null==r.offsety&&(r.offsety=0))},
c.prototype.beforeDraw=function(t){if(null!=this.pixiSprite&&(this.type===n.Canvas&&this.pixiSprite.texture.update(),this.inEffectState===o.Run)){-1===this.inEffectStartTick&&(this.inEffectStartTick=t);var e=t-this.inEffectStartTick,i=e/this.inEffectTime
;switch(i<0&&(i=0),1<i&&(i=1),this.inEffectEase){case"in":i=u.Ease.in(i);break;case"out":i=u.Ease.out(i);break;case"both":i=u.Ease.inOut(i)}this.inEffectTypes.includes("alpha")&&this.InEffectAlpha(this.pixiSprite,e,i),this.inEffectTypes.includes("move"
)&&this.InEffectMove(this.pixiSprite,e,i),e>=this.inEffectTime&&(this.inEffectState=o.Stop)}},c.prototype.InEffectAlpha=function(t,e,i){t.alpha=i},c.prototype.InEffectMove=function(t,e,i){this._offsetX=Math.floor(this.inEffectOptions.offsetx*(1-i)),
this._offsetY=Math.floor(this.inEffectOptions.offsety*(1-i)),t.x=this._x+this._offsetX,t.y=this._y+this._offsetY},c);function c(t){this._x=0,this._y=0,this._offsetX=0,this._offsetY=0,this._width=32,this._height=32,this._scaleX=1,this._scaleY=1,
this._visible=!0,this._textStyle=null,this._textPitch=0,this.pixiSprite=null,this.type=n.Unknown,this.inEffectTypes=[],this.inEffectOptions={},this.inEffectEase="none",this.inEffectState=o.Stop,this.inEffectTime=100,this.inEffectStartTick=-1,
this.callbacks=t}e.PonSprite=l},function(t,e,i){"use strict";var r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}
;Object.defineProperty(e,"__esModule",{value:!0});var n=r(i(5)),s=(Object.defineProperty(o.prototype,"texture",{get:function(){return this.videoTexture},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"sprite",{get:function(){
return this.videoSprite},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"source",{get:function(){return this.videoTexture.baseTexture.resource.source},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{
get:function(){return this.videoSprite.width},set:function(t){this.videoSprite.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.videoSprite.height},set:function(t){this.videoSprite.height=t},
enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"loop",{get:function(){return this.source.loop},set:function(t){this.source.loop=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"volume",{get:function(){
return this.source.volume},set:function(t){this.source.volume=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"playing",{get:function(){return!this.source.ended},enumerable:!0,configurable:!0}),o.prototype.destroy=function(){
this.clear()},o.prototype.clear=function(){this.stop(),this.callbacks.pixiContainerRemoveChild(this.videoSprite),this.videoSprite.destroy(),this.videoTexture.destroy()},o.prototype.play=function(){this.source.play()},o.prototype.stop=function(){
this.source.pause(),this.source.currentTime=0},o.prototype.pause=function(){this.source.pause()},o);function o(t,e){this.callbacks=e,this.videoTexture=t,this.source.preload="auto",this.videoSprite=new n.Sprite(this.videoTexture),this.videoSprite.width=700
,this.videoSprite.height=700,this.callbacks.pixiContainerAddChild(this.videoSprite)}e.PonVideo=s},function(t,e,i){"use strict";var n=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t
)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},s=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0]
)throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError(
"Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{
value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(
6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t]
)}}},r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o,a,h=r(i(5)),u=i(9);(
a=o=o||{})[a.Stop=0]="Stop",a[a.Run=1]="Run";var l=(d.prototype.setColor=function(t){this.color=null==t?["#ffffff"]:"number"==typeof t?[h.utils.hex2string(t)]:"string"==typeof t?[t]:t.map(function(t){return"number"==typeof t?h.utils.hex2string(t):""+t})},
d.prototype.setShadowColor=function(t){this.shadowColor="number"==typeof t?h.utils.hex2string(t):t},d.prototype.setEdgeColor=function(t){this.edgeColor="number"==typeof t?h.utils.hex2string(t):t},Object.defineProperty(d.prototype,"fontFamilyStr",{
get:function(){return this.fontFamily.map(function(t){return'"'+t+'"'}).join(",")},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"font",{get:function(){
return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px "+this.fontFamilyStr},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"shadowColorStr",{get:function(){var t;return"rgba("+255*(
t="string"==typeof this.shadowColor?h.utils.hex2rgb(h.utils.string2hex(this.shadowColor)):h.utils.hex2rgb(this.shadowColor))[0]+","+255*t[1]+","+255*t[2]+","+this.shadowAlpha+")"},enumerable:!0,configurable:!0}),d.prototype.genGradient=function(t,e,i){
for(var r=t.measureText(d.METRICS_STRING),n=e,s=i-r.actualBoundingBoxAscent,o=e,a=i+r.actualBoundingBoxDescent,h=t.createLinearGradient(n,s,o,a),u=this.color.length,l=0;l<u;l++){var c=this.fillGradientStops[l];null==c&&(c=l/(u-1)),h.addColorStop(c,
this.color[l])}return h},d.prototype.getChWidth=function(t,e){return t.font=this.font,t.strokeStyle=this.edgeColor,t.lineWidth=this.edgeWidth,t.fillStyle="#FFFFFF",t.textBaseline=this.textBaseline,t.measureText(e).width},d.prototype.applyStyleTo=function(
t,e,i){t.font=this.font,t.strokeStyle=this.edgeColor,t.lineWidth=this.edgeWidth,t.textBaseline=this.textBaseline,1<this.color.length?(null==this.gradient&&(this.gradient=this.genGradient(t,e,i)),t.fillStyle=this.gradient):t.fillStyle=this.color[0]},
d.prototype.applyShadowTo=function(t){this.shadow?(t.shadowColor=this.shadowColorStr,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowDistance,t.shadowOffsetY=this.shadowDistance):this.clearShadowFrom(t)},d.prototype.clearShadowFrom=function(t){
t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0},d.prototype.checkOptions=function(){this.inEffectTypes.includes("move")&&(null==this.inEffectOptions&&(this.inEffectOptions={}),null==this.inEffectOptions.offsetx&&(
this.inEffectOptions.offsetx=0),null==this.inEffectOptions.offsety&&(this.inEffectOptions.offsety=0))},d.prototype.clone=function(){return Object.assign(new d,this)},d.prototype.resetGradientBuffer=function(){this.gradient=null},
d.prototype.store=function(t){var e={};return Object.assign(e,this.clone()),e},d.prototype.restore=function(e,t,i){return n(this,void 0,void 0,function(){return s(this,function(t){return Object.assign(this,e),[2]})})},d.METRICS_STRING="ぽン甘｜|gq",d)
;function d(){this.fontFamily=["GenShinGothic","monospace"],this.fontSize=24,this.fontWeight="normal",this.fontStyle="normal",this.color=["#ffffff"],this.textBaseline="alphabetic",this.shadow=!1,this.shadowAlpha=1,this.shadowAngle=Math.PI/6,
this.shadowBlur=5,this.shadowColor="#000000",this.shadowDistance=2,this.edgeColor="#000000",this.edgeWidth=0,this.pitch=0,this.fillGradientStops=[],this.fillGradientType="vertical",this.inEffectTypes=[],this.inEffectTime=100,this.inEffectEase="none",
this.inEffectOptions={},this.gradient=null}e.TextStyle=l;var f=(c.prototype.clone=function(t){return Object.assign(new c(t,this.ch,this.style,this.x,this.y),this)},c.prototype.beforeDraw=function(t){if(this.inEffectState!==o.Run)return!1
;-1===this.inEffectStartTick&&(this.inEffectStartTick=t);var e=t-this.inEffectStartTick,i=e/this.style.inEffectTime;switch(i<0&&(i=0),1<i&&(i=1),this.style.inEffectEase){case"in":i=u.Ease.in(i);break;case"out":i=u.Ease.out(i);break;case"both":
i=u.Ease.inOut(i)}return this.style.inEffectTypes.includes("alpha")&&this.InEffectAlpha(e,i),this.style.inEffectTypes.includes("move")&&this.InEffectMove(e,i),e>=this.style.inEffectTime&&(this.inEffectState=o.Stop),!0},c.prototype.InEffectAlpha=function(t
,e){this.alpha=e},c.prototype.InEffectMove=function(t,e){this._offsetX=Math.floor(this.style.inEffectOptions.offsetx*(1-e)),this._offsetY=Math.floor(this.style.inEffectOptions.offsety*(1-e))},c.prototype.draw=function(t,e,i,r){var n=Math.floor(
this.x+this._offsetX+i)+.5,s=Math.floor(this.y+this._offsetY+r)+.5;t.globalAlpha=this.alpha,0<this.style.edgeWidth?(this.style.applyStyleTo(t,n,s),this.style.applyShadowTo(t),t.strokeText(this.ch,n,s),this.style.clearShadowFrom(t)):(
this.style.applyStyleTo(t,n,s),this.style.applyShadowTo(t)),t.fillText(this.ch,n,s)},c);function c(t,e,i,r,n){this.x=0,this.y=0,this.width=0,this.alpha=1,this.inEffectState=o.Stop,this.inEffectStartTick=-1,this._offsetX=0,this._offsetY=0,this.ch=e,
this.style=i.clone(),this.x=r,this.y=n,this.width=i.getChWidth(t,e)+i.pitch,this.style.checkOptions(),this.style.resetGradientBuffer(),null!=this.style.inEffectTypes&&0<this.style.inEffectTypes.length&&(this.inEffectState=o.Run)}e.LayerChar=f;var p=(
Object.defineProperty(m.prototype,"text",{get:function(){return this.chList.map(function(t){return t.ch}).join("")},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"textX",{get:function(){return this._textX},enumerable:!0,configurable:!0
}),Object.defineProperty(m.prototype,"tailChar",{get:function(){return this.chList[this.chList.length-1].ch},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"length",{get:function(){return this.chList.length},enumerable:!0,
configurable:!0}),Object.defineProperty(m.prototype,"width",{get:function(){if(0===this.chList.length)return 0;var e=0;return this.chList.forEach(function(t){e+=t.width}),e-=this.chList[this.chList.length-1].style.pitch},enumerable:!0,configurable:!0}),
m.prototype.forEach=function(t){this.chList.forEach(t)},m.prototype.destroy=function(){this.clear()},m.prototype.clear=function(){this.chList.splice(0,this.chList.length),this.rubyList.splice(0,this.rubyList.length),this.lineHeight=0,this.rubyText="",
this.rubyFontSize=10,this.rubyOffset=2,this.rubyPitch=2},m.prototype.addChar=function(t,e,i,r){var n=this._textX,s=new f(t,e,i,n,r);this._textX+=s.width,this.chList.push(s),""!==this.rubyText&&(this.addRubyText(t,s,i),this.rubyText="")},
m.prototype.addRubyText=function(t,e,i){var r=this,n=i.clone();n.fontSize=this.rubyFontSize;for(var s=this.rubyText,o=this.rubyPitch,a=e.x+e.width/2,h=[],u=0,l=0;l<s.length;l++){var c=new f(t,s.charAt(l),n,0,0);h.push(c),u+=c.width}u-=o
;var d=-this.rubyOffset,p=a-u/2;h.forEach(function(t){t.y=d,t.x=p,p+=t.width,r.rubyList.push(t)})},m.prototype.reserveRubyText=function(t,e,i,r){this.rubyText=t,this.rubyFontSize=e,this.rubyOffset=i,this.rubyPitch=r},m.prototype.getCh=function(t){
return this.chList[t]},m.prototype.getTailCh=function(){return this.chList[this.chList.length-1]},m.prototype.backspace=function(){this.chList.splice(this.chList.length-1,1)},m.prototype.beforeDraw=function(e){var i=!1;return this.chList.forEach(function(
t){t.beforeDraw(e)&&(i=!0)}),i},m.prototype.draw=function(e,i){var r=this;this.chList.forEach(function(t){t.draw(e,i,r.x,r.y)}),this.rubyList.forEach(function(t){t.draw(e,i,r.x,r.y)})},m.prototype.copyTo=function(e,i){i.clear();var r=this,n=i
;m.storeParams.forEach(function(t){return n[t]=r[t]}),this.chList.forEach(function(t){i.chList.push(t.clone(e))}),this.rubyList.forEach(function(t){i.rubyList.push(t.clone(e))})},m.storeParams=["x","y","lineHeight","_textX","rubyText","rubyFontSize",
"rubyOffset","rubyPitch"],m);function m(){this.x=0,this.y=0,this.lineHeight=0,this.chList=[],this.rubyList=[],this._textX=0,this.rubyText="",this.rubyFontSize=10,this.rubyOffset=2,this.rubyPitch=2}e.LayerTextLine=p;var _=(Object.defineProperty(y.prototype
,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t,this.clear()},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t
,this.clear()},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"text",{get:function(){return this.lines.map(function(t){return t.text}).join("\n")},enumerable:!0,configurable:!0}),y.prototype.beforeDraw=function(e){var i=this
;this.lines.forEach(function(t){t.beforeDraw(e)&&(i.updated=!0)})},y.prototype.draw=function(e){var i=this.context;i.clearRect(0,0,this.canvas.width,this.canvas.height),this.lines.forEach(function(t){t.draw(i,e)}),this.sprite.texture.update(),
this.updated=!1},Object.defineProperty(y.prototype,"currentLine",{get:function(){return this.lines[this.lines.length-1]},enumerable:!0,configurable:!0}),y.prototype.addText=function(t){if(null!=t&&""!==t)for(var e=0;e<t.length;e++)this.addChar(t.charAt(e)
)},y.prototype.addChar=function(t){if(null!=t&&""!=t){if(1<t.length)return this.addText(t);this.updated=!0;var e=this.currentLine,i=e.getTailCh();e.addChar(this.context,t,this.style,this.lineHeight),this.alignCurrentTextLine()
;var r=this.autoReturn&&this.shouldBeNewTextLine();r&&null!=i&&-1!==y.tailProhibitionChar.indexOf(i.ch)&&(r=!1),r&&-1!==y.headProhibitionChar.indexOf(t)&&(r=!1),r&&(e.backspace(),this.alignCurrentTextLine(),this.addTextReturn(),this.currentLine.addChar(
this.context,t,this.style,this.lineHeight),this.alignCurrentTextLine())}},y.prototype.getNextTextPos=function(t){var e=this.currentLine,i=e.x+e.width,r=0,n=e.y,s=!1;switch(this.align){case"left":this.shouldBeNewTextLine(t)?(r=this.getTextLineBasePoint(),
n=this.currentLine.y+this.lineHeight+this.linePitch,s=!0):(r=i,n=e.y);break;case"center":this.shouldBeNewTextLine(t)?(r=this.getTextLineBasePoint()-t/2,n=this.currentLine.y+this.lineHeight+this.linePitch,s=!0):(r=i+t/2,n=e.y);break;case"right":r=i,n=e.y,
this.shouldBeNewTextLine(t)?(r=this.getTextLineBasePoint()-t,n=this.currentLine.y+this.lineHeight+this.linePitch,s=!0):(r=i,n=e.y)}return{x:r,y:n,newLineFlag:s}},y.prototype.shouldBeNewTextLine=function(t){void 0===t&&(t=0);var e=this.currentLine,i=e.x,
r=e.x+e.width;switch(this.align){case"left":return r+t>this.width-this.marginRight;case"center":return i-t/2<this.marginLeft||r+t/2>this.width-this.marginRight;case"right":return i-t<this.marginLeft}},y.prototype.addTextReturn=function(){
var t=this.currentLine.y;this.lines.push(new p),null!=this.reservedIndentPoint?this.indentPoint=this.reservedIndentPoint:this.reservedIndentClear&&(this.indentPoint=null,this.reservedIndentClear=!1),this.locatePoint=null,this.alignCurrentTextLine(),
this.currentLine.y=t+this.lineHeight+this.linePitch},y.prototype.alignCurrentTextLine=function(){var t=this.currentLine;switch(this.align){case"left":t.x=this.getTextLineBasePoint();break;case"center":t.x=this.getTextLineBasePoint()-t.width/2;break
;case"right":t.x=this.getTextLineBasePoint()-t.width}},y.prototype.getTextLineBasePoint=function(){if(null!=this.locatePoint)return this.locatePoint;switch(this.align){case"left":return null==this.indentPoint?this.marginLeft:this.indentPoint;case"center":
return null==this.indentPoint?(this.width-this.marginLeft-this.marginRight)/2:(this.width-this.indentPoint-this.marginRight)/2;case"right":return null==this.indentPoint?this.width-this.marginRight:this.indentPoint}},y.prototype.setCharLocate=function(t,e
){var i=this.currentLine;this.addTextReturn();var r=this.currentLine;if(null!=t)this.locatePoint=t;else switch(this.align){case"left":this.locatePoint=i.x+i.width;break;case"center":this.locatePoint=i.x+i.width/2;break;case"right":this.locatePoint=i.x}
r.y=null!=e?e:i.y},y.prototype.setIndentPoint=function(){var t=this.currentLine;switch(this.align){case"left":case"center":this.reservedIndentPoint=t.x+t.width;break;case"right":this.reservedIndentPoint=t.x}},y.prototype.clearIndentPoint=function(){
this.reservedIndentPoint=null,this.reservedIndentClear=!0},y.prototype.reserveRubyText=function(t){this.currentLine.reserveRubyText(t,this.rubyFontSize,this.rubyOffset,this.rubyPitch)},y.prototype.clear=function(){this.lines.forEach(function(t){
return t.clear()}),this.lines.splice(0,this.lines.length),this.lines.push(new p),this.locatePoint=null,this.indentPoint=null,this.reservedIndentPoint=null,this.reservedIndentClear=!1,this.currentLine.x=this.getTextLineBasePoint(),
this.currentLine.y=this.marginTop,this.updated=!0},y.prototype.copyTo=function(i){var r=this;i.clear(),i.width=this.width,i.height=this.height,i.style=this.style.clone();var e=this,n=i;y.storeParams.forEach(function(t){return n[t]=e[t]}),i.lines=[],
this.lines.forEach(function(t){var e=new p;t.copyTo(r.context,e),i.lines.push(e)})},y.prototype.store=function(t){var e={},i=this;return y.storeParams.forEach(function(t){return e[t]=i[t]}),e.width=this.width,e.height=this.height,e.style=this.style.store(
t),e},y.prototype.restore=function(i,t,r){return n(this,void 0,void 0,function(){var e;return s(this,function(t){return e=this,y.storeParams.forEach(function(t){return e[t]=i[t]}),r&&this.clear(),this.width!=i.width&&(this.clear(),this.width=i.width),
this.height!=i.height&&(this.clear(),this.height=i.height),[2]})})},y.headProhibitionChar='%),:;]}｡｣ﾞﾟ。，、．：；゛゜ヽヾゝ"ゞ々’”）〕］｝〉》」』】°′″℃￠％‰!.?､･ｧｨｩｪｫｬｭｮｯｰ・？！ーぁぃぅぇぉっゃゅょゎァィゥェォッャュョヮヵヶ',y.tailProhibitionChar="\\$([{｢‘“（〔［｛〈《「『【￥＄￡",y.storeParams=["lineHeight",
"linePitch","marginTop","marginRight","marginBottom","marginLeft","autoReturn","locatePoint","indentPoint","reservedIndentPoint","reservedIndentClear","align","rubyFontSize","rubyOffset","rubyPitch"],y);function y(){this.lines=[],this.updated=!0,
this.style=new l,this.lineHeight=0,this.linePitch=5,this.marginTop=10,this.marginRight=10,this.marginBottom=10,this.marginLeft=10,this.autoReturn=!0,this.locatePoint=null,this.indentPoint=null,this.reservedIndentPoint=null,this.reservedIndentClear=!1,
this.align="left",this.rubyFontSize=10,this.rubyOffset=2,this.rubyPitch=2,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.lineHeight=this.style.fontSize,this.canvas.width=800,this.canvas.height=32,this.clear(),
this.sprite=new h.Sprite(h.Texture.from(this.canvas)),this.sprite.anchor.set(0),this.sprite.x=0,this.sprite.y=0}e.LayerTextCanvas=_},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]
}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),
o=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((
h=h.apply(s,o||[])).next())})},a=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(
t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(
o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys
).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop()
;continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var h,u=i(11),s=i(63),l=(h=s.FilteredLayer,n(c,h),
c.prototype.addChar=function(t){h.prototype.addChar.call(this,t),1===t.length&&this.owner.onAddChar(this,t)},c.prototype.addTextReturn=function(){h.prototype.addTextReturn.call(this),this.owner.onTextReturn(this)},c.prototype.loadChildImage=function(i,r,n
,s){return o(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return e=new u.BaseLayer("ChildImage (filePath)",this.resource,this.owner),this.addChild(e),this.childImages.push(e),e.x=r,e.y=n,[4,e.loadImage(i)];case 1:
return t.sent(),e.alpha=s,e.visible=!0,[2]}})})},c.prototype.freeChildImages=function(){var e=this;this.childImages.forEach(function(t){t.freeImage(),t.destroy(),e.deleteChildLayer(t)}),this.childImages=[]},c.prototype.freeImage=function(){
h.prototype.freeImage.call(this)},c.prototype.storeVisible=function(){this.visibleBuffer=this.visible},c.prototype.restoreVisible=function(){this.visible=this.visibleBuffer},c.prototype.store=function(e){var i=h.prototype.store.call(this,e),r=this
;return c.ponLayerStoreParams.forEach(function(t){return i[t]=r[t]}),i.childImages=this.childImages.map(function(t){return t.store(e)}),i},c.prototype.restore=function(r,n,s){return o(this,void 0,void 0,function(){var e,i=this;return a(this,function(t){
switch(t.label){case 0:return[4,h.prototype.restore.call(this,r,n,s)];case 1:return t.sent(),e=this,c.ponLayerStoreParams.forEach(function(t){return e[t]=r[t]}),0<r.childImages.length?r.childImages.length!==this.childImages.length?[3,3]:[4,Promise.all(
r.childImages.map(function(t,e){return i.childImages[e].restore(t,n,s)}))]:[3,6];case 2:return t.sent(),[3,5];case 3:return this.freeChildImages(),[4,Promise.all(r.childImages.map(function(t){var e=new u.BaseLayer(t.name,i.resource,i.owner)
;return i.addChild(e),i.childImages.push(e),e.restore(t,n,s)}))];case 4:t.sent(),t.label=5;case 5:return[3,7];case 6:this.freeChildImages(),t.label=7;case 7:return[2]}})})},c.prototype.copyTo=function(i){var r=this;h.prototype.copyTo.call(this,i)
;var e=this,n=i;c.ponLayerStoreParams.forEach(function(t){return n[t]=e[t]}),i.freeChildImages(),this.childImages.forEach(function(t){var e=new u.BaseLayer(t.name,r.resource,r.owner);i.addChild(e),i.childImages.push(e),t.copyTo(e)})},
c.ponLayerStoreParams=["autoHideWithMessage","visibleBuffer"],c);function c(t,e,i){var r=h.call(this,t,e,i)||this;return r.autoHideWithMessage=!1,r.childImages=[],r.visibleBuffer=r.visible,r}e.PonLayer=l},function(t,e,i){"use strict";var r,
n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,
e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}
function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},o=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0
),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(
o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue
;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(
o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{
value:!0});var a,h=i(64),u=i(71),l=i(72),c=i(73),d=(a=h.MovableLayer,n(p,a),Object.defineProperty(p.prototype,"pixiFilters",{get:function(){return null==this.container.filters?[]:this.container.filters},enumerable:!0,configurable:!0}),
Object.defineProperty(p.prototype,"filters",{get:function(){return this._filters},enumerable:!0,configurable:!0}),p.registerFilter=function(t,e){p.filterClassList[t]=e},p.prototype.addFilter=function(t,e){var i=(0,p.filterClassList[t])(e)
;this.addLayerFilter(i)},p.prototype.addLayerFilter=function(t){this.filters.push(t);var e=[];this.filters.forEach(function(t){e.push(t.pixiFilter)}),this.container.filters=e},p.prototype.clearFilters=function(){this._filters=[],this.container.filters=[]}
,p.prototype.store=function(t){var e=a.prototype.store.call(this,t);return e.filters=[],this.filters.forEach(function(t){e.filters.push({filterName:t.filterName,data:t.store()})}),e},p.prototype.restore=function(i,r,n){return s(this,void 0,void 0,
function(){var e=this;return o(this,function(t){switch(t.label){case 0:return[4,a.prototype.restore.call(this,i,r,n)];case 1:return t.sent(),this.clearFilters(),null!=i.filters&&i.filters.forEach(function(t){e.addFilter(t.filterName,t.data)}),[2]}})})},
p.prototype.copyTo=function(e){a.prototype.copyTo.call(this,e),e.clearFilters(),this.filters.forEach(function(t){e.addFilter(t.filterName,t.store())})},p.filterClassList=null,p);function p(t,e,i){var r=a.call(this,t,e,i)||this;return r._filters=[],
r._filters=[],null==p.filterClassList&&(p.filterClassList={},p.registerFilter(l.BlurFilter.filterName,l.createBlurFilter),p.registerFilter(c.ColorMatrixFilter.filterName,c.createColorMatrixFilter),p.registerFilter(u.ColorFilter.filterName,
u.createColorFilter)),r}e.FilteredLayer=d},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e
)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){
function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},o=this&&this.__generator||function(i,r){var n,s,o,t,a={
label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n
)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:
return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){
a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{
value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var a,h=i(65),u=i(9),l=(a=h.SliderLayer,n(c,a),Object.defineProperty(c.prototype,"isMoving",{get:function(){return this._isMoving},enumerable:!0,configurable:!0}),
Object.defineProperty(c.prototype,"isLoopMoving",{get:function(){return this.moveLoop},enumerable:!0,configurable:!0}),c.prototype.startMove=function(t,e,i,r,n,s,o){if("bezier2"===n&&2!==r.length)throw new Error("bezier2ではpathを2点指定する必要があります。");if(
"bezier3"===n&&3!==r.length)throw new Error("bezier3ではpathを3点指定する必要があります。");if("catmullrom"===n&&r.length<2)throw new Error("catmullromではpathを2点以上指定する必要があります。");if(o&&"linear"!==n&&"catmullrom"!==n)throw new Error(
"自動移動をループできるのはlinearまたはcatmullromの場合のみです。");this._isMoving=!0,this.moveType=n,this.moveEase=s,this.movePoint=0,this.moveTime=e,this.moveDelay=i,this.moveLoop=o,this.moveTotalTime=e*(r.length-1),this.moveStartTick=-1,this.moveDelayStartTick=-1
;var a=this.clonePath(r);a.unshift({x:this.x,y:this.y,alpha:this.alpha,scalex:this.scaleX,scaley:this.scaleY});for(var h=1;h<a.length;h++){var u=a[h-1],l=a[h];null==l.x&&(l.x=u.x),null==l.y&&(l.y=u.y),null==l.alpha&&(l.alpha=u.alpha),null==l.scalex&&(
l.scalex=u.scalex),null==l.scaley&&(l.scaley=u.scaley)}this.movePosList=a,"bezier2"!==n&&"bezier3"!==n||(this.moveTime=this.moveTotalTime)},c.prototype.stopMove=function(t){if(void 0===t&&(t=!0),this._isMoving){
var e=this.movePosList[this.movePosList.length-1];this.x=e.x,this.y=e.y,this.alpha=e.alpha,this.scaleX=e.scalex,this.scaleY=e.scaley,this._isMoving=!1,this.movePosList=[],this.moveLoop=!1,t&&this.owner.conductor.trigger("move")}},
c.prototype.clonePath=function(t){var r=[];return t.forEach(function(e){var i={};Object.keys(e).forEach(function(t){i[t]=e[t]}),r.push(i)}),r},c.prototype.update=function(t){if(a.prototype.update.call(this,t),this._isMoving){if(
-1===this.moveDelayStartTick&&(this.moveDelayStartTick=t),t-this.moveDelayStartTick<this.moveDelay)return;-1===this.moveStartTick&&(this.moveStartTick=t);var e=(t-this.moveStartTick)/this.moveTime;switch(this.moveEase){case"in":e=u.Ease.in(e);break
;case"out":e=u.Ease.out(e);break;case"both":e=u.Ease.inOut(e)}switch(1<e&&(e=1),this.moveType){case"bezier2":this.moveBezierCurve2(t,e);break;case"bezier3":this.moveBezierCurve3(t,e);break;case"catmullrom":this.moveCatmullRom(t,e);break;default:
this.moveLinear(t,e)}}},c.prototype.moveLinear=function(t,e){var i,r=this.movePosList[this.movePoint];if(i=this.movePoint+1<this.movePosList.length?this.movePosList[this.movePoint+1]:this.movePosList[0],this.x=Math.floor(r.x+(i.x-r.x)*e),
this.y=Math.floor(r.y+(i.y-r.y)*e),this.alpha=r.alpha+(i.alpha-r.alpha)*e,this.scaleX=r.scalex+(i.scalex-r.scalex)*e,this.scaleY=r.scaley+(i.scaley-r.scaley)*e,t-this.moveStartTick>=this.moveTime)if(this.movePoint++,this.moveLoop){
this.movePoint>=this.movePosList.length&&(this.movePoint=0),this.moveStartTick+=this.moveTime;var n=this.movePosList[this.movePoint];this.x=n.x,this.y=n.y}else this.movePoint+1<this.movePosList.length?(this.moveStartTick+=this.moveTime,
n=this.movePosList[this.movePoint],this.x=n.x,this.y=n.y):this.stopMove()},c.prototype.moveBezierCurve2=function(t,e){var i=this.movePosList[0],r=this.movePosList[1],n=this.movePosList[2],s=e;this.x=(1-s)*(1-s)*i.x+2*(1-s)*s*r.x+s*s*n.x,this.y=(1-s)*(1-s
)*i.y+2*(1-s)*s*r.y+s*s*n.y,this.alpha=i.alpha+(n.alpha-i.alpha)*e,this.scaleX=i.scalex+(n.scalex-i.scalex)*e,this.scaleY=i.scaley+(n.scaley-i.scaley)*e,t-this.moveStartTick>=this.moveTime&&this.stopMove()},c.prototype.moveBezierCurve3=function(t,e){
var i=this.movePosList[0],r=this.movePosList[1],n=this.movePosList[2],s=this.movePosList[3],o=e;this.x=(1-o)*(1-o)*(1-o)*i.x+3*(1-o)*(1-o)*o*r.x+3*(1-o)*o*o*n.x+o*o*o*s.x,this.y=(1-o)*(1-o)*(1-o)*i.y+3*(1-o)*(1-o)*o*r.y+3*(1-o)*o*o*n.y+o*o*o*s.y,
this.alpha=i.alpha+(s.alpha-i.alpha)*e,this.scaleX=i.scalex+(s.scalex-i.scalex)*e,this.scaleY=i.scaley+(s.scaley-i.scaley)*e,t-this.moveStartTick>=this.moveTime&&this.stopMove()},c.prototype.moveCatmullRom=function(t,e){var i,r,n,s,o=this.movePoint,
a=this.movePosList;if(s=this.moveLoop?(i=o-1<0?a[a.length-1]:a[o-1],r=a[o],n=a[(o+1)%a.length],a[(o+2)%a.length]):0===o?(i=a[o],r=a[o],n=a[o+1],a[o+2]):o+2>=a.length?(i=a[o-1],r=a[o],n=a[o+1],a[o+1]):(i=a[o-1],r=a[o],n=a[o+1],a[o+2]),
this.x=this.catmullRom(i.x,r.x,n.x,s.x,e),this.y=this.catmullRom(i.y,r.y,n.y,s.y,e),this.alpha=r.alpha+(n.alpha-r.alpha)*e,this.scaleX=r.scalex+(n.scalex-r.scalex)*e,this.scaleY=r.scaley+(n.scaley-r.scaley)*e,t-this.moveStartTick>=this.moveTime)if(
this.movePoint++,this.moveLoop){this.movePoint>=this.movePosList.length&&(this.movePoint=0),this.moveStartTick+=this.moveTime;var h=this.movePosList[this.movePoint];this.x=h.x,this.y=h.y}else this.movePoint+1<this.movePosList.length?(
this.moveStartTick+=this.moveTime,h=this.movePosList[this.movePoint],this.x=h.x,this.y=h.y):this.stopMove()},c.prototype.catmullRom=function(t,e,i,r,n){var s=(i-t)/2,o=(r-e)/2,a=n*n;return a*n*(2*e-2*i+s+o)+(-3*e+3*i-2*s-o)*a+s*n+e},
c.prototype.store=function(t){var e=a.prototype.store.call(this,t),i=this;if(this.isMoving)if(this.moveLoop)c.movableLayerStoreParams.forEach(function(t){e[t]=i[t]});else{var r=this.movePosList[this.movePosList.length-1];e.x=r.x,e.y=r.y,e.alpha=r.alpha}
return e},c.prototype.restore=function(i,r,n){return s(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return this.stopMove(!1),[4,a.prototype.restore.call(this,i,r,n)];case 1:return t.sent(),i.moveLoop&&(e=this,
c.movableLayerStoreParams.forEach(function(t){e[t]=i[t]}),this.moveDelay=0,this.moveDelayStartTick=-1,this.moveStartTick=-1),[2]}})})},c.prototype.copyTo=function(t){a.prototype.copyTo.call(this,t);var e=this,i=t;c.movableLayerStoreParams.forEach(
function(t){return i[t]=e[t]})},c.movableLayerStoreParams=["_isMoving","moveType","moveEase","movePosList","movePoint","moveTime","moveDelay","moveLoop","moveTotalTime","moveStartTick","moveDelayStartTick"],c);function c(t,e,i){var r=a.call(this,t,e,i
)||this;return r._isMoving=!1,r.moveType="linear",r.moveEase="none",r.movePosList=[],r.movePoint=0,r.moveTime=0,r.moveDelay=0,r.moveLoop=!1,r.moveTotalTime=0,r.moveStartTick=-1,r.moveDelayStartTick=-1,r}e.MovableLayer=l},function(t,e,i){"use strict";var r
,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t
,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}
function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},c=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0
),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(
o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue
;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(
o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{
value:!0});var s,o=i(11),a=i(12),h=i(66),u=(s=a.Button,n(d,s),d.prototype.initSliderButton=function(e){return l(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.loadImage(e)];case 1:return t.sent(),
this.initButton(),this.width=Math.floor(this.imageWidth/3),[2]}})})},d.prototype.clearSliderButton=function(){this.clearButton(),this.freeImage()},d.prototype.setButtonStatus=function(t){switch(s.prototype.setButtonStatus.call(this,t),t){case"normal":
case"disabled":this.imageX=0;break;case"over":this.imageX=-Math.floor(this.imageWidth/3);break;case"on":this.imageX=-Math.floor(this.imageWidth/3*2)}},d.prototype.setCallbacks=function(t){this.callbacks=t},d.prototype.onMouseDown=function(t){
s.prototype.onMouseDown.call(this,t),this.isInsideEvent(t)&&this.callbacks.onMouseDown&&this.callbacks.onMouseDown(t)},d.prototype.onMouseUp=function(t){s.prototype.onMouseUp.call(this,t),this.callbacks.onMouseUp&&this.callbacks.onMouseUp(t)},d)
;function d(){return null!==s&&s.apply(this,arguments)||this}e.SliderButton=u;var p,f=(p=o.BaseLayer,n(m,p),m.prototype.initSlider=function(r,n,s,o,a){return l(this,void 0,void 0,function(){var e,i=this;return c(this,function(t){return this.clearSlider(),
r<0&&(r=0),1<r&&(r=1),this.value=r,this.exp=n,(e=[]).push(this.loadImage(s)),e.push(this.foreImage.loadImage(o).then(function(){i.foreImage.x=0,i.foreImage.y=0,i.foreImage.visible=!0})),e.push(this.button.initSliderButton(a).then(function(){i.button.x=0,
i.button.y=0,i.button.visible=!0,i.button.setButtonStatus("normal")})),[2,Promise.all(e).then(function(){i.setValue(r),i.visible=!0,i.lock()})]})})},m.prototype.clearSlider=function(){this.freeImage(),this.value=0,this.exp="",this.down=!1,
this.foreImage.freeImage(),this.foreImage.visible=!1,this.button.clearSliderButton(),this.button.freeImage(),this.button.visible=!1},m.prototype.lock=function(){this.locked=!0,this.button.setButtonStatus("disabled")},m.prototype.unlock=function(){
this.locked=!1,this.button.setButtonStatus("normal")},m.prototype.setValueX=function(t){var e=t-this.button.width/2;e<0&&(e=0),e>this.width-this.button.width&&(e=this.width-this.button.width),this.foreImage.width=e;var i=(this.button.x=e)/(
this.width-this.button.width);i<0&&(i=0),1<i&&(i=1),this.value=i},m.prototype.setValue=function(t){t<0&&(t=0),1<t&&(t=1);var e=t*(this.width-this.button.width);this.value=t,this.foreImage.width=e,this.button.x=e},m.prototype.onButtonDown=function(t){
this.locked||(this.down=!0)},m.prototype.onButtonUp=function(t){},m.prototype.onMouseEnter=function(t){p.prototype.onMouseEnter.call(this,t)},m.prototype.onMouseLeave=function(t){p.prototype.onMouseLeave.call(this,t)},m.prototype.onMouseDown=function(t){
p.prototype.onMouseDown.call(this,t),!this.locked&&this.isInsideEvent(t)&&(this.setValueX(t.x),this.down=!0,t.stopPropagation(),t.forceStop())},m.prototype.onMouseMove=function(t){p.prototype.onMouseMove.call(this,t),!this.locked&&this.down&&(
this.setValueX(t.x),this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.over)},m.prototype.onMouseUp=function(t){p.prototype.onMouseUp.call(this,t),this.down&&(this.down=!1,this.resource.getForeCanvasElm(
).style.cursor=this.resource.cursor.normal,null!=this.exp&&""!==this.exp&&(console.log("typeof",typeof this.exp),"function"==typeof this.exp?this.exp(this.value):this.resource.evalJs(this.exp)),t.stopPropagation(),t.forceStop())},
m.prototype.store=function(t){var e=p.prototype.store.call(this,t),i=this;return m.sliderStoreParams.forEach(function(t){e[t]=i[t]}),e.foreImage=this.foreImage.store(t),e.button=this.button.store(t),e},m.prototype.restore=function(r,n,s){return l(this,
void 0,void 0,function(){var e,i=this;return c(this,function(t){switch(t.label){case 0:return this.clearSlider(),[4,p.prototype.restore.call(this,r,n,s)];case 1:return t.sent(),e=this,m.sliderStoreParams.forEach(function(t){e[t]=r[t]}),[4,
this.foreImage.restore(r.foreImage,n,s)];case 2:return t.sent(),[4,this.button.restore(r.button,n,s)];case 3:return t.sent(),this.button.setCallbacks({onMouseDown:function(t){i.onButtonDown(t)},onMouseUp:function(t){i.onButtonUp(t)}}),[2]}})})},
m.prototype.restoreAfterLoadImage=function(t,e){p.prototype.restoreAfterLoadImage.call(this,t,e),this.setValue(t.value),t.locked?this.lock():this.unlock()},m.prototype.copyTo=function(t){p.prototype.copyTo.call(this,t);var e=this,i=t
;m.sliderStoreParams.forEach(function(t){i[t]=e[t]}),this.foreImage.copyTo(t.foreImage),this.button.copyTo(t.button)},m.sliderStoreParams=["locked","value","exp"],m);function m(t,e,i){var r=p.call(this,t,e,i)||this;return r.locked=!1,r.value=0,r.exp="",
r.down=!1,r.foreImage=new o.BaseLayer("slider fore",e,i),r.addChild(r.foreImage),r.button=new u("slider button",e,i),r.addChild(r.button),r.button.setCallbacks({onMouseDown:function(t){r.onButtonDown(t)},onMouseUp:function(t){r.onButtonUp(t)}}),r}
e.Slider=f;var _,y=(_=h.ToggleButtonLayer,n(v,_),v.prototype.addSlider=function(r,n,s,o,a,h,u){return l(this,void 0,void 0,function(){var e,i;return c(this,function(t){return e="Slider "+this.sliders.length,i=new f(e,this.resource,this.owner),
this.addChild(i),this.sliders.push(i),i.x=r,i.y=n,[2,i.initSlider(s,o,a,h,u)]})})},v.prototype.clearSliders=function(){var e=this;this.sliders.forEach(function(t){t.clearSlider(),t.destroy(),e.deleteChildLayer(t)}),this.sliders=[]},
v.prototype.lockSliders=function(){this.sliders.forEach(function(t){return t.lock()})},v.prototype.unlockSliders=function(){this.sliders.forEach(function(t){return t.unlock()})},v.prototype.store=function(e){var t=_.prototype.store.call(this,e)
;return t.sliders=this.sliders.map(function(t){return t.store(e)}),t},v.prototype.restore=function(e,r,n){return l(this,void 0,void 0,function(){var i=this;return c(this,function(t){switch(t.label){case 0:return[4,_.prototype.restore.call(this,e,r,n)]
;case 1:return t.sent(),null!=e.sliders&&0<e.sliders.length?(console.log("sliders",e.sliders),e.sliders.length!==this.sliders.length?[3,3]:[4,Promise.all(e.sliders.map(function(t,e){return i.sliders[e].restore(t,r,n)}))]):[3,6];case 2:return t.sent(),[3,5
];case 3:return this.clearSliders(),[4,Promise.all(e.sliders.map(function(t){var e=new f(t.name,i.resource,i.owner);return i.addChild(e),i.sliders.push(e),e.restore(t,r,n)}))];case 4:t.sent(),t.label=5;case 5:return[3,7];case 6:this.clearSliders(),
t.label=7;case 7:return[2]}})})},v.prototype.restoreAfterLoadImage=function(t,e){if(_.prototype.restoreAfterLoadImage.call(this,t,e),null!=t.sliders&&0<t.sliders.length)for(var i=0;i<t.sliders.length;i++)this.sliders[i].restoreAfterLoadImage(t.sliders[i],
e)},v.prototype.copyTo=function(i){var r=this;_.prototype.copyTo.call(this,i),i.clearSliders(),this.sliders.forEach(function(t){var e=new f(r.name,i.resource,i.owner);i.addChild(e),i.sliders.push(e),t.copyTo(e)})},v);function v(){var t=null!==_&&_.apply(
this,arguments)||this;return t.sliders=[],t}e.SliderLayer=y},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(
var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,
e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},c=this&&this.__generator||function(i,r){var n,s,o,t,
a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n
)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:
return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){
a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{
value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var s,o=i(67),a=i(70),d=(s=a.ToggleButton,n(h,s),h.prototype.initImageToggleButton=function(e,i,r,n,s){return void 0===r&&(r=!1),l(this,void 0,void 0,function(){
return c(this,function(t){switch(t.label){case 0:this.clearToggleButton(),this.freeImage(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.loadImage(e)];case 2:return t.sent(),this.direction=s,"vertical"===this.direction?this.height=Math.floor(
this.imageHeight/2):this.width=Math.floor(this.imageWidth/2),this.initToggleButton(i,r,n),[3,4];case 3:throw t.sent(),new Error("画像の読み込みに失敗しました。");case 4:return[2]}})})},h.prototype.clearToggleButton=function(){s.prototype.clearToggleButton.call(this),
this.direction="horizontal"},h.prototype.setValue=function(t){s.prototype.setValue.call(this,t),"vertical"===this.direction?this.imageY=t?-Math.floor(this.imageHeight/2):0:this.imageX=t?-Math.floor(this.imageWidth/2):0},h.prototype.store=function(t){
var e=s.prototype.store.call(this,t),i=this;return h.imageToggleButtonStoreParams.forEach(function(t){e[t]=i[t]}),e},h.prototype.restore=function(e,i,r){return l(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,
s.prototype.restore.call(this,e,i,r)];case 1:return t.sent(),[2]}})})},h.prototype.restoreAfterLoadImage=function(e,t){var i=this;h.imageToggleButtonStoreParams.forEach(function(t){i[t]=e[t]}),s.prototype.restoreAfterLoadImage.call(this,e,t)},
h.prototype.copyTo=function(t){s.prototype.copyTo.call(this,t);var e=this,i=t;h.imageToggleButtonStoreParams.forEach(function(t){i[t]=e[t]})},h.imageToggleButtonStoreParams=["direction"],h);function h(){var t=null!==s&&s.apply(this,arguments)||this
;return t.direction="horizontal",t}e.ImageToggleButton=d;var u,p=(u=o.ImageButtonLayer,n(f,u),f.prototype.addToggleButton=function(r,n,s,o,a,h,u){return void 0===a&&(a=!1),l(this,void 0,void 0,function(){var e,i;return c(this,function(t){
return e="ImageToggleButton "+this.imageToggleButtons.length,i=new d(e,this.resource,this.owner),this.addChild(i),this.imageToggleButtons.push(i),i.x=n,i.y=s,[2,i.initImageToggleButton(r,o,a,h,u)]})})},f.prototype.clearToggleButtons=function(){var e=this
;this.imageToggleButtons.forEach(function(t){t.clearToggleButton(),t.destroy(),e.deleteChildLayer(t)}),this.imageToggleButtons=[]},f.prototype.lockButtons=function(){u.prototype.lockButtons.call(this),this.imageToggleButtons.forEach(function(t){
t.setButtonStatus("disabled")})},f.prototype.unlockButtons=function(){u.prototype.unlockButtons.call(this),this.imageToggleButtons.forEach(function(t){t.setButtonStatus("enabled")})},f.prototype.lockSystemButtons=function(){
u.prototype.lockSystemButtons.call(this),this.imageToggleButtons.forEach(function(t){t.lockSystemButton()})},f.prototype.unlockSystemButtons=function(){u.prototype.unlockSystemButtons.call(this),this.imageToggleButtons.forEach(function(t){
t.unlockSystemButton()})},f.prototype.store=function(e){var t=u.prototype.store.call(this,e);return t.imageToggleButtons=this.imageToggleButtons.map(function(t){return t.store(e)}),t},f.prototype.restore=function(e,r,n){return l(this,void 0,void 0,
function(){var i=this;return c(this,function(t){switch(t.label){case 0:return 0<e.imageToggleButtons.length?e.imageToggleButtons.length!==this.imageToggleButtons.length?[3,2]:[4,Promise.all(e.imageToggleButtons.map(function(t,e){
return i.imageToggleButtons[e].restore(t,r,n)}))]:[3,5];case 1:return t.sent(),[3,4];case 2:return this.clearToggleButtons(),[4,Promise.all(e.imageToggleButtons.forEach(function(t){var e=new d(t.name,i.resource,i.owner);return i.addChild(e),
i.imageToggleButtons.push(e),e.restore(t,r,n)}))];case 3:t.sent(),t.label=4;case 4:return[3,6];case 5:this.clearToggleButtons(),t.label=6;case 6:return[4,u.prototype.restore.call(this,e,r,n)];case 7:return t.sent(),[2]}})})},
f.prototype.restoreAfterLoadImage=function(t,e){if(u.prototype.restoreAfterLoadImage.call(this,t,e),null!=t.imageToggleButtons&&0<t.imageToggleButtons.length)for(var i=0;i<t.imageToggleButtons.length;i++)this.imageToggleButtons[i].restoreAfterLoadImage(
t.imageToggleButtons[i],e)},f.prototype.copyTo=function(i){u.prototype.copyTo.call(this,i),i.clearToggleButtons(),this.imageToggleButtons.forEach(function(t){var e=new d(name,i.resource,i.owner);i.addChild(e),i.imageToggleButtons.push(e),t.copyTo(e)})},f)
;function f(){var t=null!==u&&u.apply(this,arguments)||this;return t.imageToggleButtons=[],t}e.ToggleButtonLayer=p},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]
}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),
g=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((
h=h.apply(s,o||[])).next())})},x=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(
t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(
o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys
).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop()
;continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var s,o=i(12),a=i(68),b=(s=o.CommandButton,n(h,s),
h.prototype.initImageButton=function(e,i,r,n,s,o,a,h,u,l,c,d,p,f){return void 0===e&&(e=!0),void 0===i&&(i=!1),void 0===r&&(r=null),void 0===n&&(n=null),void 0===s&&(s=!0),void 0===o&&(o=!1),void 0===a&&(a=null),void 0===h&&(h=null),void 0===u&&(u=null),
g(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return this.clearCommandButton(),this.freeImage(),this.initCommandButton(e,i,r,n,s,o,a,h,u,d,p,f),this.direction=c,[4,this.loadImage(l)];case 1:return t.sent(),
"vertical"===this.direction?this.height=Math.floor(this.imageHeight/3):this.width=Math.floor(this.imageWidth/3),this.setButtonStatus("disabled"),[2]}})})},h.prototype.clearCommandButton=function(){s.prototype.clearCommandButton.call(this),
this.direction="horizontal"},h.prototype.setButtonStatus=function(t){if(s.prototype.setButtonStatus.call(this,t),"vertical"===this.direction)switch(t){case"normal":case"disabled":this.imageY=0;break;case"over":this.imageY=-Math.floor(this.imageHeight/3)
;break;case"on":this.imageY=-Math.floor(this.imageHeight/3*2)}else switch(t){case"normal":case"disabled":this.imageX=0;break;case"over":this.imageX=-Math.floor(this.imageWidth/3);break;case"on":this.imageX=-Math.floor(this.imageWidth/3*2)}},
h.prototype.store=function(t){var e=s.prototype.store.call(this,t),i=this;return h.imageButtonStoreParams.forEach(function(t){e[t]=i[t]}),e},h.prototype.restore=function(e,i,r){return g(this,void 0,void 0,function(){return x(this,function(t){switch(
t.label){case 0:return[4,s.prototype.restore.call(this,e,i,r)];case 1:return t.sent(),[2]}})})},h.prototype.restoreAfterLoadImage=function(e,t){var i=this;h.imageButtonStoreParams.forEach(function(t){i[t]=e[t]}),s.prototype.restoreAfterLoadImage.call(this
,e,t)},h.prototype.copyTo=function(t){s.prototype.copyTo.call(this,t);var e=this,i=t;h.imageButtonStoreParams.forEach(function(t){i[t]=e[t]})},h.imageButtonStoreParams=["direction"],h);function h(){var t=null!==s&&s.apply(this,arguments)||this
;return t.direction="horizontal",t}e.CommandImageButton=b;var u,l=(u=a.TextButtonLayer,n(c,u),c.prototype.addImageButton=function(r,n,s,o,a,h,u,l,c,d,p,f,m,_,y,v){return void 0===r&&(r=!0),void 0===n&&(n=!1),void 0===s&&(s=null),void 0===o&&(o=null),
void 0===a&&(a=!0),void 0===h&&(h=null),void 0===u&&(u=null),void 0===l&&(l=null),g(this,void 0,void 0,function(){var e,i;return x(this,function(t){switch(t.label){case 0:return e="ImageButton "+this.imageButtons.length,i=new b(e,this.resource,this.owner)
,this.addChild(i),this.imageButtons.push(i),i.x=d,i.y=p,[4,i.initImageButton(r,n,s,o,a,m,h,u,l,c,f,_,y,v)];case 1:return t.sent(),[2]}})})},c.prototype.clearImageButtons=function(){var e=this;this.imageButtons.forEach(function(t){t.clearCommandButton(),
t.destroy(),e.deleteChildLayer(t)}),this.imageButtons=[]},c.prototype.lockButtons=function(){u.prototype.lockButtons.call(this),this.imageButtons.forEach(function(t){t.setButtonStatus("disabled")})},c.prototype.unlockButtons=function(){
u.prototype.unlockButtons.call(this),this.imageButtons.forEach(function(t){t.setButtonStatus("normal")})},c.prototype.lockSystemButtons=function(){u.prototype.lockSystemButtons.call(this),this.imageButtons.forEach(function(t){t.lockSystemButton()})},
c.prototype.unlockSystemButtons=function(){u.prototype.unlockSystemButtons.call(this),this.imageButtons.forEach(function(t){t.unlockSystemButton()})},c.prototype.store=function(e){var t=u.prototype.store.call(this,e)
;return t.imageButtons=this.imageButtons.map(function(t){return t.store(e)}),t},c.prototype.restore=function(e,r,n){return g(this,void 0,void 0,function(){var i=this;return x(this,function(t){switch(t.label){case 0:
return 0<e.imageButtons.length?e.imageButtons.length!==this.imageButtons.length?[3,2]:[4,Promise.all(e.imageButtons.map(function(t,e){return i.imageButtons[e].restore(t,r,n)}))]:[3,5];case 1:return t.sent(),[3,4];case 2:return this.clearImageButtons(),[4,
Promise.all(e.imageButtons.map(function(t){var e=new b(t.name,i.resource,i.owner);return i.addChild(e),i.imageButtons.push(e),e.restore(t,r,n)}))];case 3:t.sent(),t.label=4;case 4:return[3,6];case 5:this.clearImageButtons(),t.label=6;case 6:return[4,
u.prototype.restore.call(this,e,r,n)];case 7:return t.sent(),[2]}})})},c.prototype.restoreAfterLoadImage=function(t,e){if(u.prototype.restoreAfterLoadImage.call(this,t,e),null!=t.imageButtons&&0<t.imageButtons.length)for(
var i=0;i<t.imageButtons.length;i++)this.imageButtons[i].restoreAfterLoadImage(t.imageButtons[i],e)},c.prototype.copyTo=function(i){u.prototype.copyTo.call(this,i),i.clearImageButtons(),this.imageButtons.forEach(function(t){var e=new b(t.name,i.resource,
i.owner);i.addChild(e),i.imageButtons.push(e),t.copyTo(e)})},c);function c(){var t=null!==u&&u.apply(this,arguments)||this;return t.imageButtons=[],t}e.ImageButtonLayer=l},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(
r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(
i.prototype=e.prototype,new i)}),s=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t
){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},o=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},
"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return
)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue
;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}
o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var a,h=i(12),u=i(69),M=(a=h.CommandButton,n(l
,a),l.prototype.initTextButton=function(t,e,i,r,n,s,o,a,h,u,l,c,d,p,f,m,_,y,v){void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===i&&(i=null),void 0===r&&(r=null),void 0===n&&(n=!0),void 0===s&&(s=!1),void 0===o&&(o=null),void 0===a&&(a=null),void 0===h&&(
h=null),void 0===u&&(u=""),void 0===l&&(l=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===p&&(p=1),void 0===f&&(f=1),void 0===m&&(m=1),void 0===_&&(_=""),void 0===y&&(y=""),void 0===v&&(v=""),this.clearCommandButton(),this.freeImage(),this.clearText(),
this.initCommandButton(t,e,i,r,n,s,o,a,h,_,y,v),this.txtBtnText=u,this.txtBtnNormalBackgroundColor=l,this.txtBtnOverBackgroundColor=c,this.txtBtnOnBackgroundColor=d,this.txtBtnNormalBackgroundAlpha=p,this.txtBtnOverBackgroundAlpha=f,
this.txtBtnOnBackgroundAlpha=m,this.setBackgroundColor(l,p),this.addText(u),this.setButtonStatus("disabled")},l.prototype.clearCommandButton=function(){a.prototype.clearCommandButton.call(this),this.txtBtnText="",this.txtBtnNormalBackgroundColor=0,
this.txtBtnOverBackgroundColor=0,this.txtBtnOnBackgroundColor=0,this.txtBtnNormalBackgroundAlpha=1,this.txtBtnOverBackgroundAlpha=1,this.txtBtnOnBackgroundAlpha=1},l.prototype.setButtonStatus=function(t){a.prototype.setButtonStatus.call(this,t),
this.resetTextButtonColors()},l.prototype.resetTextButtonColors=function(){var t=null,e=null;switch(this.buttonStatus){case"normal":case"disabled":t=this.txtBtnNormalBackgroundColor,e=this.txtBtnNormalBackgroundAlpha;break;case"over":
t=this.txtBtnOverBackgroundColor,e=this.txtBtnOverBackgroundAlpha;break;case"on":t=this.txtBtnOnBackgroundColor,e=this.txtBtnOnBackgroundAlpha}null==t&&(t=this.txtBtnNormalBackgroundColor),null==e&&(e=this.txtBtnNormalBackgroundAlpha),
this.setBackgroundColor(t,e)},l.prototype.store=function(t){var e=a.prototype.store.call(this,t),i=this;return l.textButtonStoreParams.forEach(function(t){e[t]=i[t]}),e},l.prototype.restoreAfterLoadImage=function(e,t){
a.prototype.restoreAfterLoadImage.call(this,e,t);var i=this;l.textButtonStoreParams.forEach(function(t){i[t]=e[t]}),this.clearText(),this.addText(e.txtBtnText)},l.prototype.copyTo=function(t){a.prototype.copyTo.call(this,t);var e=this,i=t
;l.textButtonStoreParams.forEach(function(t){i[t]=e[t]})},l.textButtonStoreParams=["txtBtnText","txtBtnNormalBackgroundColor","txtBtnOverBackgroundColor","txtBtnOnBackgroundColor","txtBtnNormalBackgroundAlpha","txtBtnOverBackgroundAlpha",
"txtBtnOnBackgroundAlpha"],l);function l(){var t=null!==a&&a.apply(this,arguments)||this;return t.txtBtnText="",t.txtBtnNormalBackgroundColor=0,t.txtBtnOverBackgroundColor=0,t.txtBtnOnBackgroundColor=0,t.txtBtnNormalBackgroundAlpha=1,
t.txtBtnOverBackgroundAlpha=1,t.txtBtnOnBackgroundAlpha=1,t}e.TextButton=M;var c,d=(c=u.FrameAnimLayer,n(p,c),p.prototype.addTextButton=function(t,e,i,r,n,s,o,a,h,u,l,c,d,p,f,m,_,y,v,g,x,b,T,E,w){void 0===t&&(t=""),void 0===e&&(e=!0),void 0===i&&(i=!1),
void 0===r&&(r=null),void 0===n&&(n=null),void 0===s&&(s=!0),void 0===o&&(o=null),void 0===a&&(a=null),void 0===h&&(h=null),void 0===y&&(y=0),void 0===v&&(v=0),void 0===g&&(g=0),void 0===x&&(x=0),void 0===b&&(b="center"),null!=t&&""!==t||(
t=""+this.textButtons.length);var A=new M("TextButton "+t,this.resource,this.owner);this.addChild(A),this.textButtons.push(A);var S=+f[0],I=null!=f[1]?+f[1]:S,C=null!=f[2]?+f[2]:S,O=+m[0],R=null!=m[1]?+m[1]:O,P=null!=m[2]?+m[2]:O;this.textCanvas.copyTo(
A.textCanvas),A.x=l,A.y=c,A.width=d,A.height=p,A.textCanvas.marginTop=y,A.textCanvas.marginRight=v,A.textCanvas.marginBottom=g,A.textCanvas.marginLeft=x,A.textCanvas.align=b,A.clearText(),A.initTextButton(e,i,r,n,s,_,o,a,h,u,S,I,C,O,R,P,T,E,w)},
p.prototype.clearTextButtons=function(){var e=this;this.textButtons.forEach(function(t){t.clearCommandButton(),t.destroy(),e.deleteChildLayer(t)}),this.textButtons=[]},p.prototype.changeTextButtonColors=function(t,e){var i=+e[0],r=null!=e[1]?+e[1]:i,
n=null!=e[2]?+e[2]:i;this.findTextButtonByName(t).forEach(function(t){t.txtBtnNormalBackgroundColor=i,t.txtBtnOverBackgroundColor=r,t.txtBtnOnBackgroundColor=n,t.resetTextButtonColors()})},p.prototype.changeTextButtonAlphas=function(t,e){var i=+e[0],
r=null!=e[1]?+e[1]:i,n=null!=e[2]?+e[2]:i;this.findTextButtonByName(t).forEach(function(t){t.txtBtnNormalBackgroundAlpha=i,t.txtBtnOverBackgroundAlpha=r,t.txtBtnOnBackgroundAlpha=n,t.resetTextButtonColors()})},p.prototype.findTextButtonByName=function(t){
var e="TextButton "+t;return this.textButtons.filter(function(t){return t.name===e})},p.prototype.lockButtons=function(){this.textButtons.forEach(function(t){t.setButtonStatus("disabled")})},p.prototype.unlockButtons=function(){this.textButtons.forEach(
function(t){t.setButtonStatus("normal")})},p.prototype.lockSystemButtons=function(){this.textButtons.forEach(function(t){t.lockSystemButton()})},p.prototype.unlockSystemButtons=function(){this.textButtons.forEach(function(t){t.unlockSystemButton()})},
p.prototype.store=function(e){var t=c.prototype.store.call(this,e);return t.textButtons=this.textButtons.map(function(t){return t.store(e)}),t},p.prototype.restore=function(e,r,n){return s(this,void 0,void 0,function(){var i=this;return o(this,function(t
){switch(t.label){case 0:return this.clearTextButtons(),null!=e.textButtons&&0<e.textButtons.length?[4,Promise.all(e.textButtons.map(function(t){var e=new M(t.name,i.resource,i.owner);return i.addChild(e),i.textButtons.push(e),e.restore(t,r,n)}))]:[3,2]
;case 1:t.sent(),t.label=2;case 2:return[4,c.prototype.restore.call(this,e,r,n)];case 3:return t.sent(),[2]}})})},p.prototype.restoreAfterLoadImage=function(t,e){if(c.prototype.restoreAfterLoadImage.call(this,t,e),
null!=t.textButtons&&0<t.textButtons.length)for(var i=0;i<t.textButtons.length;i++)this.textButtons[i].restoreAfterLoadImage(t.textButtons[i],e)},p.prototype.copyTo=function(i){c.prototype.copyTo.call(this,i),i.clearTextButtons(),this.textButtons.forEach(
function(t){var e=new M(name,i.resource,i.owner);i.addChild(e),i.textButtons.push(e),t.copyTo(e)})},p);function p(){var t=null!==c&&c.apply(this,arguments)||this;return t.textButtons=[],t}e.TextButtonLayer=d},function(t,e,i){"use strict";var r,
n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,
e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}
function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},o=this&&this.__generator||function(i,r){var n,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0
),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(
o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue
;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(
o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{
value:!0});var a,h=i(11),u=i(7),l=(a=h.BaseLayer,n(c,a),Object.defineProperty(c.prototype,"frameAnimLoop",{get:function(){return this._frameAnimLoop},enumerable:!0,configurable:!0}),c.prototype.initFrameAnim=function(t,e,i,r,n){this.stopFrameAnim(!1),
this._frameAnimLoop=t,this.frameAnimTime=e,this.frameAnimWidth=this.width=i,this.frameAnimHeight=this.height=r,this.frameAnimFrames=n},Object.defineProperty(c.prototype,"hasFrameAnim",{get:function(){return 0!==this.frameAnimFrames.length},enumerable:!0,
configurable:!0}),Object.defineProperty(c.prototype,"frameAnimRunning",{get:function(){return"run"===this.frameAnimState},enumerable:!0,configurable:!0}),c.prototype.startFrameAnim=function(t){if(0===this.frameAnimFrames.length)throw new Error(
"アニメーション定義が未定義です");this.frameAnimState="run",this.frameAnimStartTick=-1},c.prototype.stopFrameAnim=function(t){void 0===t&&(t=!0),"run"===this.frameAnimState&&(this.frameAnimState="stop",this.frameAnimStartTick=-1,t&&this.owner.conductor.trigger(
"frameanim"))},c.prototype.deleteFrameAnim=function(){this.stopFrameAnim(),this._frameAnimLoop=!1,this.frameAnimTime=50,this.frameAnimWidth=32,this.frameAnimHeight=32,this.frameAnimFrames=[]},c.prototype.update=function(t){if(a.prototype.update.call(this,
t),this.frameAnimRunning){-1===this.frameAnimStartTick&&(this.frameAnimStartTick=t);var e=this.frameAnimStartTick,i=this.frameAnimTime,r=this.frameAnimFrames;if(!this._frameAnimLoop&&t-e>r.length*i){var n=r[r.length-1];this.applyFrameAnim(n),
this.stopFrameAnim()}else n=r[Math.floor((t-e)/i)%r.length],this.applyFrameAnim(n)}},c.prototype.applyFrameAnim=function(t){null!=t.x&&(this.imageX=-+t.x),null!=t.y&&(this.imageY=-+t.y),null!=t.alpha&&(this.alpha=+t.alpha)},c.prototype.freeImage=function(
){this.deleteFrameAnim(),a.prototype.freeImage.call(this)},c.prototype.store=function(t){var e=a.prototype.store.call(this,t),i=this;return c.frameAnimLayerStoreParams.forEach(function(t){e[t]=i[t]}),e},c.prototype.restore=function(e,i,r){return s(this,
void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.stopFrameAnim(!1),[4,a.prototype.restore.call(this,e,i,r)];case 1:return t.sent(),[2]}})})},c.prototype.restoreAfterLoadImage=function(e,t){var i=this
;c.frameAnimLayerStoreParams.forEach(function(t){i[t]=e[t]}),0!==e.frameAnimFrames.length&&"run"===e.frameAnimState&&(this.startFrameAnim(t),u.Logger.debug("data.frameAnimState",e.frameAnimState,this.frameAnimState,this.frameAnimFrames))},
c.prototype.copyTo=function(t){a.prototype.copyTo.call(this,t);var e=this,i=t;c.frameAnimLayerStoreParams.forEach(function(t){return i[t]=e[t]})},c.frameAnimLayerStoreParams=["_frameAnimLoop","frameAnimTime","frameAnimWidth","frameAnimHeight",
"frameAnimFrames","frameAnimStartTick","frameAnimState"],c);function c(){var t=null!==a&&a.apply(this,arguments)||this;return t._frameAnimLoop=!1,t.frameAnimTime=50,t.frameAnimWidth=32,t.frameAnimHeight=32,t.frameAnimFrames=[],t.frameAnimStartTick=-1,
t.frameAnimState="stop",t}e.FrameAnimLayer=l},function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e
)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=this&&this.__awaiter||function(s,o,a,h){return new(a=a||Promise)(function(t,e){
function i(t){try{n(h.next(t))}catch(t){e(t)}}function r(t){try{n(h.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,r)}n((h=h.apply(s,o||[])).next())})},o=this&&this.__generator||function(i,r){var n,s,o,t,a={
label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n
)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:
return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){
a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(i,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{
value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var a,h=i(11),u=(a=h.BaseLayer,n(l,a),l.prototype.initToggleButton=function(t,e,i){this.insideFlag=!1,this.varName=t,this.isSystemButton=e,this.exp=i,
this.setButtonStatus("disabled"),this.setValue(this.getValue()),this.visible=!0},l.prototype.clearToggleButton=function(){this.setButtonStatus("disabled"),this.insideFlag=!1,this.varName="toggle-button-value",this.exp=null},
l.prototype.setButtonStatus=function(t){this.isSystemButton&&this.systemButtonLocked?this.buttonStatus="disabled":this.buttonStatus=t,"enabled"===t&&this.insideFlag?this.resource.getForeCanvasElm(
).style.cursor=this.resource.cursor.over:this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.normal},l.prototype.lockSystemButton=function(){this.isSystemButton&&(this.systemButtonLocked=!0,this.setButtonStatus("disabled"))},
l.prototype.unlockSystemButton=function(){this.isSystemButton&&(this.systemButtonLocked=!1,this.setButtonStatus("enabled"))},l.prototype.setValue=function(t){this.resource.tmpVar[this.varName]=t},l.prototype.getValue=function(){
return this.resource.tmpVar[this.varName]},l.prototype.onChangeStable=function(t){a.prototype.onChangeStable.call(this,t),this.isSystemButton&&(this.systemButtonLocked||(t?this.setButtonStatus("enabled"):this.setButtonStatus("disabled")))},
l.prototype.onMouseEnter=function(t){a.prototype.onMouseEnter.call(this,t),"disabled"!==this.buttonStatus&&(this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.over),this.insideFlag=!0},l.prototype.onMouseLeave=function(t){
a.prototype.onMouseLeave.call(this,t),"disabled"!==this.buttonStatus&&(this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.normal),this.insideFlag=!1},l.prototype.onMouseDown=function(t){a.prototype.onMouseDown.call(this,t),
"disabled"!==this.buttonStatus&&(this.resource.getForeCanvasElm().style.cursor=this.resource.cursor.on)},l.prototype.onMouseUp=function(t){a.prototype.onMouseUp.call(this,t),t.isLeft&&"disabled"!==this.buttonStatus&&(this.setValue(!this.getValue()),
null!==this.exp&&""!==this.exp&&this.resource.evalJs(this.exp))},l.prototype.store=function(t){var e=a.prototype.store.call(this,t),i=this;return l.toggleButtonStoreParams.forEach(function(t){e[t]=i[t]}),e},l.prototype.restore=function(e,i,r){return s(
this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.clearToggleButton(),[4,a.prototype.restore.call(this,e,i,r)];case 1:return t.sent(),[2]}})})},l.prototype.restoreAfterLoadImage=function(e,t){
a.prototype.restoreAfterLoadImage.call(this,e,t);var i=this;l.toggleButtonStoreParams.forEach(function(t){i[t]=e[t]}),this.insideFlag=!1,this.setButtonStatus(e.buttonStatus),this.setValue(this.getValue())},l.prototype.copyTo=function(t){
a.prototype.copyTo.call(this,t);var e=this,i=t;l.toggleButtonStoreParams.forEach(function(t){i[t]=e[t]})},l.toggleButtonStoreParams=["insideFlag","buttonStatus","varName","isSystemButton","systemButtonLocked","exp"],l);function l(){
var t=null!==a&&a.apply(this,arguments)||this;return t.insideFlag=!1,t.buttonStatus="disabled",t.varName="toggle-button-value",t.exp=null,t.isSystemButton=!1,t.systemButtonLocked=!1,t}e.ToggleButton=u},function(t,e,i){"use strict";var r,
n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,
e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var s,o=i(74),a=i(15),h=(s=a.LayerFilter,n(u,s),Object.defineProperty(u.prototype,"filterName",{get:function(){return u.filterName
},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),u.filterName="color",u.permitedList=["gamma","saturation","contrast","brightness","red","green","blue"],u)
;function u(i){var t=s.call(this,i,u.permitedList)||this,r=t._filter=new o.AdjustmentFilter;return i=t.params,u.permitedList.forEach(function(t){if(null!=i[t]){var e=+i[t];e<0&&(e=0),r[t]=e}}),t}e.ColorFilter=h,e.createColorFilter=function(t){if(null==t
)throw new Error("Cannot create GammaFilter, params is empty.");return new h(t)}},function(t,a,h){"use strict";(function(r){var n,t=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){
t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(a,"__esModule",{
value:!0});var s,e=h(15),i=(s=e.LayerFilter,t(o,s),Object.defineProperty(o.prototype,"filterName",{get:function(){return o.filterName},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"filter",{get:function(){return this._filter},
enumerable:!0,configurable:!0}),o.filterName="blur",o);function o(t){var e=s.call(this,t)||this,i=e._filter=new r.filters.BlurFilter;return i.blurX=t.blurX||4,i.blurY=t.blurY||4,i.quality=t.quality||4,e}a.BlurFilter=i,a.createBlurFilter=function(t){if(
null==t)throw new Error("Cannot create BlurFilter, data is empty.");return new i(t)}}).call(this,h(5))},function(t,a,h){"use strict";(function(r){var n,t=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]
}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)})
;Object.defineProperty(a,"__esModule",{value:!0});var s,e=h(15),i=(s=e.LayerFilter,t(o,s),Object.defineProperty(o.prototype,"filterName",{get:function(){return o.filterName},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"filter",{
get:function(){return this._filter},enumerable:!0,configurable:!0}),o.filterName="colormatrix",o);function o(t){var e=s.call(this,t)||this,i=e._filter=new r.filters.ColorMatrixFilter;switch(console.log("ColorMatrixFilter type:",t.type),t.type.toLowerCase(
)){case"negative":i.negative(!0);break;case"grayscale":i.greyscale(t.scale||1,!0);break;case"brightness":i.brightness(t.bright||.5,!0);break;case"browni":i.browni(!0);break;case"contrast":i.contrast(t.contrast||.5,!0);break;case"desaturate":i.desaturate()
;break;case"hue":i.hue(t.rotation||0,!0);break;case"kodachrome":i.kodachrome(!0);break;case"lsd":i.lsd(!0);break;case"night":i.night(t.intensity||0,!0);break;case"polaroid":i.polaroid(!0);break;case"predator":i.predator(t.amount||0,!0);break
;case"saturate":i.saturate(t.amount||0,!0);break;case"sepia":i.sepia(!0);break;case"technicolor":i.technicolor(!0);break;case"toBGR":i.toBGR(!0);break;case"vintage":i.vintage(!0);break;case"colortone":i.colorTone(t.desaturation,t.toned,t.lightColor,
t.darkColor,!0)}return e}a.ColorMatrixFilter=i,a.createColorMatrixFilter=function(t){if(null==t)throw new Error("Cannot create ColorMatrixFilter, params is empty.");return new i(t)}}).call(this,h(5))},function(t,e,i){"use strict";i.r(e);function r(t){
this.items=[],this._name=t}var n={empty:{configurable:!0},name:{configurable:!0}};r.prototype.emit=function(t,e,i,r,n,s,o,a){if(8<arguments.length)throw new Error("max arguments reached");for(var h=this.name,u=this.items,l=0,c=u.length;l<c;l++)u[l][h](t,e
,i,r,n,s,o,a);return this},r.prototype.add=function(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this},r.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&this.items.splice(e,1),this},r.prototype.contains=function(t){
return-1!==this.items.indexOf(t)},r.prototype.removeAll=function(){return this.items.length=0,this},r.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},n.empty.get=function(){return 0===this.items.length},n.name.get=function(
){return this._name},Object.defineProperties(r.prototype,n),r.prototype.dispatch=r.prototype.emit,r.prototype.run=r.prototype.emit;var s=i(0),o=i.n(s);var S={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,
SPRITE_MAX_TEXTURES:function(t){var e=!0;if(o.a.tablet||o.a.phone){if(e=!1,o.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(i)11<=parseInt(i[1],10)&&(e=!0)}if(o.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/)
;if(r)7<=parseInt(r[1],10)&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},
GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:o.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!o.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},a=i(19),h=i.n(a)
,u=(i(2),i(1)),l=i.n(u),c={WEBGL_LEGACY:0,WEBGL:1,WEBGL2:2},d=0,p=1,f=0,m=1,_=2,y=3,v=4,g=5,x=6,b=7,T=8,E=9,w=10,A=11,I=12,C=13,O=14,R=15,P=16,M=17,N=18,L=19,F=20,D=21,U=22,B=23,k=24,X=25,G=26,V=27,j=28,H=4,Y=5,z=6408,W=6402,q=3553,K=34067,Z=35866,J=34069
,Q=5121,$=5123,tt=5126,et=36193,it=1,rt=0,nt=33071,st=1,ot=1,at="mediump",ht="highp";S.RETINA_PREFIX=/@([0-9\.]+)x/;var ut,lt=!(S.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0),ct="5.1.0";var dt=function(){for(var t=[],e=[],i=0;i<32;i++)e[t[i]=i]=i;t[M]=f,t[N]=m,
t[L]=y,e[f]=M,e[m]=N,e[y]=L;var r=[];return r.push(e),r.push(t),r}();function pt(t,e,i){var r,n=t.length;if(!(n<=e||0===i)){var s=n-(i=n<e+i?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var ft=0;function mt(){return++ft}function _t(t){return t+=0===t,
--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function yt(t){return!(t&t-1||!t)}function vt(t){var e=(65535<t)<<4,i=(255<(t>>>=e))<<3;return e|=i,e|=i=(15<(t>>>=i))<<2,(e|=i=(3<(t>>>=i))<<1)|(t>>>=i)>>1}var gt={},xt=Object.create(null),
bt=Object.create(null);function Tt(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||S.RESOLUTION,this.resize(t,e)}var Et={width:{configurable:!0},height:{configurable:!0}}
;Tt.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},Tt.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},
Tt.prototype.destroy=function(){this.context=null,this.canvas=null},Et.width.get=function(){return this.canvas.width},Et.width.set=function(t){this.canvas.width=t},Et.height.get=function(){return this.canvas.height},Et.height.set=function(t){
this.canvas.height=t},Object.defineProperties(Tt.prototype,Et);var wt;function At(t,e){var i=S.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var St={};S.TARGET_FPMS=.06;function It(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),
void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}var Ct=0,Ot=-25;It.prototype.match=function(t,e){return e=e||null,this.fn===t&&this.context===e},It.prototype.emit=function(t){
this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},It.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,
t.next=this},It.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,
this.previous=null,e};function Rt(){var e=this;this._head=new It(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/S.TARGET_FPMS,this.elapsedMS=1/S.TARGET_FPMS,
this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}var Pt={FPS:{configurable:!0},
minFPS:{configurable:!0},maxFPS:{configurable:!0}},Mt={shared:{configurable:!0},system:{configurable:!0}};Rt.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),
this._requestId=requestAnimationFrame(this._tick))},Rt.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Rt.prototype._startIfPossible=function(){this.started?this._requestIfNeeded(
):this.autoStart&&this.start()},Rt.prototype.add=function(t,e,i){return void 0===i&&(i=Ct),this._addListener(new It(t,e,i))},Rt.prototype.addOnce=function(t,e,i){return void 0===i&&(i=Ct),this._addListener(new It(t,e,i,!0))},
Rt.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}e=(i=e).next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},Rt.prototype.remove=function(
t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Rt.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Rt.prototype.stop=function(){this.started&&(
this.started=!1,this._cancelIfNeeded())},Rt.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},Rt.prototype.update=function(t){var e;if(void 0===t&&(
t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS)if(e+.05*this._minElapsedMS<this._minElapsedMS)return;this.deltaMS=e,
this.deltaTime=this.deltaMS*S.TARGET_FPMS;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Pt.FPS.get=function(){return 1e3/this.elapsedMS},
Pt.minFPS.get=function(){return 1e3/this._maxElapsedMS},Pt.minFPS.set=function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,S.TARGET_FPMS);this._maxElapsedMS=1/i},Pt.maxFPS.get=function(){return this._minElapsedMS?Math.round(
1e3/this._minElapsedMS):0},Pt.maxFPS.set=function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},Mt.shared.get=function(){if(!Rt._shared){var t=Rt._shared=new Rt;t.autoStart=!0,t._protected=!0}
return Rt._shared},Mt.system.get=function(){if(!Rt._system){var t=Rt._system=new Rt;t.autoStart=!0,t._protected=!0}return Rt._system},Object.defineProperties(Rt.prototype,Pt),Object.defineProperties(Rt,Mt);function Nt(t,e){void 0===t&&(t=0),void 0===e&&(
e=0),this.x=t,this.y=e}Nt.prototype.clone=function(){return new Nt(this.x,this.y)},Nt.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},Nt.prototype.copyTo=function(t){return t.set(this.x,this.y),t},Nt.prototype.equals=function(t){
return t.x===this.x&&t.y===this.y},Nt.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)};function Lt(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}var Ft={x:{configurable:!0},y:{configurable:!0}}
;Lt.prototype.clone=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=t||this.cb,r=e||this.scope;return new Lt(i,r,this._x,this._y)},Lt.prototype.set=function(t,e){var i=t||0,r=e||(0!==e?i:0);this._x===i&&this._y===r||(this._x=i,this._y=r,
this.cb.call(this.scope))},Lt.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},Lt.prototype.copyTo=function(t){return t.set(this._x,this._y),t},Lt.prototype.equals=function(t){
return t.x===this._x&&t.y===this._y},Ft.x.get=function(){return this._x},Ft.x.set=function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},Ft.y.get=function(){return this._y},Ft.y.set=function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},
Object.defineProperties(Lt.prototype,Ft);function Dt(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this.array=null}
var Ut=2*Math.PI,Bt=180/Math.PI,kt=Math.PI/180,Xt=0,Gt=1,Vt=2,jt=3,Ht=4,Yt={IDENTITY:{configurable:!0},TEMP_MATRIX:{configurable:!0}};Dt.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},
Dt.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},Dt.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,
i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},Dt.prototype.apply=function(t,e){e=e||new Nt;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx
,e.y=this.b*i+this.d*r+this.ty,e},Dt.prototype.applyInverse=function(t,e){e=e||new Nt;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(
-this.ty*this.a+this.tx*this.b)*i,e},Dt.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},Dt.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},Dt.prototype.rotate=function(t){
var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},Dt.prototype.append=function(t){var e=this.a,i=this.b,
r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},Dt.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,
this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},Dt.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c
;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},Dt.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,
s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(Ut-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,
t.position.y=this.ty,t},Dt.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},
Dt.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Dt.prototype.clone=function(){var t=new Dt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Dt.prototype.copyTo=function(t
){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},Dt.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Yt.IDENTITY.get=function(){return new Dt},
Yt.TEMP_MATRIX.get=function(){return new Dt},Object.defineProperties(Dt,Yt);var zt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Wt=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],qt=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Kt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],
Zt=[],Jt=[],Qt=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Zt.push(e);for(var i=0;i<16;i++)for(var r=Qt(zt[t]*zt[i]+qt[t]*Wt[i]),n=Qt(Wt[t]*zt[i]+Kt[t]*Wt[i]),s=Qt(zt[t]*qt[i]+qt[t]*Kt[i]),o=Qt(Wt[t]*qt[i]+Kt[t]*Kt[i]),a=0;a<16;a++)if(
zt[a]===r&&Wt[a]===n&&qt[a]===s&&Kt[a]===o){e.push(a);break}}for(var h=0;h<16;h++){var u=new Dt;u.set(zt[h],Wt[h],qt[h],Kt[h],0,0),Jt.push(u)}}();function $t(){this.worldTransform=new Dt,this.localTransform=new Dt,this.position=new Lt(this.onChange,this,0
,0),this.scale=new Lt(this.onChange,this,1,1),this.pivot=new Lt(this.onChange,this,0,0),this.skew=new Lt(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,
this._parentID=0}var te={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return zt[t]},uY:function(t){return Wt[t]},vX:function(t){return qt[t]},vY:function(t){return Kt[t]},
inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Zt[t][e]},sub:function(t,e){return Zt[t][te.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e
)?0<=e?te.S:te.N:2*Math.abs(e)<=Math.abs(t)?0<t?te.E:te.W:0<e?0<t?te.SE:te.SW:0<t?te.NE:te.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=Jt[te.inv(e)];n.tx=i,n.ty=r,t.append(n)}},ee={rotation:{configurable:!0}}
;$t.prototype.onChange=function(){this._localID++},$t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(
this._rotation-this.skew._x),this._localID++},$t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,
t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},$t.prototype.updateTransform=function(t){
var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),
e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,
r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},$t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},ee.rotation.get=function(){return this._rotation},
ee.rotation.set=function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},Object.defineProperties($t.prototype,ee),$t.IDENTITY=new $t;function ie(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t)
,this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=Gt}var re={left:{configurable:!0},right:{configurable:!0},top:{configurable:!0},bottom:{configurable:!0}},ne={EMPTY:{configurable:!0}};re.left.get=function(){return this.x},
re.right.get=function(){return this.x+this.width},re.top.get=function(){return this.y},re.bottom.get=function(){return this.y+this.height},ne.EMPTY.get=function(){return new ie(0,0,0,0)},ie.prototype.clone=function(){return new ie(this.x,this.y,this.width
,this.height)},ie.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},ie.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},
ie.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},ie.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},
ie.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0)},
ie.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,
this.height=r-this.y},ie.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=i-e,this.y=r,this.height=n-r},
Object.defineProperties(ie.prototype,re),Object.defineProperties(ie,ne);function se(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=Vt}se.prototype.clone=function(){return new se(this.x,this.y,
this.radius)},se.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},se.prototype.getBounds=function(){return new ie(this.x-this.radius,this.y-this.radius,2*this.radius,
2*this.radius)};function oe(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=jt}oe.prototype.clone=function(){return new oe(this.x,this.y,this.width,this.height)},
oe.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},oe.prototype.getBounds=function(){return new ie(this.x-this.width,this.y-this.height,this.width,
this.height)};function ae(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(Array.isArray(t[0])&&(t=t[0]),t[0]instanceof Nt){for(var i=[],r=0,n=t.length;r<n;r++)i.push(t[r].x,t[r].y);t=i}this.points=t,this.type=Xt,this.closeStroke=!0}
ae.prototype.clone=function(){var t=new ae(this.points.slice());return t.closeStroke=this.closeStroke,t},ae.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],
h=this.points[2*s],u=this.points[2*s+1];e<a!=e<u&&t<(e-a)/(u-a)*(h-o)+o&&(i=!i)}return i};function he(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,
this.radius=n,this.type=Ht}he.prototype.clone=function(){return new he(this.x,this.y,this.width,this.height,this.radius)},he.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(
t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),
n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1},S.SORTABLE_CHILDREN=!1
;function ue(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}ue.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},ue.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,
this.maxX=-1/0,this.maxY=-1/0},ue.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?ie.EMPTY:((t=t||new ie(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},
ue.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},ue.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY
,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=r<s?s:r,n=n<o?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=r<s?s:r,n=n<o?o:n,this.minX=e,this.minY=i,this.maxX=r,
this.maxY=n},ue.prototype.addFrame=function(t,e,i,r,n){var s=t.worldTransform,o=s.a,a=s.b,h=s.c,u=s.d,l=s.tx,c=s.ty,d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=o*e+h*i+l,y=a*e+u*i+c;d=_<d?_:d,p=y<p?y:p,f=f<_?_:f,m=m<y?y:m,d=(_=o*r+h*i+l)<d?_:d,p=(
y=a*r+u*i+c)<p?y:p,f=f<_?_:f,m=m<y?y:m,d=(_=o*e+h*n+l)<d?_:d,p=(y=a*e+u*n+c)<p?y:p,f=f<_?_:f,m=m<y?y:m,d=(_=o*r+h*n+l)<d?_:d,p=(y=a*r+u*n+c)<p?y:p,f=f<_?_:f,m=m<y?y:m,this.minX=d,this.minY=p,this.maxX=f,this.maxY=m},ue.prototype.addVertexData=function(t,e
,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],u=t[a+1];r=h<r?h:r,n=u<n?u:n,s=s<h?h:s,o=o<u?u:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},ue.prototype.addVertices=function(t,e,i,r){for(var n=t.worldTransform,
s=n.a,o=n.b,a=n.c,h=n.d,u=n.tx,l=n.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=i;m<r;m+=2){var _=e[m],y=e[m+1],v=s*_+a*y+u,g=h*y+o*_+l;c=v<c?v:c,d=g<d?g:d,p=p<v?v:p,f=f<g?g:f}this.minX=c,this.minY=d,this.maxX=p,this.maxY=f},
ue.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},ue.prototype.addBoundsMask=function(t,e){
var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,
this.maxY=u<s?s:u}},ue.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,
u=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=h<n?n:h,this.maxY=u<s?s:u}};var le=function(t){function n(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new $t,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,
this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new ue,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,
this._destroyed=!1,this.isSprite=!1}t&&(n.__proto__=t);var e={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{
configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return((n.prototype=Object.create(t&&t.prototype)
).constructor=n).mixin=function(t){for(var e=Object.keys(t),i=0;i<e.length;++i){var r=e[i];Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(
this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent},n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},
n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},
n.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),
this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new ie),e=this._boundsRect),this._bounds.getRectangle(e)},n.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,
this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new ie),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},n.prototype.toGlobal=function(t,e,i){
return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},
n.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)
),this.worldTransform.applyInverse(t,i)},n.prototype.render=function(t){},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.setTransform=function(t,e,i,r,
n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,
this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,
this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},e.x.get=function(){return this.position.x},e.x.set=function(t){this.transform.position.x=t},e.y.get=function(){
return this.position.y},e.y.set=function(t){this.transform.position.y=t},e.worldTransform.get=function(){return this.transform.worldTransform},e.localTransform.get=function(){return this.transform.localTransform},e.position.get=function(){
return this.transform.position},e.position.set=function(t){this.transform.position.copyFrom(t)},e.scale.get=function(){return this.transform.scale},e.scale.set=function(t){this.transform.scale.copyFrom(t)},e.pivot.get=function(){
return this.transform.pivot},e.pivot.set=function(t){this.transform.pivot.copyFrom(t)},e.skew.get=function(){return this.transform.skew},e.skew.set=function(t){this.transform.skew.copyFrom(t)},e.rotation.get=function(){return this.transform.rotation},
e.rotation.set=function(t){this.transform.rotation=t},e.angle.get=function(){return this.transform.rotation*Bt},e.angle.set=function(t){this.transform.rotation=t*kt},e.zIndex.get=function(){return this._zIndex},e.zIndex.set=function(t){this._zIndex=t,
this.parent&&(this.parent.sortDirty=!0)},e.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},e.mask.get=function(){return this._mask},e.mask.set=function(t){this._mask&&(this._mask.renderable=!0,
this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)},Object.defineProperties(n.prototype,e),n}(h.a);function ce(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}
le.prototype.displayObjectUpdateTransform=le.prototype.updateTransform;var de=function(n){function t(){n.call(this),this.children=[],this.sortableChildren=S.SORTABLE_CHILDREN,this.sortDirty=!1}n&&(t.__proto__=n);var e={width:{configurable:!0},height:{
configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++)this.addChild(e[r]
);else t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)
;return t},t.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,
t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},t.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e)
;this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},t.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},
t.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);pt(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(
e)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(1<i)for(var r=0;r<i;r++
)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,pt(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},
t.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,pt(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},
t.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,s=n-r;if(0<s&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1)
;this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0==s&&0===this.children.length)return[];throw new RangeError(
"removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}
t&&1<this.children.length&&this.children.sort(ce),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),
this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(
var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,
e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters
)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},t.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[
]);for(var r=this._enabledFilters.length=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,
s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},t.prototype._render=function(t){},t.prototype.destroy=function(t){
n.prototype.destroy.call(this),this.sortDirty=!1;var e="boolean"==typeof t?t:t&&t.children,i=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<i.length;++r)i[r].destroy(t)},e.width.get=function(){return this.scale.x*this.getLocalBounds(
).width},e.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},e.height.get=function(){return this.scale.y*this.getLocalBounds().height},e.height.set=function(t){var e=this.getLocalBounds().height
;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(t.prototype,e),t}(le);de.prototype.containerUpdateTransform=de.prototype.updateTransform;function pe(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,
this.internal=!1,this.onResize=new r("setRealSize",2),this.onUpdate=new r("update")}var fe={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};pe.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),(
this._width||this._height)&&this.onResize.run(this._width,this._height)},pe.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t)},pe.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,
this.onResize.run(t,e))},fe.valid.get=function(){return!!this._width&&!!this._height},pe.prototype.update=function(){this.destroyed||this.onUpdate.run()},pe.prototype.load=function(){return Promise.resolve()},fe.width.get=function(){return this._width},
fe.height.get=function(){return this._height},pe.prototype.upload=function(t,e,i){return!1},pe.prototype.style=function(t,e,i){return!1},pe.prototype.dispose=function(){},pe.prototype.destroy=function(){this.destroyed||(this.onResize.removeAll(),
this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null,this.destroyed=!0,this.dispose())},Object.defineProperties(pe.prototype,fe);var me=function(r){function t(t){var e=t.naturalWidth||t.videoWidth||t.width,
i=t.naturalHeight||t.videoHeight||t.height;r.call(this,e,i),this.source=t}return r&&(t.__proto__=r),((t.prototype=Object.create(r&&r.prototype)).constructor=t).crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(
void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,(wt=wt||document.createElement("a")).href=t;var i=!(t=l.a.parse(wt.href)).port&&""===e.port||t.port===e.port
;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},t.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight;return r=r||this.source,n.pixelStorei(
n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),e.target===n.TEXTURE_2D&&i.width===s&&i.height===o?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r):(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)),!0},
t.prototype.update=function(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,e=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,e),r.prototype.update.call(this)}},
t.prototype.dispose=function(){this.source=null},t}(pe),_e=function(o){function t(t,e){if(e=e||{},!(t instanceof HTMLImageElement)){var i=new Image;o.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}o.call(this,t),this.url=t.src,this._process=null,
this.preserveBitmap=!1,this.createBitmap=(void 0!==e.createBitmap?e.createBitmap:S.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.premultiplyAlpha=!1!==e.premultiplyAlpha,this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}return o&&(
t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.load=function(t){var r=this;return void 0!==t&&(this.createBitmap=t),this._load||(this._load=new Promise(function(t){r.url=r.source.src;function e(){r.destroyed||(
i.onload=null,i.onerror=null,r.resize(i.width,i.height),r._load=null,r.createBitmap?t(r.process()):t(r))}var i=r.source;i.complete&&i.src?e():i.onload=e})),this._load},t.prototype.process=function(){var e=this
;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha?"premultiply":"none"}).then(
function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t,e,i){if(e.premultiplyAlpha=this.premultiplyAlpha,!this.createBitmap
)return o.prototype.upload.call(this,t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(o.prototype.upload.call(this,t,e,i,this.bitmap),!this.preserveBitmap){var r=!0;for(var n in e._glTextures){var s=e._glTextures[n];if(
s!==i&&s.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){o.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,
this._load=null},t}(me),ye=[];function ve(t,e){if(!t)return null;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=ye.length-1;0<=n;--n){var s=ye[n];if(s.test&&s.test(t,i))return new s(t,e)}
return new _e(t,e)}var ge=function(s){function t(t,e){var i=e||{},r=i.width,n=i.height;if(!r||!n)throw new Error("BufferResource width or height invalid");s.call(this,r,n),this.data=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)
).constructor=t).prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(
i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(t){
return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},t}(pe),xe={scaleMode:rt,format:z,premultiplyAlpha:!1},be=function(f){function o(t,e){void 0===t&&(t=null),void 0===e&&(e=null),f.call(this);var i=(e=e||{}
).premultiplyAlpha,r=e.mipmap,n=e.anisotropicLevel,s=e.scaleMode,o=e.width,a=e.height,h=e.wrapMode,u=e.format,l=e.type,c=e.target,d=e.resolution,p=e.resourceOptions;!t||t instanceof pe||((t=ve(t,p)).internal=!0),this.width=o||0,this.height=a||0,
this.resolution=d||S.RESOLUTION,this.mipmap=void 0!==r?r:S.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==n?n:S.ANISOTROPIC_LEVEL,this.wrapMode=h||S.WRAP_MODE,this.scaleMode=void 0!==s?s:S.SCALE_MODE,this.format=u||z,this.type=l||Q,this.target=c||q,
this.premultiplyAlpha=!1!==i,this.uid=mt(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<o&&0<a,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,
this._batchEnabled=0,this.setResource(t)}f&&(o.__proto__=f),(o.prototype=Object.create(f&&f.prototype)).constructor=o;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}};return t.realWidth.get=function(){return Math.ceil(
this.width*this.resolution)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution)},o.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,
i=!0),i&&this.dirtyStyleId++,this},o.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},o.prototype.setRealSize=function(t,e,i){
return this.resolution=i||this.resolution,this.width=Math.ceil(t/this.resolution),this.height=Math.ceil(e/this.resolution),this._refreshPOT(),this.update(),this},o.prototype._refreshPOT=function(){this.isPowerOfTwo=yt(this.realWidth)&&yt(this.realHeight)}
,o.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.ceil(this.width*e/t),this.height=Math.ceil(this.height*e/t),this.emit("update",this)),this._refreshPOT()),this},
o.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},o.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,
this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},o.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),
this.resource=null),this.cacheId&&(delete bt[this.cacheId],delete xt[this.cacheId],this.cacheId=null),this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},o.prototype.dispose=function(){this.emit("dispose",this)},
o.from=function(t,e){var i=null;i="string"==typeof t?t:(t._pixiId||(t._pixiId="pixiid_"+mt()),t._pixiId);var r=bt[i];return r||((r=new o(t,e)).cacheId=i,o.addToCache(r,i)),r},o.fromBuffer=function(t,e,i,r){t=t||new Float32Array(e*i*4);var n=new ge(t,{
width:e,height:i}),s=t instanceof Float32Array?tt:Q;return new o(n,Object.assign(xe,r||{width:e,height:i,type:s}))},o.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),bt[e]&&console.warn(
"BaseTexture added to the cache with an id ["+e+"] that already had an entry"),bt[e]=t)},o.removeFromCache=function(t){if("string"==typeof t){var e=bt[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete bt[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete bt[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(o.prototype,t),o}(h.a);be._globalBatch=0;var Te=function(a){function t(t,e){
var i;e=e||{};var r=t;Array.isArray(t)&&(r=(i=t).length),a.call(this,e.width,e.height),this.items=[],this.itemDirtyIds=[];for(var n=0;n<r;n++){var s=new be;this.items.push(s),this.itemDirtyIds.push(-1)}if(this.length=r,this._load=null,i)for(
var o=0;o<r;o++)this.addResourceAt(ve(i[o],e),o)}return a&&(t.__proto__=a),((t.prototype=Object.create(a&&a.prototype)).constructor=t).prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,
this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},
t.prototype.bind=function(t){a.prototype.bind.call(this,t),t.target=Z;for(var e=0;e<this.length;e++)this.items[e].on("update",t.update,t)},t.prototype.unbind=function(t){a.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++)this.items[e].off(
"update",t.update,t)},t.prototype.load=function(){var r=this;if(this._load)return this._load;var n=this.items.map(function(t){return t.resource}),t=n.map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){var t=n[0],e=t.width,
i=t.height;return r.resize(e,i),Promise.resolve(r)}),this._load},t.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,
e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},t}(pe),Ee=function(t){function e(){t.apply(
this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(me),we=function(r){function o(t,e){if(
e=e||{},r.call(this,t,e),this.length!==o.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var i=0;i<o.SIDES;i++)this.items[i].target=J+i;!1!==e.autoLoad&&this.load()}return r&&(o.__proto__=r),((o.prototype=Object.create(
r&&r.prototype)).constructor=o).prototype.bind=function(t){r.prototype.bind.call(this,t),t.target=K},o.prototype.upload=function(t,e,i){for(var r=this.itemDirtyIds,n=0;n<o.SIDES;n++){var s=this.items[n];r[n]<s.dirtyId&&(r[n]=s.dirtyId,
s.valid&&s.resource.upload(t,s,i))}return!0},o}(Te);we.SIDES=6;var Ae=function(i){function r(t,e){e=e||{},i.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,
this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}return i&&(r.__proto__=i),((r.prototype=Object.create(i&&i.prototype)).constructor=r).prototype.load=function(){var e=this
;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.")
;e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()})),this._load},r.prototype._loadSvg=function(){var s=this,o=new Image;i.crossOrigin(o,this.svg,this._crossorigin),o.src=this.svg,o.onload=function(){var t=o.width,
e=o.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=t*s.scale,r=e*s.scale;(s._overrideWidth||s._overrideHeight)&&(i=s._overrideWidth||s._overrideHeight/e*t,
r=s._overrideHeight||s._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);var n=s.source;n.width=i,n.height=r,n._pixiId="canvas_"+mt(),n.getContext("2d").drawImage(o,0,0,t,e,0,0,i,r),s._resolve(),s._resolve=null}},r.getSize=function(t){
var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},r.prototype.dispose=function(){i.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},r.test=function(t,e){
return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(me)
;Ae.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Se=function(l){function i(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){var i=document.createElement(
"video");i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),l.crossOrigin(i,t[0].src||t[0],e.crossorigin);for(var r=0;r<t.length;++r){var n=document.createElement("source"),s=t[r],o=s.src,a=s.mime,h=(
o=o||t[r]).split("?").shift().toLowerCase(),u=h.substr(h.lastIndexOf(".")+1);a=a||"video/"+u,n.src=o,n.type=a,i.appendChild(n)}t=i}l.call(this,t),this._autoUpdate=!0,this._isAutoUpdating=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,
this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),!1!==e.autoLoad&&this.load()}l&&(i.__proto__=l);var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return((i.prototype=Object.create(
l&&l.prototype)).constructor=i).prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var e=Rt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(
l.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},i.prototype.load=function(){var e=this;if(this._load)return this._load;var i=this.source;return(
i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady(
)?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay)),this._load=new Promise(function(t){e.valid?t(e):(e._resolve=t,i.load())}),this._load},i.prototype._isSourcePlaying=function(){
var t=this.source;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},i.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},i.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),
!this._isAutoUpdating&&this.autoUpdate&&(Rt.shared.add(this.update,this),this._isAutoUpdating=!0)},i.prototype._onPlayStop=function(){this._isAutoUpdating&&(Rt.shared.remove(this.update,this),this._isAutoUpdating=!1)},i.prototype._onCanPlay=function(){
var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),
this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},i.prototype.dispose=function(){this._isAutoUpdating&&Rt.shared.remove(this.update,this),this.source&&(this.source.pause(),this.source.src="",this.source.load()),l.prototype.dispose.call(
this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(Rt.shared.remove(this.update,this),this._isAutoUpdating=!1
):this._autoUpdate&&!this._isAutoUpdating&&(Rt.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},i.test=function(t,e){
return t instanceof HTMLVideoElement||-1<i.TYPES.indexOf(e)},Object.defineProperties(i.prototype,t),i}(me);Se.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var Ie=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((
e.prototype=Object.create(t&&t.prototype)).constructor=e).test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(me);ye.push(_e,Ie,Ee,Se,Ae,ge,we,Te);function Ce(t){this.renderer=t}Ce.prototype.destroy=function(){
this.renderer=null};function Oe(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},
this.disposeRunner=new r("disposeFramebuffer",2)}var Re=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.upload=function(t,e,i){var r=t.gl
;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,
r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(ge),Pe={colorTexture:{configurable:!0}};Pe.colorTexture.get=function(){return this.colorTextures[0]},Oe.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),
this.colorTextures[t]=e||new be(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Oe.prototype.addDepthTexture=function(t){return this.depthTexture=t||new be(new Re(null,{
width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:W,type:$}),this.dirtyId++,this.dirtyFormat++,this},Oe.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,
this.dirtyFormat++,this},Oe.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Oe.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,
this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},
Oe.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties(Oe.prototype,Pe);function Me(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}var Ne=function(n){
function t(t){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});n.call(this,null,t);var e=t||{},i=e.width,r=e.height;this.mipmap=!1,this.width=Math.ceil(i)||100,this.height=Math.ceil(r)||100,
this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new Oe(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this).enableStencil(),this.stencilMaskStack=[],this.filterStack=[{}]}return n&&(
t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose()
,n.prototype.dispose.call(this)},t.prototype.destroy=function(){n.prototype.destroy.call(this,!0),this.framebuffer=null},t}(be);Me.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=te.add(i
,te.NW),this.x0=a+s*te.uX(i),this.y0=h+o*te.uY(i),i=te.add(i,2),this.x1=a+s*te.uX(i),this.y1=h+o*te.uY(i),i=te.add(i,2),this.x2=a+s*te.uX(i),this.y2=h+o*te.uY(i),i=te.add(i,2),this.x3=a+s*te.uX(i),this.y3=h+o*te.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,
this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,
this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Le=new Me,Fe=function(o){function a(t,e,i,r,n,s){if(o.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new ie(0,0,1,1)),t instanceof a&&(
t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=Le,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(this._rotate%2!=0)throw new Error(
"attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new Nt(s.x,s.y):new Nt(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",
this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}o&&(a.__proto__=o);var t={frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return((a.prototype=Object.create(
o&&o.prototype)).constructor=a).prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},a.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,
this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},a.prototype.destroy=function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;e&&xt[e.url]&&a.removeFromCache(e.url),
this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,a.removeFromCache(this),this.textureCacheIds=null},
a.prototype.clone=function(){return new a(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},a.prototype.updateUvs=function(){this._uvs===Le&&(this._uvs=new Me),this._uvs.set(this._frame,this.baseTexture,this.rotate),
this._updateID++},a.from=function(t,e){void 0===e&&(e={});var i=null;i="string"==typeof t?t:(t._pixiId||(t._pixiId="pixiid_"+mt()),t._pixiId);var r=xt[i];return r||(e.resolution||(e.resolution=At(t)),(r=new a(new be(t,e))).baseTexture.cacheId=i,
be.addToCache(r.baseTexture,i),a.addToCache(r,i)),r},a.fromBuffer=function(t,e,i,r){return new a(be.fromBuffer(t,e,i,r))},a.fromLoader=function(t,e,i){var r=new _e(t);r.url=e;var n=new a(new be(r,{scaleMode:S.SCALE_MODE,resolution:At(e)}));return i=i||e,
be.addToCache(n.baseTexture,i),a.addToCache(n,i),i!==e&&(be.addToCache(n.baseTexture,e),a.addToCache(n,e)),n},a.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),xt[e]&&console.warn(
"Texture added to the cache with an id ["+e+"] that already had an entry"),xt[e]=t)},a.removeFromCache=function(t){if("string"==typeof t){var e=xt[t];if(e){var i=e.textureCacheIds.indexOf(t);return-1<i&&e.textureCacheIds.splice(i,1),delete xt[t],e}
}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)xt[t.textureCacheIds[r]]===t&&delete xt[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},t.frame.get=function(){return this._frame},t.frame.set=function(t){
this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,u="Y: "+i+" + "+n+" = "+(i+n
)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},
t.rotate.get=function(){return this._rotate},t.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){return this.orig.height},Object.defineProperties(a.prototype,t),a}(
h.a);function De(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Fe.EMPTY=new Fe(new be),De(Fe.EMPTY),De(Fe.EMPTY.baseTexture),Fe.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16
;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Fe(new be(new Ee(t)))}(),De(Fe.WHITE),De(Fe.WHITE.baseTexture);function Ue(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,
this._pixelsHeight=0}var Be=function(a){function n(t,e){var i=null;if(!(t instanceof Ne)){var r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4];console.warn("Please use RenderTexture.create("+r+", "+n+") instead of the ctor directly."),
i=arguments[0],e=null,t=new Ne({width:r,height:n,scaleMode:s,resolution:o})}a.call(this,t,e),this.legacyRenderer=i,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return a&&(n.__proto__=a),((n.prototype=Object.create(
a&&a.prototype)).constructor=n).prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=0<t&&0<e,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs(
)},n.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},n.create=function(t,e,i,r){return"number"==typeof t&&(t={width:t,height:e,scaleMode:i,resolution:r}),new n(new Ne(t))}
,n}(Fe);Ue.prototype.createTexture=function(t,e){var i=new Ne(Object.assign({width:t,height:e},this.textureOptions));return new Be(i)},Ue.prototype.getOptimalTexture=function(t,e,i){void 0===i&&(i=1);var r=Ue.SCREEN_KEY;t*=i,e*=i,
this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=_t(t)))<<16|65535&(e=_t(e))),this.texturePool[r]||(this.texturePool[r]=[]);var n=this.texturePool[r].pop();return(n=n||this.createTexture(t,e)).filterPoolKey=r,
n.setResolution(i),n},Ue.prototype.getFilterTexture=function(t){var e=this.renderer.renderTexture.current,i=this.getOptimalTexture(e.width,e.height,t||e.baseTexture.resolution);return i.filterFrame=e.filterFrame,i},Ue.prototype.returnTexture=function(t){
var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},Ue.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Ue.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(
var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},Ue.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var e=Ue.SCREEN_KEY,i=this.texturePool[e];if(this.enableFullScreen=0<t.width&&0<t.height,i
)for(var r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Ue.SCREEN_KEY="screen";function ke(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,
this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o}ke.prototype.destroy=function(){this.buffer=null},ke.from=function(t,e,i,r,n){return new ke(t,e,i,r,n)};function Xe(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),
this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=Ge++,this.disposeRunner=new r("disposeBuffer",2)}var Ge=0;function Ve(t){if(4===t.BYTES_PER_ELEMENT
)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array"
;return null}Xe.prototype.update=function(t){this.data=t||this.data,this._updateID++},Xe.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Xe.prototype.destroy=function(){this.dispose(),this.data=null},Xe.from=function(t){
return t instanceof Array&&(t=new Float32Array(t)),new Xe(t)};var je={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function He(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,
this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=ze++,this.instanced=!1,this.instanceCount=1,this._size=null,this.disposeRunner=new r("disposeGeometry",2),this.refCount=0}var Ye={5126:4,5123:2,5121:1},ze=0,We={
Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};He.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error(
"You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new Xe(e));var h=t.split("|");if(1<h.length){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}var l=this.buffers.indexOf(e)
;return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new ke(l,i,r,n,s,o,a),this.instanced=this.instanced||a,this},He.prototype.getAttribute=function(t){return this.attributes[t]},He.prototype.getBuffer=function(t){
return this.buffers[this.getAttribute(t).buffer]},He.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new Xe(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},
He.prototype.getIndex=function(){return this.indexBuffer},He.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Xe;for(t in this.attributes){var n=this.attributes[t],
s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*Ye[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,u=0;u<t.length;u++){var l=e[u],c=t[u],d=Ve(c)
;n[d]||(n[d]=new je[d](o)),a=n[d];for(var p=0;p<c.length;p++){a[(p/l|0)*r+h+p%l]=c[p]}h+=l}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],
this.indexBuffer&&this.buffers.push(this.indexBuffer),this},He.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},He.prototype.dispose=function(){
this.disposeRunner.run(this,!1)},He.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer.destroy(),this.attributes=null},He.prototype.clone=function(){for(var t=new He,e=0;e<this.buffers.length;e++)t.buffers[e]=new Xe(
this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new ke(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(
this.indexBuffer)],t.indexBuffer.index=!0),t},He.merge=function(t){for(var e,i=new He,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++
)r[h]=new(We[Ve(e.buffers[h].data)])(n[h]),i.buffers[h]=new Xe(r[h]);for(var u=0;u<t.length;u++){e=t[u];for(var l=0;l<e.buffers.length;l++)r[l].set(e.buffers[l].data,s[l]),s[l]+=e.buffers[l].data.length}if(i.attributes=e.attributes,e.indexBuffer){
i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,f=0,m=0;m<e.buffers.length;m++)if(e.buffers[m]!==e.indexBuffer){f=m;break}for(var _ in e.attributes){var y=e.attributes[_];(0|y.buffer)===f&&(
d+=y.size*Ye[y.type]/4)}for(var v=0;v<t.length;v++){for(var g=t[v].indexBuffer.data,x=0;x<g.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[f].data.length/d,p+=g.length}}return i};function qe(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},
this.dirtyId=0,this.id=Je++,this.static=!!e}var Ke=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(He),
Ze=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Xe(this.vertices),this.uvBuffer=new Xe(this.uvs),this.addAttribute("aVertexPosition",
this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,
this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,
this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(He),Je=0
;qe.prototype.update=function(){this.dirtyId++},qe.prototype.add=function(t,e,i){this.uniforms[t]=new qe(e,i)},qe.from=function(t,e){return new qe(t,e)};function Qe(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,
this.sourceFrame=new ie,this.destinationFrame=new ie,this.filters=[]}Qe.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};function $e(t){this.renderer=t}var ti=function(e){function t(t){e.call(this,t),
this.defaultFilterStack=[{}],this.texturePool=new Ue,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Ke,this.quadUv=new Ze,this.tempRect=new ie,this.activeState={},this.globalUniforms=new qe({outputFrame:this.tempRect,
inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Qe,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,
u=1;u<e.length;u++){var l=e[u];s=Math.min(s,l.resolution),o=Math.max(o,l.padding),a=a||l.autoFit,h=h||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,
n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),
n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},t.prototype.pop=function(){
var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,
n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){
var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,
h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,u,l,!0,e);var d=u;u=l,
l=d}i[c].apply(this,u,h.renderTexture,!1,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),
r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.set(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(H)):(n.geometry.bind(
this.quad),n.geometry.draw(Y))},t.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(Dt.TEMP_MATRIX);return a.invert()
,o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),this.texturePool.getOptimalTexture(t,
e,i)},t.prototype.getFilterTexture=function(t){var e=this.activeState.renderTexture,i=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return i.filterFrame=e.filterFrame,i},t.prototype.returnFilterTexture=function(t){
this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t}(Ce);$e.prototype.flush=function(){},$e.prototype.destroy=function(){
this.renderer=null},$e.prototype.start=function(){},$e.prototype.stop=function(){this.flush()},$e.prototype.render=function(t){};var ei=function(e){function t(t){e.call(this,t),this.emptyRenderer=new $e(t),this.currentRenderer=this.emptyRenderer}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},
t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t}(Ce);S.PREFER_ENV=o.a.any?c.WEBGL:c.WEBGL2;function ii(t){this.buffer=t,this.updateID=-1,this.byteLength=-1
,this.refCount=0}var ri=0,ni=function(e){function t(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener(
"webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={isLost:{configurable:!0}}
;return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=ri++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension(
"WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=ri++,this.renderer.runners.contextChange.run(t)},t.prototype.initFromOptions=function(t){
var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var i;if(S.PREFER_ENV>=c.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e
)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},t.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(
this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension(
"MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension(
"OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(
this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(t){
t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),
t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.gl.flush()},
t.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(t.prototype,i),t}(Ce),si=function(e){function t(t){
e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new Oe(10,10)}e&&(t.__proto__=e);var i={size:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ie,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){
var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;S.PREFER_ENV===c.WEBGL_LEGACY&&(i=e=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(
this.writeDepthTexture=!1)}},t.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(
r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++
)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height
):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},
t.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,
height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},t.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},t.prototype.initFramebuffer=function(t){
var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},t.prototype.resizeFramebuffer=function(t){
var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(
r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){
var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(
this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((1<n.length&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){
var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(
e.RENDERBUFFER,i.stencil),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height))},t.prototype.disposeFramebuffer=function(t,e){
var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);0<=n&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),
i.stencil&&r.deleteRenderbuffer(i.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},t.prototype.reset=function(){
this.current=this.unknownFramebuffer,this.viewport=new ie},Object.defineProperties(t.prototype,i),t}(Ce),oi={5126:4,5123:2,5121:1},ai=function(e){function t(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,
this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var i=this.renderer.context.extensions.vertexArrayObject;S.PREFER_ENV===c.WEBGL_LEGACY&&(i=null),i?(
t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},
t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=function(t,e){return s.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,
i,r,n){return s.drawElementsInstancedANGLE(t,e,i,r,n)},t.drawArraysInstanced=function(t,e,i,r){return s.drawArraysInstancedANGLE(t,e,i,r)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},
t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||((this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={})
;var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},
t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID
;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),(this._boundBuffer=n).byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s
,r.data,o)}}}},t.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},t.prototype.getSignature=function(t,e){
var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},t.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),
s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o;var a=t.buffers,h=t.attributes,u={},l={};for(var c in a)u[c]=0,l[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn(
"PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*oi[h[d].type];for(var p in h){var f=h[p],m=f.size;void 0===f.stride&&(
u[f.buffer]===m*oi[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=l[f.buffer],l[f.buffer]+=m*oi[f.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){var y=a[_];y._glBuffers[r]||(y._glBuffers[r]=new ii(
i.createBuffer()),(this.managedBuffers[y.id]=y).disposeRunner.add(this)),y._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o},t.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){
delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]
){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,
0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(
var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},
t.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],u=n[h.buffer]._glBuffers[r];if(
e.attributeData[a]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[a].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance
)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},t.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,
a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn(
"unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,
this._activeGeometry=null},t}(Ce);function hi(t,e,i,r){var n=ui(t,t.VERTEX_SHADER,e),s=ui(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),
t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o
)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function ui(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),
t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function li(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":
return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return ci(2*e)
;case"bvec3":return ci(3*e);case"bvec4":return ci(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function ci(t){
for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}var di,pi=null;function fi(){if(pi)return pi;var t,e=document.createElement("canvas");if(S.PREFER_ENV>=c.WEBGL2&&(t=e.getContext("webgl2",{})),!t){if(!(t=e.getContext("webgl",{})||e.getContext(
"experimental-webgl",{})))throw new Error("This browser does not support WebGL. Try using the canvas renderer");t.getExtension("WEBGL_draw_buffers")}return pi=t}function mi(t,e,i){if("precision"===t.substring(0,9)
)return i!==ht&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return e===ht&&i!==ht&&(r=at),"precision "+r+" float;\n"+t}var _i={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,
bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};var yi=null,vi={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",
BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function gi(t,e){if(!yi){var i=Object.keys(vi);yi={};for(var r=0;r<i.length;++r){var n=i[r]
;yi[t[n]]=vi[n]}}return yi[e]}var xi={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",
vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",
vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",
vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",
bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",
mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},bi={float:"gl.uniform1fv(location, v)",
vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",
int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",
bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Ti,Ei=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%",
"gl_FragColor = vec4(0.0);","}"].join("\n");function wi(t){for(var e="",i=0;i<t;++i)0<i&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function Ai(t,e,i){void 0===i&&(i="pixi-shader"),this.id=Si++,this.vertexSrc=t||Ai.defaultVertexSrc,
this.fragmentSrc=e||Ai.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Ii[i]?(Ii[i]++,i+="-"+Ii[i]):Ii[i]=1,
this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=mi(this.vertexSrc,S.PRECISION_VERTEX,ht),this.fragmentSrc=mi(this.fragmentSrc,S.PRECISION_FRAGMENT,function(){if(!di
){di=at;var t=fi();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);di=e.precision?ht:at}}return di}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}var Si=0
,Ii={},Ci={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Ai.prototype.extractData=function(t,e){var i=fi();if(i){var r=hi(i,t,e);this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),
i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},Ai.prototype.getAttributeData=function(t,e){for(var i,r={},n=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<s;o++){var a=e.getActiveAttrib(t,o),h=gi(e,a.type),u={type:h,
name:a.name,size:(i=h,_i[i]),location:0};r[a.name]=u,n.push(u)}n.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<n.length;l++)n[l].location=l;return r},Ai.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,
e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=gi(e,s.type);i[o]={type:h,size:s.size,isArray:a,value:li(h,s.size)}}return i},Ci.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"
},Ci.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},Ai.from=function(t,e,i){var r=t+e,n=gt[r];return n||(gt[r]=n=new Ai(t
,e,i)),n},Object.defineProperties(Ai,Ci);function Oi(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof qe?e:new qe(e):new qe({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(
this.uniformGroup.uniforms[i]))}var Ri={uniforms:{configurable:!0}};Oi.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},
Oi.prototype.destroy=function(){this.uniformGroup=null},Ri.uniforms.get=function(){return this.uniformGroup.uniforms},Oi.from=function(t,e,i){var r=Ai.from(t,e);return new Oi(r,i)},Object.defineProperties(Oi.prototype,Ri);function Pi(){this.data=0,
this.blendMode=f,this.polygonOffset=0,this.blend=!0}var Mi={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{
configurable:!0}};Mi.blend.get=function(){return!!(1&this.data)},Mi.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},Mi.offsets.get=function(){return!!(2&this.data)},Mi.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},
Mi.culling.get=function(){return!!(4&this.data)},Mi.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},Mi.depthTest.get=function(){return!!(8&this.data)},Mi.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},
Mi.clockwiseFrontFace.get=function(){return!!(16&this.data)},Mi.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},Mi.blendMode.get=function(){return this._blendMode},Mi.blendMode.set=function(t){this.blend=t!==F,this._blendMode=t},
Mi.polygonOffset.get=function(){return this._polygonOffset},Mi.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},Pi.for2d=function(){var t=new Pi;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(Pi.prototype,Mi)
;var Ni=function(n){function s(t,e,i){var r=Ai.from(t||s.defaultVertexSrc,e||s.defaultFragmentSrc);n.call(this,r,i),this.padding=0,this.resolution=S.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,
this.state=new Pi}n&&(s.__proto__=n);var t={blendMode:{configurable:!0}},e={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return((s.prototype=Object.create(n&&n.prototype)).constructor=s).prototype.apply=function(t,e,i,r,n){
t.applyFilter(this,e,i,r,n)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(t){this.state.blendMode=t},e.defaultVertexSrc.get=function(){
return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"
},e.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(s.prototype,t),Object.defineProperties(s,e),s
}(Oi);Ni.SOURCE_KEY_MAP={};function Li(t,e){this._texture=t,this.mapCoord=new Dt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}
var Fi=new Dt,Di={texture:{configurable:!0}};Di.texture.get=function(){return this._texture},Di.texture.set=function(t){this._texture=t,this._updateID=-1},Li.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2
){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},Li.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs
;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(Fi.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Fi));var s=e.baseTexture,o=this.uClampFrame,
a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,
this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(Li.prototype,Di);function Ui(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}var Bi=function(i){
function t(t){var e=new Dt;i.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"
,
"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"
),t.renderable=!1,this.maskSprite=t,this.maskMatrix=e}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(
s.transform=new Li(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.premultiplyAlpha?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),
this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},t}(Ni),ki=function(e){function t(t){e.call(this,t),this.scissor=!1,this.scissorData=null,this.scissorRenderTarget=null,this.enableScissor=!1,
this.alphaMaskPool=[],this.alphaMaskIndex=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.push=function(t,e){if(e.isSprite)this.pushSpriteMask(t,e);else if(
this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencil.stencilMaskStack.length&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a);(r=Math.round(r*(180/Math.PI)))%90?this.pushStencilMask(e
):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},t.prototype.pop=function(t,e){e.isSprite?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencil.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},
t.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool[this.alphaMaskIndex];(i=i||(this.alphaMaskPool[this.alphaMaskIndex]=[new Bi(e)]))[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var r=t.filterArea;t.filterArea=e.getBounds(!0),
this.renderer.filter.push(t,i),t.filterArea=r,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t.prototype.pushStencilMask=function(t){this.renderer.batch.flush(),
this.renderer.stencil.pushStencil(t)},t.prototype.popStencilMask=function(){this.renderer.stencil.popStencil()},t.prototype.pushScissorMask=function(t,e){e.renderable=!0;var i=this.renderer._activeRenderTarget,r=e.getBounds();r.fit(i.size),e.renderable=!1
,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var n=this.renderer.resolution;this.renderer.gl.scissor(r.x*n,(i.root?i.size.height-r.y-r.height:r.y)*n,r.width*n,r.height*n),this.scissorRenderTarget=i,this.scissorData=e,this.scissor=!0},
t.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},t}(Ce),Xi=function(e){function t(t){e.call(this,t),this.stencilMaskStack=[]}return e&&(
t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.setMaskStack=function(t){var e=this.renderer.gl;t.length!==this.stencilMaskStack.length&&(0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)),
this.stencilMaskStack=t},t.prototype.pushStencil=function(t){var e=this.renderer.gl,i=this.stencilMaskStack.length;0===i&&e.enable(e.STENCIL_TEST),this.stencilMaskStack.push(t),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,i,this._getBitwiseMask()),
e.stencilOp(e.KEEP,e.KEEP,e.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},t.prototype.popStencil=function(){var t=this.renderer.gl,e=this.stencilMaskStack.pop()
;0===this.stencilMaskStack.length?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,
this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},t.prototype._getBitwiseMask=function(){
return(1<<this.stencilMaskStack.length)-1},t.prototype.destroy=function(){e.prototype.destroy.call(this,this),this.stencilMaskStack=null},t}(Ce),Gi=function(e){function t(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,
this.defaultFrame=null,this.projectionMatrix=new Dt,this.transform=null}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.update=function(t,e,i,r){
this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer
;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(
n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},t.prototype.setTransform=function(){},t}(Ce),Vi=new ie,ji=function(e){function t(t){e.call(this,t),
this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ie,this.destinationFrame=new ie}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.bind=function(t,e,i){
void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture;r=s.resolution,i||(Vi.width=s.realWidth,Vi.height=s.realHeight,i=Vi),e=e||i,this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),
this.renderer.stencil.setMaskStack(s.stencilMaskStack)}else r=this.renderer.resolution,i||(Vi.width=n.width,Vi.height=n.height,i=Vi),e=e||i,n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.stencil.setMaskStack(
this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},
t.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(Ce
);Ui.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Hi=0,Yi=function(e){function t(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Hi++}
return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Ti)return Ti;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;")
;Ti=!0===t({a:"b"},"a","b")}catch(t){Ti=!1}return Ti}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},
t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),
e||this.syncUniformGroup(t.uniformGroup),r},t.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t){
var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},t.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,
t.uniforms,this.renderer)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(
var n in t.uniforms){var s=e[n];if(s)if("float"===s.type&&1===s.size
)r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n";else if(
"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray)if("mat3"===s.type&&1===s.size
)void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n";else if(
"vec2"===s.type&&1===s.size
)void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n";else if(
"vec4"===s.type&&1===s.size
)void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n";else{
r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?xi:bi)[s.type].replace("location","ud."+n+".location")+";\n"
}else r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n"
,i++;else t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e]
,t.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},t.prototype.getglProgram=function(){
return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=hi(e,i.vertexSrc,i.fragmentSrc,r),
o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:li(h.type,h.size)}}var u=new Ui(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=u},t.prototype.reset=function(){this.program=null,this.shader=null},
t.prototype.destroy=function(){this.destroyed=!0},t}(Ce);function zi(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}var Wi=function(e){
function i(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=F,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,
this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Pi,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(i.__proto__=e),((i.prototype=Object.create(e&&e.prototype)).constructor=i).prototype.contextChange=function(t){this.gl=t
,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[f]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[m]=[t.ONE,t.ONE],e[_]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[y]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[v]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[g]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[x]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[b]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[T]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[E]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[w]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[A]=[t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[I]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[O]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[R]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[F]=[0,0],e[M]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,
t.ONE_MINUS_SRC_ALPHA],e[N]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[L]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[D]=[t.DST_ALPHA,t.ZERO],e[U]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[B]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[k]=[
t.ONE_MINUS_DST_ALPHA,t.ONE],e[X]=[t.ZERO,t.SRC_ALPHA],e[G]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[V]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[j]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},
i.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},
i.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t);this.stateId=t.data},i.prototype.setBlend=function(t){
this.updateCheck(i.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},i.prototype.setOffset=function(t){this.updateCheck(i.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},i.prototype.setDepthTest=function(t){
this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},i.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},i.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},i.prototype.setBlendMode=function(t){
if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,
i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},i.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},i.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1
,this.setBlendMode(0)},i.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},i.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},i.checkPolygonOffset=function(t,e){
t.setPolygonOffset(e.polygonOffset,0)},i}(Ce),qi=function(e){function t(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=S.GC_MAX_IDLE,this.checkCountMax=S.GC_MAX_CHECK_COUNT,this.mode=S.GC_MODE}return e&&(t.__proto__=e),((
t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.postrender=function(){this.count++,this.mode!==ot&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},t.prototype.run=function(){for(
var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),i=!(e[r]=null))}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},
t.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var i=t.children.length-1;0<=i;i--)this.unload(t.children[i])},t}(Ce),Ki=function(e){function t(t){e.call(this,t),
this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new be}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.contextChange=function(){
var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null
;this.emptyTextures={};var r=new zi(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,
this.emptyTextures[t.TEXTURE_CUBE_MAP]=new zi(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null)
;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},t.prototype.bind=function(t,e){void 0===e&&(e=0)
;var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),
this.boundTextures[e]!==t&&i.bindTexture(t.target,r.texture),r.dirtyId!==t.dirtyId&&this.updateTexture(t),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,
this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},
t.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(
this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},t.prototype.initTexture=function(t){var e=new zi(this.gl.createTexture());return e.dirtyId=-1,
t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl
;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===et&&(e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e
){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,
e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(
t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&pt(this.managedTextures,r,1)}},t.prototype.updateTextureStyle=function(t){
var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==st&&2===this.webGLVersion||t.isPowerOfTwo?(e.mipmap=1<=t.mipmap,e.wrapMode=t.wrapMode):(e.mipmap=0,e.wrapMode=nt),t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),
e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(
t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&0<t.anisotropicLevel&&t.scaleMode===it){var n=Math.min(t.anisotropicLevel,i.getParameter(
r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},
t}(Ce),Zi=new Dt;h.a;function Ji(){this.textures=[],this.ids=[],this.blend=0,this.textureCount=0,this.start=0,this.size=0,this.type=4}function Qi(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),
this.float32View=new Float32Array(this.rawBinaryData)}var $i={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};$i.int8View.get=function(){return this._int8View||(
this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},$i.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},$i.int16View.get=function(){return this._int16View||(
this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},$i.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},$i.int32View.get=function(){return this._int32View||(
this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},Qi.prototype.view=function(t){return this[t+"View"]},Qi.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,
this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},Qi.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:
throw new Error(t+" isn't a valid view type")}},Object.defineProperties(Qi.prototype,$i);function tr(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error(
'Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}var er=function(i){function t(t){i.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,
this.state=Pi.for2d(),this.size=8e3,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._drawCalls=[];for(
var e=0;e<this.size/4;e++)this._drawCalls[e]=new Ji;this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this)}return i&&(t.__proto__=i),((t.prototype=Object.create(
i&&i.prototype)).constructor=t).prototype.contextChange=function(){var t=this.renderer.gl;S.PREFER_ENV===c.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),S.SPRITE_MAX_TEXTURES),
this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Ei.replace(/%forloop%/gi,wi(t));if(e.shaderSource(i,r),e.compileShader(i),
e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass},
t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,
this._bufferedElements[this._bufferSize++]=t)},t.prototype.flush=function(){if(0!==this._vertexCount){var t,e,i=this.getAttributeBuffer(this._vertexCount),r=this.getIndexBuffer(this._indexCount),n=this.renderer.gl,s=this._bufferedElements,
o=this._drawCalls,a=this.MAX_TEXTURES,h=this._packedGeometries,u=this.vertexSize,l=this.renderer.textureGC.count,c=0,d=0,p=0,f=o[0],m=0,_=-1;f.textureCount=0,f.start=0,f.blend=_;var y,v=++be._globalBatch;for(y=0;y<this._bufferSize;++y){var g=s[y]
;s[y]=null,t=g._texture.baseTexture;var x=dt[t.premultiplyAlpha?1:0][g.blendMode];_!==x&&(_=x,e=null,p=a,v++),e!==t&&(e=t)._batchEnabled!==v&&(p===a&&(v++,p=0,f.size=d-f.start,(f=o[m++]).textureCount=0,f.blend=_,f.start=d),t.touched=l,t._batchEnabled=v,
t._id=p,f.textures[f.textureCount++]=t,p++),this.packInterleavedGeometry(g,i,r,c,d),c+=g.vertexData.length/2*u,d+=g.indices.length}be._globalBatch=v,f.size=d-f.start,S.CAN_UPLOAD_SAME_BUFFER?(h[this._flushId]._buffer.update(i.rawBinaryData,0),
h[this._flushId]._indexBuffer.update(r,0),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,h[this._flushId]=new this.geometryClass),h[this._flushId]._buffer.update(i.rawBinaryData,0),
h[this._flushId]._indexBuffer.update(r,0),this.renderer.geometry.bind(h[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++);var b=this.renderer.texture,T=this.renderer.state;for(y=0;y<m;y++){for(var E=o[y],w=E.textureCount,A=0;A<w;A++
)b.bind(E.textures[A],A),E.textures[A]=null;T.setBlendMode(E.blend),n.drawElements(E.type,E.size,n.UNSIGNED_SHORT,2*E.start)}this._bufferSize=0,this._vertexCount=0,this._indexCount=0}},t.prototype.start=function(){this.renderer.state.set(this.state),
this.renderer.shader.bind(this._shader),S.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++
)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._drawCalls=null,this._shader&&(this._shader.destroy(),
this._shader=null),i.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(t){var e=_t(Math.ceil(t/8)),i=vt(e),r=8*e;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new Qi(
r*this.vertexSize*4)),n},t.prototype.getIndexBuffer=function(t){var e=_t(Math.ceil(t/12)),i=vt(e),r=12*e;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n},
t.prototype.packInterleavedGeometry=function(t,e,i,r,n){for(var s=e.uint32View,o=e.float32View,a=r/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._id,d=Math.min(t.worldAlpha,1),
p=d<1&&t._texture.baseTexture.premultiplyAlpha?function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(n=n*e+.5|0)}(t._tintRGB,d):t._tintRGB+(255*d<<24),
f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=h[f],o[r++]=h[f+1],s[r++]=p,o[r++]=c;for(var m=0;m<u.length;m++)i[n++]=a+u[m]},t}($e);tr.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i
;this.defaultGroupCache[t]=qe.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ai(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),
translationMatrix:new Dt,default:this.defaultGroupCache[t]};return new Oi(this.programCache[t],n)},tr.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)0<i&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",
e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"};function ir(){}var rr=function(e){function t(t){void 0===t&&(t=!1),e.call(this),this._buffer=new Xe(null,t,!1),this._indexBuffer=new Xe(null,t,!0),
this.addAttribute("aVertexPosition",this._buffer,2,!1,tt).addAttribute("aTextureCoord",this._buffer,2,!1,tt).addAttribute("aColor",this._buffer,4,!0,Q).addAttribute("aTextureId",this._buffer,1,!0,tt).addIndex(this._indexBuffer)}return e&&(t.__proto__=e),(
t.prototype=Object.create(e&&e.prototype)).constructor=t}(He),
nr="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"
,sr="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",or={defaultVertexSrc:{configurable:!0},
defaultFragmentTemplate:{configurable:!0}};ir.create=function(t){var e=Object.assign({vertex:nr,fragment:sr,geometryClass:rr,vertexSize:6},t),i=e.vertex,r=e.fragment,n=e.vertexSize,s=e.geometryClass;return function(e){function t(t){e.call(this,t),
this.shaderGenerator=new tr(i,r),this.geometryClass=s,this.vertexSize=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(er)},or.defaultVertexSrc.get=function(){return nr},or.defaultFragmentTemplate.get=function(){
return sr},Object.defineProperties(ir,or);ir.create();i.d(e,"AdjustmentFilter",function(){return ar});var ar=function(e){function t(t){e.call(this,
"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}"
,
"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float gamma;\nuniform float contrast;\nuniform float saturation;\nuniform float brightness;\nuniform float red;\nuniform float green;\nuniform float blue;\nuniform float alpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (c.a > 0.0) {\n        c.rgb /= c.a;\n\n        vec3 rgb = pow(c.rgb, vec3(1. / gamma));\n        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);\n        rgb.r *= red;\n        rgb.g *= green;\n        rgb.b *= blue;\n        c.rgb = rgb * brightness;\n\n        c.rgb *= c.a;\n    }\n\n    gl_FragColor = c * alpha;\n}\n"
),Object.assign(this,{gamma:1,saturation:1,contrast:1,brightness:1,red:1,green:1,blue:1,alpha:1},t)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.apply=function(t,e,i,r){this.uniforms.gamma=Math.max(
this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,
t.applyFilter(this,e,i,r)},t}(Ni)}]);